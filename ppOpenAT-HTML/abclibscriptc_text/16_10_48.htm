
<html>
<head>
<title>OutputUnroll_Line_C メンバ関数説明</title><base target="main">
<link rel ="stylesheet" type="text/css" href="stylesheet.css" title="stylesheet">
<meta http-equiv="Content-Type" content="text/html;charset=Shift_JIS">
</head>

<body bgcolor="#ffffff">

<div align="right"><font size="2">ABCLibScriptC プロジェクト</font></div>

<table width=100% bgcolor="#e6e6fa" class="titlebgcolor" border="1" cellpadding="7" cellspacing="0">
<tr>
    <td><font class="titlefont">14.10.48. OutputUnroll_Line_C メンバ関数説明</font></td>
</tr>
</table>

<p></p>
<table border="1">
<tr><th align="left" nowrap>メンバ関数名</th>  <td nowrap>OutputUnroll_Line_C</td></tr>
<tr><th align="left" nowrap>定義ファイル名</th><td nowrap>TuneRegion.cpp</td></tr>
<tr><th align="left" nowrap>定義行</th>        <td nowrap>9474</td></tr>
<tr><th align="left" nowrap>所属名</th>        <td nowrap>TTuneRegion</td></tr>
<tr><th align="left" nowrap>アクセス属性</th>  <td nowrap>public</td></tr>
<tr><th align="left" nowrap>宣言形式</th>      <td nowrap>int OutputUnroll_Line_C ( FILE * fp , int TokPos , unsigned int UseDoRefValBits , int RefValIdx )</td></tr>
<tr><th align="left" nowrap>概要</th>          <td nowrap>多重化したコードを１行出力する。<br>UseDoRefValBitsとRefValIdxによるDo参照変数部分の置換を行った行を出力する。<br>RefValIdxは、Countに対しての番号となる。（呼び出し側から指定される）<br>ここから、別の解析を呼ぶことはない。<br>最後のトークン（通常はtid_LineEnd)の位置を返す。</td></tr>
<tr><th align="left" nowrap>戻り値</th>        <td nowrap></td></tr>
<tr><th align="left" nowrap>パラメタ説明</th>  <td nowrap>fp  出力先ファイルポインタ<br>TokPos  トークン位置<br>UseDoRefValBits 使用中ＤＯ参照変数Ｂｉｔｓ<br>RefValIdx   参照変数インデックス</td></tr>
<tr><th align="left" nowrap>機能説明</th>      <td nowrap></td></tr>
<tr><th align="left" nowrap>備考</th>          <td nowrap></td></tr>
</table>

<p></p>
呼出し元関数一覧表
<table border="1">
<tr>
<th nowrap>№</th>
<th nowrap>名称</th>
<th nowrap>定義ファイル名</th>
<th nowrap>定義行</th>
</tr>
<tr>
<td nowrap>1</td>
<td nowrap><a href="16_10_44.htm">TTuneRegion::OutputUnroll_DoBlock_C</a></td>
<td nowrap><a href="5_7.htm">TuneRegion.cpp</a></td>
<td nowrap><a href="16_10_44.htm">10311</a></td>
</tr>
<tr>
<td nowrap>2</td>
<td nowrap><a href="16_10_46.htm">TTuneRegion::OutputUnroll_IfBlock_C</a></td>
<td nowrap><a href="5_7.htm">TuneRegion.cpp</a></td>
<td nowrap><a href="16_10_46.htm">10955</a></td>
</tr>
<tr>
<td nowrap>3</td>
<td nowrap><a href="16_10_50.htm">TTuneRegion::OutputUnrollExecCode_C</a></td>
<td nowrap><a href="5_7.htm">TuneRegion.cpp</a></td>
<td nowrap><a href="16_10_50.htm">8945</a></td>
</tr>
</table>

<p></p>
呼出し先関数一覧表
<table border="1">
<tr>
<th nowrap>№</th>
<th nowrap>名称</th>
<th nowrap>定義ファイル名</th>
<th nowrap>定義行</th>
</tr>
<tr>
<td nowrap>1</td>
<td nowrap><a href="16_10_6.htm">TTuneRegion::ChangeFromOrgStr</a></td>
<td nowrap><a href="5_7.htm">TuneRegion.cpp</a></td>
<td nowrap><a href="16_10_6.htm">11408</a></td>
</tr>
<tr>
<td nowrap>2</td>
<td nowrap><a href="16_10_10.htm">TTuneRegion::GetBitIdx</a></td>
<td nowrap><a href="5_7.htm">TuneRegion.cpp</a></td>
<td nowrap><a href="16_10_10.htm">11287</a></td>
</tr>
<tr>
<td nowrap>3</td>
<td nowrap><a href="16_10_11.htm">TTuneRegion::GetDoValAddValue</a></td>
<td nowrap><a href="5_7.htm">TuneRegion.cpp</a></td>
<td nowrap><a href="16_10_11.htm">11455</a></td>
</tr>
<tr>
<td nowrap>4</td>
<td nowrap><a href="16_10_13.htm">TTuneRegion::GetNewValName</a></td>
<td nowrap><a href="5_7.htm">TuneRegion.cpp</a></td>
<td nowrap><a href="16_10_13.htm">11089</a></td>
</tr>
<tr>
<td nowrap>5</td>
<td nowrap><a href="16_10_14.htm">TTuneRegion::GetNewValName</a></td>
<td nowrap><a href="5_7.htm">TuneRegion.cpp</a></td>
<td nowrap><a href="16_10_14.htm">11245</a></td>
</tr>
<tr>
<td nowrap>6</td>
<td nowrap><a href="16_10_22.htm">TTuneRegion::GetValAddValue2</a></td>
<td nowrap><a href="5_7.htm">TuneRegion.cpp</a></td>
<td nowrap><a href="16_10_22.htm">11560</a></td>
</tr>
<tr>
<td nowrap>7</td>
<td nowrap><a href="16_10_30.htm">TTuneRegion::Merge_Unroll_Line_C</a></td>
<td nowrap><a href="5_7.htm">TuneRegion.cpp</a></td>
<td nowrap><a href="16_10_30.htm">9662</a></td>
</tr>
<tr>
<td nowrap>8</td>
<td nowrap>IntToStr</td>
<td nowrap><a href="5_16.htm">VCL_Lib.h</a></td>
<td nowrap>107</td>
</tr>
<tr>
<td nowrap>9</td>
<td nowrap>TrimRight</td>
<td nowrap><a href="5_16.htm">VCL_Lib.h</a></td>
<td nowrap>106</td>
</tr>
<tr>
<td nowrap>10</td>
<td nowrap>c_str</td>
<td nowrap><br></td>
<td nowrap><br></td>
</tr>
<tr>
<td nowrap>11</td>
<td nowrap>find</td>
<td nowrap><br></td>
<td nowrap><br></td>
</tr>
<tr>
<td nowrap>12</td>
<td nowrap>fprintf</td>
<td nowrap><br></td>
<td nowrap><br></td>
</tr>
<tr>
<td nowrap>13</td>
<td nowrap>fseek</td>
<td nowrap><br></td>
<td nowrap><br></td>
</tr>
<tr>
<td nowrap>14</td>
<td nowrap>ftell</td>
<td nowrap><br></td>
<td nowrap><br></td>
</tr>
<tr>
<td nowrap>15</td>
<td nowrap>length</td>
<td nowrap><br></td>
<td nowrap><br></td>
</tr>
</table>

<p></p>

<p></p>
参照メンバ変数一覧表
<table border="1">
<tr>
<th nowrap>№</th>
<th nowrap>名称</th>
<th nowrap>定義ファイル名</th>
<th nowrap>定義行</th>
</tr>
<tr>
<td nowrap>1</td>
<td nowrap>TTuneRegion::ArgValList</td>
<td nowrap><a href="5_15.htm">TuneRegion.h</a></td>
<td nowrap>207</td>
</tr>
<tr>
<td nowrap>2</td>
<td nowrap>TTuneRegion::DoValIdx</td>
<td nowrap><a href="5_15.htm">TuneRegion.h</a></td>
<td nowrap>159</td>
</tr>
<tr>
<td nowrap>3</td>
<td nowrap>TTuneRegion::DoValName</td>
<td nowrap><a href="5_15.htm">TuneRegion.h</a></td>
<td nowrap>158</td>
</tr>
<tr>
<td nowrap>4</td>
<td nowrap>TTuneRegion::OffsetStr</td>
<td nowrap><a href="5_15.htm">TuneRegion.h</a></td>
<td nowrap>214</td>
</tr>
<tr>
<td nowrap>5</td>
<td nowrap>TTuneRegion::TokenEndPos</td>
<td nowrap><a href="5_15.htm">TuneRegion.h</a></td>
<td nowrap>190</td>
</tr>
<tr>
<td nowrap>6</td>
<td nowrap>TTuneRegion::TokenList</td>
<td nowrap><a href="5_15.htm">TuneRegion.h</a></td>
<td nowrap>187</td>
</tr>
<tr>
<td nowrap>7</td>
<td nowrap>TTuneRegion::UnrollCount</td>
<td nowrap><a href="5_15.htm">TuneRegion.h</a></td>
<td nowrap>151</td>
</tr>
<tr>
<td nowrap>8</td>
<td nowrap>TTuneRegion::UnRollDoRefValBits</td>
<td nowrap><a href="5_15.htm">TuneRegion.h</a></td>
<td nowrap>149</td>
</tr>
</table>

<p></p>
参照先一覧表
<table border="1">
<tr>
<th nowrap>№</th>
<th nowrap>名称</th>
<th nowrap>種別</th>
<th nowrap>定義ファイル名</th>
<th nowrap>定義行</th>
</tr>
<tr>
<td nowrap>1</td>
<td nowrap><a href="16_9_1.htm">TToken</a></td>
<td nowrap>クラス</td>
<td nowrap><a href="5_10.htm">pass1.h</a></td>
<td nowrap><a href="16_9_1.htm">294</a></td>
</tr>
<tr>
<td nowrap>2</td>
<td nowrap><a href="16_11_1.htm">TValData</a></td>
<td nowrap>クラス</td>
<td nowrap><a href="5_11.htm">pass2.h</a></td>
<td nowrap><a href="16_11_1.htm">106</a></td>
</tr>
</table>

<p></p>
<pre>
関数論理チャート

        |  +------------------------------------------------------------------------------------------------------+ 
  9474  +--+ int TTuneRegion::OutputUnroll_Line_C(FILE *fp,int TokPos,unsigned int UseDoRefValBits,int RefValIdx) | 
  9475     | {                                                                                                    | 
           +--+---------------------------------------------------------------------------------------------------+ 
  9476        +--- string s;
  9477        +--- int Idx;
  9478        +--- int AddValue;   // 変数への加算数
  9479        +--- TValData *ValData;
  9480        +--- TToken *Token,*TokenB,*TokenF;
  9481        +--- int j;
  9482        +--- string OprCheckStr = &quot;(),&quot;;
  9483        +--- string NewValName;
  9484        +--- string NewLastOutputStr;
  9485        +--- int StartNestLevel;
  9486        +--- static long int LastOutputSPos = 0;
  9487        +--- static long int LastOutputEPos = 0;
  9488        +--- static string BaseOutputStr = &quot;&quot;;
  9489        +--- static string LastOutputStr = &quot;&quot;;
  9490        +--- long int CurOutputPos;
  9491        +--- int AddOprStrPos = -1;
  9492        +--- int StartTokPos;
  9493        |    
  9494        +--- Token = (TToken *)TokenList-&gt;Items[TokPos];
              |  +------------------------------------+ 
  9495        +--+ if(Token-&gt;TokId == tid_DaiKokka){  | 
              |  +--+---------------------------------+ 
  9496        |     +--- s = OffsetStr + Token-&gt;OrgStr;
  9497        |     +--- fprintf(fp,&quot;%s&quot;,s.c_str());
              |     |  +----------------+ 
  9498        |     +--+ return TokPos; | 
              |     |  +----------------+ 
              |   +-+---+ 
  9499        |   |  }  | 
              |   +-----+ 
  9500        +--- StartTokPos = TokPos;
  9501        +--- StartNestLevel = Token-&gt;BrNestLevel;
  9502        +--- s = &quot;&quot;;
              |  +----------------------------------------------------------------+ 
  9503        +--+ if(UseDoRefValBits == 0){ // UnRollなしの場合は、そのまま出力  | 
              |  +--+-------------------------------------------------------------+ 
              |     |  +------------------------------------------+ 
  9504        |     +--+ for( ; TokPos &lt; TokenEndPos ; TokPos++){ | 
              |     |  +--+---------------------------------------+ 
  9505        |     |     +--- Token = (TToken *)TokenList-&gt;Items[TokPos];
  9506        |     |     +--- s += Token-&gt;OrgStr;
              |     |     |  +----------------------+ 
  9507        |     |     +--+ if(Token-&gt;LineEndF){ | 
              |     |     |  +--+-------------------+ 
              |     |     |     |  +--------+ 
  9508        |     |     |     +--+ break; | 
              |     |     |     |  +--------+ 
              |     |     |   +-+---+ 
  9509        |     |     |   |  }  | 
              |     |     |   +-----+ 
              |     |   +-+---+ 
  9510        |     |   |  }  | 
              |     |   +-----+ 
  9511        |     +--- s = OffsetStr + s;
  9512        |     +--- fprintf(fp,&quot;%s&quot;,s.c_str());
              |     |  +----------------+ 
  9513        |     +--+ return TokPos; | 
              |     |  +----------------+ 
              |   +-+---+ 
  9514        |   |  }  | 
              |   +-----+ 
  9515        +--- //
  9516        |    // DO依存変数または、Do変数を含んだ式！  
  9517        |    // 変数部分の置換を行う                  
  9518        |    //                                       
              |  +----------------------------------------------------------------+ 
  9519        +--+ for(j = TokPos ; j &lt; TokenEndPos ; j++){ // 行の先頭から、最後 | 
              |  +--+-------------------------------------------------------------+ 
  9520        |     +--- Token = (TToken *)TokenList-&gt;Items[j];
              |     |  +----------------------------------------------------------------+ 
  9521        |     +--+ if(Token-&gt;TokId == tid_Semikoron){  // ; が同じレベルで出現時  | 
              |     |  +--+-------------------------------------------------------------+ 
              |     |     |  +--------------------------------------------+ 
  9522        |     |     +--+ if(Token-&gt;BrNestLevel &gt;= StartNestLevel){  | 
              |     |     |  +--+-----------------------------------------+ 
  9523        |     |     |     +--- s += TrimRight(Token-&gt;OrgStr);
  9524        |     |     |     +--- TokPos = j;
              |     |     |     |  +--------+ 
  9525        |     |     |     +--+ break; | 
              |     |     |     |  +--------+ 
              |     |     |   +-+---+ 
  9526        |     |     |   |  }  | 
              |     |     |   +-----+ 
              |     |   +-+---+ 
  9527        |     |   |  }  | 
              |     |   +-----+ 
              |     |  +--------------------------------------------------------------------+ 
  9528        |     +--+ if((StartNestLevel == Token-&gt;BrNestLevel)&amp;&amp;(AddOprStrPos == -1)){  | 
              |     |  +--+-----------------------------------------------------------------+ 
              |     |     |  +------------------------------------------------+ 
  9529        |     |     +--+ if((Token-&gt;Str == &quot;+&quot;)||(Token-&gt;Str == &quot;-&quot;)){  | 
              |     |     |  +--+---------------------------------------------+ 
  9530        |     |     |     +--- //
  9531        |     |     |     |    // 最初の+-の出現位置。合計計算の式のマージをチェックする。  
  9532        |     |     |     |    // １つ前の = まで戻って、それが一致しているかをチェック。   
  9533        |     |     |     |    //                                                           
  9534        |     |     |     +--- int k;
  9535        |     |     |     +--- int SetPos = -1;
  9536        |     |     |     |    
  9537        |     |     |     +--- AddOprStrPos = -2;
              |     |     |     |  +--------------------------------+ 
  9538        |     |     |     +--+ for(k = j - 1 ; k &gt; 0 ; k--){  | 
              |     |     |     |  +--+-----------------------------+ 
  9539        |     |     |     |     +--- TokenB = (TToken *)TokenList-&gt;Items[k];
              |     |     |     |     |  +--------------------------------+ 
  9540        |     |     |     |     +--+ if(TokenB-&gt;TokId == tid_Set){  | 
              |     |     |     |     |  +--+-----------------------------+ 
  9541        |     |     |     |     |     +--- SetPos = k;
              |     |     |     |     |     |  +--------+ 
  9542        |     |     |     |     |     +--+ break; | 
              |     |     |     |     |     |  +--------+ 
              |     |     |     |     |   +-+---+ 
  9543        |     |     |     |     |   |  }  | 
              |     |     |     |     |   +-----+ 
              |     |     |     |   +-+---+ 
  9544        |     |     |     |   |  }  | 
              |     |     |     |   +-----+ 
              |     |     |     |  +--------------------+ 
  9545        |     |     |     +--+ if(SetPos != -1){  | 
              |     |     |     |  +--+-----------------+ 
              |     |     |     |     |  +------------------------------------+ 
  9546        |     |     |     |     +--+ for(k = j - 1 ; k &gt; SetPos ; k--){ | 
              |     |     |     |     |  +--+---------------------------------+ 
  9547        |     |     |     |     |     +--- TokenB = (TToken *)TokenList-&gt;Items[k];
  9548        |     |     |     |     |     +--- TokenF = (TToken *)TokenList-&gt;Items[k-(j-1)+SetPos-1];
              |     |     |     |     |     |  +----------------------------------+ 
  9549        |     |     |     |     |     +--+ if(TokenB-&gt;Str != TokenF-&gt;Str){  | 
              |     |     |     |     |     |  +--+-------------------------------+ 
              |     |     |     |     |     |     |  +------------------+ 
  9550        |     |     |     |     |     |     +--+ break; // 不一致 | 
              |     |     |     |     |     |     |  +------------------+ 
              |     |     |     |     |     |   +-+---+ 
  9551        |     |     |     |     |     |   |  }  | 
              |     |     |     |     |     |   +-----+ 
              |     |     |     |     |   +-+---+ 
  9552        |     |     |     |     |   |  }  | 
              |     |     |     |     |   +-----+ 
              |     |     |     |     |  +------------------------------------------------+ 
  9553        |     |     |     |     +--+ if(k == SetPos){    // 一致 Val = Val + の形。 | 
              |     |     |     |     |  +--+---------------------------------------------+ 
              |     |     |     |     |     |  +------------------------------------+ 
  9554        |     |     |     |     |     +--+ if(k-(j-1)+SetPos == StartTokPos){ | 
              |     |     |     |     |     |  +--+---------------------------------+ 
  9555        |     |     |     |     |     |     +--- AddOprStrPos = s.length();
              |     |     |     |     |     |   +-+---+ 
  9556        |     |     |     |     |     |   |  }  | 
              |     |     |     |     |     |   +-----+ 
              |     |     |     |     |   +-+---+ 
  9557        |     |     |     |     |   |  }  | 
              |     |     |     |     |   +-----+ 
              |     |     |     |   +-+---+ 
  9558        |     |     |     |   |  }  | 
              |     |     |     |   +-----+ 
              |     |     |   +-+---+ 
  9559        |     |     |   |  }  | 
              |     |     |   +-----+ 
              |     |   +-+---+ 
  9560        |     |   |  }  | 
              |     |   +-----+ 
  9561        |     |    
  9562        |     +--- ValData = (TValData *)Token-&gt;ValData;
              |     |  +----------------------+ 
  9563        |     +--+ if(ValData != NULL){ | 
              |     |  +--+-------------------+ 
              |     |     |  +------------------------------+ 
  9564        |     |     +--+ if(ValData-&gt;DoValBits != 0){ | 
              |     |     |  +--+---------------------------+ 
  9565        |     |     |     +--- //
  9566        |     |     |     |    // DO変数の置き換え                                  
  9567        |     |     |     |    // 前後が オペレータでなければ、()を付けない。       
  9568        |     |     |     |    // 加算する値は、UnrollCount[] と kk によって決まる  
  9569        |     |     |     |    //                                                   
  9570        |     |     |     +--- Idx = GetBitIdx(ValData-&gt;DoValBits);
  9571        |     |     |     +--- TokenB = (TToken *)TokenList-&gt;Items[j-1];
  9572        |     |     |     +--- TokenF = (TToken *)TokenList-&gt;Items[j+1];
  9573        |     |     |     |    
  9574        |     |     |     +--- //      fprintf(fp,&quot;AddValue %s[RefValIdx=%d:DoValBits %04X] DoValIdx = %d UnRollBits = %04X \n&quot;,ValData-&gt;Str.c_str(),
  9575        |     |     |     |    //          RefValIdx,ValData-&gt;DoValBits,DoValIdx,UnRollDoRefValBits);                                                 
  9576        |     |     |     |                                                                                                                           
  9577        |     |     |     +--- AddValue = GetDoValAddValue(RefValIdx,
  9578        |     |     |     |                    ValData-&gt;DoValBits &amp; UnRollDoRefValBits, 
  9579        |     |     |     |                    DoValIdx,UnrollCount);                   
              |     |     |     |  +--------------------+ 
  9580        |     |     |     +--+ if(AddValue == 0){ | 
              |     |     |     |  +--+-----------------+ 
  9581        |     |     |     |     +--- s += ChangeFromOrgStr(Token-&gt;OrgStr,&quot;&quot;);
  9582        |     |     |     |     +--- s += DoValName[Idx];
              |     |     |     |   +-+---+ 
  9583        |     |     |     |   |  }  | 
              |     |     |     |   +-+---+ 
              |     |     |     |   +-+-----------------------------------------------------------+ 
  9583        |     |     |     |   |  else if((OprCheckStr.find(TokenB-&gt;Str) != string::npos)&amp;&amp;  | 
  9584        |     |     |     |   |         (OprCheckStr.find(TokenF-&gt;Str) != string::npos)){   | 
              |     |     |     |   +-+-----------------------------------------------------------+ 
  9585        |     |     |     |     +--- s += ChangeFromOrgStr(Token-&gt;OrgStr,&quot;&quot;);
  9586        |     |     |     |     +--- s += DoValName[Idx] + &quot;+&quot; + IntToStr(AddValue);
              |     |     |     |   +-+---+ 
  9587        |     |     |     |   |  }  | 
              |     |     |     |   +-+---+ 
              |     |     |     |   +-+-------+ 
  9587        |     |     |     |   |  else{  | 
              |     |     |     |   +-+-------+ 
  9588        |     |     |     |     +--- s += ChangeFromOrgStr(Token-&gt;OrgStr,&quot;&quot;);
  9589        |     |     |     |     +--- s += &quot;(&quot;+DoValName[Idx] + &quot;+&quot;+ IntToStr(AddValue)+&quot;)&quot;;
              |     |     |     |   +-+---+ 
  9590        |     |     |     |   |  }  | 
              |     |     |     |   +-----+ 
              |     |     |   +-+---+ 
  9591        |     |     |   |  }  | 
              |     |     |   +-+---+ 
              |     |     |   +-+-------------------------------------------------------------+ 
  9591        |     |     |   |  else if(((ValData-&gt;RefDoValBits &amp; UnRollDoRefValBits) != 0)  | 
  9592        |     |     |   |             &amp;&amp;(ValData-&gt;ArrayLevel == 0)){                    | 
              |     |     |   +-+-------------------------------------------------------------+ 
  9593        |     |     |     +--- //
  9594        |     |     |     |    // Do依存変数の置き換え                                
  9595        |     |     |     |    // ・配列は、対象外とする。(Doの変数が含まれると想定)  
  9596        |     |     |     |    // ・Do依存変数のAddValueを求める（Idx)                
  9597        |     |     |     |    //                                                     
  9598        |     |     |     +--- AddValue = GetValAddValue2(RefValIdx,
  9599        |     |     |     |                    ValData-&gt;RefDoValBits,UnRollDoRefValBits,  
  9600        |     |     |     |                    DoValIdx,UnrollCount);                     
              |     |     |     |  +--------------------+ 
  9601        |     |     |     +--+ if(AddValue == 0){ | 
              |     |     |     |  +--+-----------------+ 
  9602        |     |     |     |     +--- NewValName = ValData-&gt;Str;
              |     |     |     |   +-+---+ 
  9603        |     |     |     |   |  }  | 
              |     |     |     |   +-+---+ 
              |     |     |     |   +-+-------+ 
  9603        |     |     |     |   |  else{  | 
              |     |     |     |   +-+-------+ 
  9604        |     |     |     |     +--- NewValName = GetNewValName(ValData-&gt;Str,AddValue+1,ArgValList);
              |     |     |     |   +-+---+ 
  9605        |     |     |     |   |  }  | 
              |     |     |     |   +-----+ 
  9606        |     |     |     +--- s += ChangeFromOrgStr(Token-&gt;OrgStr,NewValName);
              |     |     |   +-+---+ 
  9607        |     |     |   |  }  | 
              |     |     |   +-+---+ 
              |     |     |   +-+-------+ 
  9607        |     |     |   |  else{  | 
              |     |     |   +-+-------+ 
  9608        |     |     |     +--- s += Token-&gt;OrgStr;
              |     |     |   +-+---+ 
  9609        |     |     |   |  }  | 
              |     |     |   +-----+ 
              |     |   +-+---+ 
  9610        |     |   |  }  | 
              |     |   +-+---+ 
              |     |   +-+-------+ 
  9610        |     |   |  else{  | 
              |     |   +-+-------+ 
  9611        |     |     +--- s += Token-&gt;OrgStr;
              |     |   +-+---+ 
  9612        |     |   |  }  | 
              |     |   +-----+ 
              |   +-+---+ 
  9613        |   |  }  | 
              |   +-----+ 
  9614        +--- //
  9615        |    // 出力行がマージ可能( Val = Val + ... ）ならばマージする。  
  9616        |    //                                                           
  9617        +--- CurOutputPos = ftell(fp);
              |  +------------------------------------------------------------------------------------------------+ 
  9618        +--+ if((AddOprStrPos &gt;= 0)&amp;&amp;(CurOutputPos == LastOutputEPos)&amp;&amp;(LastOutputSPos &lt; LastOutputEPos)){  | 
              |  +--+---------------------------------------------------------------------------------------------+ 
  9619        |     +--- NewLastOutputStr = Merge_Unroll_Line_C(&amp;BaseOutputStr,LastOutputStr,&amp;s,AddOprStrPos);
              |     |  +----------------------------------------+ 
  9620        |     +--+ if(NewLastOutputStr != LastOutputStr){ | 
              |     |  +--+-------------------------------------+ 
  9621        |     |     +--- fseek(fp,LastOutputSPos,SEEK_SET);
  9622        |     |     +--- fprintf(fp,&quot;%s\n&quot;,NewLastOutputStr.c_str());
  9623        |     |     +--- CurOutputPos = ftell(fp);
              |     |   +-+---+ 
  9624        |     |   |  }  | 
              |     |   +-+---+ 
              |     |   +-+-------+ 
  9624        |     |   |  else{  | 
              |     |   +-+-------+ 
  9625        |     |     +--- BaseOutputStr = s;
              |     |   +-+---+ 
  9626        |     |   |  }  | 
              |     |   +-----+ 
              |   +-+---+ 
  9627        |   |  }  | 
              |   +-+---+ 
              |   +-+-------+ 
  9627        |   |  else{  | 
              |   +-+-------+ 
  9628        |     +--- BaseOutputStr = s;
              |   +-+---+ 
  9629        |   |  }  | 
              |   +-----+ 
  9630        +--- LastOutputSPos = CurOutputPos;
  9631        +--- s = OffsetStr + s;
  9632        +--- LastOutputStr = s;
  9633        +--- fprintf(fp,&quot;%s\n&quot;,s.c_str());
  9634        +--- LastOutputEPos = ftell(fp);
              |  +----------------+ 
  9635        +--+ return TokPos; | 
              |  +----------------+ 
            +-+---+ 
  9636      |  }  | 
            +-----+ 
</pre>


</body>
</html>
