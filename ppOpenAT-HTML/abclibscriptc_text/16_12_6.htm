
<html>
<head>
<title>MakeResultHTML メンバ関数説明</title><base target="main">
<link rel ="stylesheet" type="text/css" href="stylesheet.css" title="stylesheet">
<meta http-equiv="Content-Type" content="text/html;charset=Shift_JIS">
</head>

<body bgcolor="#ffffff">

<div align="right"><font size="2">ABCLibScriptC プロジェクト</font></div>

<table width=100% bgcolor="#e6e6fa" class="titlebgcolor" border="1" cellpadding="7" cellspacing="0">
<tr>
    <td><font class="titlefont">14.12.6. MakeResultHTML メンバ関数説明</font></td>
</tr>
</table>

<p></p>
<table border="1">
<tr><th align="left" nowrap>メンバ関数名</th>  <td nowrap>MakeResultHTML</td></tr>
<tr><th align="left" nowrap>定義ファイル名</th><td nowrap>Visual.cpp</td></tr>
<tr><th align="left" nowrap>定義行</th>        <td nowrap>428</td></tr>
<tr><th align="left" nowrap>所属名</th>        <td nowrap>TVisualDM</td></tr>
<tr><th align="left" nowrap>アクセス属性</th>  <td nowrap>private</td></tr>
<tr><th align="left" nowrap>宣言形式</th>      <td nowrap>void MakeResultHTML ( TTuneRegion * TuneRegion )</td></tr>
<tr><th align="left" nowrap>概要</th>          <td nowrap>各TuneRegionごとの結果ページを作成する。</td></tr>
<tr><th align="left" nowrap>戻り値</th>        <td nowrap></td></tr>
<tr><th align="left" nowrap>パラメタ説明</th>  <td nowrap>TuneRegion  対象チューニングリージョンクラス</td></tr>
<tr><th align="left" nowrap>機能説明</th>      <td nowrap></td></tr>
<tr><th align="left" nowrap>備考</th>          <td nowrap></td></tr>
</table>

<p></p>
呼出し元関数一覧表
<table border="1">
<tr>
<th nowrap>№</th>
<th nowrap>名称</th>
<th nowrap>定義ファイル名</th>
<th nowrap>定義行</th>
</tr>
<tr>
<td nowrap>1</td>
<td nowrap><a href="16_12_4.htm">TVisualDM::Exec</a></td>
<td nowrap><a href="5_8.htm">Visual.cpp</a></td>
<td nowrap><a href="16_12_4.htm">63</a></td>
</tr>
</table>

<p></p>
呼出し先関数一覧表
<table border="1">
<tr>
<th nowrap>№</th>
<th nowrap>名称</th>
<th nowrap>定義ファイル名</th>
<th nowrap>定義行</th>
</tr>
<tr>
<td nowrap>1</td>
<td nowrap><a href="16_2_6.htm">TMainF::ErrMessage</a></td>
<td nowrap><a href="5_1.htm">main.cpp</a></td>
<td nowrap><a href="16_2_6.htm">767</a></td>
</tr>
<tr>
<td nowrap>2</td>
<td nowrap>IntToStr</td>
<td nowrap><a href="5_16.htm">VCL_Lib.h</a></td>
<td nowrap>107</td>
</tr>
<tr>
<td nowrap>3</td>
<td nowrap>c_str</td>
<td nowrap><br></td>
<td nowrap><br></td>
</tr>
<tr>
<td nowrap>4</td>
<td nowrap>fclose</td>
<td nowrap><br></td>
<td nowrap><br></td>
</tr>
<tr>
<td nowrap>5</td>
<td nowrap>fopen</td>
<td nowrap><br></td>
<td nowrap><br></td>
</tr>
<tr>
<td nowrap>6</td>
<td nowrap>fprintf</td>
<td nowrap><br></td>
<td nowrap><br></td>
</tr>
</table>

<p></p>
参照外部変数一覧表
<table border="1">
<tr>
<th nowrap>№</th>
<th nowrap>名称</th>
<th nowrap>定義ファイル名</th>
<th nowrap>定義行</th>
</tr>
<tr>
<td nowrap>1</td>
<td nowrap>MainF</td>
<td nowrap><a href="5_1.htm">main.cpp</a></td>
<td nowrap>53</td>
</tr>
</table>

<p></p>
参照メンバ変数一覧表
<table border="1">
<tr>
<th nowrap>№</th>
<th nowrap>名称</th>
<th nowrap>定義ファイル名</th>
<th nowrap>定義行</th>
</tr>
<tr>
<td nowrap>1</td>
<td nowrap>TVisualDM::DirName</td>
<td nowrap><a href="5_17.htm">Visual.h</a></td>
<td nowrap>58</td>
</tr>
</table>

<p></p>
参照先一覧表
<table border="1">
<tr>
<th nowrap>№</th>
<th nowrap>名称</th>
<th nowrap>種別</th>
<th nowrap>定義ファイル名</th>
<th nowrap>定義行</th>
</tr>
<tr>
<td nowrap>1</td>
<td nowrap><a href="16_8_1.htm">TSubRegion</a></td>
<td nowrap>クラス</td>
<td nowrap><a href="5_15.htm">TuneRegion.h</a></td>
<td nowrap><a href="16_8_1.htm">375</a></td>
</tr>
<tr>
<td nowrap>2</td>
<td nowrap><a href="16_10_1.htm">TTuneRegion</a></td>
<td nowrap>クラス</td>
<td nowrap><a href="5_15.htm">TuneRegion.h</a></td>
<td nowrap><a href="16_10_1.htm">143</a></td>
</tr>
</table>

<p></p>
<pre>
関数論理チャート

        |  +----------------------------------------------------------+ 
   428  +--+ void TVisualDM::MakeResultHTML(TTuneRegion *TuneRegion)  | 
   429     | {                                                        | 
           +--+-------------------------------------------------------+ 
   430        +--- FILE *fp;
   431        +--- string FileName;
   432        +--- string s;
   433        +--- int i,c;
   434        +--- TSubRegion *SubRegion;
   435        |    
   436        +--- FileName = DirName + &quot;/OAT/OATLog_&quot;+TuneRegion-&gt;Name+&quot;.html&quot;;
   437        +--- fp = fopen(FileName.c_str(),&quot;wt&quot;);
              |  +------------------+ 
   438        +--+ if(fp == NULL){  | 
              |  +--+---------------+ 
   439        |     +--- MainF-&gt;ErrMessage(-1,&quot;File Open Err &quot;+ FileName);
              |     |  +----------+ 
   440        |     +--+ return;  | 
              |     |  +----------+ 
              |   +-+---+ 
   441        |   |  }  | 
              |   +-----+ 
   442        +--- //
   443        |    // HTMLファイルを出力する。  
   444        |    //                           
   445        +--- fprintf(fp,&quot;&lt;html&gt;\n&quot;);
   446        +--- fprintf(fp,&quot;&lt;head&gt;\n&quot;);
   447        +--- fprintf(fp,&quot;&lt;meta http-equiv=\&quot;Content-Type\&quot; content=\&quot;text/html; charset=shift_jis\&quot;&gt;\n&quot;);
   448        +--- fprintf(fp,&quot;&lt;meta name=\&quot;GENERATOR\&quot; content=\&quot;OAT 1.0\&quot;&gt;\n&quot;);
   449        +--- fprintf(fp,&quot;&lt;title&gt;OAT_%s Result&lt;/title&gt;\n&quot;,TuneRegion-&gt;Name.c_str());
   450        +--- fprintf(fp,&quot;&lt;/head&gt;\n&quot;);
   451        |    
   452        +--- fprintf(fp,&quot;&lt;body&gt;\n&quot;);
   453        +--- fprintf(fp,&quot;&lt;h1 align = \&quot;center\&quot;&gt;&lt;b&gt;OAT_%s&amp;nbsp;Result&lt;/b&gt;\n&quot;,TuneRegion-&gt;Name.c_str());
   454        +--- fprintf(fp,&quot;&lt;/h1&gt;\n&quot;);
   455        |    
   456        +--- //
   457        |    // Applet部分を出力する。                                                  
   458        |    // 各ページごとに参照データが異なる。                                      
   459        |    // データファイルは、空白で作成されているので、読込みエラーにはならない。  
   460        |    //                                                                         
   461        +--- fprintf(fp,&quot;&lt;p align = \&quot;center\&quot;&gt;\n&quot;);
   462        +--- fprintf(fp,&quot;&lt;applet\n&quot;);
   463        +--- fprintf(fp,&quot;codebase = \&quot;./\&quot;\n&quot;);
   464        +--- fprintf(fp,&quot;code = \&quot;vlapplet.Applet1.class\&quot;\n&quot;);
   465        +--- fprintf(fp,&quot;archive = \&quot;vlapplet.jar\&quot;\n&quot;);
   466        |    
   467        +--- fprintf(fp,&quot;name = \&quot;gtable\&quot;\n&quot;);
   468        +--- fprintf(fp,&quot;width = \&quot;640\&quot;\n&quot;);
   469        +--- fprintf(fp,&quot;height = \&quot;510\&quot;\n&quot;);
   470        +--- fprintf(fp,&quot;alt = \&quot;Javaアプレットです。\&quot;&gt;\n&quot;);
   471        +--- fprintf(fp,&quot;&lt;param name=\&quot;FolderName\&quot; value=\&quot;gtable-\&quot;&gt;\n&quot;);
   472        +--- fprintf(fp,&quot;&lt;param name=\&quot;FILENAME\&quot; value=\&quot;OATLog_%s.dat\&quot;&gt;\n&quot;,TuneRegion-&gt;Name.c_str());
   473        |    
   474        +--- fprintf(fp,&quot;&lt;param name=\&quot;LSMFILENAME\&quot; value=\&quot;%s_%c_LSM.dat\&quot;&gt;\n&quot;,
   475        |        TuneRegion-&gt;Name.c_str(),TuneRegion-&gt;TuneGroupName[1]            
   476        |    );                                                                   
   477        |    
   478        +--- fprintf(fp,&quot;&lt;param name=\&quot;CaseCount\&quot; value=\&quot;%d\&quot;&gt;\n&quot;,TuneRegion-&gt;CaseCount);
   479        +--- //
   480        |    // SubRegionごとの個数（前のＩｄｘを含んだ個数）をセット 
   481        |    //                                                       
   482        +--- fprintf(fp,&quot;&lt;param name=\&quot;SubCount\&quot; value=\&quot;%d\&quot;&gt;\n&quot;,TuneRegion-&gt;SubRegionList-&gt;Count);
   483        +--- s = &quot;&quot;;
   484        +--- c = 0;
              |  +----------------------------------------------------------+ 
   485        +--+ for(i = 0 ; i &lt; TuneRegion-&gt;SubRegionList-&gt;Count ; i++){ | 
              |  +--+-------------------------------------------------------+ 
   486        |     +--- SubRegion = (TSubRegion *)TuneRegion-&gt;SubRegionList-&gt;Items[i];
   487        |     +--- c += SubRegion-&gt;CaseCount;
              |     |  +--------------+ 
   488        |     +--+ if(s != &quot;&quot;){ | 
              |     |  +--+-----------+ 
   489        |     |     +--- s += &quot;,&quot;;
              |     |   +-+---+ 
   490        |     |   |  }  | 
              |     |   +-----+ 
   491        |     +--- s += IntToStr(c);
              |   +-+---+ 
   492        |   |  }  | 
              |   +-----+ 
   493        +--- fprintf(fp,&quot;&lt;param name=\&quot;SubCaseIdx\&quot; value=\&quot;%s\&quot;&gt;\n&quot;,s.c_str());
   494        +--- fprintf(fp,&quot;&lt;/applet&gt;\n&quot;);
   495        +--- fprintf(fp,&quot;&lt;/p&gt;\n&quot;);
   496        |    
   497        +--- //
   498        |    // データ一覧表示ボタン  
   499        |    //                       
   500        +--- fprintf(fp,&quot;&lt;form&gt;\n&quot;);
   501        +--- //    fprintf(fp,&quot;&lt;p align=\&quot;right\&quot;&gt;\n&quot;);
   502        |    //    fprintf(fp,&quot;&lt;INPUT TYPE=\&quot;button\&quot; VALUE=\&quot;結果データ 一覧表示\&quot;\n&quot;);  
   503        +--- fprintf(fp,&quot;&lt;p align=\&quot;center\&quot;&gt;\n&quot;);
   504        +--- fprintf(fp,&quot;&lt;INPUT TYPE=\&quot;button\&quot; VALUE=\&quot; Result data list   \&quot;\n&quot;);
   505        +--- fprintf(fp,&quot;  onClick=\&quot;makeNewWindow()\&quot;&gt;\n&quot;);
   506        +--- fprintf(fp,&quot;&lt;/p&gt;\n&quot;);
   507        +--- fprintf(fp,&quot;&lt;/form&gt;\n&quot;);
   508        |    
   509        |     
   510        +--- //
   511        |    // Appletから Nの開始、終了、Stepの３データを所得する。              
   512        |    // このデータとCase数から計算した値とデータ行数が一致しない場合は、  
   513        |    // エラー表示（データが正しくありません。）が行われる。              
   514        |    //                                                                   
   515        |                                                                         
   516        +--- fprintf(fp,&quot;&lt;script type=\&quot;text/javascript\&quot;&gt;\n&quot;);
   517        +--- fprintf(fp,&quot;&lt;!--\n&quot;);
   518        |    
   519        +--- //
   520        |    // Table部分の表示                       
   521        |    // RowCount数だけのLoopでの表示となる。  
   522        |    //                                       
   523        +--- fprintf(fp,&quot;var nw = null;\n&quot;);
   524        |    
   525        +--- fprintf(fp,&quot;function makeNewWindow() {\n&quot;);
   526        +--- //
   527        |    // Check Applet Enable 
   528        |    //                     
   529        +--- fprintf(fp,&quot;  if(typeof(document.applets[0]) == typeof(undefined)){\n&quot;);
   530        +--- fprintf(fp,&quot;    alert(\&quot;JavaAppletが起動していません。\&quot;);\n&quot;);
   531        +--- fprintf(fp,&quot;    return;\n&quot;);
   532        +--- fprintf(fp,&quot;  }\n&quot;);
   533        +--- //
   534        |    // Open New Window 
   535        |    //                 
   536        +--- fprintf(fp,&quot;  if(!nw || nw.closed) {\n&quot;);
   537        +--- fprintf(fp,&quot;    nw = window.open(\&quot;\&quot;,\&quot;\&quot;,\&quot;WIDTH=500,HEIGHT=400,resizable,scrollbars\&quot;);\n&quot;);
   538        |    
   539        +--- //
   540        |    // 新しいウィンドウのデータを出力  
   541        |    //                                 
   542        +--- fprintf(fp,&quot;    nw.document.writeln(\&quot;&lt;html&gt;\&quot;);\n&quot;);
   543        +--- fprintf(fp,&quot;    nw.document.writeln(\&quot;&lt;head&gt;\&quot;);\n&quot;);
   544        +--- s = &quot;&lt;meta http-equiv=\\\&quot;Content-Type\\\&quot; content=\\\&quot;text/html; charset=shift_jis\\\&quot;&gt;&quot;;
   545        +--- fprintf(fp,&quot;    nw.document.writeln(\&quot;%s\&quot;);\n&quot;,s.c_str());
   546        +--- s = &quot;&lt;meta name=\\\&quot;GENERATOR\\\&quot; content=\\\&quot;OAT 1.0\\\&quot;&gt;&quot;;
   547        +--- fprintf(fp,&quot;    nw.document.writeln(\&quot;%s\&quot;);\n&quot;,s.c_str());
   548        +--- s =&quot;&lt;title&gt;OAT_&quot;+TuneRegion-&gt;Name+&quot; Result&lt;/title&gt;&quot;;
   549        +--- fprintf(fp,&quot;    nw.document.writeln(\&quot;%s\&quot;);\n&quot;,s.c_str());
   550        +--- fprintf(fp,&quot;    nw.document.writeln(\&quot;&lt;/head&gt;\&quot;);\n&quot;);
   551        +--- fprintf(fp,&quot;    nw.document.writeln(\&quot;&lt;body&gt;\&quot;);\n&quot;);
   552        +--- s = &quot;&lt;h1 align = \\\&quot;center\\\&quot;&gt;&lt;b&gt;OAT_&quot;+TuneRegion-&gt;Name+&quot;&amp;nbsp;Result&lt;/b&gt;&quot;;
   553        +--- fprintf(fp,&quot;    nw.document.writeln(\&quot;%s\&quot;);\n&quot;,s.c_str());
   554        +--- fprintf(fp,&quot;    nw.document.writeln(\&quot;&lt;/h1&gt;\&quot;);\n&quot;);
   555        |    
   556        +--- //
   557        |    // テーブル内容を出力  
   558        |    //                     
   559        +--- fprintf(fp,&quot;    var ValId = document.gtable.getId(\&quot;d\&quot;);\n&quot;);
   560        +--- fprintf(fp,&quot;    var DataCount = parseInt(document.gtable.getCount(ValId));\n&quot;);
   561        +--- fprintf(fp,&quot;    var RowCount = (DataCount/2)-5;\n&quot;); // 先頭５行はヘッダ部分
   562        +--- fprintf(fp,&quot;    var NumProcs = parseInt(document.gtable.get(ValId,0));\n&quot;);
   563        +--- fprintf(fp,&quot;    var StartTuneSize = parseInt(document.gtable.get(ValId,1));\n&quot;);
   564        +--- fprintf(fp,&quot;    var EndTuneSize = parseInt(document.gtable.get(ValId,2));\n&quot;);
   565        +--- fprintf(fp,&quot;    var SampDist = parseInt(document.gtable.get(ValId,3));\n&quot;);
   566        |    
   567        +--- fprintf(fp,&quot;    nw.document.writeln(\&quot;&lt;table border=\\\&quot;2\\\&quot; width=\\\&quot;100%%\\\&quot;&gt;\&quot;);\n&quot;);
   568        +--- fprintf(fp,&quot;    nw.document.writeln(\&quot;&lt;tr&gt;\&quot;);\n&quot;);
   569        +--- fprintf(fp,&quot;    nw.document.writeln(\&quot;&lt;td width=\\\&quot;10%%\\\&quot;&gt;DataNo&lt;/td&gt;\&quot;);\n&quot;);
   570        +--- fprintf(fp,&quot;    nw.document.writeln(\&quot;&lt;td width=\\\&quot;10%%\\\&quot;&gt;N&lt;/td&gt;\&quot;);\n&quot;);
   571        +--- fprintf(fp,&quot;    nw.document.writeln(\&quot;&lt;td width=\\\&quot;10%%\\\&quot;&gt;CaseNo&lt;/td&gt;\&quot;);\n&quot;);
   572        +--- fprintf(fp,&quot;    nw.document.writeln(\&quot;&lt;td width=\\\&quot;25%%\\\&quot;&gt;CaseInfo&lt;/td&gt;\&quot;);\n&quot;);
   573        +--- fprintf(fp,&quot;    nw.document.writeln(\&quot;&lt;td width=\\\&quot;45%%\\\&quot;&gt;Result&lt;/td&gt;\&quot;);\n&quot;);
   574        +--- fprintf(fp,&quot;    nw.document.writeln(\&quot;&lt;/tr&gt;\&quot;);\n&quot;);
   575        |    
   576        +--- fprintf(fp,&quot;    for(i = 0 ; i &lt; RowCount ; i++){\n&quot;);
   577        +--- fprintf(fp,&quot;      nw.document.writeln(\&quot;\&quot;);\n&quot;);
   578        +--- fprintf(fp,&quot;      i0 = i+1;\n&quot;);    //
   579        +--- fprintf(fp,&quot;      n = Math.floor(i / %d)*SampDist+StartTuneSize;\n&quot;,TuneRegion-&gt;CaseCount);
   580        +--- fprintf(fp,&quot;      i1 = (i %% %d)+1;\n&quot;,TuneRegion-&gt;CaseCount);
   581        +--- fprintf(fp,&quot;      d = document.gtable.get(ValId,i+5);\n&quot;);
   582        |    
   583        +--- fprintf(fp,&quot;      CaseInfo = \&quot;\&quot;;\n&quot;);
              |  +--------------------------------------------+ 
   584        +--+ if(TuneRegion-&gt;SubRegionList-&gt;Count != 0){ | 
              |  +--+-----------------------------------------+ 
   585        |     +--- int CaseCount;
   586        |     |    
   587        |     +--- fprintf(fp,&quot;i2 = 1; i3 = i1-1\n&quot;);
              |     |  +----------------------------------------------------------------+ 
   588        |     +--+ for(int k = 0 ; k &lt; TuneRegion-&gt;SubRegionList-&gt;Count-1 ; k++){ | 
              |     |  +--+-------------------------------------------------------------+ 
   589        |     |     +--- SubRegion = (TSubRegion *)TuneRegion-&gt;SubRegionList-&gt;Items[k];
   590        |     |     +--- CaseCount = SubRegion-&gt;CaseCount;
   591        |     |     +--- fprintf(fp,&quot;      if(i3 &gt;= %d){ i2++; i3 -= %d}\n&quot;,CaseCount,CaseCount);
              |     |   +-+---+ 
   592        |     |   |  }  | 
              |     |   +-----+ 
   593        |     +--- fprintf(fp,&quot;      CaseInfo += \&quot;SubRegion=\&quot;+i2;\n&quot;);
   594        |     +--- //
   595        |     |    // 各サブリージョンごとの varid()のIdxを出力する。                   
   596        |     |    // VaridListのFromToの値となる。                                     
   597        |     |    // i3 にサブリージョン内での idx値が入っているので、それを使用する。 
   598        |     |    // 例えば varid(i) from 1 to 4 varid (j) from 1 to 3 ならば          
   599        |     |    //  i = xx Math.Floor( i3 /jCount ) % iCount; となる。               
   600        |     |    //                                                                   
              |     |  +--------------------------------------------------------------+ 
   601        |     +--+ for(int k = 0 ; k &lt; TuneRegion-&gt;SubRegionList-&gt;Count ; k++){ | 
              |     |  +--+-----------------------------------------------------------+ 
   602        |     |     +--- SubRegion = (TSubRegion *)TuneRegion-&gt;SubRegionList-&gt;Items[k];
   603        |     |     +--- CaseCount = SubRegion-&gt;CaseCount;
              |     |     |  +----------------------------------+ 
   604        |     |     +--+ if(SubRegion-&gt;variedCount != 0){ | 
              |     |     |  +--+-------------------------------+ 
   605        |     |     |     +--- fprintf(fp,&quot;      if(i2 == %d){\n&quot;,k+1);
              |     |     |     |  +--------------------------------------------------------+ 
   606        |     |     |     +--+ for(int kk = 0 ; kk &lt; SubRegion-&gt;variedCount ; kk++){  | 
              |     |     |     |  +--+-----------------------------------------------------+ 
   607        |     |     |     |     +--- string fmt;
   608        |     |     |     |     +--- string VName =SubRegion-&gt;variedValName[kk];     // 変数名 （必須）
   609        |     |     |     |     +--- /************************************************************************/
   610        |     |     |     |     |    //                                                                         
   611        |     |     |     |     |    //Kogakuin Irie                                                            
   612        |     |     |     |     |    //実数とstep機能の対応のための変更                                         
   613        |     |     |     |     |    //変更前の部分をコメントアウト                                             
   614        |     |     |     |     |    //                                                                         
   615        |     |     |     |     +--- //int VStart = SubRegion-&gt;variedFromValue[kk];        // 開始値
   616        |     |     |     |     |    //int VEnd = SubRegion-&gt;variedToValue[kk];          // 終了値    
   617        |     |     |     |     +--- float VStart = SubRegion-&gt;variedFromValue[kk];        // 開始値
   618        |     |     |     |     +--- float VEnd = SubRegion-&gt;variedToValue[kk];          // 終了値
   619        |     |     |     |     +--- float VStep = SubRegion-&gt;variedStepValue[kk];           // 増分値（追加処理）
   620        |     |     |     |     +--- int VCount;
   621        |     |     |     |     |    
   622        |     |     |     |     +--- //VCount = VEnd - VStart+1;
   623        |     |     |     |     +--- VCount = (int)((VEnd - VStart) / VStep + 1);
   624        |     |     |     |     +--- //
   625        |     |     |     |     |    //ここまで                                                                 
   626        |     |     |     |     |    //                                                                         
   627        |     |     |     |     |    /************************************************************************/ 
   628        |     |     |     |     +--- CaseCount /= VCount;
   629        |     |     |     |     |    
   630        |     |     |     |     +--- fprintf(fp,&quot;        i4 = Math.floor(i3 / %d ) %% %d + %d;\n&quot;,
   631        |     |     |     |     |        CaseCount,VCount,VStart);                                  
   632        |     |     |     |     +--- fprintf(fp,&quot;        CaseInfo += \&quot;,%s=\&quot;+i4;\n&quot;,VName.c_str());
   633        |     |     |     |     |    
              |     |     |     |   +-+---+ 
   634        |     |     |     |   |  }  | 
              |     |     |     |   +-----+ 
   635        |     |     |     +--- fprintf(fp,&quot;    }\n&quot;);
              |     |     |   +-+---+ 
   636        |     |     |   |  }  | 
              |     |     |   +-----+ 
              |     |   +-+---+ 
   637        |     |   |  }  | 
              |     |   +-----+ 
              |   +-+---+ 
   638        |   |  }  | 
              |   +-+---+ 
              |   +-+-----------------------------------------------+ 
   638        |   |  else{  // SubRegionがない場合の CaseInfoの出力 | 
              |   +-+-----------------------------------------------+ 
   639        |     +--- int CaseCount;
   640        |     |    
   641        |     +--- CaseCount = TuneRegion-&gt;CaseCount;
   642        |     +--- fprintf(fp,&quot;      i3 = i1-1\n&quot;);
              |     |  +--------------------------------------------------------+ 
   643        |     +--+ for(int kk = 0 ; kk &lt; TuneRegion-&gt;variedCount ; kk++){ | 
              |     |  +--+-----------------------------------------------------+ 
   644        |     |     +--- string fmt;
   645        |     |     +--- string VName = TuneRegion-&gt;variedValName[kk];   // 変数名 （必須）
   646        |     |     +--- /***************************************************************/
   647        |     |     |    //                                                                 
   648        |     |     |    //Kogakuin Irie                                                    
   649        |     |     |    //実数とstep機能の対応のための変更                                 
   650        |     |     |    //変更前の部分をコメントアウト                                     
   651        |     |     |    //                                                                 
   652        |     |     +--- //int VStart = TuneRegion-&gt;variedFromValue[kk];       // 開始値
   653        |     |     |    //int VEnd = TuneRegion-&gt;variedToValue[kk];         // 終了値    
   654        |     |     +--- float VStart = TuneRegion-&gt;variedFromValue[kk];       // 開始値
   655        |     |     +--- float VEnd = TuneRegion-&gt;variedToValue[kk];         // 終了値
   656        |     |     +--- float VStep = TuneRegion-&gt;variedStepValue[kk];          // 増分値（追加処理）
   657        |     |     +--- int VCount;
   658        |     |     |    
   659        |     |     +--- //VCount = VEnd - VStart+1;
   660        |     |     +--- VCount = (int)((VEnd - VStart) / VStep + 1);
   661        |     |     +--- //
   662        |     |     |    //ここまで                                                         
   663        |     |     |    //                                                                 
   664        |     |     |    /***************************************************************/  
   665        |     |     +--- CaseCount /= VCount;
   666        |     |     |    
   667        |     |     +--- fprintf(fp,&quot;      i4 = Math.floor(i3 / %d ) %% %d + %d;\n&quot;,
   668        |     |     |            CaseCount,VCount,VStart);                            
              |     |     |  +--------------+ 
   669        |     |     +--+ if(kk == 0){ | 
              |     |     |  +--+-----------+ 
   670        |     |     |     +--- fprintf(fp,&quot;      CaseInfo += \&quot;%s=\&quot;+i4;\n&quot;,VName.c_str());
              |     |     |   +-+---+ 
   671        |     |     |   |  }  | 
              |     |     |   +-+---+ 
              |     |     |   +-+-------+ 
   671        |     |     |   |  else{  | 
              |     |     |   +-+-------+ 
   672        |     |     |     +--- fprintf(fp,&quot;      CaseInfo += \&quot;,%s=\&quot;+i4;\n&quot;,VName.c_str());
              |     |     |   +-+---+ 
   673        |     |     |   |  }  | 
              |     |     |   +-----+ 
              |     |   +-+---+ 
   674        |     |   |  }  | 
              |     |   +-----+ 
              |   +-+---+ 
   675        |   |  }  | 
              |   +-----+ 
   676        +--- s = &quot;\&quot;&lt;tr&gt;&quot;
   677        |        &quot;&lt;td width=\\\&quot;10%%\\\&quot;&gt;\&quot;+i0+\&quot;&lt;/td&gt;&quot;       
   678        |        &quot;&lt;td width=\\\&quot;10%%\\\&quot;&gt;\&quot;+n+\&quot;&lt;/td&gt;&quot;        
   679        |        &quot;&lt;td width=\\\&quot;10%%\\\&quot;&gt;\&quot;+i1+\&quot;&lt;/td&gt;&quot;       
   680        |        &quot;&lt;td width=\\\&quot;25%%\\\&quot;&gt;\&quot;+CaseInfo+\&quot;&lt;/td&gt;&quot; 
   681        |        &quot;&lt;td width=\\\&quot;45%%\\\&quot;&gt;\&quot;+d+\&quot;&lt;/td&gt;&quot;        
   682        |        &quot;&lt;/tr&gt;\&quot;&quot;;                                   
   683        |    
   684        +--- fprintf(fp,&quot;      nw.document.writeln(%s);\n&quot;,s.c_str());
   685        |    
   686        +--- fprintf(fp,&quot;    }\n&quot;);
   687        +--- fprintf(fp,&quot;    nw.document.writeln(\&quot;&lt;/table&gt;\&quot;);\n&quot;);
   688        |    
   689        +--- fprintf(fp,&quot;    nw.document.writeln(\&quot;&lt;/body&gt;\&quot;);\n&quot;);
   690        +--- fprintf(fp,&quot;    nw.document.writeln(\&quot;&lt;/html&gt;\&quot;);\n&quot;);
   691        |    
   692        +--- fprintf(fp,&quot;    nw.document.close();\n&quot;);
   693        +--- fprintf(fp,&quot;  }else if(nw){\n&quot;);
   694        +--- fprintf(fp,&quot;    nw.focus();\n&quot;);
   695        +--- fprintf(fp,&quot;  }\n&quot;);
   696        +--- fprintf(fp,&quot;}\n&quot;);
   697        +--- fprintf(fp,&quot;// --&gt;\n&quot;);
   698        +--- fprintf(fp,&quot;&lt;/script&gt;\n&quot;);
   699        +--- fprintf(fp,&quot;&lt;noscript&gt;\n&quot;);
   700        +--- fprintf(fp,&quot;JavaScript対応ブラウザで表示してください。\n&quot;);
   701        +--- fprintf(fp,&quot;&lt;/noscript&gt;\n&quot;);
   702        +--- fprintf(fp,&quot;&lt;br&gt;\n&quot;);
   703        +--- fprintf(fp,&quot;&lt;/body&gt;\n&quot;);
   704        |    
   705        +--- fclose(fp);
   706        |    
            +-+---+ 
   707      |  }  | 
            +-----+ 
</pre>


</body>
</html>
