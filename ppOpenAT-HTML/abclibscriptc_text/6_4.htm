
<html>
<head>
<title>pass3.cpp ò_óùÉ`ÉÉÅ[Ég</title><base target="main">
<link rel ="stylesheet" type="text/css" href="stylesheet.css" title="stylesheet">
<meta http-equiv="Content-Type" content="text/html;charset=Shift_JIS">
</head>

<body bgcolor="#ffffff">

<div align="right"><font size="2">ABCLibScriptC ÉvÉçÉWÉFÉNÉg</font></div>

<table width=100% bgcolor="#e6e6fa" class="titlebgcolor" border="1" cellpadding="7" cellspacing="0">
<tr>
    <td><font class="titlefont">5.4. pass3.cpp ò_óùÉ`ÉÉÅ[Ég</font></td>
</tr>
</table>

<p></p>
<pre>
ÉtÉ@ÉCÉãò_óùÉ`ÉÉÅ[Ég

     1  +--- ÔªÉ\/*=====================================================================*
     2  |     *                                                                     *           
     3  |     *   Software Name : ppOpen-AT                                         *           
     4  |     *         Version : 0.1                                               *           
     5  |     *                                                                     *           
     6  |     *   License                                                           *           
     7  |     *     This file is part of ppOpen-AT.                                 *           
     8  |     *     ppOpen-AT is a free software, you can use it under the terms    *           
     9  |     *     of The MIT License (MIT). See LICENSE file and User's guide     *           
    10  |     *     for more details.                                               *           
    11  |     *                                                                     *           
    12  |     *   ppOpen-HPC project:                                               *           
    13  |     *     Open Source Infrastructure for Development and Execution of     *           
    14  |     *     Large-Scale Scientific Applications on Post-Peta-Scale          *           
    15  |     *     Supercomputers with Automatic Tuning (AT).                      *           
    16  |     *                                                                     *           
    17  |     *   Organizations:                                                    *           
    18  |     *     The University of Tokyo                                         *           
    19  |     *       - Information Technology Center                               *           
    20  |     *       - Atmosphere and Ocean Research Institute (AORI)              *           
    21  |     *       - Graduate School of Interdisciplinary Information Studies    *           
    22  |     *         /Earthquake Research Institute (ERI)                        *           
    23  |     *       - Graduate School of Frontier Science                         *           
    24  |     *     Kyoto University                                                *           
    25  |     *       - Academic Center for Computing and Media Studies             *           
    26  |     *     Japan Agency for Marine-Earth Science and Technology (JAMSTEC)  *           
    27  |     *                                                                     *           
    28  |     *   Sponsorship:                                                      *           
    29  |     *     Japan Science and Technology Agency (JST), Basic Research       *           
    30  |     *     Programs: CREST, Development of System Software Technologies    *           
    31  |     *     for post-Peta Scale High Performance Computing.                 *           
    32  |     *                                                                     *           
    33  |     *   Copyright (c) 2012                                                *           
    34  |     *      Information Technology Center, The University of Tokyo         *           
    35  |     *                                                                     *           
    36  |     *=====================================================================*/          
    37  |     /*----------------------------------------------------------------------------*/  
    38  |    //                                                                                 
    39  |    //  Ê¶ÇËÉíÅ                                                                        
    40  |    //    „Éë„ÇπÔºì                                                                    
    41  |    //                                                                                 
    42  |    //  ‰ΩúÊàêËÄÖ                                                                      
    43  |    //                                                                                 
    44  |    /*----------------------------------------------------------------------------*/   
    45  |                                                                                       
    46  +--- #include &quot;pass3.h&quot;
    47  |    
    48  +--- void ParseScript(TList *TokenList,int sPos,string TokStr);
    49  +--- TScValData *GetScValData(TList *TokenList,string ValName);
    50  |    
    51  +--- /*----------------------------------------------------------------------------*/
    52  |    //                                                                                                   
    53  |    //  1.ÊóÅEÊúÉÉË™ûÂêç                                                                                 
    54  |    //                                                                                                   
    55  |    //  2.„Éë„É©„ÉÅB„ÇÉ\Ë™ÉÉÊòé                                                                          
    56  |    //    TokenList   „Éà„Éº„ÇÉb„ÉÉE„ÉÉF„ÇÉP„Éà                                                          
    57  |    //    ValDataList Â§âÊï∞„ÉÉF„ÇÉP„Éà                                                                  
    58  |    //                                                                                                   
    59  |    //  3.Ê¶ÇËÉíÅ                                                                                        
    60  |    //    „ÇÉP„ÇÉb„ÉÉF„Éó„Éà„ÅÉáËßÅvÊûê„ÇíË°å„Å™„ÅÑ„ÄÅToken-&gt;Script„ÅÉH„Éá„Éº„ÇÉ\„Çí„Çª„ÉÉ„Éà„Åô„Çã„ÄÇ   
    61  |    //                                                                                                   
    62  |    //  4.Ê©üËÉΩË™ÉÉÊòé                                                                                  
    63  |    //                                                                                                   
    64  |    //  5.ÊàÉT„ÇäÂÄÅA                                                                                    
    65  |    //                                                                                                   
    66  |    //  6.ÂÇôËÄÉ                                                                                         
    67  |    //                                                                                                   
    68  |    /*----------------------------------------------------------------------------*/                     
        |  +--------------------------------------------------+ 
    69  +--+ void Pass3(TList *TokenList,TList *ValDataList)  | 
    70  |  | {                                                | 
        |  +--+-----------------------------------------------+ 
    71  |     +--- int i;
    72  |     +--- TToken *Token;
    73  |     +--- TToken *Token2;
    74  |     +--- TScript *Script = NULL;
    75  |     +--- TScript *LastScript = NULL;
    76  |     +--- string s,s1;
    77  |     +--- int pos;
    78  |     |    
        |     |  +----------------------------------------+ 
    79  |     +--+ if(MainF-&gt;SrcCodeType != MainF-&gt;sctC){ | 
        |     |  +--+-------------------------------------+ 
        |     |     |  +------------------------------------------+ 
    80  |     |     +--+ for(i = 0 ; i &lt; TokenList-&gt;Count ; i++){ | 
        |     |     |  +--+---------------------------------------+ 
    81  |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[i];
        |     |     |     |  +----------------------------------------------+ 
    82  |     |     |     +--+ if(Token-&gt;TokId == tid_Comment){ // Fortran  | 
        |     |     |     |  +--+-------------------------------------------+ 
    83  |     |     |     |     +--- s = Trim(Token-&gt;Str);
    84  |     |     |     |     +--- pos = s.find(' ');
        |     |     |     |     |  +----------------+ 
    85  |     |     |     |     +--+ if(pos &gt;= 0){  | 
        |     |     |     |     |  +--+-------------+ 
    86  |     |     |     |     |     +--- s = Trim(s.substr(0,pos));
        |     |     |     |     |   +-+---+ 
    87  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |     |  +------------------------------+ 
    88  |     |     |     |     +--+ if(LowerCase(s) == &quot;!oat$&quot;){ | 
        |     |     |     |     |  +--+---------------------------+ 
    89  |     |     |     |     |     +--- Script = new TScript(TokenList,i,LastScript,ValDataList);
        |     |     |     |     |     |  +----------------------------------+ 
    90  |     |     |     |     |     +--+ if(Script-&gt;ScType != sct_None){  | 
        |     |     |     |     |     |  +--+-------------------------------+ 
    91  |     |     |     |     |     |     +--- LastScript = Script;
        |     |     |     |     |     |   +-+---+ 
    92  |     |     |     |     |     |   |  }  | 
        |     |     |     |     |     |   +-----+ 
    93  |     |     |     |     |     +--- Token-&gt;Script = Script;
        |     |     |     |     |   +-+---+ 
    94  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |   +-+---+ 
    95  |     |     |     |   |  }  | 
        |     |     |     |   +-+---+ 
        |     |     |     |   +-+---------------------------------------+ 
    95  |     |     |     |   |  else if(Token-&gt;TokId != tid_LineEnd){  | 
        |     |     |     |   +-+---------------------------------------+ 
    96  |     |     |     |     +--- LastScript = NULL;
        |     |     |     |   +-+---+ 
    97  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |   +-+---+ 
    98  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |   +-+---+ 
    99  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-----------+ 
    99  |     |   |  else{ // C | 
        |     |   +-+-----------+ 
        |     |     |  +--------------------------------------------+ 
   100  |     |     +--+ for(i = 0 ; i &lt; TokenList-&gt;Count-1 ; i++){ | 
        |     |     |  +--+-----------------------------------------+ 
   101  |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[i];
        |     |     |     |  +--------------------------------------+ 
   102  |     |     |     +--+ if(Token-&gt;TokId == tid_SharpPragma){ | 
        |     |     |     |  +--+-----------------------------------+ 
   103  |     |     |     |     +--- Token2 = (TToken *)TokenList-&gt;Items[i+1];
        |     |     |     |     |  +--------------------------------------+ 
   104  |     |     |     |     +--+ if(LowerCase(Token2-&gt;Str) == &quot;oat&quot;){ | 
        |     |     |     |     |  +--+-----------------------------------+ 
   105  |     |     |     |     |     +--- Script = new TScript(TokenList,i+1,LastScript,ValDataList);
        |     |     |     |     |     |  +----------------------------------+ 
   106  |     |     |     |     |     +--+ if(Script-&gt;ScType != sct_None){  | 
        |     |     |     |     |     |  +--+-------------------------------+ 
   107  |     |     |     |     |     |     +--- LastScript = Script;
        |     |     |     |     |     |   +-+---+ 
   108  |     |     |     |     |     |   |  }  | 
        |     |     |     |     |     |   +-----+ 
   109  |     |     |     |     |     +--- Token-&gt;Script = Script;
        |     |     |     |     |   +-+---+ 
   110  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |   +-+---+ 
   111  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |   +-+---+ 
   112  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |   +-+---+ 
   113  |     |   |  }  | 
        |     |   +-----+ 
        |   +-+---+ 
   114  |   |  }  | 
        |   +-----+ 
   115  |    
   116  +--- /*----------------------------------------------------------------------------*/
   117  |    //                                                                                                                     
   118  |    //  1.ÊóÅEÊúÉÉË™ûÂêç                                                                                                   
   119  |    //                                                                                                                     
   120  |    //  2.„Éë„É©„ÉÅB„ÇÉ\Ë™ÉÉÊòé                                                                                            
   121  |    //    TokenList   „Éà„Éº„ÇÉb„ÉÉE„ÉÉF„ÇÉP„Éà                                                                            
   122  |    //    sPos    „Éà„Éº„ÇÉb„ÉÉE„ÉÉF„ÇÉP„ÉàÈñãÂßã‰ÉXçÁÉXÉá                                                                 
   123  |    //                                                                                                                     
   124  |    //  3.Ê¶ÇËÉíÅ                                                                                                          
   125  |    //    „ÇÉP„ÇÉb„ÉÉF„Éó„Éà„Éá„Éº„ÇÉ\„ÇíÁîüÊàê„Åô„Çã„ÄÇ„Çπ„ÇÉb„ÉÉF„Éó„Éà„ÅÉáÁ®ÉáÈ°û„Å´Âøú„Åò„ÅüÂá¶ÁêÜ„ÅåË°å„Çè„Çå„Çã„ÄÇ   
   126  |    //    ÂøÖËÉíÅ„Å™Â†ÉGÂêà„ÅØ„ÄÅ„Çπ„ÇÉb„ÉÉF„Éó„ÉàÂ§âÊï∞ÁîüÊàê„ÇÇËÅBå„Çè„Çå„Çã„ÄÇ                                          
   127  |    //                                                                                                                     
   128  |    //  4.Ê©üËÉΩË™ÉÉÊòé                                                                                                    
   129  |    //                                                                                                                     
   130  |    //  5.ÊàÉT„ÇäÂÄÅA                                                                                                      
   131  |    //                                                                                                                     
   132  |    //  6.ÂÇôËÄÉ                                                                                                           
   133  |    //                                                                                                                     
   134  |    /*----------------------------------------------------------------------------*/                                       
        |  +------------------------------------------------------------------------------------+ 
   135  +--+ TScript::TScript(TList *TokenList,int sPos,TScript *LastScript,TList *ValDataList) | 
   136  |  | {                                                                                  | 
        |  +--+---------------------------------------------------------------------------------+ 
   137  |     +--- string s,s1,s2;
   138  |     +--- int i;
   139  |     +--- TToken *Token;
   140  |     +--- TokStrList = new TStringList;
   141  |     |    
   142  |     +--- PreviousScript = LastScript;
        |     |  +--------------------------+ 
   143  |     +--+ if(LastScript != NULL){  | 
        |     |  +--+-----------------------+ 
   144  |     |     +--- LastScript-&gt;NextScript = this;
   145  |     |     +--- /*
   146  |     |     |            //  Ôºë„Å§Ââç„ÅÆ„ÇÉP„ÇÉb„ÉÉF„Éó„Éà„ÅÉáÁ∂ôÁÉJö„Åã„ÅÉD„ÅÜ„Åã„Çí„ÉÅ„ÇÉ@„ÉÉ„ÇØ„Åô„Çã„ÄÇ  
   147  |     |     |            if(LastScript-&gt;LineEndTokPos != sPos-2){ // LineEnd + #Pragma                        
   148  |     |     |                LastScript = NULL; // Á∂ôÁÉJö„Åß„ÅÉb„ÅÉF„ÅÑ„ÄÇ                                   
   149  |     |     |            }                                                                                    
   150  |     |     |    */                                                                                           
        |     |   +-+---+ 
   151  |     |   |  }  | 
        |     |   +-----+ 
   152  |     +--- /*
   153  |     |        if(MainF-&gt;SrcCodeType == MainF-&gt;sctFortran){    // Fortran„ÅÉáÂ†ÉGÂêà„ÅØ„ÇÉE„ÉÅB„ÉÉE„ÉàÔÉVëËÅBå  
   154  |     |            i = sPos;                                                                                    
   155  |     |            Token = (TToken *)TokenList-&gt;Items[i];                                                       
   156  |     |            Str = Token-&gt;Str;                                                                            
   157  |     |            LineEndTokPos = i;  // „ÇÉP„ÇÉb„ÉÉF„Éó„Éà„ÅÉáÊîÉPË°å„Éà„ÉÉV„ÇÉb„ÉÉE‰ΩçÁÉXÉá                  
   158  |     |        }else{                                                                                           
   159  |     |    */                                                                                                   
   160  |     +--- TokPos = sPos;
   161  |     +--- Str = &quot;&quot;; // ÔºëËÅBå„ÅÆÊñáÂÉÖóÂàó
        |     |  +----------------------------------------------+ 
   162  |     +--+ for(i = sPos ; i &lt; TokenList-&gt;Count ; i++){  | 
        |     |  +--+-------------------------------------------+ 
   163  |     |     +--- Token = (TToken *)TokenList-&gt;Items[i];
        |     |     |  +----------------------------------+ 
   164  |     |     +--+ if(Token-&gt;TokId == tid_LineEnd){ | 
        |     |     |  +--+-------------------------------+ 
        |     |     |     |  +--------+ 
   165  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |   +-+---+ 
   166  |     |     |   |  }  | 
        |     |     |   +-----+ 
   167  |     |     +--- // „ÇÉP„ÇÉb„ÉÉF„Éó„ÉàÂÜÖ„ÅÆ„Éà„Éº„ÇÉb„ÉÉE„ÅÉb„ÄÅ„Ç≥„ÉÅB„ÉÉE„ÉàÊâ±„ÅÑ„Å®„Åô„Çã„ÄÇ
   168  |     |     |    // OAT‰ªÅEÂ§ñ„Åß„ÅÉá„ÇÉE„ÉÅB„ÉÉE„Éà„ÅØ„ÄÅPass1„ÅÉ@„Åô„Åß„ÅÉH„ÇÉE„ÉÅB„ÉÉE„ÉàÊâ±„ÅÑ„ÄÇ   
   169  |     |     +--- Token-&gt;TokId = tid_Comment;
   170  |     |     +--- Str += Token-&gt;OrgStr;
        |     |   +-+---+ 
   171  |     |   |  }  | 
        |     |   +-----+ 
   172  |     +--- LineEndTokPos = i;  // „ÇÉP„ÇÉb„ÉÉF„Éó„Éà„ÅÉáÊîÉPË°å„Éà„ÉÉV„ÇÉb„ÉÉE‰ΩçÁÉXÉá
   173  |     |                                                                                 
   174  |     +--- Token = (TToken *)TokenList-&gt;Items[sPos];
   175  |     |    
   176  |     +--- ScValDataList = NULL;
   177  |     +--- TuneRegion = NULL;
   178  |     +--- ScType = sct_install;
   179  |     +--- ScAction = sca_none;
   180  |     +--- ScRegion = scr_none;
   181  |     |    
   182  |     +--- // FittingÈñÅuÈÄÅv„ÅÉá„Éá„Éº„ÇÉ\
   183  |     +--- FittingType = 0;
   184  |     +--- FittingDegree = 0;      // Â§öÈ†ÖÂÉVè„ÅÆÊ¨ÅBÊïÅ[
   185  |     +--- SampledList = NULL;     // int„ÅÉáÂΩÅu„ÅÉ@ Sampled„ÅÉáÂÄÅA„Åå„Çª„ÉÉ„Éà
   186  |     |                                                                           
   187  |     +--- //d-splineÁîÉBËøÉXÂä†ÈÉÉBÂàÜ
   188  |     +--- FittingDspline = 0;
   189  |     +--- FittingDynamic = 0;
   190  |     +--- //d-splineÁîÉBËøÉXÂä†ÈÉÉBÂàÜ„Åì„Åì„Åæ„ÅÉ@
   191  |     |                                               
   192  |     +--- //
   193  |     |    // „Éà„Éº„ÇÉb„ÉÉE„ÅÉHÂàÜËÉ@Åv„Åô„Çã„ÄÇ                                                                                 
   194  |     |    // Script„ÅÉ@„ÅÉá„ÇÉT„Éë„É¨„ÉÉV„ÇÉ\„ÅÉb„ÄÅÈÄöÂÉNÉN„Çà„ÇäÂ∞ë„Å™„ÅÑ„ÄÇ                                                   
   195  |     |    // „Åì„Çå„ÅÉb„ÄÅleast-squares „ÅÉF„ÅÉD„ÇíÔÉVë„Éà„ÉÉV„ÇÉb„ÉÉE„ÅÉB„Åó„Å¶ÊâÉA„ÅÜ„Åü„ÇÅ„ÄÇ                                 
   196  |     |    // „Åü„Å†„Åó„ÄÅ‰ÉNÄÈÉÉB„ÅÉáScript„ÅÉH„ÅÅA„ÅÑ„Å¶„ÅÉb„ÄÅÂÖÉ„ÇíÂèÇÁÖÉ@„Åó„Åü„ÅÑ„Åü„ÇÅ„Å´Âêå„ÅòToken‰∏Éí„ÅÉE„ÅÉB„Åô„Çã„ÄÇ  
   197  |     |    //                                                                                                                     
   198  |     +--- s1 = &quot;&quot;;
   199  |     +--- s = Str;
        |     |  +------------------------------------------+ 
   200  |     +--+ for(i = 1 ; i &lt;= (int)s.length() ; i++){ | 
        |     |  +--+---------------------------------------+ 
        |     |     |  +------------------------------------------------------------------+ 
   201  |     |     +--+ if((s[i] == ' ')||(s[i] == '(')||(s[i] == ')')||(s[i] == ',')){  | 
        |     |     |  +--+---------------------------------------------------------------+ 
   202  |     |     |     +--- s1 = Trim(s1);
        |     |     |     |  +----------------+ 
   203  |     |     |     +--+ if(s1 != &quot;&quot;){  | 
        |     |     |     |  +--+-------------+ 
   204  |     |     |     |     +--- TokStrList-&gt;Add(s1);
        |     |     |     |   +-+---+ 
   205  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
   206  |     |     |     +--- s1 = s[i];
        |     |     |     |  +----------------+ 
   207  |     |     |     +--+ if(s1 != &quot; &quot;){ | 
        |     |     |     |  +--+-------------+ 
   208  |     |     |     |     +--- TokStrList-&gt;Add(s1);
        |     |     |     |   +-+---+ 
   209  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
   210  |     |     |     +--- s1 = &quot;&quot;;
        |     |     |   +-+---+ 
   211  |     |     |   |  }  | 
        |     |     |   +-+---+ 
        |     |     |   +-+-------+ 
   211  |     |     |   |  else{  | 
        |     |     |   +-+-------+ 
   212  |     |     |     +--- s1 += s[i];
        |     |     |   +-+---+ 
   213  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |   +-+---+ 
   214  |     |   |  }  | 
        |     |   +-----+ 
   215  |     +--- s1 = Trim(s1);
        |     |  +----------------+ 
   216  |     +--+ if(s1 != &quot;&quot;){  | 
        |     |  +--+-------------+ 
   217  |     |     +--- TokStrList-&gt;Add(s1);
        |     |   +-+---+ 
   218  |     |   |  }  | 
        |     |   +-----+ 
   219  |     +--- /*
   220  |     |        for(i = 0 ; i &lt; TokStrList-&gt;Count ; i++){  
   221  |     |            MainF-&gt;print(TokStrList-&gt;Strings[i]);  
   222  |     |        }                                          
   223  |     |                                                   
   224  |     |    */                                             
   225  |     +--- // „ÇÉP„ÇÉb„ÉÉF„Éó„Éà„Éà„Éº„ÇÉb„ÉÉEËßÅvÊûê
   226  |     +--- i = 0;
   227  |     +--- i++; // Skip &quot;!OAT$&quot; or &quot;OAT&quot;
        |     |  +------------------------------+ 
   228  |     +--+ if(i &gt;= TokStrList-&gt;Count){  | 
        |     |  +--+---------------------------+ 
        |     |     |  +----------+ 
   229  |     |     +--+ return;  | 
        |     |     |  +----------+ 
        |     |   +-+---+ 
   230  |     |   |  }  | 
        |     |   +-----+ 
   231  |     +--- s = LowerCase(TokStrList-&gt;Strings[i++]);
        |     |  +----------------------------+ 
   232  |     +--+ if(i &gt; TokStrList-&gt;Count){ | 
        |     |  +--+-------------------------+ 
   233  |     |     +--- ScType = sct_None;
   234  |     |     +--- //      TokStrList-&gt;Clear();
        |     |     |  +----------+ 
   235  |     |     +--+ return;  | 
        |     |     |  +----------+ 
        |     |   +-+---+ 
   236  |     |   |  }  | 
        |     |   +-----+ 
        |     |  +------------------------------+ 
   237  |     +--+ if(i == TokStrList-&gt;Count){  | 
        |     |  +--+---------------------------+ 
   238  |     |     +--- i--; // „ÇÇ„ÅóÊúÄÂæå„ÅÆÂ†ÉGÂêà„ÅØ„ÄÅÔÉVë„Å§ÊàÉT„Åó„Å¶ÂèÇÁÖß„ÇÉB„ÉÉD„ÉÉV„ÇíÂõûÈÅÉ\„Åô„Çã„ÄÇ
        |     |   +-+---+ 
   239  |     |   |  }  | 
        |     |   +-----+ 
        |     |  +------------------+ 
   240  |     +--+ if(s == &quot;call&quot;){ | 
        |     |  +--+---------------+ 
   241  |     |     +--- //
   242  |     |     |    // #pragma ABCLib call ABCLib_BPset(&quot;i&quot;) „Çí                       
   243  |     |     |    // #pragma ABCLib BPset(&quot;i&quot;) „ÅÉHÂ§âÊõ¥„Åô„Çã„ÄÇ Mod 2011/09/05    
   244  |     |     |    //  ÈùûÂùáË≥ÉFË®àÁÉáóÊÉDüÂÉbÉZÂøúÔÉVàÂÉPÉEÊàê23/7/20Ôºâ„ÅÆÂØÉZÂøú  
   245  |     |     |    //                                                                 
   246  |     |     +--- s2 = LowerCase(TokStrList-&gt;Strings[i]);
        |     |     |  +------------------------+ 
   247  |     |     +--+ if(s2 == &quot;oat_bpset&quot;){ | 
        |     |     |  +--+---------------------+ 
   248  |     |     |     +--- s = &quot;bpset&quot;;
   249  |     |     |     +--- i+=1;
        |     |     |   +-+---+ 
   250  |     |     |   |  }  | 
        |     |     |   +-+---+ 
        |     |     |   +-+-------------------------------+ 
   250  |     |     |   |  else if(s2 == &quot;oat_setparm&quot;){  | 
        |     |     |   +-+-------------------------------+ 
   251  |     |     |     +--- s = &quot;setparm&quot;;
   252  |     |     |     +--- i+=1;
        |     |     |   +-+---+ 
   253  |     |     |   |  }  | 
        |     |     |   +-+---+ 
        |     |     |   +-+-----------------------------------------------------------------------------------+ 
   253  |     |     |   |  else if(s2 == &quot;oat_atexec&quot;){   // call OAT_ATexec() ÂºïÊï∞„Åå„Çª„ÉÉ„Éà„Åï„Çå„Çã„ÄÇ | 
        |     |     |   +-+-----------------------------------------------------------------------------------+ 
   254  |     |     |     +--- s = &quot;atexec&quot;;
   255  |     |     |     +--- i+=1;
        |     |     |   +-+---+ 
   256  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |   +-+---+ 
   257  |     |   |  }  | 
        |     |   +-----+ 
        |     |  +----------------------+ 
   258  |     +--+ if(s == &quot;install&quot;){  | 
        |     |  +--+-------------------+ 
   259  |     |     +--- ScType = sct_install;   // ËáÉFÂãï„ÉÅ„ÉÅE„ÉÉV„Éã„É≥„ÇÅ[Á®ÉáÈ°û
        |     |   +-+---+ 
   260  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-------------------------+ 
   260  |     |   |  else if(s == &quot;static&quot;){  | 
        |     |   +-+-------------------------+ 
   261  |     |     +--- ScType = sct_static;    // ËáÉFÂãï„ÉÅ„ÉÅE„ÉÉV„Éã„É≥„ÇÅ[Á®ÉáÈ°û
        |     |   +-+---+ 
   262  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-------------------------+ 
   262  |     |   |  else if(s == &quot;dynamic&quot;){ | 
        |     |   +-+-------------------------+ 
   263  |     |     +--- ScType = sct_dynamic;   // ËáÉFÂãï„ÉÅ„ÉÅE„ÉÉV„Éã„É≥„ÇÅ[Á®ÉáÈ°û
        |     |   +-+---+ 
   264  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-----------------------+ 
   264  |     |   |  else if(s == &quot;name&quot;){  | 
        |     |   +-+-----------------------+ 
   265  |     |     +--- ScType = sct_name;      // ËáÉFÂãï„ÉÅ„ÉÅE„ÉÉV„Éã„É≥„ÇÅ[Á®ÉáÈ°û
        |     |   +-+---+ 
   266  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+---------------------------+ 
   266  |     |   |  else if(s == &quot;parameter&quot;){ | 
        |     |   +-+---------------------------+ 
   267  |     |     +--- ScType = sct_parameter;
        |     |   +-+---+ 
   268  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-------------------------+ 
   268  |     |   |  else if(s == &quot;select&quot;){  | 
        |     |   +-+-------------------------+ 
   269  |     |     +--- ScType = sct_select;
        |     |   +-+---+ 
   270  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+---------------------------+ 
   270  |     |   |  else if(s == &quot;according&quot;){ | 
        |     |   +-+---------------------------+ 
   271  |     |     +--- ScType = sct_according;
        |     |   +-+---+ 
   272  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-------------------------+ 
   272  |     |   |  else if(s == &quot;varied&quot;){  | 
        |     |   +-+-------------------------+ 
   273  |     |     +--- ScType = sct_varied;
        |     |   +-+---+ 
   274  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-------------------------+ 
   274  |     |   |  else if(s == &quot;fitting&quot;){ | 
        |     |   +-+-------------------------+ 
   275  |     |     +--- ScType = sct_fitting;
        |     |   +-+---+ 
   276  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+---------------------------------------------+ 
   276  |     |   |  else if(s == &quot;pripro&quot;){    // Mod 2011/08/03 | 
        |     |   +-+---------------------------------------------+ 
   277  |     |     +--- ScType = sct_prepro;
        |     |   +-+---+ 
   278  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-------------------------+ 
   278  |     |   |  else if(s == &quot;prepro&quot;){  | 
        |     |   +-+-------------------------+ 
   279  |     |     +--- ScType = sct_prepro;
        |     |   +-+---+ 
   280  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-------------------------+ 
   280  |     |   |  else if(s == &quot;postpro&quot;){ | 
        |     |   +-+-------------------------+ 
   281  |     |     +--- ScType = sct_postpro;
        |     |   +-+---+ 
   282  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-----------------------+ 
   282  |     |   |  else if(s == &quot;debug&quot;){ | 
        |     |   +-+-----------------------+ 
   283  |     |     +--- ScType = sct_debug;
        |     |   +-+---+ 
   284  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+---------------------------------+ 
   284  |     |   |  else if(s == &quot;oat_dynpefthis&quot;){  | 
        |     |   +-+---------------------------------+ 
   285  |     |     +--- ScType = sct_DynPefThis;
        |     |   +-+---+ 
   286  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-------------------------+ 
   286  |     |   |  else if(s == &quot;number&quot;){  | 
        |     |   +-+-------------------------+ 
   287  |     |     +--- ScType = sct_Number;
        |     |   +-+---+ 
   288  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-----------------------+ 
   288  |     |   |  else if(s == &quot;bpset&quot;){ | 
        |     |   +-+-----------------------+ 
   289  |     |     +--- ScType = sct_BPset;
        |     |   +-+---+ 
   290  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+---------------------------+ 
   290  |     |   |  else if(s == &quot;allocate&quot;){  | 
        |     |   +-+---------------------------+ 
   291  |     |     +--- ScType = sct_Allocate;
        |     |   +-+---+ 
   292  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+---------------------+ 
   292  |     |   |  else if(s == &quot;pre&quot;){ | 
        |     |   +-+---------------------+ 
   293  |     |     +--- s2 = LowerCase(TokStrList-&gt;Strings[i]);
        |     |     |  +--------------------+ 
   294  |     |     +--+ if(s2 == &quot;bpset&quot;){ | 
        |     |     |  +--+-----------------+ 
   295  |     |     |     +--- ScType = sct_pre_BPset;
   296  |     |     |     +--- i++;
        |     |     |   +-+---+ 
   297  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |   +-+---+ 
   298  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-----------------------+ 
   298  |     |   |  else if(s == &quot;post&quot;){  | 
        |     |   +-+-----------------------+ 
   299  |     |     +--- s2 = LowerCase(TokStrList-&gt;Strings[i]);
        |     |     |  +--------------------+ 
   300  |     |     +--+ if(s2 == &quot;bpset&quot;){ | 
        |     |     |  +--+-----------------+ 
   301  |     |     |     +--- ScType = sct_post_BPset;
   302  |     |     |     +--- i++;
        |     |     |   +-+---+ 
   303  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |   +-+---+ 
   304  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-------------------------+ 
   304  |     |   |  else if(s == &quot;setparm&quot;){ | 
        |     |   +-+-------------------------+ 
   305  |     |     +--- ScType = sct_SetParm;
        |     |     |  +------------------------------------------+ 
   306  |     |     +--+ if(MainF-&gt;Call_SetParam_Script == NULL){ | 
        |     |     |  +--+---------------------------------------+ 
   307  |     |     |     +--- MainF-&gt;Call_SetParam_Script = this;
        |     |     |   +-+---+ 
   308  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |   +-+---+ 
   309  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-----------------------------+ 
   309  |     |   |  else if(s == &quot;splitpoint&quot;){  | 
        |     |   +-+-----------------------------+ 
   310  |     |     +--- ScType = sct_SplitPoint;
        |     |   +-+---+ 
   311  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-----------------------------------+ 
   311  |     |   |  else if(s == &quot;splitpointcopydef&quot;){ | 
        |     |   +-+-----------------------------------+ 
   312  |     |     +--- ScType = sct_SplitPointCopyDef;
        |     |   +-+---+ 
   313  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+---------------------------------------+ 
   313  |     |   |  else if(s == &quot;splitpointcopyinsert&quot;){  | 
        |     |   +-+---------------------------------------+ 
   314  |     |     +--- ScType = sct_SplitPointCopyInsert;
        |     |   +-+---+ 
   315  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-------------------------------+ 
   315  |     |   |  else if(s == &quot;rotationorder&quot;){ | 
        |     |   +-+-------------------------------+ 
   316  |     |     +--- ScType = sct_RotationOrder;
        |     |   +-+---+ 
   317  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-----------------------+ 
   317  |     |   |  else if(s == &quot;bind&quot;){  | 
        |     |   +-+-----------------------+ 
   318  |     |     +--- ScType = sct_Bind;
        |     |   +-+---+ 
   319  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-----------------------------------------+ 
   319  |     |   |  else if(s == &quot;list&quot;){  // Add 2016/02/26 | 
        |     |   +-+-----------------------------------------+ 
   320  |     |     +--- ScType = sct_List;
        |     |   +-+---+ 
   321  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-------------------------+ 
   321  |     |   |  else if(s == &quot;variedd&quot;){ | 
        |     |   +-+-------------------------+ 
   322  |     |     +--- ScType = sct_variedD;
        |     |   +-+---+ 
   323  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-----------------------+ 
   323  |     |   |  else if(s == &quot;listd&quot;){ | 
        |     |   +-+-----------------------+ 
   324  |     |     +--- ScType = sct_ListD;
        |     |   +-+---+ 
   325  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-------------------------+ 
   325  |     |   |  else if(s == &quot;replace&quot;){ | 
        |     |   +-+-------------------------+ 
   326  |     |     +--- ScType = sct_Replace;
        |     |   +-+---+ 
   327  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-------------------------+ 
   327  |     |   |  else if(s == &quot;target&quot;){  | 
        |     |   +-+-------------------------+ 
   328  |     |     +--- ScType = sct_Target;
        |     |   +-+---+ 
   329  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+---------------------+ 
   329  |     |   |  else if(s == &quot;gwv&quot;){ | 
        |     |   +-+---------------------+ 
   330  |     |     +--- ScType = sct_GWV;
        |     |   +-+---+ 
   331  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+---------------------------+ 
   331  |     |   |  else if(s == &quot;gwv-list&quot;){  | 
        |     |   +-+---------------------------+ 
   332  |     |     +--- ScType = sct_GWV_list;
        |     |   +-+---+ 
   333  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-----------------------------+ 
   333  |     |   |  else if(s == &quot;gwv-target&quot;){  | 
        |     |   +-+-----------------------------+ 
   334  |     |     +--- ScType = sct_GWV_target;
        |     |   +-+---+ 
   335  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-------------------------+ 
   335  |     |   |  else if(s == &quot;atexec&quot;){  | 
        |     |   +-+-------------------------+ 
        |     |     |  +----------------------------------------+ 
   336  |     |     +--+ if(MainF-&gt;Call_ATExec_Script == NULL){ | 
        |     |     |  +--+-------------------------------------+ 
   337  |     |     |     +--- MainF-&gt;Call_ATExec_Script = this;
        |     |     |   +-+---+ 
   338  |     |     |   |  }  | 
        |     |     |   +-----+ 
   339  |     |     +--- ScType = sct_ATExec;
   340  |     |     +--- TokStrList-&gt;Clear();
   341  |     |     +--- // ATExec()„ÅÉH„ÅÅA„ÅÑ„Å¶„ÅÉb„ÄÅÂÉVïÊï∞„ÉÉF„ÇÉP„ÉàÂèÇÁÖÉ@„Åå„ÅÇ„Çã„ÅÆ„ÅÉ@„ÄÅValDataÂèÇÁÖßÂèÉbËÉÉX„ÅÉF„Éà„Éº„ÇÉb„ÉÉE„Çí‰ÉXÉ\ÁîÉB„Åô„Çã„ÄÇ
        |     |     |  +------------------------------------------------+ 
   342  |     |     +--+ for(int j = sPos+1 ; j &lt; LineEndTokPos ; j++){ | 
        |     |     |  +--+---------------------------------------------+ 
   343  |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[j];
   344  |     |     |     +--- TokStrList-&gt;AddObject(Token-&gt;OrgStr,Token);
        |     |     |   +-+---+ 
   345  |     |     |   |  }  | 
        |     |     |   +-----+ 
   346  |     |     +--- //
   347  |     |     |    //  atexecÂÜÖ„ÅÆ„Éá„Éº„ÇÉ\„ÅÉH„ÅÅA„ÅÑ„Å¶„ÅÉb„ÄÅÂÅAâÊï∞Âêç„ÇíÊéÅu„Åó„Å¶ValData„ÇíËÉBÉÖÂÆö„Åô„Çã„ÄÇ  
   348  |     |     |    //                                                                                                 
   349  |     |     +--- AddDataDef_C(MainF-&gt;TokenList,sPos+1,LineEndTokPos,ValDataList);
   350  |     |     +--- //  }else if((LastScript != NULL)&amp;&amp;(LastScript-&gt;ScType == sct_ATExec)){ // Á∂ôÁÉJö
        |     |   +-+---+ 
   351  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-------------------------------------------------------------------------------+ 
   351  |     |   |  else if((LastScript != NULL)&amp;&amp;(LastScript-&gt;CheckBrBalance() != 0)){ // Á∂ôÁÉJö | 
        |     |   +-+-------------------------------------------------------------------------------+ 
   352  |     |     +--- // Ôºë„Å§Ââç„ÅÆ„ÇÉP„ÇÉb„ÉÉF„Éó„Éà„ÅåATExec„ÅÉ@‰ªäÂõû„ÅåÊåáÂÆö„Å™„Åó„ÅÆÂ†ÉGÂêà„ÅØ„ÄÅÂâç„ÅÉá„Éà„Éº„ÇÉb„ÉÉE„ÅÉHËøÉXÂä†„Åô„Çã„ÄÇ
   353  |     |     +--- Token = (TToken *)TokenList-&gt;Items[LastScript-&gt;LineEndTokPos];
   354  |     |     +--- LastScript-&gt;TokStrList-&gt;AddObject(Token-&gt;OrgStr,Token);
   355  |     |     +--- //          MainF-&gt;print(&quot;[&quot;+Token-&gt;Str+&quot;]&quot;);
        |     |     |  +------------------------------------------------+ 
   356  |     |     +--+ for(int j = sPos+1 ; j &lt; LineEndTokPos ; j++){ | 
        |     |     |  +--+---------------------------------------------+ 
   357  |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[j];
   358  |     |     |     +--- //          MainF-&gt;print(&quot;[&quot;+Token-&gt;Str+&quot;]&quot;);
   359  |     |     |     +--- LastScript-&gt;TokStrList-&gt;AddObject(Token-&gt;OrgStr,Token);
        |     |     |   +-+---+ 
   360  |     |     |   |  }  | 
        |     |     |   +-----+ 
   361  |     |     +--- AddDataDef_C(MainF-&gt;TokenList,sPos+1,LineEndTokPos,ValDataList);
   362  |     |     +--- ScType = sct_None;
   363  |     |     +--- TokStrList-&gt;Clear();
        |     |   +-+---+ 
   364  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-----------------------------------------------------------------------+ 
   364  |     |   |  else if(s == &quot;option&quot;){    // „ÇÉP„ÇÉb„ÉÉF„Éó„Éà Option Add 2016/02/29 | 
        |     |   +-+-----------------------------------------------------------------------+ 
   365  |     |     +--- ScType = sct_Option;
        |     |   +-+---+ 
   366  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-------------+ 
   366  |     |   |  else{ // Âºè | 
        |     |   +-+-------------+ 
   367  |     |     +--- ScType = sct_command;   // ËáÉFÂãï„ÉÅ„ÉÅE„ÉÉV„Éã„É≥„ÇÅ[Á®ÉáÈ°û
   368  |     |     +--- //
   369  |     |     |    // „ÇÉE„Éû„É≥„Éâ„ÅÆÂ†ÉGÂêà„ÅØ„ÄÅTokStrList„ÇíÔÉVë„Å§„Å†„Åë„Å´‰øÉáÊ≠Åv„Åô„Çã„ÄÇ   
   370  |     |     |    // „ÇÅA„ÉÉE„ÉÜ„É≥„Éà„ÇíÊúâÂäπ„ÅÉH„Åô„Çã„Åü„ÇÅ„ÅÉH OrgStrÂÅÉG„ÇíÂèÇÁÖÉ@„ÄÇ        
   371  |     |     |    //                                                                               
   372  |     |     +--- s = &quot;&quot;;
        |     |     |  +----------------------------------------------+ 
   373  |     |     +--+ for(i = TokPos+1 ; i &lt; LineEndTokPos ; i++){ | 
        |     |     |  +--+-------------------------------------------+ 
   374  |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[i];
   375  |     |     |     +--- s += Token-&gt;OrgStr;
        |     |     |   +-+---+ 
   376  |     |     |   |  }  | 
        |     |     |   +-----+ 
   377  |     |     +--- TokStrList-&gt;Clear();
   378  |     |     +--- s = &quot;      &quot;+s; // Fortan„ÅÉBÂêà„Çè„Åõ„Å¶„ÄÅÁÉDÉRÁôÉX„ÇíÂâç„ÅÉHÂÖÅE„Çå„Çã„ÄÇ
   379  |     |     +--- TokStrList-&gt;Add(s);
        |     |     |  +----------+ 
   380  |     |     +--+ return;  | 
        |     |     |  +----------+ 
   381  |     |     +--- /*
   382  |     |     |            s = Str;                                                                             
   383  |     |     |            if(MainF-&gt;SrcCodeType != MainF-&gt;sctC){                                               
   384  |     |     |                s.erase(0,6);   // Delete &quot;!OAT$ &quot;                                               
   385  |     |     |            }else{                                                                               
   386  |     |     |                s.erase(0,4);   // Delete &quot;OAT &quot;                                                 
   387  |     |     |            }                                                                                    
   388  |     |     |            s = &quot;      &quot;+Trim(s); // Fortan„ÅÉBÂêà„Çè„Åõ„Å¶„ÄÅÁÉDÉRÁôÉX„ÇíÂâç„ÅÉHÂÖÅE„Çå„Çã„ÄÇ   
   389  |     |     |    */                                                                                           
        |     |   +-+---+ 
   390  |     |   |  }  | 
        |     |   +-----+ 
   391  |     +--- //
   392  |     |    //  List„Åã„ÇâList_End„ÅÉZ„ÅÉ@„ÅÉá„ÇÉP„ÇÉb„ÉÉF„Éó„Éà„ÅÉH„ÅÅA„ÅÑ„Å¶„ÅÉb„ÄÅÂÖÉ„ÅÉáTokenList„ÅÉBÂêå„ÅòÂèÇÁÖß„ÅÉH„Åô„Çã„ÄÇ2016/02/29 
   393  |     |    //                                                                                                                               
        |     |  +------------------------------------------------------+ 
   394  |     +--+ if((ScType &gt;= sct_List)&amp;&amp;(ScType &lt;= sct_List_End)){  | 
        |     |  +--+---------------------------------------------------+ 
   395  |     |     +--- TokStrList-&gt;Clear();
        |     |     |  +--------------------------------------------------+ 
   396  |     |     +--+ for(int j = sPos+1 ; j &lt;= LineEndTokPos ; j++){  | 
        |     |     |  +--+-----------------------------------------------+ 
   397  |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[j];
   398  |     |     |     +--- TokStrList-&gt;AddObject(Token-&gt;OrgStr,Token);
        |     |     |   +-+---+ 
   399  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |   +-+---+ 
   400  |     |   |  }  | 
        |     |   +-----+ 
   401  |     +--- // Ê©üËÉΩ„Çí„ÉÅ„ÇÉ@„ÉÉ„ÇØ
        |     |  +------------------------------+ 
   402  |     +--+ if(i &gt;= TokStrList-&gt;Count){  | 
        |     |  +--+---------------------------+ 
        |     |     |  +----------+ 
   403  |     |     +--+ return;  | 
        |     |     |  +----------+ 
        |     |   +-+---+ 
   404  |     |   |  }  | 
        |     |   +-----+ 
        |     |  +----------------------------+ 
   405  |     +--+ if(ScType == sct_fitting){ | 
        |     |  +--+-------------------------+ 
   406  |     |     +--- GetFittingParam(i);
        |     |     |  +----------+ 
   407  |     |     +--+ return;  | 
        |     |     |  +----------+ 
        |     |   +-+---+ 
   408  |     |   |  }  | 
        |     |   +-----+ 
   409  |     +--- s = LowerCase(TokStrList-&gt;Strings[i++]);
        |     |  +--------------------+ 
   410  |     +--+ if(s == &quot;define&quot;){ | 
        |     |  +--+-----------------+ 
   411  |     |     +--- ScAction = sca_define;
        |     |   +-+---+ 
   412  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+---------------------------+ 
   412  |     |   |  else if(s == &quot;variable&quot;){  | 
        |     |   +-+---------------------------+ 
   413  |     |     +--- ScAction = sca_variable;
        |     |   +-+---+ 
   414  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-------------------------+ 
   414  |     |   |  else if(s == &quot;select&quot;){  | 
        |     |   +-+-------------------------+ 
   415  |     |     +--- ScAction = sca_select;
        |     |   +-+---+ 
   416  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-------------------------+ 
   416  |     |   |  else if(s == &quot;unroll&quot;){  | 
        |     |   +-+-------------------------+ 
   417  |     |     +--- ScAction = sca_unroll;
        |     |   +-+---+ 
   418  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-----------------------------+ 
   418  |     |   |  else if(s == &quot;loopfusion&quot;){  | 
        |     |   +-+-----------------------------+ 
   419  |     |     +--- ScAction = sca_loopfusion;
        |     |   +-+---+ 
   420  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+---------------------------+ 
   420  |     |   |  else if(s == &quot;loopsplit&quot;){ | 
        |     |   +-+---------------------------+ 
   421  |     |     +--- ScAction = sca_loopsplit;
        |     |   +-+---+ 
   422  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+---------------------------------+ 
   422  |     |   |  else if(s == &quot;loopfusionsplit&quot;){ | 
        |     |   +-+---------------------------------+ 
   423  |     |     +--- ScAction = sca_loopfusionsplit;
        |     |   +-+---+ 
   424  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-------------------------------+ 
   424  |     |   |  else if(s == &quot;rotationorder&quot;){ | 
        |     |   +-+-------------------------------+ 
   425  |     |     +--- ScAction = sca_rotationorder;
        |     |   +-+---+ 
   426  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-------------------------------------------------+ 
   426  |     |   |  else if((s == &quot;atexec&quot;)&amp;&amp;(ScType == sct_Bind)){  | 
        |     |   +-+-------------------------------------------------+ 
   427  |     |     +--- ScAction = sca_none;
   428  |     |     +--- s = LowerCase(TokStrList-&gt;Strings[i++]);
        |     |     |  +------------------------+ 
   429  |     |     +--+ if(s == &quot;arguments&quot;){  | 
        |     |     |  +--+---------------------+ 
   430  |     |     |     +--- s = LowerCase(TokStrList-&gt;Strings[i++]);
        |     |     |     |  +--------------------+ 
   431  |     |     |     +--+ if(s == &quot;start&quot;){  | 
        |     |     |     |  +--+-----------------+ 
   432  |     |     |     |     +--- ScAction = sca_bind_atexec_arg_start;
        |     |     |     |   +-+---+ 
   433  |     |     |     |   |  }  | 
        |     |     |     |   +-+---+ 
        |     |     |     |   +-+---------------------+ 
   434  |     |     |     |   |  else if(s == &quot;end&quot;){ | 
        |     |     |     |   +-+---------------------+ 
   435  |     |     |     |     +--- ScAction = sca_bind_atexec_arg_end;
   436  |     |     |     |     +--- GetBindArgument(TokenList,sPos);
        |     |     |     |   +-+---+ 
   437  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |   +-+---+ 
   438  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |   +-+---+ 
   439  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-----------------------------------------+ 
   439  |     |   |  else if(s == &quot;list&quot;){  // Add 2016/02/26 | 
        |     |   +-+-----------------------------------------+ 
   440  |     |     +--- ScAction = sca_list;
        |     |   +-+---+ 
   441  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+---------------------------+ 
   441  |     |   |  else if(s == &quot;variabled&quot;){ | 
        |     |   +-+---------------------------+ 
   442  |     |     +--- ScAction = sca_variableD;
        |     |   +-+---+ 
   443  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-----------------------+ 
   443  |     |   |  else if(s == &quot;listd&quot;){ | 
        |     |   +-+-----------------------+ 
   444  |     |     +--- ScAction = sca_listD;
        |     |   +-+---+ 
   445  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-------------------------+ 
   445  |     |   |  else if(s == &quot;replace&quot;){ | 
        |     |   +-+-------------------------+ 
   446  |     |     +--- ScAction = sca_replace;
        |     |   +-+---+ 
   447  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-------------------------+ 
   447  |     |   |  else if(s == &quot;target&quot;){  | 
        |     |   +-+-------------------------+ 
   448  |     |     +--- ScAction = sca_target;
        |     |   +-+---+ 
   449  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+---------------------+ 
   449  |     |   |  else if(s == &quot;gwv&quot;){ | 
        |     |   +-+---------------------+ 
   450  |     |     +--- ScAction = sca_GWV;
        |     |   +-+---+ 
   451  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+---------------------------+ 
   451  |     |   |  else if(s == &quot;gwv-list&quot;){  | 
        |     |   +-+---------------------------+ 
   452  |     |     +--- ScAction = sca_GWV_list;
        |     |   +-+---+ 
   453  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-----------------------------+ 
   453  |     |   |  else if(s == &quot;gwv-target&quot;){  | 
        |     |   +-+-----------------------------+ 
   454  |     |     +--- ScAction = sca_GWV_target;
        |     |   +-+---+ 
   455  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-------+ 
   455  |     |   |  else{  | 
        |     |   +-+-------+ 
   456  |     |     +--- ScAction = sca_none;
   457  |     |     +--- i--; // Ë©ÉCÂΩì„Å™„Åó„ÅÆÂ†ÉGÂêà„ÅØ„ÄÅÔÉVë„Å§ÊàÉT„Åô„ÄÇ
        |     |   +-+---+ 
   458  |     |   |  }  | 
        |     |   +-----+ 
   459  |     +--- //
   460  |     |    //„ÄÄÂØÉZË±ÅBÂ§âÊï∞„ÉÉF„ÇÉP„Éà„Çí‰ΩúÊàê„Åô„Çã„ÄÇ () ÂÜÖ„ÅÆÂ†ÉGÂêà  
   461  |     |    //                                                                 
   462  |     +--- TScValData *ScValData;
        |     |  +------------------------------+ 
   463  |     +--+ if(i &gt;= TokStrList-&gt;Count){  | 
        |     |  +--+---------------------------+ 
        |     |     |  +----------+ 
   464  |     |     +--+ return;  | 
        |     |     |  +----------+ 
        |     |   +-+---+ 
   465  |     |   |  }  | 
        |     |   +-----+ 
   466  |     +--- s = TokStrList-&gt;Strings[i++];
        |     |  +----------------+ 
   467  |     +--+ if(s == &quot;(&quot;){  | 
        |     |  +--+-------------+ 
        |     |     |  +--------------------------------------+ 
   468  |     |     +--+ for(; i &lt; TokStrList-&gt;Count ; i++){  | 
        |     |     |  +--+-----------------------------------+ 
   469  |     |     |     +--- s = TokStrList-&gt;Strings[i];
        |     |     |     |  +----------------+ 
   470  |     |     |     +--+ if(s == &quot;)&quot;){  | 
        |     |     |     |  +--+-------------+ 
   471  |     |     |     |     +--- i++;
        |     |     |     |     |  +--------+ 
   472  |     |     |     |     +--+ break; | 
        |     |     |     |     |  +--------+ 
        |     |     |     |   +-+---+ 
   473  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
   474  |     |     |     +--- s = TokStrList-&gt;Strings[i];
        |     |     |     |  +----------------+ 
   475  |     |     |     +--+ if(s == &quot;,&quot;){  | 
        |     |     |     |  +--+-------------+ 
        |     |     |     |     |  +------------+ 
   476  |     |     |     |     +--+ continue;  | 
        |     |     |     |     |  +------------+ 
        |     |     |     |   +-+---+ 
   477  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
   478  |     |     |     +--- // Â§âÊï∞„ÇíËÉ\ÉXÂä†„Åô„Çã„ÄÇÔÉVàÂêåÂêç„ÅÆÂ§âÊï∞„Åå„ÅÇ„Çå„Å∞„ÄÅÂÖ±Êúâ„Åô„Çã)
   479  |     |     |     +--- ScValData = GetScValData(TokenList,s);
   480  |     |     |     +--- ScValData-&gt;RefCount++;
        |     |     |     |  +----------------------------+ 
   481  |     |     |     +--+ if(ScValDataList == NULL){ | 
        |     |     |     |  +--+-------------------------+ 
   482  |     |     |     |     +--- ScValDataList = new TList;
        |     |     |     |   +-+---+ 
   483  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
   484  |     |     |     +--- ScValDataList-&gt;Add((void *)ScValData);
        |     |     |   +-+---+ 
   485  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |   +-+---+ 
   486  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-------+ 
   486  |     |   |  else{  | 
        |     |   +-+-------+ 
   487  |     |     +--- i--;
        |     |   +-+---+ 
   488  |     |   |  }  | 
        |     |   +-----+ 
   489  |     +--- //
   490  |     |    // Â§âÊï∞„ÅÉáÂæå„ÅÆ region start , region end „Çí„ÉÅ„ÇÉ@„ÉÉ„ÇØ„Åó„Å¶ ScRegion„ÅÉH„ÇÉT„ÉÉ„Éà  
   491  |     |    // sub region start , sub region end „ÇÇÂÉbÉZË±ÅB„ÅÉB„ÅÉF„Çã„ÄÇ                              
   492  |     |    //                                                                                           
        |     |  +------------------------------+ 
   493  |     +--+ if(i &gt;= TokStrList-&gt;Count){  | 
        |     |  +--+---------------------------+ 
        |     |     |  +----------+ 
   494  |     |     +--+ return;  | 
        |     |     |  +----------+ 
        |     |   +-+---+ 
   495  |     |   |  }  | 
        |     |   +-----+ 
   496  |     +--- s = LowerCase(TokStrList-&gt;Strings[i++]);
        |     |  +--------------------+ 
   497  |     +--+ if(s == &quot;region&quot;){ | 
        |     |  +--+-----------------+ 
        |     |     |  +------------------------------+ 
   498  |     |     +--+ if(i &gt;= TokStrList-&gt;Count){  | 
        |     |     |  +--+---------------------------+ 
        |     |     |     |  +----------+ 
   499  |     |     |     +--+ return;  | 
        |     |     |     |  +----------+ 
        |     |     |   +-+---+ 
   500  |     |     |   |  }  | 
        |     |     |   +-----+ 
   501  |     |     +--- s = LowerCase(TokStrList-&gt;Strings[i++]);
        |     |     |  +--------------------+ 
   502  |     |     +--+ if(s == &quot;start&quot;){  | 
        |     |     |  +--+-----------------+ 
   503  |     |     |     +--- ScRegion = scr_start;
        |     |     |     |  +------------------------------------------------------------+ 
   504  |     |     |     +--+ if((ScType == sct_pre_BPset)||(ScType == sct_post_BPset)|| | 
   505  |     |     |     |  |     (ScType == sct_SplitPointCopyDef)){                    | 
        |     |     |     |  +--+---------------------------------------------------------+ 
   506  |     |     |     |     +--- ScRegion = scr_substart;
        |     |     |     |   +-+---+ 
   507  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |   +-+---+ 
   508  |     |     |   |  }  | 
        |     |     |   +-+---+ 
        |     |     |   +-+---------------------+ 
   508  |     |     |   |  else if(s == &quot;end&quot;){ | 
        |     |     |   +-+---------------------+ 
   509  |     |     |     +--- ScRegion = scr_end;
        |     |     |     |  +------------------------------------------------------------+ 
   510  |     |     |     +--+ if((ScType == sct_pre_BPset)||(ScType == sct_post_BPset)|| | 
   511  |     |     |     |  |     (ScType == sct_SplitPointCopyDef)){                    | 
        |     |     |     |  +--+---------------------------------------------------------+ 
   512  |     |     |     |     +--- ScRegion = scr_subend;
        |     |     |     |   +-+---+ 
   513  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |   +-+---+ 
   514  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |   +-+---+ 
   515  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+---------------------+ 
   515  |     |   |  else if(s == &quot;sub&quot;){ | 
        |     |   +-+---------------------+ 
   516  |     |     +--- s = LowerCase(TokStrList-&gt;Strings[i++]);
        |     |     |  +--------------------+ 
   517  |     |     +--+ if(s == &quot;region&quot;){ | 
        |     |     |  +--+-----------------+ 
        |     |     |     |  +------------------------------+ 
   518  |     |     |     +--+ if(i &gt;= TokStrList-&gt;Count){  | 
        |     |     |     |  +--+---------------------------+ 
        |     |     |     |     |  +----------+ 
   519  |     |     |     |     +--+ return;  | 
        |     |     |     |     |  +----------+ 
        |     |     |     |   +-+---+ 
   520  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
   521  |     |     |     +--- s = TokStrList-&gt;Strings[i++];
        |     |     |     |  +--------------------+ 
   522  |     |     |     +--+ if(s == &quot;start&quot;){  | 
        |     |     |     |  +--+-----------------+ 
   523  |     |     |     |     +--- ScRegion = scr_substart;
        |     |     |     |   +-+---+ 
   524  |     |     |     |   |  }  | 
        |     |     |     |   +-+---+ 
        |     |     |     |   +-+---------------------+ 
   524  |     |     |     |   |  else if(s == &quot;end&quot;){ | 
        |     |     |     |   +-+---------------------+ 
   525  |     |     |     |     +--- ScRegion = scr_subend;
        |     |     |     |   +-+---+ 
   526  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |   +-+---+ 
   527  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |   +-+---+ 
   528  |     |   |  }  | 
        |     |   +-----+ 
   529  |     |    
        |   +-+---+ 
   530  |   |  }  | 
        |   +-----+ 
   531  +--- /*----------------------------------------------------------------------------*/
   532  |    //                                                                                         
   533  |    //  1.ÊóÅEÊúÉÉË™ûÂêç                                                                       
   534  |    //                                                                                         
   535  |    //  2.„Éë„É©„ÉÅB„ÇÉ\Ë™ÉÉÊòé                                                                
   536  |    //    sPos    „Éà„Éº„ÇÉb„ÉÉE„ÉÉF„ÇÉP„ÉàÈñãÂßã‰ÉXçÁÉXÉá                                     
   537  |    //                                                                                         
   538  |    //  3.Ê¶ÇËÉíÅ                                                                              
   539  |    //    fitting Script„ÇíËÉ@ÅvÊûê„Åó„ÅÉíScript„Éá„Éº„ÇÉ\„ÅÉHÂÖÅE„Çå„Çã„ÄÇ                    
   540  |    //    SampledList-&gt;Count = 0 „ÅÉáÂ†ÉGÂêà„ÅØ„ÄÅ„Éá„Éï„Ç©„ÉÉH„Éà„ÅÆÂÄÅA„ÇíËÉBÉÖÂÆö„Åô„Çã„ÄÇ  
   541  |    //                                                                                         
   542  |    //  4.Ê©üËÉΩË™ÉÉÊòé                                                                        
   543  |    //                                                                                         
   544  |    //  5.ÊàÉT„ÇäÂÄÅA                                                                          
   545  |    //                                                                                         
   546  |    //  6.ÂÇôËÄÉ                                                                               
   547  |    //                                                                                         
   548  |    /*----------------------------------------------------------------------------*/           
        |  +------------------------------------------+ 
   549  +--+ void TScript::GetFittingParam(int sPos)  | 
   550  |  | {                                        | 
        |  +--+---------------------------------------+ 
   551  |     +--- int i = sPos;
   552  |     +--- string s;
   553  |     +--- int sIdx,eIdx,mIdx;
   554  |     |    
   555  |     +--- FittingType = 0;
   556  |     +--- SampledList = new TList;
   557  |     +--- //d-splineÁîÉBËøÉXÂä†ÈÉÉBÂàÜ
   558  |     +--- FittingDspline = 0;
   559  |     +--- FittingDynamic = 0;
   560  |     +--- //d-splineÁîÉBËøÉXÂä†ÈÉÉBÂàÜ„ÄÄ„Åì„Åì„ÅÉZ„ÅÉ@
   561  |     +--- s = LowerCase(TokStrList-&gt;Strings[i++]);
        |     |  +----------------------------+ 
   562  |     +--+ if(s == &quot;least-squares&quot;){  | 
        |     |  +--+-------------------------+ 
   563  |     |     +--- FittingType = 1;
        |     |   +-+---+ 
   564  |     |   |  }  | 
        |     |   +-----+ 
   565  |     +--- //d-splineÁîÉBËøÉXÂä†ÈÉÉBÂàÜ
   566  |     |                                 
   567  |     +--- /***********************************************************/
   568  |     |    //                                                                                           
   569  |     |    //Kogakuin Irie                                                                              
   570  |     |    //pragmaÊåáÁÅAÉRÊñá„ÅÆÂ§âÊõ¥Ôºå„Åä„Çà„Å≥2Ê¨ÅBÂÖÉ„Å∏„ÅÉáÂØÉZÂøú                               
   571  |     |    //ÂÆüËÅBåÊôÇ„ÅÉB„Åù„ÅÆ‰ªñ„Å´„Çà„Çãd-Spline„ÅÉáÂåÉRÂàÅE„ÅÉbÔºå                                
   572  |     |    //region start Êñá„Å´Ë®òËÉ\Å[„Åó„Åü„ÉÅ„É•„ÉÉV„Éã„É≥„ÇÅ[„ÇÉ\„ÇÅA„Éü„É≥„ÇÅ[„ÅÉH„Çà„ÇäÂàÅAÊñÉÖ  
   573  |     |    //                                                                                           
   574  |     |    //ÊóÅuÂ≠ò„Ç≥„ÉÉV„Éâ„ÅØ„ÇÉE„ÉÅB„ÉÉE„Éà„Ç¢„ÇÉí„Éà                                              
   575  |     |    //                                                                                           
   576  |     |    //if(                                                                                        
   577  |     +--- //  //s = LowerCase(TokStrList-&gt;Strings[i++]);
   578  |     |    //  else if(s == &quot;dspline&quot;){                             
   579  |     |    //      FittingDspline = 1;                              
   580  |     |    //      printf(&quot;fittingdspline ON%d\n&quot;,FittingDspline);  
   581  |     |    //      goto DSP1;                                       
   582  |     |    //  }                                                    
   583  |     |    //                                                       
   584  |     |    //  else if(s == &quot;dynamicdspline&quot;){                      
   585  |     |    //      FittingDynamic = 1;                              
   586  |     |    //      printf(&quot;fittingdynamic ON%d\n&quot;,FittingDynamic);  
   587  |     |    //      goto DSP1;                                       
   588  |     |    //  }                                                    
   589  |     +--- //s = LowerCase(TokStrList-&gt;Strings[i++]);
        |     |   +-+-------------------------+ 
   590  |     |   |  else if(s == &quot;dspline&quot;){ | 
        |     |   +-+-------------------------+ 
   591  |     |     +--- FittingDspline = 1;
   592  |     |     +--- printf(&quot;fittingdspline ON%d\n&quot;,FittingDspline);
        |     |     |  +------------+ 
   593  |     |     +--+ goto DSP1; | 
        |     |     |  +------------+ 
        |     |   +-+---+ 
   594  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+---------------------------+ 
   595  |     |   |  else if(s == &quot;dspline2&quot;){  | 
        |     |   +-+---------------------------+ 
   596  |     |     +--- FittingDspline = 2;
   597  |     |     +--- printf(&quot;fittingdspline2 ON%d\n&quot;,FittingDspline);
        |     |     |  +------------+ 
   598  |     |     +--+ goto DSP1; | 
        |     |     |  +------------+ 
        |     |   +-+---+ 
   599  |     |   |  }  | 
        |     |   +-----+ 
   600  |     +--- //
   601  |     |    //„Åì„Åì„ÅÉZ„ÅÉ@                                               
   602  |     |    //                                                             
   603  |     |    /***********************************************************/  
   604  |     +--- //d-splineÁîÉBËøÉXÂä†ÈÉÉBÂàÜ„ÄÄ„Åì„Åì„ÅÉZ„ÅÉ@
        |     |  +----------------------------+ 
   605  |     +--+ if(i &lt; TokStrList-&gt;Count){ | 
        |     |  +--+-------------------------+ 
   606  |     |     +--- s = LowerCase(TokStrList-&gt;Strings[i++]);
        |     |   +-+---+ 
   607  |     |   |  }  | 
        |     |   +-----+ 
   608  |     +--- FittingDegree = atoi(s.c_str());        // Â§öÈ†ÖÂÉVè„ÅÆÊ¨ÅBÊïÅ[
        |     |  +----------------------------+ 
   609  |     +--+ if(i &lt; TokStrList-&gt;Count){ | 
        |     |  +--+-------------------------+ 
   610  |     |     +--- s = LowerCase(TokStrList-&gt;Strings[i++]);
        |     |   +-+---+ 
   611  |     |   |  }  | 
        |     |   +-----+ 
        |     |  +----------------------+ 
   612  |     +--+ if(s == &quot;sampled&quot;){  | 
        |     |  +--+-------------------+ 
        |     |     |  +------------------------------------+ 
   613  |     |     +--+ for(;i &lt;= TokStrList-&gt;Count;i++){  | 
        |     |     |  +--+---------------------------------+ 
   614  |     |     |     +--- s = TokStrList-&gt;Strings[i];
   615  |     |     |     +--- s = Trim(s);
        |     |     |     |  +------------------------------+ 
   616  |     |     |     +--+ if((s == &quot;(&quot;)||(s == &quot;,&quot;)){  | 
        |     |     |     |  +--+---------------------------+ 
        |     |     |     |     |  +------------+ 
   617  |     |     |     |     +--+ continue;  | 
        |     |     |     |     |  +------------+ 
        |     |     |     |   +-+---+ 
   618  |     |     |     |   |  }  | 
        |     |     |     |   +-+---+ 
        |     |     |     |   +-+-------------------+ 
   618  |     |     |     |   |  else if(s == &quot;)&quot;){ | 
        |     |     |     |   +-+-------------------+ 
        |     |     |     |     |  +--------+ 
   619  |     |     |     |     +--+ break; | 
        |     |     |     |     |  +--------+ 
        |     |     |     |   +-+---+ 
   620  |     |     |     |   |  }  | 
        |     |     |     |   +-+---+ 
        |     |     |     |   +-+-------+ 
   620  |     |     |     |   |  else{  | 
        |     |     |     |   +-+-------+ 
   621  |     |     |     |     +--- mIdx = s.find(&quot;-&quot;);
        |     |     |     |     |  +----------------+ 
   622  |     |     |     |     +--+ if(mIdx &gt;= 0){ | 
        |     |     |     |     |  +--+-------------+ 
        |     |     |     |     |     |  +----------------+ 
   623  |     |     |     |     |     +--+ if(mIdx == 0){ | 
        |     |     |     |     |     |  +--+-------------+ 
   624  |     |     |     |     |     |     +--- sIdx = 1;
        |     |     |     |     |     |   +-+---+ 
   625  |     |     |     |     |     |   |  }  | 
        |     |     |     |     |     |   +-+---+ 
        |     |     |     |     |     |   +-+-------+ 
   625  |     |     |     |     |     |   |  else{  | 
        |     |     |     |     |     |   +-+-------+ 
   626  |     |     |     |     |     |     +--- sIdx = atoi(s.c_str());
   627  |     |     |     |     |     |     +--- s = s.substr(mIdx+1,s.length());
        |     |     |     |     |     |   +-+---+ 
   628  |     |     |     |     |     |   |  }  | 
        |     |     |     |     |     |   +-----+ 
   629  |     |     |     |     |     +--- eIdx = atoi(s.c_str());
        |     |     |     |     |   +-+---+ 
   630  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-+---+ 
        |     |     |     |     |   +-+-------+ 
   630  |     |     |     |     |   |  else{  | 
        |     |     |     |     |   +-+-------+ 
   631  |     |     |     |     |     +--- sIdx = eIdx = atoi(s.c_str());
        |     |     |     |     |   +-+---+ 
   632  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |     |  +--------------------------------------+ 
   633  |     |     |     |     +--+ for(int i = sIdx ; i &lt;= eIdx ; i++){ | 
        |     |     |     |     |  +--+-----------------------------------+ 
        |     |     |     |     |     |  +--------------------------------------------------+ 
   634  |     |     |     |     |     +--+ if(SampledList-&gt;IndexOf((void *)(long)i) == -1){ | 
        |     |     |     |     |     |  +--+-----------------------------------------------+ 
   635  |     |     |     |     |     |     +--- SampledList-&gt;Add((void *)(long)i);
        |     |     |     |     |     |   +-+---+ 
   636  |     |     |     |     |     |   |  }  | 
        |     |     |     |     |     |   +-----+ 
        |     |     |     |     |   +-+---+ 
   637  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |   +-+---+ 
   638  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |   +-+---+ 
   639  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |   +-+---+ 
   640  |     |   |  }  | 
        |     |   +-----+ 
        |     +---------+ 
   641  |     |  DSP1:  | 
        |     +---------+ 
   641  |     +--- ;//d-splineÁîÉBËøÉXÂä†ÈÉÉBÂàÜ
        |   +-+---+ 
   642  |   |  }  | 
        |   +-----+ 
   643  +--- /*----------------------------------------------------------------------------*/
   644  |    //                                                                                                                     
   645  |    //  1.ÊóÅEÊúÉÉË™ûÂêç                                                                                                   
   646  |    //                                                                                                                     
   647  |    //  2.„Éë„É©„ÉÅB„ÇÉ\Ë™ÉÉÊòé                                                                                            
   648  |    //    TokenList   „Éà„Éº„ÇÉb„ÉÉE„ÉÉF„ÇÉP„Éà                                                                            
   649  |    //    ValName „ÇÉP„ÇÉb„ÉÉF„Éó„ÉàÂ§âÊï∞Âêç                                                                              
   650  |    //                                                                                                                     
   651  |    //  3.Ê¶ÇËÉíÅ                                                                                                          
   652  |    //    ValName„ÅÉBÂêå„ÅòÂêçÂâç„ÅÉá„ÇÉP„ÇÉb„ÉÉF„Éó„ÉàÂ§âÊï∞„ÇíÊé¢„Åó„Å¶„ÄÅ„Å™„Åë„Çå„ÅÅ[„ÄÅÊñ∞Ë¶è„Å´‰ΩúÊàê„Åô„Çã„ÄÇ       
   653  |    //    Ê§úÁÉGÅu„ÅÉb„ÄÅTokList„ÅÉáScript„ÇíÈ†ÜÁï™„ÅÉHÊ§úÁÉGÅu„Åô„Çã„ÄÇ                                                   
   654  |    //                                                                                                                     
   655  |    //  4.Ê©üËÉΩË™ÉÉÊòé                                                                                                    
   656  |    //                                                                                                                     
   657  |    //  5.ÊàÉT„ÇäÂÄÅA                                                                                                      
   658  |    //    ValName„ÅÉBÂêå„ÅòÂêçÂâç„ÅÉá„ÇÉP„ÇÉb„ÉÉF„Éó„ÉàÂ§âÊï∞„ÅÉáscValData„ÇíËÉ\î„Åô„ÄÇ„Å™„Åë„Çå„ÅÅ[„ÄÅÊñ∞Ë¶è„Å´‰ΩúÊàê„Åó  
   659  |    //    „ÅÉí„Åù„ÅÆscValkData„ÇíËÉ\î„Åô„ÄÇ                                                                                
   660  |    //                                                                                                                     
   661  |    //  6.ÂÇôËÄÉ                                                                                                           
   662  |    //                                                                                                                     
   663  |    /*----------------------------------------------------------------------------*/                                       
        |  +------------------------------------------------------------+ 
   664  +--+ TScValData *GetScValData(TList *TokenList,string ValName)  | 
   665  |  | {                                                          | 
        |  +--+---------------------------------------------------------+ 
   666  |     +--- int i,j;
   667  |     +--- TToken *Token;
   668  |     +--- TScValData *ScValData;
   669  |     +--- TScript *Script;
   670  |     +--- int cp;
   671  |     |    
   672  |     +--- // &quot;&quot;„ÅÉ@ÂõÉC„ÅÉZ„Çå„Å¶ÂëÉV„ÅÅ[„Çå„ÅüÂ†ÉGÂêà„ÅØ&quot;&quot;„ÇíÂÅAâÊï∞Âêç„Åã„ÇâÂâäÈôÅA„Åô„Çã„ÄÇ
   673  |     +--- cp = ValName.find(&quot;\&quot;&quot;);
        |     |  +--------------+ 
   674  |     +--+ if(cp &gt;= 0){ | 
        |     |  +--+-----------+ 
   675  |     |     +--- ValName.erase(cp,1);
        |     |   +-+---+ 
   676  |     |   |  }  | 
        |     |   +-----+ 
   677  |     +--- cp = ValName.find(&quot;\&quot;&quot;);
        |     |  +--------------+ 
   678  |     +--+ if(cp &gt;= 0){ | 
        |     |  +--+-----------+ 
   679  |     |     +--- ValName.erase(cp,1);
        |     |   +-+---+ 
   680  |     |   |  }  | 
        |     |   +-----+ 
        |     |  +------------------------------------------+ 
   681  |     +--+ for(i = 0 ;i &lt; TokenList-&gt;Count ; i++){  | 
        |     |  +--+---------------------------------------+ 
   682  |     |     +--- Token = (TToken *)TokenList-&gt;Items[i];
        |     |     |  +----------------------------+ 
   683  |     |     +--+ if(Token-&gt;Script == NULL){ | 
        |     |     |  +--+-------------------------+ 
        |     |     |     |  +------------+ 
   684  |     |     |     +--+ continue;  | 
        |     |     |     |  +------------+ 
        |     |     |   +-+---+ 
   685  |     |     |   |  }  | 
        |     |     |   +-----+ 
   686  |     |     +--- Script = (TScript *)Token-&gt;Script;
        |     |     |  +------------------------------------+ 
   687  |     |     +--+ if(Script-&gt;ScValDataList == NULL){ | 
        |     |     |  +--+---------------------------------+ 
        |     |     |     |  +------------+ 
   688  |     |     |     +--+ continue;  | 
        |     |     |     |  +------------+ 
        |     |     |   +-+---+ 
   689  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +------------------------------------------------------+ 
   690  |     |     +--+ for(j = 0 ; j &lt; Script-&gt;ScValDataList-&gt;Count ; j++){ | 
        |     |     |  +--+---------------------------------------------------+ 
   691  |     |     |     +--- ScValData = (TScValData *)Script-&gt;ScValDataList-&gt;Items[j];
        |     |     |     |  +--------------------------------+ 
   692  |     |     |     +--+ if(ScValData-&gt;Str == ValName){ | 
        |     |     |     |  +--+-----------------------------+ 
        |     |     |     |     |  +--------------------+ 
   693  |     |     |     |     +--+ return ScValData;  | 
        |     |     |     |     |  +--------------------+ 
        |     |     |     |   +-+---+ 
   694  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |   +-+---+ 
   695  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |   +-+---+ 
   696  |     |   |  }  | 
        |     |   +-----+ 
   697  |     +--- ScValData = new TScValData(ValName);
        |     |  +--------------------+ 
   698  |     +--+ return ScValData;  | 
        |     |  +--------------------+ 
        |   +-+---+ 
   699  |   |  }  | 
        |   +-----+ 
   700  +--- /*----------------------------------------------------------------------------*/
   701  |    //                                                                                                                                         
   702  |    //  1.ÊóÅEÊúÉÉË™ûÂêç                                                                                                                       
   703  |    //                                                                                                                                         
   704  |    //  2.„Éë„É©„ÉÅB„ÇÉ\Ë™ÉÉÊòé                                                                                                                
   705  |    //    DefineF Â§âÊï∞ÂÆöÁÉZÉDÂÖÅE„Çä„ÅÆÂºïÊï∞„ÇíËÉ\î„Åô„Åã„ÄÅÂÅAâÊï∞Âêç„ÅÆ„ÅÉ\„ÇíËÉ\î„Åô„Åã„ÇíÊåáÂÉáö„Åô„Çã„ÄÇ                              
   706  |    //    ValName1 ÂêçÂâç„Åå‰ÉNÄËáÉG„Åó„ÅüÂ†ÉGÂêà„Å´ÁΩÉá„ÅçÊèõ„Åà„ÇãÂ§âÊï∞                                                                     
   707  |    //    ValName2 ÁΩÉá„ÅçÊèõ„Åà„ÇãÊñÅ[„Åó„ÅÑÂ§âÊï∞Âêç                                                                                         
   708  |    //    SkipArgCount „Åô„Åß„ÅÉHË®ÉÖÂÆöÊÉNà„Å®„Åó„Å¶„ÇÉP„ÇÉÖ„ÉÉ„Éó„Åô„ÇãÂºïÊï∞„ÅÉáÂÄãÊï∞                                                      
   709  |    //                                                                                                                                         
   710  |    //  3.Ê¶ÇËÉíÅ                                                                                                                              
   711  |    //    ATExec()„ÅÉá„ÇÉP„ÇÉb„ÉÉF„Éó„Éà„ÅÉáÂºïÊï∞„ÇíËÉ\î„Åô„ÄÇÂÉáöÁÉZÉDÂÖÅE„Çä„ÅÆÂ†ÉGÂêà„ÅØÂÖàÈ†ÉÖ„ÅÉáÔºíÂÉVïÊï∞„ÅÉbÂØÉZË±ÅBÂ§ñ„Å®„Åô„Çã„ÄÇ   
   712  |    //                                                                                                                                         
   713  |    //  4.Ê©üËÉΩË™ÉÉÊòé                                                                                                                        
   714  |    //                                                                                                                                         
   715  |    //  5.ÊàÉT„ÇäÂÄÅA                                                                                                                          
   716  |    //    ATExec()„ÅÉáÂºïÊï∞„ÅÉáÊñáÂÉÖóÂàó„ÇíËÉ\î„Åô„ÄÇ                                                                                        
   717  |    //                                                                                                                                         
   718  |    //  6.ÂÇôËÄÉ                                                                                                                               
   719  |    //                                                                                                                                         
   720  |    /*----------------------------------------------------------------------------*/                                                           
        |  +------------------------------------------------------------------------------------------------+ 
   721  +--+ string TScript::GetATExecArgStr(bool DefineF,string ValName1,string ValName2,int SkipArgCount) | 
   722  |  | {                                                                                              | 
        |  +--+---------------------------------------------------------------------------------------------+ 
   723  |     +--- TToken *Token;
   724  |     +--- TToken *Token2;
   725  |     +--- string rStr = &quot;&quot;;
   726  |     +--- string s;
   727  |     +--- int i,j,k;
   728  |     +--- int ArgCount = 0;
   729  |     +--- TValData *ValData;
   730  |     +--- TStringList *ATExec_ArgValList;
   731  |     +--- string ValName;
   732  |     |    
        |     |  +--------------------------------------------+ 
   733  |     +--+ for(i = 0 ; i &lt; TokStrList-&gt;Count ; i++){  | 
        |     |  +--+-----------------------------------------+ 
   734  |     |     +--- Token = (TToken *)TokStrList-&gt;Objects[i];
        |     |     |  +--------------------+ 
   735  |     |     +--+ if(Token == NULL){ | 
        |     |     |  +--+-----------------+ 
        |     |     |     |  +------------+ 
   736  |     |     |     +--+ continue;  | 
        |     |     |     |  +------------+ 
        |     |     |   +-+---+ 
   737  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +----------------------------------+ 
   738  |     |     +--+ if(Token-&gt;TokId == tid_Kannma){  | 
        |     |     |  +--+-------------------------------+ 
   739  |     |     |     +--- ArgCount++;
        |     |     |   +-+---+ 
   740  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +--------------------+ 
   741  |     |     +--+ if(ArgCount &lt; 2){  | 
        |     |     |  +--+-----------------+ 
        |     |     |     |  +------------+ 
   742  |     |     |     +--+ continue;  | 
        |     |     |     |  +------------+ 
        |     |     |   +-+---+ 
   743  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +--------------------------------+ 
   744  |     |     +--+ if(Token-&gt;TokId == tid_Kakko){ | 
        |     |     |  +--+-----------------------------+ 
        |     |     |     |  +------------+ 
   745  |     |     |     +--+ continue;  | 
        |     |     |     |  +------------+ 
        |     |     |   +-+---+ 
   746  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +--------------------------------+ 
   747  |     |     +--+ if(Token-&gt;TokId == tid_Kokka){ | 
        |     |     |  +--+-----------------------------+ 
        |     |     |     |  +------------+ 
   748  |     |     |     +--+ continue;  | 
        |     |     |     |  +------------+ 
        |     |     |   +-+---+ 
   749  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +------------------------------+ 
   750  |     |     +--+ if(Token-&gt;ValData == NULL){  | 
        |     |     |  +--+---------------------------+ 
        |     |     |     |  +--------------+ 
   751  |     |     |     +--+ if(DefineF){ | 
        |     |     |     |  +--+-----------+ 
   752  |     |     |     |     +--- rStr += Token-&gt;OrgStr;
        |     |     |     |   +-+---+ 
   753  |     |     |     |   |  }  | 
        |     |     |     |   +-+---+ 
        |     |     |     |   +-+-------+ 
   753  |     |     |     |   |  else{  | 
        |     |     |     |   +-+-------+ 
   754  |     |     |     |     +--- rStr += Trim(Token-&gt;OrgStr);
        |     |     |     |   +-+---+ 
   755  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |   +-+---+ 
   756  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +------------------------------------------------------+ 
   757  |     |     +--+ if(DefineF &amp;&amp; (MainF-&gt;SrcCodeType != MainF-&gt;sctC)){  | 
        |     |     |  +--+---------------------------------------------------+ 
   758  |     |     |     +--- //
   759  |     |     |     |    //  Fortran„ÅÉ@„ÅÉáÂÆöÁÉZÉDÔºàÔÉVëËÅBå„Åî„ÅÉBÔºâ                   
   760  |     |     |     |    //                                                                 
   761  |     |     |     |    // ÂÆöÁÉZÉDÂÖÅE„Çä„ÅÆÊñáÂÉÖóÂàó„ÇíËÉBÉÖÂÆö„Åô„Çã„ÄÇ                
   762  |     |     |     |    // **„ÅÉáÂáÉíÁêÜ„Å® Token-&gt;OrgStr„ÅÉá„ÇÉ\„Éñ„ÅØÂÆöÁÉZÉD„ÅÉáÂâç„Å∏  
   763  |     |     |     +--- ValData = (TValData *)Token-&gt;ValData;
   764  |     |     |     +--- s = Token-&gt;OrgStr;
        |     |     |     |  +----------------------------------------------+ 
   765  |     |     |     +--+ for(int j = 0 ; j &lt; (int)s.length() ; j++){  | 
        |     |     |     |  +--+-------------------------------------------+ 
        |     |     |     |     |  +------------------+ 
   766  |     |     |     |     +--+ if(s[j] &lt;= ' '){ | 
        |     |     |     |     |  +--+---------------+ 
   767  |     |     |     |     |     +--- rStr += s[j];
        |     |     |     |     |   +-+---+ 
   768  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-+---+ 
        |     |     |     |     |   +-+-------+ 
   768  |     |     |     |     |   |  else{  | 
        |     |     |     |     |   +-+-------+ 
        |     |     |     |     |     |  +--------+ 
   769  |     |     |     |     |     +--+ break; | 
        |     |     |     |     |     |  +--------+ 
        |     |     |     |     |   +-+---+ 
   770  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |   +-+---+ 
   771  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
   772  |     |     |     +--- rStr += &quot;      &quot;+Trim(ValData-&gt;DefStr1 + ValData-&gt;DefStr2); // ‰∏Éí„ÅÉE„ÅÉáÂÆÅvË®Ä„ÅÉF„ÅÉá„ÅÉ@„ÇÉ\„Éñ„ÅØ„ÅÉF„Åó„ÄÇ
        |     |     |     |  +--------------------------------------------------------------------+ 
   773  |     |     |     +--+ for(k = ValData-&gt;ArrayDefPosS ; k &lt; ValData-&gt;ArrayDefPosE ; k++){  | 
        |     |     |     |  +--+-----------------------------------------------------------------+ 
   774  |     |     |     |     +--- Token2 = (TToken *)MainF-&gt;TokenList-&gt;Items[k];
   775  |     |     |     |     +--- rStr += Token2-&gt;OrgStr;
        |     |     |     |   +-+---+ 
   776  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
   777  |     |     |     +--- rStr += &quot;\n&quot;;
   778  |     |     |     |    
        |     |     |   +-+---+ 
   779  |     |     |   |  }  | 
        |     |     |   +-+---+ 
        |     |     |   +-+-------------------+ 
   779  |     |     |   |  else if(DefineF){  | 
        |     |     |   +-+-------------------+ 
   780  |     |     |     +--- // ÂÆöÁÉZÉDÂÖÅE„Çä„ÅÆÊñáÂÉÖóÂàó„ÇíËÉBÉÖÂÆö„Åô„Çã„ÄÇ
   781  |     |     |     |    // **„ÅÉáÂáÉíÁêÜ„Å® Token-&gt;OrgStr„ÅÉá„ÇÉ\„Éñ„ÅØÂÆöÁÉZÉD„ÅÉáÂâç„Å∏  
   782  |     |     |     +--- ValData = (TValData *)Token-&gt;ValData;
   783  |     |     |     +--- s = Token-&gt;OrgStr;
        |     |     |     |  +----------------------------------------------+ 
   784  |     |     |     +--+ for(int j = 0 ; j &lt; (int)s.length() ; j++){  | 
        |     |     |     |  +--+-------------------------------------------+ 
        |     |     |     |     |  +------------------+ 
   785  |     |     |     |     +--+ if(s[j] &lt;= ' '){ | 
        |     |     |     |     |  +--+---------------+ 
   786  |     |     |     |     |     +--- rStr += s[j];
        |     |     |     |     |   +-+---+ 
   787  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-+---+ 
        |     |     |     |     |   +-+-------+ 
   787  |     |     |     |     |   |  else{  | 
        |     |     |     |     |   +-+-------+ 
        |     |     |     |     |     |  +--------+ 
   788  |     |     |     |     |     +--+ break; | 
        |     |     |     |     |     |  +--------+ 
        |     |     |     |     |   +-+---+ 
   789  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |   +-+---+ 
   790  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
   791  |     |     |     +--- rStr += Trim(ValData-&gt;DefStr1 + ValData-&gt;DefStr2); // ‰∏Éí„ÅÉE„ÅÉáÂÆÅvË®Ä„ÅÉF„ÅÉá„ÅÉ@„ÇÉ\„Éñ„ÅØ„ÅÉF„Åó„ÄÇ
        |     |     |     |  +------------------------------------+ 
   792  |     |     |     +--+ if(rStr[rStr.length()-1] == '*'){  | 
        |     |     |     |  +--+---------------------------------+ 
   793  |     |     |     |     +--- rStr += Token-&gt;Str;
        |     |     |     |   +-+---+ 
   794  |     |     |     |   |  }  | 
        |     |     |     |   +-+---+ 
        |     |     |     |   +-+-------+ 
   794  |     |     |     |   |  else{  | 
        |     |     |     |   +-+-------+ 
   795  |     |     |     |     +--- rStr += &quot; &quot;+Token-&gt;Str;
        |     |     |     |   +-+---+ 
   796  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |     |  +--------------------------------------------------------------------+ 
   797  |     |     |     +--+ for(k = ValData-&gt;ArrayDefPosS ; k &lt; ValData-&gt;ArrayDefPosE ; k++){  | 
        |     |     |     |  +--+-----------------------------------------------------------------+ 
   798  |     |     |     |     +--- Token2 = (TToken *)MainF-&gt;TokenList-&gt;Items[k];
   799  |     |     |     |     +--- rStr += Token2-&gt;OrgStr;
        |     |     |     |   +-+---+ 
   800  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |   +-+---+ 
   801  |     |     |   |  }  | 
        |     |     |   +-+---+ 
        |     |     |   +-+-------+ 
   801  |     |     |   |  else{  | 
        |     |     |   +-+-------+ 
        |     |     |     |  +------------------------------+ 
   802  |     |     |     +--+ if(Token-&gt;Str == ValName1){  | 
        |     |     |     |  +--+---------------------------+ 
   803  |     |     |     |     +--- rStr += Trim(ValName2); // ÂÆöÁÉZÉD„ÅÉ@„ÅÉF„ÅÑÂ†ÉGÂêà„ÅØÁ©ÉRÁôÉX„ÇíËÉDÅ[„ÇÅ„Çã„ÄÇ
        |     |     |     |   +-+---+ 
   804  |     |     |     |   |  }  | 
        |     |     |     |   +-+---+ 
        |     |     |     |   +-+-------+ 
   804  |     |     |     |   |  else{  | 
        |     |     |     |   +-+-------+ 
   805  |     |     |     |     +--- rStr += Trim(Token-&gt;Str); // ÂÆöÁÉZÉD„ÅÉ@„ÅÉF„ÅÑÂ†ÉGÂêà„ÅØÁ©ÉRÁôÉX„ÇíËÉDÅ[„ÇÅ„Çã„ÄÇ
        |     |     |     |   +-+---+ 
   806  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |   +-+---+ 
   807  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |   +-+---+ 
   808  |     |   |  }  | 
        |     |   +-----+ 
   809  |     +--- //
   810  |     |    //  ËáÉFÂãïËÉ\ÉXÂä†„Åï„Çå„ÅüÂÅAâÊï∞„Åå„ÅÇ„Çå„Å∞ËøÉXÂä†„Åô„Çã„ÄÇ  
   811  |     |    //                                                               
   812  |     +--- ATExec_ArgValList = MainF-&gt;Call_ATExec_ArgList;
   813  |     +--- //  for(j = 0 ; j &lt; ATExec_ArgValList-&gt;Count ; j++){
        |     |  +--------------------------------------------------------------+ 
   814  |     +--+ for(j = SkipArgCount ; j &lt; ATExec_ArgValList-&gt;Count ; j++){  | 
        |     |  +--+-----------------------------------------------------------+ 
   815  |     |     +--- ValName = ATExec_ArgValList-&gt;Strings[j];
        |     |     |  +--------------------------------------------+ 
   816  |     |     +--+ for(i = 0 ; i &lt; TokStrList-&gt;Count ; i++){  | 
        |     |     |  +--+-----------------------------------------+ 
   817  |     |     |     +--- Token = (TToken *)TokStrList-&gt;Objects[i];
        |     |     |     |  +--------------------+ 
   818  |     |     |     +--+ if(Token == NULL){ | 
        |     |     |     |  +--+-----------------+ 
        |     |     |     |     |  +------------+ 
   819  |     |     |     |     +--+ continue;  | 
        |     |     |     |     |  +------------+ 
        |     |     |     |   +-+---+ 
   820  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |     |  +------------------------------+ 
   821  |     |     |     +--+ if(Token-&gt;ValData != NULL){  | 
        |     |     |     |  +--+---------------------------+ 
   822  |     |     |     |     +--- ValData = (TValData *)Token-&gt;ValData;
        |     |     |     |     |  +------------------------------+ 
   823  |     |     |     |     +--+ if(ValName == ValData-&gt;Str){ | 
        |     |     |     |     |  +--+---------------------------+ 
        |     |     |     |     |     |  +--------+ 
   824  |     |     |     |     |     +--+ break; | 
        |     |     |     |     |     |  +--------+ 
        |     |     |     |     |   +-+---+ 
   825  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |   +-+---+ 
   826  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |   +-+---+ 
   827  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +------------------------------+ 
   828  |     |     +--+ if(i == TokStrList-&gt;Count){  | 
        |     |     |  +--+---------------------------+ 
   829  |     |     |     +--- ValData = (TValData *)ATExec_ArgValList-&gt;Objects[j];
        |     |     |     |  +------------------------------------------------------+ 
   830  |     |     |     +--+ if(DefineF &amp;&amp; (MainF-&gt;SrcCodeType != MainF-&gt;sctC)){  | 
        |     |     |     |  +--+---------------------------------------------------+ 
   831  |     |     |     |     +--- rStr += ValData-&gt;GetDefStr_Fortran()+&quot; &quot;+ValData-&gt;Str;
        |     |     |     |     |  +--------------------------------------------------------------------+ 
   832  |     |     |     |     +--+ for(k = ValData-&gt;ArrayDefPosS ; k &lt; ValData-&gt;ArrayDefPosE ; k++){  | 
        |     |     |     |     |  +--+-----------------------------------------------------------------+ 
   833  |     |     |     |     |     +--- Token2 = (TToken *)MainF-&gt;TokenList-&gt;Items[k];
   834  |     |     |     |     |     +--- rStr += Token2-&gt;OrgStr;
        |     |     |     |     |   +-+---+ 
   835  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
   836  |     |     |     |     +--- rStr += &quot;\n&quot;;
        |     |     |     |   +-+---+ 
   837  |     |     |     |   |  }  | 
        |     |     |     |   +-+---+ 
        |     |     |     |   +-+-------------------+ 
   837  |     |     |     |   |  else if(DefineF){  | 
        |     |     |     |   +-+-------------------+ 
   838  |     |     |     |     +--- rStr += &quot;,&quot;+ValData-&gt;GetDefStr_C()+ValData-&gt;Str;
        |     |     |     |     |  +--------------------------------------------------------------------+ 
   839  |     |     |     |     +--+ for(k = ValData-&gt;ArrayDefPosS ; k &lt; ValData-&gt;ArrayDefPosE ; k++){  | 
        |     |     |     |     |  +--+-----------------------------------------------------------------+ 
   840  |     |     |     |     |     +--- Token2 = (TToken *)MainF-&gt;TokenList-&gt;Items[k];
   841  |     |     |     |     |     +--- rStr += Token2-&gt;OrgStr;
        |     |     |     |     |   +-+---+ 
   842  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |   +-+---+ 
   843  |     |     |     |   |  }  | 
        |     |     |     |   +-+---+ 
        |     |     |     |   +-+-------+ 
   843  |     |     |     |   |  else{  | 
        |     |     |     |   +-+-------+ 
   844  |     |     |     |     +--- s = ValData-&gt;GetDefStr_C(); // ÂÆöÁÉZÉDÈÉÉBÂàÜ„ÅÆÊîÉPË°å„Å®„ÇÉP„Éö„Éº„ÇÉP„ÇíÁÉJôÊâø„Åô„Çã„ÄÇ
        |     |     |     |     |  +--------------------------------------------+ 
   845  |     |     |     |     +--+ for(int k = 0 ; k &lt; (int)s.length(); k++){ | 
        |     |     |     |     |  +--+-----------------------------------------+ 
        |     |     |     |     |     |  +------------------+ 
   846  |     |     |     |     |     +--+ if(s[k] &gt; ' '){  | 
        |     |     |     |     |     |  +--+---------------+ 
   847  |     |     |     |     |     |     +--- s.erase(k,s.length());
        |     |     |     |     |     |     |  +--------+ 
   848  |     |     |     |     |     |     +--+ break; | 
        |     |     |     |     |     |     |  +--------+ 
        |     |     |     |     |     |   +-+---+ 
   849  |     |     |     |     |     |   |  }  | 
        |     |     |     |     |     |   +-----+ 
        |     |     |     |     |   +-+---+ 
   850  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
   851  |     |     |     |     +--- rStr += &quot;,&quot;+s+ValData-&gt;Str;
        |     |     |     |   +-+---+ 
   852  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |   +-+---+ 
   853  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |   +-+---+ 
   854  |     |   |  }  | 
        |     |   +-----+ 
   855  |     +--- //
   856  |     |    //  Ë°å„ÅåÈïÉL„ÅÑÂ†ÉGÂêà„ÅØ„ÄÅ„Ç´„ÉÉE„ÉûÈÉ®ÂàÜ„ÅÆÂæå„ÅßÂàÜÂâ≤„Åô„Çã„ÄÇ   
   857  |     |    //                                                                       
   858  |     +--- int LineLen = 0;
   859  |     +--- int cp;
   860  |     |    
   861  |     +--- s = rStr;
   862  |     +--- rStr = &quot;&quot;;
        |     |  +------------------------------------------+ 
   863  |     +--+ for(i = 0 ; i &lt; (int)s.length() ; i++){  | 
        |     |  +--+---------------------------------------+ 
   864  |     |     +--- rStr += s[i];
   865  |     |     +--- LineLen++;
        |     |     |  +--------------------+ 
   866  |     |     +--+ if(s[i] == '\n'){  | 
        |     |     |  +--+-----------------+ 
   867  |     |     |     +--- LineLen = 0;
        |     |     |   +-+---+ 
   868  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +--------------------+ 
   869  |     |     +--+ if(LineLen &gt;= 50){ | 
        |     |     |  +--+-----------------+ 
        |     |     |     |  +------------------+ 
   870  |     |     |     +--+ if(s[i] == ','){ | 
        |     |     |     |  +--+---------------+ 
   871  |     |     |     |     +--- cp = s.find('\n',i);
        |     |     |     |     |  +----------------+ 
   872  |     |     |     |     +--+ if(cp &gt; i+10){ | 
        |     |     |     |     |  +--+-------------+ 
   873  |     |     |     |     |     +--- rStr += &quot;\n\t&quot;;
   874  |     |     |     |     |     +--- LineLen = 0;
        |     |     |     |     |   +-+---+ 
   875  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |   +-+---+ 
   876  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |   +-+---+ 
   877  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |   +-+---+ 
   878  |     |   |  }  | 
        |     |   +-----+ 
        |     |  +--------------+ 
   879  |     +--+ return rStr; | 
        |     |  +--------------+ 
        |   +-+---+ 
   880  |   |  }  | 
        |   +-----+ 
   881  +--- /*----------------------------------------------------------------------------*/
   882  |    //                                                                               
   883  |    //  1.ÊóÅEÊúÉÉË™ûÂêç                                                             
   884  |    //                                                                               
   885  |    //  2.„Éë„É©„ÉÅB„ÇÉ\Ë™ÉÉÊòé                                                      
   886  |    //    s   ÂÖÉÊñáÂ≠óÂàó                                                           
   887  |    //                                                                               
   888  |    //  3.Ê¶ÇËÉíÅ                                                                    
   889  |    //    „ÇÉP„ÇÉb„ÉÉF„Éó„ÉàÁ®ÉáÈ°û„Å®()„ÅÉáÂØÉZÂøú„Çí„ÉÅ„Çß„ÉÉ„ÇØ„Åó„Å¶Ëøî„Åô„ÄÇ    
   890  |    //    Ê¨ÅB„ÅÉáË°å„ÅåÁ∂ôÁÉJöËÅBå„Åã„ÅÉD„ÅÜ„Åã„ÅÉáÂàÅAÂÆö„Å´‰ΩÉ\ÁîÉB„Åô„Çã„ÄÇ      
   891  |    //                                                                               
   892  |    //  4.Ê©üËÉΩË™ÉÉÊòé                                                              
   893  |    //                                                                               
   894  |    //  5.ÊàÉT„ÇäÂÄÅA                                                                
   895  |    //    Ôºà„Å®Ôºâ„ÅÆÊïÅ[„ÅÉáÂ∑Éá„ÇíËÉ\î„Åô„ÄÇ                                      
   896  |    //                                                                               
   897  |    //  6.ÂÇôËÄÉ                                                                     
   898  |    //                                                                               
   899  |    /*----------------------------------------------------------------------------*/ 
        |  +--------------------------------+ 
   900  +--+ int TScript::CheckBrBalance()  | 
   901  |  | {                              | 
        |  +--+-----------------------------+ 
   902  |     +--- int i;
   903  |     +--- TToken *Token;
   904  |     +--- int BrCount = 0;
   905  |     |    
        |     |  +----------------------------+ 
   906  |     +--+ if(ScType != sct_ATExec){  | 
        |     |  +--+-------------------------+ 
        |     |     |  +------------------------------------------------------------------------------+ 
   907  |     |     +--+ return 0; // ÂØÉZË±ÅBÁ®ÉáÈ°û‰ÉTÅEÂ§ñ„ÅØ„ÉÅ„Çß„ÉÉ„ÇØ„ÅÉF„Åó„ÅßÔºê„ÇíËøî„Åô„ÄÇ | 
        |     |     |  +------------------------------------------------------------------------------+ 
        |     |   +-+---+ 
   908  |     |   |  }  | 
        |     |   +-----+ 
        |     |  +--------------------------------------------+ 
   909  |     +--+ for(i = 0 ; i &lt; TokStrList-&gt;Count ; i++){  | 
        |     |  +--+-----------------------------------------+ 
   910  |     |     +--- Token = (TToken *)TokStrList-&gt;Objects[i];
        |     |     |  +--------------------+ 
   911  |     |     +--+ if(Token == NULL){ | 
        |     |     |  +--+-----------------+ 
        |     |     |     |  +------------+ 
   912  |     |     |     +--+ continue;  | 
        |     |     |     |  +------------+ 
        |     |     |   +-+---+ 
   913  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +--------------------------------+ 
   914  |     |     +--+ if(Token-&gt;TokId == tid_Kakko){ | 
        |     |     |  +--+-----------------------------+ 
   915  |     |     |     +--- BrCount++;
        |     |     |   +-+---+ 
   916  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +--------------------------------+ 
   917  |     |     +--+ if(Token-&gt;TokId == tid_Kokka){ | 
        |     |     |  +--+-----------------------------+ 
   918  |     |     |     +--- BrCount--;
        |     |     |   +-+---+ 
   919  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |   +-+---+ 
   920  |     |   |  }  | 
        |     |   +-----+ 
        |     |  +------------------+ 
   921  |     +--+ return BrCount;  | 
        |     |  +------------------+ 
   922  |     |    
        |   +-+---+ 
   923  |   |  }  | 
        |   +-----+ 
   924  +--- /*----------------------------------------------------------------------------*/
   925  |    //                                                                               
   926  |    //  1.ÊóÅEÊúÉÉË™ûÂêç                                                             
   927  |    //                                                                               
   928  |    //  2.„Éë„É©„ÉÅB„ÇÉ\Ë™ÉÉÊòé                                                      
   929  |    //                                                                               
   930  |    //  3.Ê¶ÇËÉíÅ                                                                    
   931  |    //    „ÇÉP„ÇÉb„ÉÉF„Éó„Éà„Éá„Éº„ÇÉ\Á†ÉGÊ£Ñ                                        
   932  |    //    ScValDataListÂÜÖ„ÅÆ„Éá„Éº„ÇÉ\„ÅÉáÁ†ÉGÊ£Ñ„ÄÇ                                
   933  |    //                                                                               
   934  |    //  4.Ê©üËÉΩË™ÉÉÊòé                                                              
   935  |    //                                                                               
   936  |    //  5.ÊàÉT„ÇäÂÄÅA                                                                
   937  |    //                                                                               
   938  |    //  6.ÂÇôËÄÉ                                                                     
   939  |    //                                                                               
   940  |    /*----------------------------------------------------------------------------*/ 
        |  +----------------------+ 
   941  +--+ TScript::~TScript()  | 
   942  |  | {                    | 
        |  +--+-------------------+ 
   943  |     +--- int i;
   944  |     +--- TScValData *ScValData;
   945  |     |    
        |     |  +----------------------------+ 
   946  |     +--+ if(ScValDataList != NULL){ | 
        |     |  +--+-------------------------+ 
        |     |     |  +----------------------------------------------+ 
   947  |     |     +--+ for(i = 0 ; i &lt; ScValDataList-&gt;Count ; i++){ | 
        |     |     |  +--+-------------------------------------------+ 
   948  |     |     |     +--- ScValData = (TScValData *)ScValDataList-&gt;Items[i];
   949  |     |     |     +--- ScValData-&gt;RefCount--;
        |     |     |     |  +--------------------------------+ 
   950  |     |     |     +--+ if(ScValData-&gt;RefCount == 0){  | 
        |     |     |     |  +--+-----------------------------+ 
   951  |     |     |     |     +--- delete ScValData;
        |     |     |     |   +-+---+ 
   952  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |   +-+---+ 
   953  |     |     |   |  }  | 
        |     |     |   +-----+ 
   954  |     |     +--- delete ScValDataList;
        |     |   +-+---+ 
   955  |     |   |  }  | 
        |     |   +-----+ 
        |     |  +--------------------------+ 
   956  |     +--+ if(SampledList != NULL){ | 
        |     |  +--+-----------------------+ 
   957  |     |     +--- delete SampledList;
        |     |   +-+---+ 
   958  |     |   |  }  | 
        |     |   +-----+ 
   959  |     +--- delete TokStrList;
        |   +-+---+ 
   960  |   |  }  | 
        |   +-----+ 
   961  +--- /*----------------------------------------------------------------------------*/
   962  |    //                                                                                                   
   963  |    //  1.ÊóÅEÊúÉÉË™ûÂêç                                                                                 
   964  |    //                                                                                                   
   965  |    //  2.„Éë„É©„ÉÅB„ÇÉ\Ë™ÉÉÊòé                                                                          
   966  |    //    ValName „ÇÉP„ÇÉb„ÉÉF„Éó„ÉàÂ§âÊï∞Âêç                                                            
   967  |    //                                                                                                   
   968  |    //  3.Ê¶ÇËÉíÅ                                                                                        
   969  |    //    „ÇÉP„ÇÉb„ÉÉF„Éó„ÉàÂ§âÊï∞„ÅÉáÁîüÊàê                                                             
   970  |    //    Fortran„ÅÉáÂ§âÊï∞„ÅÉBÂàÅEÈÄî„Å´„ÇÉP„ÇÉb„ÉÉF„Éó„ÉàÂÜÖ„Åß„ÅÉáÂ§âÊï∞„ÅÉB„Åó„Å¶ÁîüÊàê„Åï„Çå„Çã„ÄÇ  
   971  |    //    „ÅÉZ„Åü„ÄÅ„Éá„ÉÉV„ÇÉ\„ÅÉáÂàùÊúüÂåñ„ÇÇË°å„Çè„Çå„Çã„ÄÇ                                           
   972  |    //                                                                                                   
   973  |    //  4.Ê©üËÉΩË™ÉÉÊòé                                                                                  
   974  |    //                                                                                                   
   975  |    //  5.ÊàÉT„ÇäÂÄÅA                                                                                    
   976  |    //                                                                                                   
   977  |    //  6.ÂÇôËÄÉ                                                                                         
   978  |    //                                                                                                   
   979  |    /*----------------------------------------------------------------------------*/                     
        |  +----------------------------------------+ 
   980  +--+ TScValData::TScValData(string ValName) | 
   981  |  | {                                      | 
        |  +--+-------------------------------------+ 
   982  |     +--- Str = ValName;
   983  |     +--- RefCount = 0;
   984  |     +--- dData = 0;
   985  |     +--- sData = 0;
   986  |     +--- eData = 0;
        |   +-+---+ 
   987  |   |  }  | 
        |   +-----+ 
   988  +--- /*----------------------------------------------------------------------------*/
   989  |    //                                                                                                           
   990  |    //  1.ÊóÅEÊúÉÉË™ûÂêç                                                                                         
   991  |    //                                                                                                           
   992  |    //  2.„Éë„É©„ÉÅB„ÇÉ\Ë™ÉÉÊòé                                                                                  
   993  |    //    s   ÂÖÉÊñáÂ≠óÂàó                                                                                       
   994  |    //                                                                                                           
   995  |    //  3.Ê¶ÇËÉíÅ                                                                                                
   996  |    //    ÈïÉL„ÅÑÊñáÂ≠óÂàó„Çí72Ê°Å„ÅßÂàÜÂâ≤„Åó„Å¶„ÄÅ&„Çí„Çª„ÉÉ„Éà„Åô„Çã„ÄÇ                                       
   997  |    //    ÔºÅvË®ÄË™û„ÅÆÂ†ÉGÂêà„ÅØ„ÄÅ‰ÉNçËÉíÅ„ÄÇÁèæÂúÉB„ÅÉbÂÖÉ„ÅÆÊñáÂÉÖóÂàó„Çí„Åù„ÅÉá„ÅÉZ„ÅÉZÊàÉT„Åó„Å¶„ÅÑ„Çã„ÄÇ  
   998  |    //    Fortran90„ÅÉáÂ†ÉGÂêà„ÇÇ„ÇÉE„ÉÅB„ÉÉE„ÉàÁÉÖâ„Çí„Åù„ÅÆ„ÅÉZ„ÅÉZ„ÅÉH„Åó„Åü„ÅÑ„Åü„ÇÅÂàÜÂâÉC„Åó„Å™„ÅÑ„ÄÇ      
   999  |    //                                                                                                           
  1000  |    //  4.Ê©üËÉΩË™ÉÉÊòé                                                                                          
  1001  |    //                                                                                                           
  1002  |    //  5.ÊàÉT„ÇäÂÄÅA                                                                                            
  1003  |    //    ÂÖÉ„ÅÆÊñáÂÉÖóÂàó„Çí„Åù„ÅÉá„ÅÉZ„ÅÉZÊàÉT„Åó„Å¶„ÅÑ„Çã„ÄÇ                                                  
  1004  |    //                                                                                                           
  1005  |    //  6.ÂÇôËÄÉ                                                                                                 
  1006  |    //                                                                                                           
  1007  |    /*----------------------------------------------------------------------------*/                             
        |  +------------------------------+ 
  1008  +--+ string SepLongStr(string s)  | 
  1009  |  | {                            | 
        |  +--+---------------------------+ 
  1010  |     +--- int cp;
  1011  |     +--- string s2,s3;
  1012  |     +--- string LineStr;
  1013  |     +--- string rStr;
  1014  |     |    
        |     |  +----------------------------------------+ 
  1015  |     +--+ if(MainF-&gt;SrcCodeType == MainF-&gt;sctC){ | 
        |     |  +--+-------------------------------------+ 
        |     |     |  +------------+ 
  1016  |     |     +--+ return s;  | 
        |     |     |  +------------+ 
        |     |   +-+---+ 
  1017  |     |   |  }  | 
        |     |   +-----+ 
  1018  |     +--- rStr = &quot;&quot;;
        |     |  +------------------------------------------------+ 
  1019  |     +--+ if(MainF-&gt;SrcCodeType == MainF-&gt;sctFortran77){ | 
        |     |  +--+---------------------------------------------+ 
  1020  |     |     +--- //
  1021  |     |     |    //  Fortrn77„ÅÉáÂ†ÉGÂêà                                                                                                
  1022  |     |     |    //  ÊîÉPË°å„Åæ„ÅÉ@„ÅÉáÊñáÂÉÖóÂàóÈïÉL„Åï„Åå72„ÇíËÉJÖ„Åà„ÇãÂ†ÉGÂêà„Å´„ÄÅÁÉJôÁÉJöËÅBå„Å´„Åô„Çã„ÄÇ                         
  1023  |     |     |    //  ÈÄî‰ÉNÉÖ„ÅÉH\n„Åå„ÅÇ„Çå„Å∞„ÄÅ„Åù„Åì„ÅßÊîÉPË°å„Å´„ÅÉF„ÅÅv„ÅÉí„ÅÑ„Çã„ÅÉá„ÅÉ@„Åù„ÅÆ„ÅÉZ„ÅÉZ„ÅÉB„Åô„Çã„ÄÇ              
  1024  |     |     |    //  ÂÖàÈ†ÉÖ„ÅÉH„ÇÉP„Éö„Éº„ÇÉP„ÇíÂÖ•„Çå„Åü„ÅÑÂ†ÉGÂêà„ÇÇ„ÅÇ„Çã„ÅÉá„ÅÉ@72ÊñáÂÉÖó„Åß„ÅÉF„Åè60ÊñáÂÉÖó„Åæ„ÅÉ@„ÅÉHÂ§âÊõ¥„ÄÇ   
  1025  |     |     |    //                                                                                                                     
        |     |     |  +------------------+ 
  1026  |     |     +--+ while(s != &quot;&quot;){  | 
        |     |     |  +--+---------------+ 
  1027  |     |     |     +--- cp = s.find('\n');
        |     |     |     |  +----------------+ 
  1028  |     |     |     +--+ if(cp == -1){  | 
        |     |     |     |  +--+-------------+ 
  1029  |     |     |     |     +--- LineStr = s;
  1030  |     |     |     |     +--- s = &quot;&quot;;
        |     |     |     |   +-+---+ 
  1031  |     |     |     |   |  }  | 
        |     |     |     |   +-+---+ 
        |     |     |     |   +-+-------+ 
  1031  |     |     |     |   |  else{  | 
        |     |     |     |   +-+-------+ 
  1032  |     |     |     |     +--- LineStr = s.substr(0,cp+1);
  1033  |     |     |     |     +--- s.erase(0,cp+1);
        |     |     |     |   +-+---+ 
  1034  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |     |  +------------------------------+ 
  1035  |     |     |     +--+ if(LineStr.length() &lt;= 72){  | 
        |     |     |     |  +--+---------------------------+ 
  1036  |     |     |     |     +--- rStr += LineStr;
        |     |     |     |   +-+---+ 
  1037  |     |     |     |   |  }  | 
        |     |     |     |   +-+---+ 
        |     |     |     |   +-+-------+ 
  1037  |     |     |     |   |  else{  | 
        |     |     |     |   +-+-------+ 
  1038  |     |     |     |     +--- // LineStr„ÅåÔÉVëËÅBå„ÅÆÈïÉL„Åï„ÇíË∂Ö„Åà„ÅÉí„ÅÑ„Çã„ÅÉá„ÅÉ@Ë°å„ÇíË§áÊï∞„ÅÉáË°å„Å´ÂàÜÂâ≤„Åô„Çã„ÄÇ
        |     |     |     |     |  +--------------------------------+ 
  1039  |     |     |     |     +--+ while(LineStr.length() &gt; 72){  | 
        |     |     |     |     |  +--+-----------------------------+ 
  1040  |     |     |     |     |     +--- rStr += LineStr.substr(0,72)+&quot;\n&quot;;
  1041  |     |     |     |     |     +--- LineStr.erase(0,72);
  1042  |     |     |     |     |     +--- LineStr =  &quot;     &amp;&quot;+LineStr;
        |     |     |     |     |   +-+---+ 
  1043  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
  1044  |     |     |     |     +--- rStr += LineStr;
        |     |     |     |   +-+---+ 
  1045  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |   +-+---+ 
  1046  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |   +-+---+ 
  1047  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-------+ 
  1047  |     |   |  else{  | 
        |     |   +-+-------+ 
  1048  |     |     +--- //
  1049  |     |     |    //  Fortrn90„ÅÉáÂ†ÉGÂêà                                                                                                  
  1050  |     |     |    //  ÊîÉPË°å„Åæ„ÅÉ@„ÅÉáÊñáÂÉÖóÂàóÈïÉL„Åï„Åå132„ÇíËÉJÖ„Åà„ÇãÂ†ÉGÂêà„Å´„ÄÅÁÉJôÁÉJöËÅBå„Å´„Åô„Çã„ÄÇ                          
  1051  |     |     |    //  ÈÄî‰ÉNÉÖ„ÅÉH\n„Åå„ÅÇ„Çå„Å∞„ÄÅ„Åù„Åì„ÅßÊîÉPË°å„Å´„ÅÉF„ÅÅv„ÅÉí„ÅÑ„Çã„ÅÉá„ÅÉ@„Åù„ÅÆ„ÅÉZ„ÅÉZ„ÅÉB„Åô„Çã„ÄÇ                
  1052  |     |     |    //  ÂÖàÈ†ÉÖ„ÅÉH„ÇÉP„Éö„Éº„ÇÉP„ÇíÂÖ•„Çå„Åü„ÅÑÂ†ÉGÂêà„ÇÇ„ÅÇ„Çã„ÅÉá„ÅÉ@132ÊñáÂÉÖó„Åß„ÅÉF„Åè120ÊñáÂÉÖó„Åæ„ÅÉ@„ÅÉHÂ§âÊõ¥„ÄÇ   
  1053  |     |     |    //                                                                                                                       
        |     |     |  +------------------+ 
  1054  |     |     +--+ while(s != &quot;&quot;){  | 
        |     |     |  +--+---------------+ 
  1055  |     |     |     +--- cp = s.find('\n');
        |     |     |     |  +----------------+ 
  1056  |     |     |     +--+ if(cp == -1){  | 
        |     |     |     |  +--+-------------+ 
  1057  |     |     |     |     +--- LineStr = s;
  1058  |     |     |     |     +--- s = &quot;&quot;;
        |     |     |     |   +-+---+ 
  1059  |     |     |     |   |  }  | 
        |     |     |     |   +-+---+ 
        |     |     |     |   +-+-------+ 
  1059  |     |     |     |   |  else{  | 
        |     |     |     |   +-+-------+ 
  1060  |     |     |     |     +--- LineStr = s.substr(0,cp+1);
  1061  |     |     |     |     +--- s.erase(0,cp+1);
        |     |     |     |   +-+---+ 
  1062  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
  1063  |     |     |     +--- //          if(LineStr.length() &lt;= 132){
        |     |     |     |  +------------------------------+ 
  1064  |     |     |     +--+ if(LineStr.length() &lt;= 120){ | 
        |     |     |     |  +--+---------------------------+ 
  1065  |     |     |     |     +--- rStr += LineStr;
        |     |     |     |   +-+---+ 
  1066  |     |     |     |   |  }  | 
        |     |     |     |   +-+---+ 
        |     |     |     |   +-+-------+ 
  1066  |     |     |     |   |  else{  | 
        |     |     |     |   +-+-------+ 
  1067  |     |     |     |     +--- // LineStr„ÅåÔÉVëËÅBå„ÅÆÈïÉL„Åï„ÇíË∂Ö„Åà„ÅÉí„ÅÑ„Çã„ÅÉá„ÅÉ@Ë°å„ÇíË§áÊï∞„ÅÉáË°å„Å´ÂàÜÂâ≤„Åô„Çã„ÄÇ
  1068  |     |     |     |     +--- //              while(LineStr.length() &gt; 132){
  1069  |     |     |     |     |    //                  rStr += LineStr.substr(0,131)+&quot;&amp;\n&quot;; 
  1070  |     |     |     |     |    //                  LineStr.erase(0,131);                
        |     |     |     |     |  +--------------------------------+ 
  1071  |     |     |     |     +--+ while(LineStr.length() &gt; 120){ | 
        |     |     |     |     |  +--+-----------------------------+ 
  1072  |     |     |     |     |     +--- rStr += LineStr.substr(0,119)+&quot;&amp;\n&quot;;
  1073  |     |     |     |     |     +--- LineStr.erase(0,119);
  1074  |     |     |     |     |     +--- LineStr =  &quot;     &amp;&quot;+LineStr;
        |     |     |     |     |   +-+---+ 
  1075  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
  1076  |     |     |     |     +--- rStr += LineStr;
        |     |     |     |   +-+---+ 
  1077  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |   +-+---+ 
  1078  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |   +-+---+ 
  1079  |     |   |  }  | 
        |     |   +-----+ 
        |     |  +--------------+ 
  1080  |     +--+ return rStr; | 
        |     |  +--------------+ 
        |   +-+---+ 
  1081  |   |  }  | 
        |   +-----+ 
  1082  +--- /*----------------------------------------------------------------------------*/
  1083  |    //                                                                                                                 
  1084  |    //  1.ÊóÅEÊúÉÉË™ûÂêç                                                                                               
  1085  |    //                                                                                                                 
  1086  |    //  2.„Éë„É©„ÉÅB„ÇÉ\Ë™ÉÉÊòé                                                                                        
  1087  |    //    sPos    „Éà„Éº„ÇÉb„ÉÉE„ÉÉF„ÇÉP„ÉàÈñãÂßã‰ÉXçÁÉXÉá                                                             
  1088  |    //                                                                                                                 
  1089  |    //  3.Ê¶ÇËÉíÅ                                                                                                      
  1090  |    //    !OAT$ bind ATexec arguments end ÈÉÉBÂàÜ„ÅßÂëÉV„ÅÅ[„Çå„Å¶                                                     
  1091  |    //    argumentsd start „ÅÉZ„ÅÉ@„ÇíËÉ@ÅvÊûê„Åó„ÅÉíÂ§âÊï∞ÁΩÉáÊèõ„Åà„ÉÉF„ÇÉP„Éà„ÇíScript„Éá„Éº„ÇÉ\„ÅÉHÂÖÅE„Çå„Çã„ÄÇ   
  1092  |    //    „ÅÉZ„Åü„ÄÅÁÉXÉáÊèõ„Å®„Åó„Å¶ÂèÇÁÖß„Åó„ÅüScript„ÅÉáÁ®ÉáÈ°û„ÇíÂ§âÊõ¥„Åô„Çã„ÄÇ                                   
  1093  |    //                                                                                                                 
  1094  |    //  4.Ê©üËÉΩË™ÉÉÊòé                                                                                                
  1095  |    //                                                                                                                 
  1096  |    //  5.ÊàÉT„ÇäÂÄÅA                                                                                                  
  1097  |    //                                                                                                                 
  1098  |    //  6.ÂÇôËÄÉ                                                                                                       
  1099  |    //                                                                                                                 
  1100  |    /*----------------------------------------------------------------------------*/                                   
        |  +--------------------------------------------------------------------+ 
  1101  +--+ void TScript::GetBindArgument(TList *TokenList,int argumentEndPos) | 
  1102  |  | {                                                                  | 
        |  +--+-----------------------------------------------------------------+ 
  1103  |     +--- int i;
  1104  |     +--- TScript *Script;
  1105  |     +--- TToken *Token;
  1106  |     +--- int argumentStartPos = -1;
  1107  |     +--- int len;
  1108  |     +--- string valName1;
  1109  |     +--- string valName2;
  1110  |     |    
  1111  |     +--- //
  1112  |     |    // arguments start „ÇíÊé¢„Åô„ÄÇËÉíã„Å§„Åã„Çâ„ÅÉF„ÅÑÂ†ÉGÂêà„ÅØ„ÇÉB„ÉÉD„ÉÉV„ÅÉB„ÅÉF„Çã„ÄÇ  
  1113  |     |    //                                                                                       
        |     |  +--------------------------------------------+ 
  1114  |     +--+ for(i = argumentEndPos-1 ; i &gt;= 0 ; i--){  | 
        |     |  +--+-----------------------------------------+ 
  1115  |     |     +--- Token = (TToken *)TokenList-&gt;Items[i];
        |     |     |  +--------------------+ 
  1116  |     |     +--+ if(Token == NULL){ | 
        |     |     |  +--+-----------------+ 
        |     |     |     |  +------------+ 
  1117  |     |     |     +--+ continue;  | 
        |     |     |     |  +------------+ 
        |     |     |   +-+---+ 
  1118  |     |     |   |  }  | 
        |     |     |   +-----+ 
  1119  |     |     +--- Script = (TScript *)Token-&gt;Script;
        |     |     |  +----------------------+ 
  1120  |     |     +--+ if(Script == NULL){  | 
        |     |     |  +--+-------------------+ 
        |     |     |     |  +------------+ 
  1121  |     |     |     +--+ continue;  | 
        |     |     |     |  +------------+ 
        |     |     |   +-+---+ 
  1122  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +--------------------------------------------------+ 
  1123  |     |     +--+ if(Script-&gt;ScAction == sca_bind_atexec_arg_end){ | 
        |     |     |  +--+-----------------------------------------------+ 
        |     |     |     |  +--------+ 
  1124  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |   +-+---+ 
  1125  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +----------------------------------------------------+ 
  1126  |     |     +--+ if(Script-&gt;ScAction == sca_bind_atexec_arg_start){ | 
        |     |     |  +--+-------------------------------------------------+ 
  1127  |     |     |     +--- argumentStartPos = i;
        |     |     |     |  +--------+ 
  1128  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |   +-+---+ 
  1129  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |   +-+---+ 
  1130  |     |   |  }  | 
        |     |   +-----+ 
        |     |  +------------------------------+ 
  1131  |     +--+ if(argumentStartPos == -1){  | 
        |     |  +--+---------------------------+ 
  1132  |     |     +--- MainF-&gt;ErrMessage(argumentEndPos,&quot;bind ATexec arguments start „ÅåËÉíã„Å§„Åã„Çä„ÅÉZ„Åõ„Çì„ÄÇ");
        |     |     |  +----------+ 
  1133  |     |     +--+ return;  | 
        |     |     |  +----------+ 
        |     |   +-+---+ 
  1134  |     |   |  }  | 
        |     |   +-----+ 
  1135  |     |    
  1136  |     +--- //
  1137  |     |    // arguments start „Åã„ÇâÁèÉZÂúÉB‰ΩçÁÉXÉá„ÅÉZ„ÅÉ@„ÇíÁÉXÉáÊèõ„É™„ÇÉP„Éà„Å´ËøÉXÂä†„Åó                                    
  1138  |     |    // „Åù„ÅÆScriptÁ®ÉáÈ°û„ÇíÂ§âÊõ¥„Åô„Çã„ÄÇÁÉXÉáÊèõ„ÅàÂÆüËÅBåÊôÇ„ÅÉb arguments end „ÅÉá„ÉÉF„ÇÉP„Éà„ÅåÂèÇÁÖß„Åï„Çå„Çã„ÄÇ   
  1139  |     |    //                                                                                                                     
        |     |  +------------------------------+ 
  1140  |     +--+ if(bindValNameList != NULL){ | 
        |     |  +--+---------------------------+ 
  1141  |     |     +--- delete bindValNameList;
        |     |   +-+---+ 
  1142  |     |   |  }  | 
        |     |   +-----+ 
  1143  |     +--- bindValNameList = new TStringList;
        |     |  +--------------------------------------------------------+ 
  1144  |     +--+ for(i = argumentStartPos ; i &lt; argumentEndPos ; i++){  | 
        |     |  +--+-----------------------------------------------------+ 
  1145  |     |     +--- Token = (TToken *)TokenList-&gt;Items[i];
        |     |     |  +--------------------+ 
  1146  |     |     +--+ if(Token == NULL){ | 
        |     |     |  +--+-----------------+ 
        |     |     |     |  +------------+ 
  1147  |     |     |     +--+ continue;  | 
        |     |     |     |  +------------+ 
        |     |     |   +-+---+ 
  1148  |     |     |   |  }  | 
        |     |     |   +-----+ 
  1149  |     |     +--- Script = (TScript *)Token-&gt;Script;
        |     |     |  +----------------------+ 
  1150  |     |     +--+ if(Script == NULL){  | 
        |     |     |  +--+-------------------+ 
        |     |     |     |  +------------+ 
  1151  |     |     |     +--+ continue;  | 
        |     |     |     |  +------------+ 
        |     |     |   +-+---+ 
  1152  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +------------------------------------+ 
  1153  |     |     +--+ if(Script-&gt;ScType != sct_command){ | 
        |     |     |  +--+---------------------------------+ 
        |     |     |     |  +------------+ 
  1154  |     |     |     +--+ continue;  | 
        |     |     |     |  +------------+ 
        |     |     |   +-+---+ 
  1155  |     |     |   |  }  | 
        |     |     |   +-----+ 
  1156  |     |     +--- Script-&gt;ScType = sct_Bind;
  1157  |     |     +--- len = Script-&gt;LineEndTokPos - Script-&gt;TokPos;
        |     |     |  +----------------+ 
  1158  |     |     +--+ if(len != 4){  | 
        |     |     |  +--+-------------+ 
  1159  |     |     |     +--- MainF-&gt;ErrMessage(i,&quot;bind ATexec arguments ÊõÉNÂºè„Ç®„ÉÉD„ÉÉV&quot;);
        |     |     |     |  +----------+ 
  1160  |     |     |     +--+ return;  | 
        |     |     |     |  +----------+ 
        |     |     |   +-+---+ 
  1161  |     |     |   |  }  | 
        |     |     |   +-----+ 
  1162  |     |     +--- Token = (TToken *)TokenList-&gt;Items[Script-&gt;TokPos+1];
  1163  |     |     +--- valName1 = Token-&gt;Str;
  1164  |     |     +--- Token = (TToken *)TokenList-&gt;Items[Script-&gt;TokPos+2];
        |     |     |  +------------------------+ 
  1165  |     |     +--+ if(Token-&gt;Str != &quot;=&quot;){ | 
        |     |     |  +--+---------------------+ 
  1166  |     |     |     +--- MainF-&gt;ErrMessage(i,&quot;bind ATexec arguments ÊõÉNÂºè„Ç®„ÉÉD„ÉÉV&quot;);
        |     |     |     |  +----------+ 
  1167  |     |     |     +--+ return;  | 
        |     |     |     |  +----------+ 
        |     |     |   +-+---+ 
  1168  |     |     |   |  }  | 
        |     |     |   +-----+ 
  1169  |     |     +--- Token = (TToken *)TokenList-&gt;Items[Script-&gt;TokPos+3];
  1170  |     |     +--- valName2 = Token-&gt;Str;
  1171  |     |     +--- bindValNameList-&gt;Add(valName1); // ÊñáÂÉÖóÂàó„ÅÉ@„ÅÉáÁΩÉáÊèõ„Å´„ÅÉF„Çã„ÄÇ
  1172  |     |     +--- bindValNameList-&gt;Add(valName2); // valName1 -&gt; valName2
        |     |   +-+---+ 
  1173  |     |   |  }  | 
        |     |   +-----+ 
        |   +-+---+ 
  1174  |   |  }  | 
        |   +-----+ 
  1175  +--- /*----------------------------------------------------------------------------*/
  1176  |    //                                                                                                                     
  1177  |    //  1.ÊóÅEÊúÉÉË™ûÂêç                                                                                                   
  1178  |    //                                                                                                                     
  1179  |    //  2.„Éë„É©„ÉÅB„ÇÉ\Ë™ÉÉÊòé                                                                                            
  1180  |    //    sPos    „Éà„Éº„ÇÉb„ÉÉE„ÉÉF„ÇÉP„ÉàÈñãÂßã‰ÉXçÁÉXÉá                                                                 
  1181  |    //                                                                                                                     
  1182  |    //  3.Ê¶ÇËÉíÅ                                                                                                          
  1183  |    //    !OAT$ bind ATexec arguments „ÇíÊé¢„Åó„Å¶Ë¶ã„Å§„Åã„Çå„ÅÅ[Â§âÊï∞Âêç„ÇíÁΩÉáÊèõ„Åó„ÅüÂÉVïÊï∞ÊñáÂÉÖóÂàó„ÇíËÉ\î„Åô„ÄÇ  
  1184  |    //                                                                                                                     
  1185  |    //  4.Ê©üËÉΩË™ÉÉÊòé                                                                                                    
  1186  |    //                                                                                                                     
  1187  |    //  5.ÊàÉT„ÇäÂÄÅA                                                                                                      
  1188  |    //    Â§âÊï∞Âêç„ÇíÁΩÉáÊèõ„Åó„ÅüÂÉVïÊï∞ÊñáÂÉÖóÂàó                                                                       
  1189  |    //                                                                                                                     
  1190  |    //  6.ÂÇôËÄÉ                                                                                                           
  1191  |    //                                                                                                                     
  1192  |    /*----------------------------------------------------------------------------*/                                       
        |  +----------------------------------------------------+ 
  1193  +--+ string TScript::ReplaseBindValName(string argStr)  | 
  1194     | {                                                  | 
           +--+-------------------------------------------------+ 
  1195        +--- //
  1196        |    // arguments end „ÇíÊé¢„Åô„ÄÇËÉíã„Å§„Åã„Çâ„ÅÉF„ÅÑÂ†ÉGÂêà„ÅØË©ÉCÂΩì„Å™„Åó„ÄÇ  
  1197        |    //                                                                           
  1198        +--- TList *TokenList = MainF-&gt;TokenList;
  1199        +--- int i,j;
  1200        +--- TScript *Script;
  1201        +--- TToken *Token;
  1202        +--- TStringList *NameList;
  1203        +--- string valName;
  1204        +--- string NewArgStr;
  1205        |    
              |  +----------------------------------+ 
  1206        +--+ for(i = TokPos ; i &gt;= 0 ; i--){  | 
              |  +--+-------------------------------+ 
  1207        |     +--- Token = (TToken *)TokenList-&gt;Items[i];
              |     |  +--------------------+ 
  1208        |     +--+ if(Token == NULL){ | 
              |     |  +--+-----------------+ 
              |     |     |  +------------+ 
  1209        |     |     +--+ continue;  | 
              |     |     |  +------------+ 
              |     |   +-+---+ 
  1210        |     |   |  }  | 
              |     |   +-----+ 
  1211        |     +--- Script = (TScript *)Token-&gt;Script;
              |     |  +----------------------+ 
  1212        |     +--+ if(Script == NULL){  | 
              |     |  +--+-------------------+ 
              |     |     |  +------------+ 
  1213        |     |     +--+ continue;  | 
              |     |     |  +------------+ 
              |     |   +-+---+ 
  1214        |     |   |  }  | 
              |     |   +-----+ 
              |     |  +--------------------------------------------------+ 
  1215        |     +--+ if(Script-&gt;ScAction == sca_bind_atexec_arg_end){ | 
              |     |  +--+-----------------------------------------------+ 
              |     |     |  +--------+ 
  1216        |     |     +--+ break; | 
              |     |     |  +--------+ 
              |     |   +-+---+ 
  1217        |     |   |  }  | 
              |     |   +-----+ 
              |   +-+---+ 
  1218        |   |  }  | 
              |   +-----+ 
              |  +--------------+ 
  1219        +--+ if(i &lt;= 0){  | 
              |  +--+-----------+ 
              |     |  +----------------+ 
  1220        |     +--+ return argStr; | 
              |     |  +----------------+ 
              |   +-+---+ 
  1221        |   |  }  | 
              |   +-----+ 
  1222        +--- NameList = (TStringList *)Script-&gt;bindValNameList;
              |  +------------------------+ 
  1223        +--+ if(NameList == NULL){  | 
              |  +--+---------------------+ 
              |     |  +----------------+ 
  1224        |     +--+ return argStr; | 
              |     |  +----------------+ 
              |   +-+---+ 
  1225        |   |  }  | 
              |   +-----+ 
  1226        +--- //
  1227        |    //  argStr„Çí„Ç´„ÉÉE„Éû„ÅßÂàÜÂâ≤„Åó„Å¶Â§âÊï∞Âêç„ÅÆÁΩÉáÊèõ„ÇíË°å„ÅÜ„ÄÇ  
  1228        |    //                                                                     
  1229        +--- NewArgStr = &quot;&quot;;
  1230        +--- valName = &quot;&quot;;
              |  +----------------------------------------------+ 
  1231        +--+ for(i = 0 ; i &lt; (int)argStr.length() ; i++){ | 
              |  +--+-------------------------------------------+ 
              |     |  +------------------------+ 
  1232        |     +--+ if(argStr[i] != ','){  | 
              |     |  +--+---------------------+ 
  1233        |     |     +--- valName += argStr[i];
              |     |     |  +----------------------------------+ 
  1234        |     |     +--+ if(i != (int)argStr.length()-1){ | 
              |     |     |  +--+-------------------------------+ 
              |     |     |     |  +------------+ 
  1235        |     |     |     +--+ continue;  | 
              |     |     |     |  +------------+ 
              |     |     |   +-+---+ 
  1236        |     |     |   |  }  | 
              |     |     |   +-----+ 
              |     |   +-+---+ 
  1237        |     |   |  }  | 
              |     |   +-----+ 
  1238        |     +--- //
  1239        |     |    //  Â§âÊï∞Âêç„ÅÆÁΩÉáÊèõ„ÇíË°å„ÅÜ„ÄÇ  
  1240        |     |    //                                   
              |     |  +------------------------------------------+ 
  1241        |     +--+ for(j = 0 ; j &lt; NameList-&gt;Count ; j+=2){ | 
              |     |  +--+---------------------------------------+ 
              |     |     |  +--------------------------------------+ 
  1242        |     |     +--+ if(NameList-&gt;Strings[j] == valName){ | 
              |     |     |  +--+-----------------------------------+ 
  1243        |     |     |     +--- valName = NameList-&gt;Strings[j+1];
              |     |     |   +-+---+ 
  1244        |     |     |   |  }  | 
              |     |     |   +-----+ 
              |     |   +-+---+ 
  1245        |     |   |  }  | 
              |     |   +-----+ 
  1246        |     +--- NewArgStr += valName;
  1247        |     +--- valName = &quot;&quot;;
              |     |  +------------------------+ 
  1248        |     +--+ if(argStr[i] == ','){  | 
              |     |  +--+---------------------+ 
  1249        |     |     +--- NewArgStr += argStr[i];
              |     |   +-+---+ 
  1250        |     |   |  }  | 
              |     |   +-----+ 
              |   +-+---+ 
  1251        |   |  }  | 
              |   +-----+ 
              |  +--------------------+ 
  1252        +--+ return NewArgStr;  | 
              |  +--------------------+ 
            +-+---+ 
  1253      |  }  | 
            +-----+ 
</pre>


</body>
</html>
