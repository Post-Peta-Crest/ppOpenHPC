
<html>
<head>
<title>GetValIdx 関数説明</title><base target="main">
<link rel ="stylesheet" type="text/css" href="stylesheet.css" title="stylesheet">
<meta http-equiv="Content-Type" content="text/html;charset=Shift_JIS">
</head>

<body bgcolor="#ffffff">

<div align="right"><font size="2">ABCLibScriptC プロジェクト</font></div>

<table width=100% bgcolor="#e6e6fa" class="titlebgcolor" border="1" cellpadding="7" cellspacing="0">
<tr>
    <td><font class="titlefont">21.8. GetValIdx 関数説明</font></td>
</tr>
</table>

<p></p>
<table border="1">
<tr><th align="left" nowrap>関数名</th>        <td nowrap>GetValIdx</td></tr>
<tr><th align="left" nowrap>定義ファイル名</th><td nowrap>pass2.cpp</td></tr>
<tr><th align="left" nowrap>定義行</th>        <td nowrap>2086</td></tr>
<tr><th align="left" nowrap>宣言形式</th>      <td nowrap>int GetValIdx ( TList * ValDataList , string ValName , int ModuleIdx )</td></tr>
<tr><th align="left" nowrap>概要</th>          <td nowrap>名前とモジュールIdxに一致する変数番号を返す。</td></tr>
<tr><th align="left" nowrap>戻り値</th>        <td nowrap>変数番号</td></tr>
<tr><th align="left" nowrap>パラメタ説明</th>  <td nowrap>ValDataList  変数リスト<br>ValName 変数名<br>ModuleIdx モジュールインデックス</td></tr>
<tr><th align="left" nowrap>機能説明</th>      <td nowrap></td></tr>
<tr><th align="left" nowrap>備考</th>          <td nowrap></td></tr>
</table>

<p></p>
呼出し元関数一覧表
<table border="1">
<tr>
<th nowrap>№</th>
<th nowrap>名称</th>
<th nowrap>定義ファイル名</th>
<th nowrap>定義行</th>
</tr>
<tr>
<td nowrap>1</td>
<td nowrap><a href="31_17.htm">Pass2_C</a></td>
<td nowrap><a href="5_3.htm">pass2.cpp</a></td>
<td nowrap><a href="31_17.htm">657</a></td>
</tr>
</table>

<p></p>

<p></p>

<p></p>
参照先一覧表
<table border="1">
<tr>
<th nowrap>№</th>
<th nowrap>名称</th>
<th nowrap>種別</th>
<th nowrap>定義ファイル名</th>
<th nowrap>定義行</th>
</tr>
<tr>
<td nowrap>1</td>
<td nowrap><a href="16_1_1.htm">TList</a></td>
<td nowrap>クラス</td>
<td nowrap><a href="5_16.htm">VCL_Lib.h</a></td>
<td nowrap><a href="16_1_1.htm">57</a></td>
</tr>
<tr>
<td nowrap>2</td>
<td nowrap><a href="16_11_1.htm">TValData</a></td>
<td nowrap>クラス</td>
<td nowrap><a href="5_11.htm">pass2.h</a></td>
<td nowrap><a href="16_11_1.htm">106</a></td>
</tr>
</table>

<p></p>
<pre>
関数論理チャート

        |  +----------------------------------------------------------------+ 
  2086  +--+ int GetValIdx(TList *ValDataList,string ValName,int ModuleIdx) | 
  2087     | {                                                              | 
           +--+-------------------------------------------------------------+ 
  2088        +--- int ValIdx;
  2089        +--- TValData *ValData;
  2090        |    
  2091        +--- //
  2092        |    //  同じMoudeIdxを探しなければ、グローバルを探す。 2011/07/28  
  2093        |    //                                                             
              |  +------------------------------------------------------------+ 
  2094        +--+ for(ValIdx = 0 ; ValIdx &lt; ValDataList-&gt;Count ; ValIdx++){  | 
              |  +--+---------------------------------------------------------+ 
  2095        |     +--- ValData = (TValData *)ValDataList-&gt;Items[ValIdx];
              |     |  +------------------------------------------+ 
  2096        |     +--+ if((ValData-&gt;Str == ValName)&amp;&amp;           | 
  2097        |     |  |     (ValData-&gt;ModuleIdx == ModuleIdx)){  | 
              |     |  +--+---------------------------------------+ 
              |     |     |  +----------------+ 
  2098        |     |     +--+ return ValIdx; | 
              |     |     |  +----------------+ 
              |     |   +-+---+ 
  2099        |     |   |  }  | 
              |     |   +-----+ 
              |   +-+---+ 
  2100        |   |  }  | 
              |   +-----+ 
              |  +------------------------------------------------------------+ 
  2101        +--+ for(ValIdx = 0 ; ValIdx &lt; ValDataList-&gt;Count ; ValIdx++){  | 
              |  +--+---------------------------------------------------------+ 
  2102        |     +--- ValData = (TValData *)ValDataList-&gt;Items[ValIdx];
              |     |  +------------------------------------------------------------------------+ 
  2103        |     +--+ if((ValData-&gt;Str == ValName)&amp;&amp;                                         | 
  2104        |     |  |     ((ValData-&gt;ModuleIdx == ModuleIdx)||(ValData-&gt;BrNestLevel == 0))){ | 
              |     |  +--+---------------------------------------------------------------------+ 
              |     |     |  +----------------+ 
  2105        |     |     +--+ return ValIdx; | 
              |     |     |  +----------------+ 
              |     |   +-+---+ 
  2106        |     |   |  }  | 
              |     |   +-----+ 
              |   +-+---+ 
  2107        |   |  }  | 
              |   +-----+ 
              |  +------------+ 
  2108        +--+ return -1; | 
              |  +------------+ 
            +-+---+ 
  2109      |  }  | 
            +-----+ 
</pre>


</body>
</html>
