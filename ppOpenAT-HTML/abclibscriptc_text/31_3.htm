
<html>
<head>
<title>AddSubFuncDef_Fortran 関数説明</title><base target="main">
<link rel ="stylesheet" type="text/css" href="stylesheet.css" title="stylesheet">
<meta http-equiv="Content-Type" content="text/html;charset=Shift_JIS">
</head>

<body bgcolor="#ffffff">

<div align="right"><font size="2">ABCLibScriptC プロジェクト</font></div>

<table width=100% bgcolor="#e6e6fa" class="titlebgcolor" border="1" cellpadding="7" cellspacing="0">
<tr>
    <td><font class="titlefont">21.3. AddSubFuncDef_Fortran 関数説明</font></td>
</tr>
</table>

<p></p>
<table border="1">
<tr><th align="left" nowrap>関数名</th>        <td nowrap>AddSubFuncDef_Fortran</td></tr>
<tr><th align="left" nowrap>定義ファイル名</th><td nowrap>pass2.cpp</td></tr>
<tr><th align="left" nowrap>定義行</th>        <td nowrap>959</td></tr>
<tr><th align="left" nowrap>宣言形式</th>      <td nowrap>void AddSubFuncDef_Fortran ( TList * TokenList , int sPos , int ePos , TList * ValDataList )</td></tr>
<tr><th align="left" nowrap>概要</th>          <td nowrap>SUBROUTINE , FUNCTIONの文（行）の処理を行う。<br>引数のValDataを生成して、 ValDataに ArgF=trueをセットする。</td></tr>
<tr><th align="left" nowrap>戻り値</th>        <td nowrap>なし</td></tr>
<tr><th align="left" nowrap>パラメタ説明</th>  <td nowrap>TokenList   処理するトークンリスト<br>sPos    TokenList上での開始位置<br>ePos    TokenList上での終了位置<br>ValDataList 変数データリスト</td></tr>
<tr><th align="left" nowrap>機能説明</th>      <td nowrap>SUBROUTINE , FUNCTIONの文（行）の処理を行う。<br>出現した変数名をValDataListに追加する。この時ValDataにArgF=trueをセットし<br>て、サブルーチンやＦｕｎｃｔｉｏｎの引数として変数が使われていることを設定<br>する。</td></tr>
<tr><th align="left" nowrap>備考</th>          <td nowrap></td></tr>
</table>

<p></p>
呼出し元関数一覧表
<table border="1">
<tr>
<th nowrap>№</th>
<th nowrap>名称</th>
<th nowrap>定義ファイル名</th>
<th nowrap>定義行</th>
</tr>
<tr>
<td nowrap>1</td>
<td nowrap><a href="31_18.htm">Pass2_Fortran</a></td>
<td nowrap><a href="5_3.htm">pass2.cpp</a></td>
<td nowrap><a href="31_18.htm">292</a></td>
</tr>
</table>

<p></p>
呼出し先関数一覧表
<table border="1">
<tr>
<th nowrap>№</th>
<th nowrap>名称</th>
<th nowrap>定義ファイル名</th>
<th nowrap>定義行</th>
</tr>
<tr>
<td nowrap>1</td>
<td nowrap>TList::Add</td>
<td nowrap><a href="5_16.htm">VCL_Lib.h</a></td>
<td nowrap>64</td>
</tr>
<tr>
<td nowrap>2</td>
<td nowrap>LowerCase</td>
<td nowrap><a href="5_16.htm">VCL_Lib.h</a></td>
<td nowrap>109</td>
</tr>
<tr>
<td nowrap>3</td>
<td nowrap>Trim</td>
<td nowrap><a href="5_16.htm">VCL_Lib.h</a></td>
<td nowrap>105</td>
</tr>
</table>

<p></p>
参照外部変数一覧表
<table border="1">
<tr>
<th nowrap>№</th>
<th nowrap>名称</th>
<th nowrap>定義ファイル名</th>
<th nowrap>定義行</th>
</tr>
<tr>
<td nowrap>1</td>
<td nowrap>ImplType</td>
<td nowrap><a href="5_3.htm">pass2.cpp</a></td>
<td nowrap>59</td>
</tr>
</table>

<p></p>
参照先一覧表
<table border="1">
<tr>
<th nowrap>№</th>
<th nowrap>名称</th>
<th nowrap>種別</th>
<th nowrap>定義ファイル名</th>
<th nowrap>定義行</th>
</tr>
<tr>
<td nowrap>1</td>
<td nowrap><a href="16_1_1.htm">TList</a></td>
<td nowrap>クラス</td>
<td nowrap><a href="5_16.htm">VCL_Lib.h</a></td>
<td nowrap><a href="16_1_1.htm">57</a></td>
</tr>
<tr>
<td nowrap>2</td>
<td nowrap><a href="16_9_1.htm">TToken</a></td>
<td nowrap>クラス</td>
<td nowrap><a href="5_10.htm">pass1.h</a></td>
<td nowrap><a href="16_9_1.htm">294</a></td>
</tr>
<tr>
<td nowrap>3</td>
<td nowrap><a href="16_11_1.htm">TValData</a></td>
<td nowrap>クラス</td>
<td nowrap><a href="5_11.htm">pass2.h</a></td>
<td nowrap><a href="16_11_1.htm">106</a></td>
</tr>
</table>

<p></p>
<pre>
関数論理チャート

        |  +------------------------------------------------------------------------------------+ 
   959  +--+ void AddSubFuncDef_Fortran(TList *TokenList,int sPos,int ePos,TList *ValDataList)  | 
   960     | {                                                                                  | 
           +--+---------------------------------------------------------------------------------+ 
   961        +--- int i,j;
   962        +--- TToken *Token;
   963        +--- int TokId;
   964        +--- string TokStr,ValName;
   965        |    
   966        +--- //  for(i = sPos ; i &lt;= ePos ; i++){
              |  +----------------------------------+ 
   967        +--+ for(i = sPos ; i &lt; ePos ; i++){  | 
              |  +--+-------------------------------+ 
   968        |     +--- Token = (TToken *)TokenList-&gt;Items[i];
   969        |     +--- TokId = Token-&gt;TokId;
   970        |     +--- TokStr = Token-&gt;Str;
   971        |     |    
              |     |  +------------------------------------------+ 
   972        |     +--+ if(TokId == tid_LineEnd){   // １行終了  | 
              |     |  +--+---------------------------------------+ 
              |     |     |  +--------+ 
   973        |     |     +--+ break; | 
              |     |     |  +--------+ 
              |     |   +-+---+ 
   974        |     |   |  }  | 
              |     |   +-----+ 
   975        |     +--- //        if(TokId != -1){  // 変数トークンのみが対象
              |     |  +----------------------------------------------------+ 
   976        |     +--+ if(TokId != tid_Val){   // 変数トークンのみが対象  | 
              |     |  +--+-------------------------------------------------+ 
              |     |     |  +------------+ 
   977        |     |     +--+ continue;  | 
              |     |     |  +------------+ 
              |     |   +-+---+ 
   978        |     |   |  }  | 
              |     |   +-----+ 
   979        |     +--- //
   980        |     |    // すでに、同じMoudelIdxで、宣言されている同名変数があるかを調べる。     
   981        |     |    // あれば、追加しない。（型の一致かどうかの判定は、コンパパイラまかせ）  
   982        |     |    //                                                                       
   983        |     +--- TValData *ValData;
   984        |     +--- bool NewValDataF = true;
   985        |     |    
   986        |     +--- ValName = Trim(TokStr);
              |     |  +--------------------------------------------+ 
   987        |     +--+ for(j = 0 ; j &lt; ValDataList-&gt;Count ; j++){ | 
              |     |  +--+-----------------------------------------+ 
   988        |     |     +--- ValData = (TValData *)ValDataList-&gt;Items[j];
   989        |     |     +--- //          if((AnsiCompareText(ValData-&gt;Str,ValName) == 0)&amp;&amp;
              |     |     |  +------------------------------------------------------+ 
   990        |     |     +--+ if((LowerCase(ValData-&gt;Str) == LowerCase(ValName))&amp;&amp; | 
   991        |     |     |  |     (ValData-&gt;ModuleIdx == Token-&gt;ModuleIdx)){       | 
              |     |     |  +--+---------------------------------------------------+ 
   992        |     |     |     +--- NewValDataF = false;
              |     |     |     |  +--------+ 
   993        |     |     |     +--+ break; | 
              |     |     |     |  +--------+ 
              |     |     |   +-+---+ 
   994        |     |     |   |  }  | 
              |     |     |   +-----+ 
              |     |   +-+---+ 
   995        |     |   |  }  | 
              |     |   +-----+ 
   996        |     +--- //
   997        |     |    // 変数リストに追加する。  
   998        |     |    //                         
              |     |  +------------------+ 
   999        |     +--+ if(NewValDataF){ | 
              |     |  +--+---------------+ 
  1000        |     |     +--- ValData = new TValData(ValName);
  1001        |     |     +--- ValDataList-&gt;Add((void *)ValData);
  1002        |     |     +--- ValData-&gt;ModuleIdx = Token-&gt;ModuleIdx;
  1003        |     |     +--- ValData-&gt;DataType = ImplType[(int)ValName[0]]; // 暗黙の宣言
  1004        |     |     +--- ValData-&gt;DefPos = -1;
  1005        |     |     +--- ValData-&gt;ArgF = true;   // ArgFをセット
              |     |   +-+---+ 
  1006        |     |   |  }  | 
              |     |   +-+---+ 
              |     |   +-+-------+ 
  1006        |     |   |  else{  | 
              |     |   +-+-------+ 
  1007        |     |     +--- ValData-&gt;ArgF = true;   // ArgFをセット
              |     |   +-+---+ 
  1008        |     |   |  }  | 
              |     |   +-----+ 
              |   +-+---+ 
  1009        |   |  }  | 
              |   +-----+ 
            +-+---+ 
  1010      |  }  | 
            +-----+ 
</pre>


</body>
</html>
