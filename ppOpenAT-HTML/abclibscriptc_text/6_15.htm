
<html>
<head>
<title>TuneRegion.h ˜_—ƒ`ƒƒ[ƒg</title><base target="main">
<link rel ="stylesheet" type="text/css" href="stylesheet.css" title="stylesheet">
<meta http-equiv="Content-Type" content="text/html;charset=Shift_JIS">
</head>

<body bgcolor="#ffffff">

<div align="right"><font size="2">ABCLibScriptC ƒvƒƒWƒFƒNƒg</font></div>

<table width=100% bgcolor="#e6e6fa" class="titlebgcolor" border="1" cellpadding="7" cellspacing="0">
<tr>
    <td><font class="titlefont">5.15. TuneRegion.h ˜_—ƒ`ƒƒ[ƒg</font></td>
</tr>
</table>

<p></p>
<pre>
ƒtƒ@ƒCƒ‹˜_—ƒ`ƒƒ[ƒg

     1  +--- ï»ƒ\/*=====================================================================*
     2  |     *                                                                     *           
     3  |     *   Software Name : ppOpen-AT                                         *           
     4  |     *         Version : 0.1                                               *           
     5  |     *                                                                     *           
     6  |     *   License                                                           *           
     7  |     *     This file is part of ppOpen-AT.                                 *           
     8  |     *     ppOpen-AT is a free software, you can use it under the terms    *           
     9  |     *     of The MIT License (MIT). See LICENSE file and User's guide     *           
    10  |     *     for more details.                                               *           
    11  |     *                                                                     *           
    12  |     *   ppOpen-HPC project:                                               *           
    13  |     *     Open Source Infrastructure for Development and Execution of     *           
    14  |     *     Large-Scale Scientific Applications on Post-Peta-Scale          *           
    15  |     *     Supercomputers with Automatic Tuning (AT).                      *           
    16  |     *                                                                     *           
    17  |     *   Organizations:                                                    *           
    18  |     *     The University of Tokyo                                         *           
    19  |     *       - Information Technology Center                               *           
    20  |     *       - Atmosphere and Ocean Research Institute (AORI)              *           
    21  |     *       - Graduate School of Interdisciplinary Information Studies    *           
    22  |     *         /Earthquake Research Institute (ERI)                        *           
    23  |     *       - Graduate School of Frontier Science                         *           
    24  |     *     Kyoto University                                                *           
    25  |     *       - Academic Center for Computing and Media Studies             *           
    26  |     *     Japan Agency for Marine-Earth Science and Technology (JAMSTEC)  *           
    27  |     *                                                                     *           
    28  |     *   Sponsorship:                                                      *           
    29  |     *     Japan Science and Technology Agency (JST), Basic Research       *           
    30  |     *     Programs: CREST, Development of System Software Technologies    *           
    31  |     *     for post-Peta Scale High Performance Computing.                 *           
    32  |     *                                                                     *           
    33  |     *   Copyright (c) 2012                                                *           
    34  |     *      Information Technology Center, The University of Tokyo         *           
    35  |     *                                                                     *           
    36  |     *=====================================================================*/          
    37  |     /*----------------------------------------------------------------------------*/  
    38  |    //                                                                                 
    39  |    //  æ¦‚èƒ’                                                                        
    40  |    //    ãƒãƒ¥ãƒƒVãƒ‹ãƒ³ã‚[ãƒƒFãƒƒVã‚ƒNãƒƒ@ãƒƒEã‚ƒbãƒƒDã‚ƒPã€€ãƒ˜ãƒƒãƒ€             
    41  |    //                                                                                 
    42  |    //  ä½œæˆè€…                                                                      
    43  |    //                                                                                 
    44  |    /*----------------------------------------------------------------------------*/   
    45  |                                                                                       
    46  +--- #include &quot;main.h&quot;
    47  |    
    48  +--- #ifndef TuneRegionH
    49  +--- #define TuneRegionH
    50  |    
    51  +--- //---------------------------------------------------------------------------
    52  |    //                                                                                         
    53  |    // å„ãƒãƒEãƒƒVãƒ‹ãƒ³ã‚[ãƒƒFãƒƒVã‚ƒNãƒƒ@ãƒƒEã”ã¨ãƒHç”Ÿæˆã•ã‚Œã‚‹ã‚¯ãƒƒDã‚ƒP        
    54  |    // ã“ã‚Œã‚’å…ƒãƒH Pass5ãƒ@ã‚ƒXãƒƒVã‚ƒPã‚ƒEãƒƒVãƒ‰ãŒç”Ÿæˆã•ã‚Œã‚‹åƒXuå¼ã«å¤‰æ›´    
    55  |    // TuneRegionListãƒHè¿ƒXåŠ ã•ã‚Œã‚‹ã€‚                                                   
    56  |    //                                                                                         
    57  |    // ç”Ÿæˆãƒbã€Pass4ãƒ@ãƒ‡ã‚ƒXãƒƒVã‚ƒPã‚’ã‚¹ã‚ƒ…ãƒvãƒƒEã™ã‚‹å½uãƒ@è¡Œã‚ã‚Œã‚‹ã€‚   
    58  |    //                                                                                         
    59  |    /*----------------------------------------------------------------------------*/           
    60  |    //  1.æ—Eæœƒƒèªå                                                                       
    61  |    //                                                                                         
    62  |    //  2.æ¦‚èƒ’                                                                              
    63  |    //    ãƒãƒ¥ãƒƒVãƒ‹ãƒ³ã‚[ã‚[ãƒƒHãƒƒVãƒ—çƒBƒ‡é¡                                          
    64  |    //                                                                                         
    65  |    //  3.æ©Ÿèƒ½èªƒƒæ˜                                                                        
    66  |    //                                                                                         
    67  |    //  4.å‚™è€ƒ                                                                               
    68  |    //                                                                                         
    69  |    /*----------------------------------------------------------------------------*/           
        |  +--------------------+ 
    70  +--+ enum TTuneGroup {  | 
        |  +--+-----------------+ 
    71  |     +--- tgInstall,
    72  |     |    tgStatic,  
    73  |     |    tgDynamic, 
        |   +-+---+ 
    74  |   |  }; | 
        |   +-----+ 
    75  |    
    76  +--- /*----------------------------------------------------------------------------*/
    77  |    //  1.æ—Eæœƒƒèªå                                                             
    78  |    //                                                                               
    79  |    //  2.æ¦‚èƒ’                                                                    
    80  |    //    ãƒãƒ¥ãƒƒVãƒ‹ãƒ³ã‚[ç¨ƒ‡é¡                                                
    81  |    //                                                                               
    82  |    //  3.æ©Ÿèƒ½èªƒƒæ˜                                                              
    83  |    //                                                                               
    84  |    //  4.å‚™è€ƒ                                                                     
    85  |    //                                                                               
    86  |    /*----------------------------------------------------------------------------*/ 
        |  +------------------+ 
    87  +--+ enum TTuneKind { | 
        |  +--+---------------+ 
    88  |     +--- tkDefine,
    89  |     |    tkVariable,                                                                                      
    90  |     |    tkSelect,                                                                                        
    91  |     |    tkUnroll,                                                                                        
    92  |     |    tkLoopFusionSplit,                                                                               
    93  |     |    tkLoopFusion,                                                                                    
    94  |     |    tkLoopSplit,                                                                                     
    95  |     |    tkRotationOrder,                                                                                 
    96  |     |                                                                                                     
    97  |     |    tkList,             // Add 2012/02/26                                                            
    98  |     |    tkVariableD,                                                                                     
    99  |     |    tkListD,                                                                                         
   100  |     |    tkReplace,                                                                                       
   101  |     |    tkGWV,                                                                                           
   102  |     |    tkList_End,         // Listç¨ƒ‡é¡ã®çµ‚ã‚ã‚Šã‚’ç¤ƒRã™èƒ…˜åˆ¥ç”ƒBã€‚äƒXƒ\ç”ƒBãƒbã—ãªã„ã€‚  
        |   +-+---+ 
   103  |   |  }; | 
        |   +-----+ 
   104  +--- /*----------------------------------------------------------------------------*/
   105  |    //  1.æ—Eæœƒƒèªå                                                             
   106  |    //                                                                               
   107  |    //  2.æ¦‚èƒ’                                                                    
   108  |    //    ã‚ƒIãƒ–ãƒªãƒƒVã‚ƒNãƒƒ@ãƒƒEç¨ƒ‡é¡                                          
   109  |    //                                                                               
   110  |    //  3.æ©Ÿèƒ½èªƒƒæ˜                                                              
   111  |    //                                                                               
   112  |    //  4.å‚™è€ƒ                                                                     
   113  |    //                                                                               
   114  |    /*----------------------------------------------------------------------------*/ 
        |  +------------------------+ 
   115  +--+ enum TSubRegionKind {  | 
        |  +--+---------------------+ 
   116  |     +--- srSelect                            // ã‚ƒIãƒ–ãƒªãƒƒVã‚ƒNãƒƒ@ãƒƒEç¨ƒ‡é¡
        |   +-+-----------------------------------------+ 
   117  |   |  };  // ã‚ƒIãƒ–ãƒªãƒƒVã‚ƒNãƒƒ@ãƒƒEç¨ƒ‡é¡ | 
   118  |   |                                           | 
        |   +-------------------------------------------+ 
   119  +--- /*----------------------------------------------------------------------------*/
   120  |    //  1.æ—Eæœƒƒèªå                                                             
   121  |    //                                                                               
   122  |    //  2.æ¦‚èƒ’                                                                    
   123  |    //    GPUç¨ƒ‡é¡                                                                 
   124  |    //                                                                               
   125  |    //  3.æ©Ÿèƒ½èªƒƒæ˜                                                              
   126  |    //    #Pragma ABCLib allocate ãƒ@æŒ‡åƒ‡šã•ã‚Œã‚‹ GPUã‚ƒFãƒ—ã‚·ãƒƒ@ãƒƒE         
   127  |    //                                                                               
   128  |    //  4.å‚™è€ƒ                                                                     
   129  |    //                                                                               
   130  |    /*----------------------------------------------------------------------------*/ 
        |  +--------------------+ 
   131  +--+ enum TGPUOption {  | 
        |  +--+-----------------+ 
   132  |     +--- gpu_option_None,    // GPUã‚ƒFãƒ—ã‚·ãƒƒ@ãƒƒEãƒFã—
   133  |     |    gpu_option_CPU,     // GPUã‚ƒFãƒ—ã‚·ãƒƒ@ãƒƒE CPU     
   134  |     |    gpu_option_GPU,     // GPUã‚ƒFãƒ—ã‚·ãƒƒ@ãƒƒE GPU     
   135  |     |    gpu_option_auto,    // GPUã‚ƒFãƒ—ã‚·ãƒƒ@ãƒƒE auto    
        |   +-+---+ 
   136  |   |  }; | 
        |   +-----+ 
   137  +--- /*----------------------------------------------------------------------------*/
   138  |    //  1.æ—Eæœƒƒèªå                                                                                                               
   139  |    //                                                                                                                                 
   140  |    //  2.æ¦‚èƒ’                                                                                                                      
   141  |    //    ãƒãƒ¥ãƒƒVãƒ‹ãƒ³ã‚[ãƒƒFãƒƒVã‚ƒNãƒƒ@ãƒƒEã‚ƒbãƒƒDã‚ƒP                                                                         
   142  |    //    å„ãƒãƒEãƒƒVãƒ‹ãƒ³ã‚[ãƒƒFãƒƒVã‚ƒNãƒƒ@ãƒƒEã”ã¨ãƒHç”Ÿæˆã•ã‚Œã€èƒ@væã«å¿œã˜ãƒ’ãƒ‡ãƒ¼ã‚ƒ\ãŒèƒBƒ…å®šã•ã‚Œã‚‹ã€‚  
   143  |    //    ã‚ƒXãƒƒVã‚ƒPç”Ÿæˆæ™‚ã«ãƒbã€ã“ãƒ‡ã‚ƒbãƒƒDã‚ƒPã‚’ã‚¢ã‚ƒbã‚ƒTã‚ƒPã—ã¦å‡ƒRåŠ›ã‚³ãƒƒVãƒ‰ãŒç”Ÿæˆã•ã‚Œã‚‹ã€‚             
   144  |    //                                                                                                                                 
   145  |    //  3.æ©Ÿèƒ½èªƒƒæ˜                                                                                                                
   146  |    //                                                                                                                                 
   147  |    //  4.å‚™è€ƒ                                                                                                                       
   148  |    //                                                                                                                                 
   149  |    /*----------------------------------------------------------------------------*/                                                   
        |  +--------------------+ 
   150  +--+ class TTuneRegion{ | 
        |  +--+-----------------+ 
        |     +-----------+ 
   151  |     |  private: | 
        |     +-----------+ 
   152  |     +--- TPass4 *Pass4;
   153  |     |    
   154  |     +--- // UnRollãƒ@å…ƒAé€šåˆ©ç”ƒBã•ã‚Œã‚‹åA‰æ•°
   155  |     +--- int CaseIdx;
   156  |     +--- unsigned int UnRollDoRefValBits;            // Unrollå¯ƒZè±Bãƒ‡DOå¤‰æ•°Bit CaseIdxã”ã¨ãƒHå¤‰
   157  |     +--- // åŒ–
   158  |     +--- int UnrollCount[32];
   159  |     +--- int DoTokPos[32];
   160  |     +--- int EndDoTokPos[32];
   161  |     +--- string DoValStr[32];
   162  |     +--- string DoVal_m[32];
   163  |     +--- string DoVal_i[32];
   164  |     +--- string DoVal_l[32];
   165  |     +--- string DoValName[32];
   166  |     +--- int DoValIdx;
   167  |     +--- int DoValCount;
   168  |     +--- char Comment;
   169  |     |    
   170  |     +--- void OutputLoopFusionExecCode_Fortran(FILE *fp);
   171  |     +--- void OutputUnrollExecCode_Fortran(FILE *fp);
   172  |     +--- void OutputLoopFusionExecCode_C(FILE *fp,FILE *fpOutHeader);
   173  |     +--- void OutputUnrollExecCode_C(FILE *fp,FILE *fpOutHeader);
   174  |     |    
   175  |     +--- string GetNewValName(string BaseName,int Idx,TStringList *ArgValList);
   176  |     +--- string GetNewValName(string BaseName,string AddStr,TStringList *ArgValList);
   177  |     +--- string GetNewValNameForValData(TValData *ValData,
   178  |     |            unsigned int UnRollDoRefValBits,int Idx,TStringList *ArgValList);  
   179  |     +--- int GetBitIdx(unsigned int Bits);
   180  |     +--- int GetValCountOfBit(unsigned int Bits,int *Count);
   181  |     +--- string ChangeFromOrgStr(string OrgStr,string Str);
   182  |     +--- int GetDoValAddValue(int kk,unsigned int UseValBits,int DoValIdx,int *Count);
   183  |     +--- //    int TTuneRegion::GetValAddValue(int kk,DWORD UseValBits,DWORD UseDoValBits,int DoValIdx,int *Count);
   184  |     +--- int GetValAddValue(int RefValIdx,unsigned int UseDoValBits,int DoValIdx,int *Count);
   185  |     +--- int GetValAddValue2(int RefValIdx,unsigned int RefDoValBits,
   186  |     |        unsigned int UnRollDoRefValBits,int DoValIdx,int *Count);  
   187  |     |    
   188  |     +--- //  string SepLongStr(string s);
   189  |     +--- void MakeArgValList();
   190  |     +--- int GetNextSemikoronPos(int sPos);
   191  |     +--- int FindEndDo2(TList *TokenList,int sPos);
   192  |     +--- int FindEndIf(TList *TokenList,int sPos);
   193  |     +--- string GetPrePostSubregionStr(int Mode);
   194  |     |    
        |     +-----------------------------------------+ 
   195  |     |  public:     // ãƒƒ’ãƒƒVã‚ƒJãƒƒVå®vè¨€ | 
        |     +-----------------------------------------+ 
   196  |     +--- TList *TokenList;
   197  |     +--- TList *ValDataList;
   198  |     +--- int TokenStartPos;                  // é–‹åƒ@‹ãƒˆãƒƒVã‚ƒbãƒƒEä½çƒXƒ‡ï¼ˆPass4å†…å‚ç…ƒ@)
   199  |     +--- int TokenEndPos;                    // çµ‚äƒR†ãƒˆãƒƒVã‚ƒbãƒƒEä½çƒXƒ‡
   200  |     |                                                                           
   201  |     +--- string Name;                    // åå‰ name ãƒ@æŒ‡åƒ‡šã•ã‚Œã‚‹ã€‚
   202  |     +--- string FuncName;                // å‘ƒVãƒEå‡ƒRã—é–¢æ•[ãƒƒTã‚ƒIãƒ–ãƒ«ãƒƒVãƒãƒ³å
   203  |     +--- string RefValStr;               // ãƒ‡ãƒãƒƒã‚°ç”ƒBï¼ˆåA‰æ•°å‚ç…§æ–‡åƒ…—åˆ—ãƒƒFã‚ƒPãƒˆïƒV‰
   204  |     +--- TTuneGroup TuneGroup;
   205  |     +--- string TuneGroupName;           // Install,Static.Dynamic
   206  |     +--- TTuneKind TuneKind;
   207  |     |    
   208  |     +--- bool UseAccordingF;                 // Sub Regionã‚’å«ã‚ã¦ AccordingæŒ‡åƒ‡šã‚ã‚Š
   209  |     |                                        // ã€‚                                           
   210  |     +--- string AccordingStr;            // Accordingãƒ@æŒ‡åƒ‡šã•ã‚ŒãŸã€€æ•[å¼
   211  |     +--- bool UsedDynPefThis;                // DynPefThisã‚ƒPã‚ƒbãƒƒFãƒ—ãƒˆãŒäƒXƒ\ç”ƒBã•ã‚ŒãŸã€‚
   212  |     |                                        // Dynamicãƒ@å‘ƒVãƒEå‡ƒRã—æ™‚ãƒ‡ setParam()ã‚’ã‚¹ã‚ƒ…ãƒƒ   
   213  |     |                                        // ãƒ—                                                         
   214  |     +--- int Number;                         // ã‚ƒPã‚ƒbãƒƒFãƒ—ãƒˆNumberãƒ@ãƒ‡æŒ‡åƒ‡š
   215  |     |                                                                                   
   216  |     +--- TStringList *ArgValList;            // ã‚ƒIãƒ–ãƒ«ãƒƒVãƒãƒ³ãƒHã™ã‚‹å ƒGåˆã®å¼•æ•°ãƒƒFã‚ƒPãƒˆ
   217  |     +--- TList *UndefinedArgValList;         // å®šçƒZƒDãŒèƒ’‹ã¤ã‹ã‚‰ãƒFã„åƒV•æ•°ãƒ‡ãƒ¼ã‚ƒ\
   218  |     +--- int CaseCount;                      // ãƒƒFãƒƒVã‚ƒNãƒƒ@ãƒƒEå†…ã®è‡ƒFå‹•ãƒãƒEãƒƒVãƒ‹ãƒ³ã‚[ãŒå–ã‚Šã†ã‚‹çƒBƒ‡é¡æ•°
   219  |     +--- TList *ValBitsList;                 // ValData-&gt;Bitsä¿æŒç”ƒB
   220  |     +--- TList *SubRegionList;               // ã‚ƒIãƒ–ãƒªãƒƒVã‚ƒNãƒƒ@ãƒƒEãƒƒFã‚ƒPãƒˆ TSubRegion ã‚ƒbãƒƒDã‚ƒP
   221  |     |                                        // Select sub region ãƒFãƒD                                    
   222  |     |                                                                                                         
   223  |     +--- string OffsetStr;
   224  |     |    
   225  |     +--- TStringList *BaseValList;           // åŸƒRæœƒƒãƒ‘ãƒ©ãƒBãƒƒVã‚ƒ\åã®å¤‰æ•°ãƒƒFã‚ƒPãƒˆ Add 2009/03/05
   226  |     |                                        // BPset(N) ã‚„ BPset(N,NX)ãƒFãƒDãƒ@è¨ƒ…å®šã•ã‚Œã‚‹ã€‚           
   227  |     |                                        // å¤‰æ•°å+ValDataãƒNãƒ‡ãƒã‚¤ãƒƒEã‚ƒ\                           
   228  |     |                                        // ãƒƒFãƒƒVã‚ƒNãƒƒ@ãƒƒEãƒ‡ãƒ¼ã‚ƒ\ä½œæˆæ™‚ã«ã‚ƒTãƒƒãƒˆã•ã‚Œã‚‹ã€‚  
   229  |     +--- TStringList *ParamValList;          // ãƒ‘ãƒ©ãƒBãƒƒVã‚ƒ\æ–‡ã®å¤‰æ•°ãƒƒFã‚ƒPãƒˆ
   230  |     |                                                                                     
   231  |     +--- //
   232  |     |    // varid (xx[,xx]) from X to Y ãƒ‡æŒ‡åƒ‡šæƒ…å ƒA (variedæŒ‡åƒ‡šæ™‚ãƒHæœ‰åŠ¹) 
   233  |     |    //                                                                             
   234  |     +--- int variedCount;
   235  |     +--- string variedValName[32];       // å¤‰æ•°å ï¼ˆåƒ\…é ˆïƒV‰
   236  |     +--- /**************************************************************************/
   237  |     |    //                                                                           
   238  |     |    //Kogakuin Irie                                                              
   239  |     |    //å®Ÿæ•°å¯ƒZå¿œã®ãŸã‚ãƒ‡å¤‰æ›´                                           
   240  |     |    //æ—uå­˜ã‚³ãƒƒVãƒ‰ã¯ã‚ƒEãƒBãƒƒEãƒˆã‚¢ã‚ƒ’ãƒˆ                              
   241  |     |    //                                                                           
   242  |     |    //  int variedFromValue[32];            // é–‹åƒ@‹å€A                       
   243  |     |    //  int variedToValue[32];              // çµ‚äƒR†å€A                       
   244  |     +--- float variedFromValue[32];          // é–‹åƒ@‹å€A
   245  |     +--- float variedToValue[32];            // çµ‚äƒR†å€A
   246  |     +--- float variedStepValue[32];          // å¢—åˆ†ï¼ˆé–“éš”ïƒV‰å€A
   247  |     +--- //
   248  |     |    //å¤‰æ›´ã“ã“ãƒZãƒ@                                                       
   249  |     |    //                                                                           
   250  |     |    /**************************************************************************/ 
   251  |     +--- void *variedValData[32];            // å¤‰æ•°ãƒNãƒ‡ãƒã‚¤ãƒƒEã‚ƒ\
   252  |     |                                                                         
   253  |     |                                                                         
   254  |     +--- //
   255  |     |    //  variedDç”ƒBå¤‰æ•° Add 2016/03/01 
   256  |     |    //                                   
   257  |     +--- int variedDCount;
   258  |     +--- string variedDValName[32];      // å¤‰æ•°å ï¼ˆåƒ\…é ˆïƒV‰
   259  |     +--- float variedDFromValue[32];         // é–‹åƒ@‹å€A
   260  |     +--- float variedDToValue[32];           // çµ‚äƒR†å€A
   261  |     +--- float variedDStepValue[32];         // å¢—åˆ†ï¼ˆé–“éš”ïƒV‰å€A
   262  |     +--- void *variedDValData[32];           // å¤‰æ•°ãƒNãƒ‡ãƒã‚¤ãƒƒEã‚ƒ\
   263  |     |                                                                         
   264  |     +--- //
   265  |     |    // Fittingãƒ‡ãŸã‚ãƒ‡ãƒ‡ãƒ¼ã‚ƒ\ 
   266  |     |    //                                 
   267  |     +--- //d-splineç”ƒBè¿ƒXåŠ éƒƒBåˆ†
   268  |     +--- int FittingDspline;
   269  |     +--- int FittingDynamic;
   270  |     +--- //d-splineç”ƒBè¿ƒXåŠ éƒƒBåˆ†ã“ã“ã¾ãƒ@
   271  |     +--- int FittingType;                    // Type = 0:ãƒFã—ã€1:least-square,2:user_
   272  |     |                                        // defined                                   
   273  |     +--- int FittingDegree;                  // å¤šé …åƒVã®æ¬Bæ•[
   274  |     +--- TList *SampledList;                 // intãƒ‡å½uãƒ@ Sampledãƒ‡å€AãŒã‚»ãƒƒãƒˆï¼ˆåƒ‡ŸäƒX“ã¯
   275  |     |                                        // ã€Scriptãƒ‡ãƒ‡ãƒ¼ã‚ƒ\ï¼‰                                
   276  |     |                                                                                                     
   277  |     +--- //
   278  |     |    //  GPUãƒ‡ãŸã‚ãƒ‡ãƒ‡ãƒ¼ã‚ƒ\ 2010/12/28 è¿ƒXåŠ  
   279  |     |    //                                                 
   280  |     +--- TGPUOption GPUOption;
   281  |     |    
   282  |     +--- //
   283  |     |    //  LoopFusionSplitãƒ‡ãŸã‚ãƒ‡ãƒ‡ãƒ¼ã‚ƒ\ 2012/03/07 
   284  |     |    //                                                     
   285  |     +--- int SplitPointCopyDef_StartPos;
   286  |     +--- int SplitPointCopyDef_EndPos;
   287  |     |    
   288  |     +--- //
   289  |     |    //  OptionæŒ‡åƒ‡šæ–‡å­—åˆ— 
   290  |     |    //                         
   291  |     +--- string OptionStr;
   292  |     |    
   293  |     +--- //
   294  |     |    // Selectãƒ‡è§væã‚’è¡Œã†  
   295  |     |    //                             
   296  |     +--- void MakeSelectData_Old(int sPos);  // ä»Eå‰ã®ãƒãƒ¼ã‚ƒNãƒƒ@ãƒƒE 2016/02/26
   297  |     +--- void MakeSelectData(int sPos);      // Replaceç­‰ã«å¯ƒZå¿œ
   298  |     +--- //
   299  |     |    //                                                                                                   
   300  |     |    // UnRollãƒ‡å ƒGåˆã®è§væçƒIæœ                                                                
   301  |     |    // Doãƒ‡Nestãƒbã€æœ€å¤ƒ@32ãƒZãƒ@ã‚’åƒbƒZè±BãƒBã™ã‚‹ã€‚(å…ƒã¯Pass4ãƒ@è§væã—ãƒ’ã„ãŸ)  
   302  |     |    //                                                                                                   
   303  |     +--- void MakeUnrollData(int sPos);
   304  |     |    
   305  |     +--- TToken *DoToken[32];                // Unrollãƒ‡ä¸€ç•ƒFå¤–å´ãƒ‡Doãƒˆãƒ¼ã‚ƒbãƒƒE
   306  |     +--- TToken *DoValToken[32];             // Doå¤‰æ•°
   307  |     +--- int DoStartSPos[32];                // Doãƒ‡åˆæœŸå€Aãƒ‡å¼
   308  |     +--- int DoStartEPos[32];
   309  |     +--- int DoEndSPos[32];                  // Doãƒ‡çµ‚ã‚ã‚Šå€Aãƒ‡å¼
   310  |     +--- int DoEndEPos[32];
   311  |     +--- int DoStepSPos[32];                 // Doãƒ‡å¢—åˆ†å€Aãƒ‡å¼
   312  |     +--- int DoStepEPos[32];
   313  |     |    
   314  |     +--- //
   315  |     |    //  LoopFusionãƒ‡è§væçƒIæœ 
   316  |     |    //                               
   317  |     +--- int FusionCount;
   318  |     |    
   319  |     +--- void MakeLoopFusionSplitData(int sPos);
   320  |     +--- TList *MakeRotaionOrderSrcTokenList();
   321  |     |    
   322  |     +--- TList *RotaionOrderList;    // RotationOrderãƒ‡ãƒƒFãƒƒVã‚ƒNãƒƒ@ãƒƒEãƒˆãƒ¼ã‚ƒbãƒƒEä½çƒXƒ‡
   323  |     |                                // å…ˆé ƒ…ãƒBæœ€å¾ŒãŒäºAäº’ã«å…Eã‚‹ã€‚                    
   324  |     |                                                                                               
   325  |     +--- //
   326  |     |    //  Replaseç­‰ã®è§væçƒIæœã€‚   
   327  |     |    //                                   
   328  |     +--- TStringList *ReplaceStrList;        // replaceæŒ‡åƒ‡šåƒ…ã§å®šçƒZƒDã•ã‚ŒãŸæ–‡å­—åˆ—ãƒƒFã‚ƒPãƒˆ
   329  |     +--- TStringList *TargetStrList;         // targeræŒ‡åƒ‡šåƒ…ã§å®šçƒZƒDã•ã‚ŒãŸæ–‡å­—åˆ—ãƒƒFã‚ƒPãƒˆã€‚æœ€å¾Œã®()ã‚’å«ã‚€å ƒGåˆã‚ã‚Šã€‚
   330  |     +--- TStringList *ListSrcStrList;        // listæŒ‡åƒ‡šåƒ…ã§å®šçƒZƒDã•ã‚ŒãŸçƒXƒ‡æ›ãˆå…ƒåA‰æ•°åãƒªã‚ƒPãƒˆ
   331  |     +--- TStringList *ListReplaceStrList;    // listæŒ‡åƒ‡šåƒ…ã§å®šçƒZƒDã•ã‚ŒãŸçƒXƒ‡æ›ãˆãƒƒFã‚ƒPãƒˆ ListSrcList*Nå€‹ã®è¦çƒG 
   332  |     +--- TStringList *ListDSrcStrList;       // listDæŒ‡åƒ‡šåƒ…ã§å®šçƒZƒDã•ã‚ŒãŸçƒXƒ‡æ›ãˆå…ƒåA‰æ•°åãƒªã‚ƒPãƒˆ
   333  |     +--- TStringList *ListDReplaceStrList;   // listDæŒ‡åƒ‡šåƒ…ã§å®šçƒZƒDã•ã‚ŒãŸçƒXƒ‡æ›ãˆãƒƒFã‚ƒPãƒˆ ListSrcList*Nå€‹ã®è¦çƒG 
   334  |     +--- TList *GWV_ListList;                // GWVå¤‰æ›ç”ƒBãƒ‡ãƒƒFã‚ƒPãƒˆã¸ãƒ‡ãƒƒFã‚ƒPãƒˆ
   335  |     +--- TStringList *GWV_TargetStrList;     // targeræŒ‡åƒ‡šåƒ…ã§å®šçƒZƒDã•ã‚ŒãŸæ–‡å­—åˆ—ãƒƒFã‚ƒPãƒˆã€‚æœ€å¾Œã®()ã‚’å«ã‚€å ƒGåˆã‚ã‚Šã€‚
   336  |     |                                                                                                                                             
   337  |     +--- //
   338  |     |    // Selectãƒ‡å ƒGåˆã®è§væçƒIæœ  
   339  |     |    //                                     
   340  |     |                                           
   341  |     +--- int GetNextKanmaPos(int sPos);
   342  |     +--- void ChackRefDoValF(int sPos,int ePos);
   343  |     +--- void AddArgValListToATExecArgList();
   344  |     +--- void SaveAndResetValBits(int sPos,int ePos);
   345  |     +--- void RestoreValBits(int sPos,int ePos);
   346  |     |    
   347  |     +--- TTuneRegion(TPass4 *aPass4,int Pos);        // ç”Ÿæˆ
   348  |     +--- ~TTuneRegion();         // ç ƒGæ£„
   349  |     |                                       
   350  |     +--- string GetInfo();   // æƒ…å ƒAã‚’æ”¹è¡Œå…¥ã‚Šæ–‡å­—åˆ—ãƒ@æ‰€å¾—ïƒVˆãƒ‡ãƒãƒƒã‚[ç”ƒBï¼‰
   351  |     |                                                                                             
   352  |     +--- void OutputSetParamCode_Fortran(FILE *fp,int TempLineNo,FILE *fpAdd);
   353  |     +--- void OutputSetParamCode_C(FILE *fp,int TempLineNo);
   354  |     +--- void OutputAutoExecCode_Fortran(FILE *fp);
   355  |     +--- void OutputAutoExecCode_C(FILE *fp,FILE *fpOutHeader);
   356  |     +--- void OutputExecCode_Fortran(FILE *fp);
   357  |     +--- void OutputExecCode_C(FILE *fp,FILE *fpOutHeader);
   358  |     +--- //  void TTuneRegion::OutputSrcCode(FILE *fp,AnsiString IndentStr,bool InCaseF);
   359  |     +--- void OutputSrcCode(FILE *fp, string IndentStr, int OutMode,int Use_OAT_functuonNameF = 0);
   360  |     +--- void OutputSelectCaseExecCode_Fortran(FILE *fp,int iusw1);
   361  |     +--- void OutputSelectCaseExecCode_C(FILE *fp,int iusw1);
   362  |     |    
   363  |     +--- void OutputReplaceSrc(FILE *fp,void *TargetSubRegion,int iusw1,bool Skip_Pragma_ACCF);
   364  |     |    
   365  |     +--- //  int OutputUnroll_DoBlock_Fortran(FILE *fp,int TokPos,unsigned int UseDoRefValBits,int RefValIdx);
   366  |     +--- int OutputUnroll_DoBlock_Fortran(FILE *fp, int TokPos,
   367  |     |        unsigned int UsedDoRefValBits, int RefValIdx,string CommentStrBeforeDo = &quot;&quot;);  
   368  |     +--- int OutputUnroll_DoBlock_C(FILE *fp,int TokPos,
   369  |     |        unsigned int UseDoRefValBits,int RefValIdx,string CommentStrBeforeDo = &quot;&quot;);  
   370  |     +--- int OutputUnroll_IfBlock_Fortran(FILE *fp,int TokPos,unsigned int UsedDoRefValBits,int RefValIdx);
   371  |     +--- int OutputUnroll_IfBlock_C(FILE *fp,int TokPos,unsigned int UsedDoRefValBits,int RefValIdx);
   372  |     +--- int OutputUnroll_Line_Fortran(FILE *fp,int TokPos,unsigned int UseDoRefValBits,int RefValIdx);
   373  |     +--- int OutputUnroll_Line_C(FILE *fp,int TokPos,unsigned int UseDoRefValBits,int RefValIdx);
   374  |     |    
   375  |     +--- int CalNewRefValIdx(int RefValIdx,unsigned int UseDoRefValBits,
   376  |     |            int AndRefValIdx,unsigned int AndUseDoRefValBits,int *UnrollCount);  
   377  |     |    
   378  |     +--- //    AnsiString TTuneRegion::GetPrePostSubregionStr(int Mode);
   379  |     +--- string GetPrePostSubregionStr(int Mode,int InControlCode);
   380  |     +--- string GetPrePostBPSetSubregionStr(int Mode);
   381  |     +--- string Merge_Unroll_Line_C(string *BaseOutputStr,
   382  |     |        string LastOutputStr,string *CurLineStr,int AddOprStrPos); 
   383  |     |    
   384  |     +--- //  void OutputSetParmSrcCode(FILE *fp,string IndentStr);
   385  |     +--- void OutputSetParmSrcCode(FILE *fp, string IndentStr,int Use_OAT_functuonNameF = 0);
   386  |     +--- string ChangePragmaStr(string OrgStr,int TokPos,int EndTokPos,
   387  |     |            TStringList *NewValStrList);                           
   388  |     |    
   389  |     +--- bool IsATExecArg(void *ValData);
   390  |     +--- void OutputFusionDo_Fortran(string FusionValName,FILE *fp,int DoNest,int FusionIdx);
   391  |     +--- void OutputFusionDo_C(string FusionValName,FILE *fp,int DoNest,int FusionIdx);
   392  |     |    
        |   +-+---+ 
   393  |   |  }; | 
        |   +-----+ 
   394  +--- //
   395  |    // SubReguon Class                                                                                           
   396  |    //                                                                                                           
   397  |    /*----------------------------------------------------------------------------*/                             
   398  |    //  1.æ—Eæœƒƒèªå                                                                                         
   399  |    //                                                                                                           
   400  |    //  2.æ¦‚èƒ’                                                                                                
   401  |    //    ã‚ƒIãƒ–ãƒªãƒƒVã‚ƒNãƒƒ@ãƒƒEã‚ƒbãƒƒDã‚ƒP                                                                 
   402  |    //    ã‚ƒPã‚ƒbãƒƒFãƒ—ãƒˆãƒ@å®šçƒZƒDã•ã‚Œã‚‹ã‚µãƒ–ãƒªãƒƒVã‚ƒNãƒƒ@ãƒƒEãƒ‡ãƒ‡ãƒ¼ã‚ƒ\ãŒæ ƒVç´ã•ã‚Œã‚‹ã€‚   
   403  |    //    ã‚ƒPãƒ—ãƒªãƒƒãƒˆãƒ‡å ƒGåˆã«ã‚‚äƒXƒ\ç”ƒBã•ã‚Œã‚‹ã€‚                                                 
   404  |    //                                                                                                           
   405  |    //  3.æ©Ÿèƒ½èªƒƒæ˜                                                                                          
   406  |    //                                                                                                           
   407  |    //  4.å‚™è€ƒ                                                                                                 
   408  |    //                                                                                                           
   409  |    /*----------------------------------------------------------------------------*/                             
        |  +--------------------+ 
   410  +--+ class TSubRegion{  | 
        |  +--+-----------------+ 
        |     +-----------+ 
   411  |     |  public:  | 
        |     +-----------+ 
   412  |     +--- Enum_ScType ScType;                 // ç¨ƒ‡é¡ sub region start ãƒ@ãƒ‡å…ˆé ƒ…ã‚ƒ…ãƒƒVãƒƒbãƒƒVãƒ‰
   413  |     +--- int TokenStartPos;
   414  |     +--- int TokenEndPos;
   415  |     +--- string AccordingStr;            // Accordingãƒ@æŒ‡åƒ‡šã•ã‚ŒãŸã€€æ•[å¼
   416  |     |                                                                               
   417  |     +--- //
   418  |     |    // varid (xx[,xx]) from X to Y ãƒ‡æŒ‡åƒ‡šæƒ…å ƒA (variedæŒ‡åƒ‡šæ™‚ãƒHæœ‰åŠ¹) 
   419  |     |    //                                                                             
   420  |     +--- int CaseCount;
   421  |     |    
   422  |     +--- int variedCount;
   423  |     +--- string variedValName[32];       // å¤‰æ•°å ï¼ˆåƒ\…é ˆïƒV‰
   424  |     +--- /**************************************************************************/
   425  |     |    //                                                                           
   426  |     |    //Kogakuin Irie                                                              
   427  |     |    //å®Ÿæ•°å¯ƒZå¿œã®ãŸã‚ãƒ‡å¤‰æ›´                                           
   428  |     |    //æ—uå­˜ã‚³ãƒƒVãƒ‰ã¯ã‚ƒEãƒBãƒƒEãƒˆã‚¢ã‚ƒ’ãƒˆ                              
   429  |     |    //                                                                           
   430  |     |    //  int variedFromValue[32];            // é–‹åƒ@‹å€A                       
   431  |     |    //  int variedToValue[32];              // çµ‚äƒR†å€A                       
   432  |     +--- float variedFromValue[32];          // é–‹åƒ@‹å€A
   433  |     +--- float variedToValue[32];            // çµ‚äƒR†å€A
   434  |     +--- float variedStepValue[32];          // å¢—åˆ†ï¼ˆé–“éš”ïƒV‰å€A
   435  |     +--- //
   436  |     |    //å¤‰æ›´ã“ã“ãƒZãƒ@                                                       
   437  |     |    //                                                                           
   438  |     |    /**************************************************************************/ 
   439  |     +--- void *variedValData[32];        // å¤‰æ•°ãƒNãƒ‡ãƒã‚¤ãƒƒEã‚ƒ\
   440  |     |                                                                     
   441  |     +--- unsigned int SplitBitsOfFusionIdx[32];  // FusionIdxãƒHã‚ˆã‚‹ Splitæœ‰åŠ¹ç„BåŠƒPBits
   442  |     +--- // DoValãƒBåŒã˜ä¸ƒ’ãƒEãƒ‡BitsãƒHãƒFã‚‹ã€‚
   443  |     |    // ï¼’^Bitsæ•[ãŒå„FusionIdxãƒHãŠã‘ã‚‹Splitæ•[ãƒHãƒFã‚‹ã€‚   
   444  |     +--- int SplitCaseCountOfFusionIdx[32];      // FusionIdxãƒHã‚ˆã‚‹ SplitCaseæ•[
   445  |     |                                                                                 
   446  |     +--- TSubRegion();
   447  |     |    
        |   +-+---+ 
   448  |   |  }; | 
        |   +-----+ 
   449  |    
   450  +--- #endif
</pre>


</body>
</html>
