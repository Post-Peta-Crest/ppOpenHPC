
<html>
<head>
<title>MakeSelectData メンバ関数説明</title><base target="main">
<link rel ="stylesheet" type="text/css" href="stylesheet.css" title="stylesheet">
<meta http-equiv="Content-Type" content="text/html;charset=Shift_JIS">
</head>

<body bgcolor="#ffffff">

<div align="right"><font size="2">ABCLibScriptC プロジェクト</font></div>

<table width=100% bgcolor="#e6e6fa" class="titlebgcolor" border="1" cellpadding="7" cellspacing="0">
<tr>
    <td><font class="titlefont">14.10.28. MakeSelectData メンバ関数説明</font></td>
</tr>
</table>

<p></p>
<table border="1">
<tr><th align="left" nowrap>メンバ関数名</th>  <td nowrap>MakeSelectData</td></tr>
<tr><th align="left" nowrap>定義ファイル名</th><td nowrap>TuneRegion.cpp</td></tr>
<tr><th align="left" nowrap>定義行</th>        <td nowrap>308</td></tr>
<tr><th align="left" nowrap>所属名</th>        <td nowrap>TTuneRegion</td></tr>
<tr><th align="left" nowrap>アクセス属性</th>  <td nowrap>public</td></tr>
<tr><th align="left" nowrap>宣言形式</th>      <td nowrap>void MakeSelectData ( int sPos )</td></tr>
<tr><th align="left" nowrap>概要</th>          <td nowrap>Selectの解析を行う</td></tr>
<tr><th align="left" nowrap>戻り値</th>        <td nowrap></td></tr>
<tr><th align="left" nowrap>パラメタ説明</th>  <td nowrap>sPos    開始位置</td></tr>
<tr><th align="left" nowrap>機能説明</th>      <td nowrap></td></tr>
<tr><th align="left" nowrap>備考</th>          <td nowrap></td></tr>
</table>

<p></p>
呼出し元関数一覧表
<table border="1">
<tr>
<th nowrap>№</th>
<th nowrap>名称</th>
<th nowrap>定義ファイル名</th>
<th nowrap>定義行</th>
</tr>
<tr>
<td nowrap>1</td>
<td nowrap><a href="16_10_54.htm">TTuneRegion::TTuneRegion</a></td>
<td nowrap><a href="5_7.htm">TuneRegion.cpp</a></td>
<td nowrap><a href="16_10_54.htm">67</a></td>
</tr>
</table>

<p></p>
呼出し先関数一覧表
<table border="1">
<tr>
<th nowrap>№</th>
<th nowrap>名称</th>
<th nowrap>定義ファイル名</th>
<th nowrap>定義行</th>
</tr>
<tr>
<td nowrap>1</td>
<td nowrap>TList::Add</td>
<td nowrap><a href="5_16.htm">VCL_Lib.h</a></td>
<td nowrap>64</td>
</tr>
<tr>
<td nowrap>2</td>
<td nowrap><a href="16_10_3.htm">TTuneRegion::AddArgValListToATExecArgList</a></td>
<td nowrap><a href="5_7.htm">TuneRegion.cpp</a></td>
<td nowrap><a href="16_10_3.htm">2220</a></td>
</tr>
<tr>
<td nowrap>3</td>
<td nowrap>TStringList::Clear</td>
<td nowrap><a href="5_16.htm">VCL_Lib.h</a></td>
<td nowrap>87</td>
</tr>
<tr>
<td nowrap>4</td>
<td nowrap><a href="16_2_6.htm">TMainF::ErrMessage</a></td>
<td nowrap><a href="5_1.htm">main.cpp</a></td>
<td nowrap><a href="16_2_6.htm">767</a></td>
</tr>
<tr>
<td nowrap>5</td>
<td nowrap><a href="16_10_25.htm">TTuneRegion::MakeArgValList</a></td>
<td nowrap><a href="5_7.htm">TuneRegion.cpp</a></td>
<td nowrap><a href="16_10_25.htm">726</a></td>
</tr>
<tr>
<td nowrap>6</td>
<td nowrap><a href="16_10_53.htm">TTuneRegion::SaveAndResetValBits</a></td>
<td nowrap><a href="5_7.htm">TuneRegion.cpp</a></td>
<td nowrap><a href="16_10_53.htm">2130</a></td>
</tr>
<tr>
<td nowrap>7</td>
<td nowrap>IntToStr</td>
<td nowrap><a href="5_16.htm">VCL_Lib.h</a></td>
<td nowrap>107</td>
</tr>
<tr>
<td nowrap>8</td>
<td nowrap>atof</td>
<td nowrap><br></td>
<td nowrap><br></td>
</tr>
<tr>
<td nowrap>9</td>
<td nowrap>atoi</td>
<td nowrap><br></td>
<td nowrap><br></td>
</tr>
<tr>
<td nowrap>10</td>
<td nowrap>c_str</td>
<td nowrap><br></td>
<td nowrap><br></td>
</tr>
</table>

<p></p>
参照外部変数一覧表
<table border="1">
<tr>
<th nowrap>№</th>
<th nowrap>名称</th>
<th nowrap>定義ファイル名</th>
<th nowrap>定義行</th>
</tr>
<tr>
<td nowrap>1</td>
<td nowrap>MainF</td>
<td nowrap><a href="5_1.htm">main.cpp</a></td>
<td nowrap>53</td>
</tr>
</table>

<p></p>
参照メンバ変数一覧表
<table border="1">
<tr>
<th nowrap>№</th>
<th nowrap>名称</th>
<th nowrap>定義ファイル名</th>
<th nowrap>定義行</th>
</tr>
<tr>
<td nowrap>1</td>
<td nowrap>TTuneRegion::AccordingStr</td>
<td nowrap><a href="5_15.htm">TuneRegion.h</a></td>
<td nowrap>201</td>
</tr>
<tr>
<td nowrap>2</td>
<td nowrap>TTuneRegion::ArgValList</td>
<td nowrap><a href="5_15.htm">TuneRegion.h</a></td>
<td nowrap>207</td>
</tr>
<tr>
<td nowrap>3</td>
<td nowrap>TTuneRegion::CaseCount</td>
<td nowrap><a href="5_15.htm">TuneRegion.h</a></td>
<td nowrap>209</td>
</tr>
<tr>
<td nowrap>4</td>
<td nowrap>TTuneRegion::DoToken</td>
<td nowrap><a href="5_15.htm">TuneRegion.h</a></td>
<td nowrap>278</td>
</tr>
<tr>
<td nowrap>5</td>
<td nowrap>TTuneRegion::FittingDegree</td>
<td nowrap><a href="5_15.htm">TuneRegion.h</a></td>
<td nowrap>253</td>
</tr>
<tr>
<td nowrap>6</td>
<td nowrap>TTuneRegion::FittingDspline</td>
<td nowrap><a href="5_15.htm">TuneRegion.h</a></td>
<td nowrap>248</td>
</tr>
<tr>
<td nowrap>7</td>
<td nowrap>TTuneRegion::FittingDynamic</td>
<td nowrap><a href="5_15.htm">TuneRegion.h</a></td>
<td nowrap>249</td>
</tr>
<tr>
<td nowrap>8</td>
<td nowrap>TTuneRegion::FittingType</td>
<td nowrap><a href="5_15.htm">TuneRegion.h</a></td>
<td nowrap>251</td>
</tr>
<tr>
<td nowrap>9</td>
<td nowrap>TTuneRegion::FuncName</td>
<td nowrap><a href="5_15.htm">TuneRegion.h</a></td>
<td nowrap>193</td>
</tr>
<tr>
<td nowrap>10</td>
<td nowrap>TTuneRegion::Name</td>
<td nowrap><a href="5_15.htm">TuneRegion.h</a></td>
<td nowrap>192</td>
</tr>
<tr>
<td nowrap>11</td>
<td nowrap>TTuneRegion::Number</td>
<td nowrap><a href="5_15.htm">TuneRegion.h</a></td>
<td nowrap>205</td>
</tr>
<tr>
<td nowrap>12</td>
<td nowrap>TTuneRegion::SampledList</td>
<td nowrap><a href="5_15.htm">TuneRegion.h</a></td>
<td nowrap>254</td>
</tr>
<tr>
<td nowrap>13</td>
<td nowrap>TTuneRegion::SubRegionList</td>
<td nowrap><a href="5_15.htm">TuneRegion.h</a></td>
<td nowrap>211</td>
</tr>
<tr>
<td nowrap>14</td>
<td nowrap>TTuneRegion::TokenEndPos</td>
<td nowrap><a href="5_15.htm">TuneRegion.h</a></td>
<td nowrap>190</td>
</tr>
<tr>
<td nowrap>15</td>
<td nowrap>TTuneRegion::TokenList</td>
<td nowrap><a href="5_15.htm">TuneRegion.h</a></td>
<td nowrap>187</td>
</tr>
<tr>
<td nowrap>16</td>
<td nowrap>TTuneRegion::TokenStartPos</td>
<td nowrap><a href="5_15.htm">TuneRegion.h</a></td>
<td nowrap>189</td>
</tr>
<tr>
<td nowrap>17</td>
<td nowrap>TTuneRegion::TuneGroup</td>
<td nowrap><a href="5_15.htm">TuneRegion.h</a></td>
<td nowrap>195</td>
</tr>
<tr>
<td nowrap>18</td>
<td nowrap>TTuneRegion::UseAccordingF</td>
<td nowrap><a href="5_15.htm">TuneRegion.h</a></td>
<td nowrap>199</td>
</tr>
<tr>
<td nowrap>19</td>
<td nowrap>TTuneRegion::variedCount</td>
<td nowrap><a href="5_15.htm">TuneRegion.h</a></td>
<td nowrap>225</td>
</tr>
<tr>
<td nowrap>20</td>
<td nowrap>TTuneRegion::variedFromValue</td>
<td nowrap><a href="5_15.htm">TuneRegion.h</a></td>
<td nowrap>235</td>
</tr>
<tr>
<td nowrap>21</td>
<td nowrap>TTuneRegion::variedStepValue</td>
<td nowrap><a href="5_15.htm">TuneRegion.h</a></td>
<td nowrap>237</td>
</tr>
<tr>
<td nowrap>22</td>
<td nowrap>TTuneRegion::variedToValue</td>
<td nowrap><a href="5_15.htm">TuneRegion.h</a></td>
<td nowrap>236</td>
</tr>
<tr>
<td nowrap>23</td>
<td nowrap>TTuneRegion::variedValData</td>
<td nowrap><a href="5_15.htm">TuneRegion.h</a></td>
<td nowrap>242</td>
</tr>
<tr>
<td nowrap>24</td>
<td nowrap>TTuneRegion::variedValName</td>
<td nowrap><a href="5_15.htm">TuneRegion.h</a></td>
<td nowrap>226</td>
</tr>
</table>

<p></p>
参照先一覧表
<table border="1">
<tr>
<th nowrap>№</th>
<th nowrap>名称</th>
<th nowrap>種別</th>
<th nowrap>定義ファイル名</th>
<th nowrap>定義行</th>
</tr>
<tr>
<td nowrap>1</td>
<td nowrap><a href="16_5_1.htm">TScript</a></td>
<td nowrap>クラス</td>
<td nowrap><a href="5_12.htm">pass3.h</a></td>
<td nowrap><a href="16_5_1.htm">209</a></td>
</tr>
<tr>
<td nowrap>2</td>
<td nowrap><a href="16_6_1.htm">TScValData</a></td>
<td nowrap>クラス</td>
<td nowrap><a href="5_12.htm">pass3.h</a></td>
<td nowrap><a href="16_6_1.htm">170</a></td>
</tr>
<tr>
<td nowrap>3</td>
<td nowrap><a href="16_8_1.htm">TSubRegion</a></td>
<td nowrap>クラス</td>
<td nowrap><a href="5_15.htm">TuneRegion.h</a></td>
<td nowrap><a href="16_8_1.htm">375</a></td>
</tr>
<tr>
<td nowrap>4</td>
<td nowrap><a href="16_9_1.htm">TToken</a></td>
<td nowrap>クラス</td>
<td nowrap><a href="5_10.htm">pass1.h</a></td>
<td nowrap><a href="16_9_1.htm">294</a></td>
</tr>
</table>

<p></p>
<pre>
関数論理チャート

        |  +--------------------------------------------+ 
   308  +--+ void TTuneRegion::MakeSelectData(int sPos) | 
   309     | {                                          | 
           +--+-----------------------------------------+ 
   310        +--- int i,j,k,k2;
   311        +--- TToken *Token;
   312        +--- TScript *Script;
   313        +--- string s;
   314        +--- TScValData *ScValData;
   315        +--- string ScValName;
   316        +--- int Nest;
   317        +--- TSubRegion *SubRegion;
   318        +--- bool InSubRegionF = false;
   319        |    
   320        +--- Token = (TToken *)TokenList-&gt;Items[sPos];
   321        |    
   322        +--- //
   323        |    // 対象変数名を所得  
   324        |    //                   
   325        +--- ScValData = NULL;
   326        +--- ScValName = &quot;&quot;;
   327        +--- //
   328        |    // 名前、参照変数（Setが先の場合は、不要）を求める 
   329        |    //                                                 
   330        |    // Name指定なし時の対策 Add 2004/08/26             
   331        +--- Name = IntToStr(MainF-&gt;TuneRegionList-&gt;Count+1);
              |  +------------------------------+ 
   332        +--+ if(TuneGroup == tgInstall){  | 
              |  +--+---------------------------+ 
   333        |     +--- FuncName = &quot;OAT_Install&quot;+Name;
              |   +-+---+ 
   334        |   |  }  | 
              |   +-+---+ 
              |   +-+---------------------------------+ 
   334        |   |  else if(TuneGroup == tgStatic){  | 
              |   +-+---------------------------------+ 
   335        |     +--- FuncName = &quot;OAT_Static&quot;+Name;
              |   +-+---+ 
   336        |   |  }  | 
              |   +-+---+ 
              |   +-+---------------------------------+ 
   336        |   |  else if(TuneGroup == tgDynamic){ | 
              |   +-+---------------------------------+ 
   337        |     +--- FuncName = &quot;OAT_Dynamic&quot;+Name;
              |   +-+---+ 
   338        |   |  }  | 
              |   +-----+ 
   339        +--- Nest = 0;
   340        +--- ArgValList-&gt;Clear();
              |  +------------------------------------------+ 
   341        +--+ for(i = sPos ; i &lt;= TokenEndPos ; i++){  | 
              |  +--+---------------------------------------+ 
   342        |     +--- Token = (TToken *)TokenList-&gt;Items[i];
              |     |  +----------------+ 
   343        |     +--+ if(Nest != 1){ | 
              |     |  +--+-------------+ 
   344        |     |     +--- //
   345        |     |     |    // TRのネストは、Skipするが、                                    
   346        |     |     |    // 変数に関しては、チェック対象とする。                          
   347        |     |     |    // 複数のSubRegionでの変数の参照・代入は統一していることが前提。 
   348        |     |     |    //                                                               
              |     |     |  +----------------------------+ 
   349        |     |     +--+ if(Token-&gt;Script != NULL){ | 
              |     |     |  +--+-------------------------+ 
   350        |     |     |     +--- Script = (TScript *)Token-&gt;Script;
              |     |     |     |  +------------------------------------+ 
   351        |     |     |     +--+ if(Script-&gt;ScRegion == scr_start){ | 
              |     |     |     |  +--+---------------------------------+ 
   352        |     |     |     |     +--- Nest++;
              |     |     |     |   +-+---+ 
   353        |     |     |     |   |  }  | 
              |     |     |     |   +-+---+ 
              |     |     |     |   +-+---------------------------------------+ 
   353        |     |     |     |   |  else if(Script-&gt;ScRegion == scr_end){  | 
              |     |     |     |   +-+---------------------------------------+ 
   354        |     |     |     |     +--- Nest--;
              |     |     |     |   +-+---+ 
   355        |     |     |     |   |  }  | 
              |     |     |     |   +-----+ 
              |     |     |   +-+---+ 
   356        |     |     |   |  }  | 
              |     |     |   +-----+ 
              |     |     |  +------------+ 
   357        |     |     +--+ continue;  | 
              |     |     |  +------------+ 
              |     |   +-+---+ 
   358        |     |   |  }  | 
              |     |   +-----+ 
              |     |  +----------------------------+ 
   359        |     +--+ if(Token-&gt;Script != NULL){ | 
              |     |  +--+-------------------------+ 
   360        |     |     +--- Script = (TScript *)Token-&gt;Script;
              |     |     |  +----------------------------------------------------------+ 
   361        |     |     +--+ if(Script-&gt;ScRegion == scr_start){      // region Start  | 
              |     |     |  +--+-------------------------------------------------------+ 
   362        |     |     |     +--- Nest++;     // TR ネスト部分の処理
              |     |     |     |  +------------+ 
   363        |     |     |     +--+ continue;  | 
              |     |     |     |  +------------+ 
              |     |     |   +-+---+ 
   364        |     |     |   |  }  | 
              |     |     |   +-+---+ 
              |     |     |   +-+-----------------------------------------------+ 
   364        |     |     |   |  else if(Script-&gt;ScType == sct_name){   // name | 
              |     |     |   +-+-----------------------------------------------+ 
   365        |     |     |     +--- Name = Script-&gt;TokStrList-&gt;Strings[2];
              |     |     |     |  +------------------------------+ 
   366        |     |     |     +--+ if(TuneGroup == tgInstall){  | 
              |     |     |     |  +--+---------------------------+ 
   367        |     |     |     |     +--- FuncName = &quot;OAT_Install&quot;+Name;
              |     |     |     |   +-+---+ 
   368        |     |     |     |   |  }  | 
              |     |     |     |   +-+---+ 
              |     |     |     |   +-+---------------------------------+ 
   368        |     |     |     |   |  else if(TuneGroup == tgStatic){  | 
              |     |     |     |   +-+---------------------------------+ 
   369        |     |     |     |     +--- FuncName = &quot;OAT_Static&quot;+Name;
              |     |     |     |   +-+---+ 
   370        |     |     |     |   |  }  | 
              |     |     |     |   +-+---+ 
              |     |     |     |   +-+---------------------------------+ 
   370        |     |     |     |   |  else if(TuneGroup == tgDynamic){ | 
              |     |     |     |   +-+---------------------------------+ 
   371        |     |     |     |     +--- FuncName = &quot;OAT_Dynamic&quot;+Name;
              |     |     |     |   +-+---+ 
   372        |     |     |     |   |  }  | 
              |     |     |     |   +-----+ 
              |     |     |   +-+---+ 
   373        |     |     |   |  }  | 
              |     |     |   +-+---+ 
              |     |     |   +-+-------------------------------------------------+ 
   373        |     |     |   |  else if(Script-&gt;ScType == sct_Number){ // number | 
              |     |     |   +-+-------------------------------------------------+ 
   374        |     |     |     +--- Number = atoi(Script-&gt;TokStrList-&gt;Strings[2].c_str());
              |     |     |   +-+---+ 
   375        |     |     |   |  }  | 
              |     |     |   +-+---+ 
              |     |     |   +-+---------------------------------------------------------+ 
   375        |     |     |   |  else if(Script-&gt;ScType == sct_according){  // Acoording  | 
              |     |     |   +-+---------------------------------------------------------+ 
              |     |     |     |  +----------------------------------------------------------------------+ 
   376        |     |     |     +--+ if(!InSubRegionF){ // SubRegion内の acordingは、SubRegion内のみ有効  | 
              |     |     |     |  +--+-------------------------------------------------------------------+ 
   377        |     |     |     |     +--- TToken *Token2;
   378        |     |     |     |     |    
   379        |     |     |     |     +--- UseAccordingF = true;
   380        |     |     |     |     +--- AccordingStr = &quot;&quot;;
              |     |     |     |     |  +--------------------------------------+ 
   381        |     |     |     |     +--+ for(j = i ; j &lt;= TokenEndPos ; j++){ | 
              |     |     |     |     |  +--+-----------------------------------+ 
   382        |     |     |     |     |     +--- Token2 = (TToken *)TokenList-&gt;Items[j];
              |     |     |     |     |     |  +------------------------------------+ 
   383        |     |     |     |     |     +--+ if(Token2-&gt;TokId == tid_LineEnd){  | 
              |     |     |     |     |     |  +--+---------------------------------+ 
              |     |     |     |     |     |     |  +--------+ 
   384        |     |     |     |     |     |     +--+ break; | 
              |     |     |     |     |     |     |  +--------+ 
              |     |     |     |     |     |   +-+---+ 
   385        |     |     |     |     |     |   |  }  | 
              |     |     |     |     |     |   +-----+ 
   386        |     |     |     |     |     +--- AccordingStr += Token2-&gt;OrgStr;
              |     |     |     |     |   +-+---+ 
   387        |     |     |     |     |   |  }  | 
              |     |     |     |     |   +-----+ 
              |     |     |     |   +-+---+ 
   388        |     |     |     |   |  }  | 
              |     |     |     |   +-----+ 
              |     |     |   +-+---+ 
   389        |     |     |   |  }  | 
              |     |     |   +-+---+ 
              |     |     |   +-+---------------------------------------+ 
   389        |     |     |   |  else if(Script-&gt;ScType == sct_varied){ | 
              |     |     |   +-+---------------------------------------+ 
   390        |     |     |     +--- //
   391        |     |     |     |    // varried処理を行う。 
   392        |     |     |     |    //                     
              |     |     |     |  +--------------------------------------------------------------------+ 
   393        |     |     |     +--+ if(!InSubRegionF){ // SubRegion内の variedは、SubRegion内のみ有効  | 
              |     |     |     |  +--+-----------------------------------------------------------------+ 
              |     |     |     |     |  +------------------------------------+ 
   394        |     |     |     |     +--+ if(Script-&gt;ScValDataList == NULL){ | 
              |     |     |     |     |  +--+---------------------------------+ 
   395        |     |     |     |     |     +--- MainF-&gt;ErrMessage(i,&quot;varied の変数指定が見つかりません。&quot;);
              |     |     |     |     |     |  +----------+ 
   396        |     |     |     |     |     +--+ return;  | 
              |     |     |     |     |     |  +----------+ 
              |     |     |     |     |   +-+---+ 
   397        |     |     |     |     |   |  }  | 
              |     |     |     |     |   +-----+ 
              |     |     |     |     |  +----------------------------------------+ 
   398        |     |     |     |     +--+ if(Script-&gt;ScValDataList-&gt;Count == 0){ | 
              |     |     |     |     |  +--+-------------------------------------+ 
   399        |     |     |     |     |     +--- MainF-&gt;ErrMessage(i,&quot;varied の変数指定が見つかりません。&quot;);
              |     |     |     |     |     |  +----------+ 
   400        |     |     |     |     |     +--+ return;  | 
              |     |     |     |     |     |  +----------+ 
              |     |     |     |     |   +-+---+ 
   401        |     |     |     |     |   |  }  | 
              |     |     |     |     |   +-----+ 
              |     |     |     |     |  +------------------------------------------------------+ 
   402        |     |     |     |     +--+ for(k = 0 ; k &lt; Script-&gt;ScValDataList-&gt;Count ; k++){ | 
              |     |     |     |     |  +--+---------------------------------------------------+ 
   403        |     |     |     |     |     +--- ScValData = (TScValData *)Script-&gt;ScValDataList-&gt;Items[k];
   404        |     |     |     |     |     +--- variedValName[variedCount] = ScValData-&gt;Str;
   405        |     |     |     |     |     +--- variedValData[variedCount] = ScValData;
   406        |     |     |     |     |     +--- DoToken[variedCount] = NULL;
              |     |     |     |     |     |  +------------------------------------------------------+ 
   407        |     |     |     |     |     +--+ for(j = 0 ; j &lt; Script-&gt;TokStrList-&gt;Count-1 ; j++){  | 
              |     |     |     |     |     |  +--+---------------------------------------------------+ 
   408        |     |     |     |     |     |     +--- s = Script-&gt;TokStrList-&gt;Strings[j];
              |     |     |     |     |     |     |  +------------------+ 
   409        |     |     |     |     |     |     +--+ if(s == &quot;from&quot;){ | 
              |     |     |     |     |     |     |  +--+---------------+ 
   410        |     |     |     |     |     |     |     +--- s = Script-&gt;TokStrList-&gt;Strings[j+1];
   411        |     |     |     |     |     |     |     +--- /**************************************************************************/
   412        |     |     |     |     |     |     |     |    //                                                                           
   413        |     |     |     |     |     |     |     |    //Kogakuin Irie                                                              
   414        |     |     |     |     |     |     |     |    //PPの変動範囲を実数にも対応                                                 
   415        |     |     |     |     |     |     |     |    //既存コードはコメントアウト                                                 
   416        |     |     |     |     |     |     |     |    //                                                                           
   417        |     |     |     |     |     |     |     |    //variedFromValue[variedCount] = atoi(s.c_str());                            
   418        |     |     |     |     |     |     |     +--- variedFromValue[variedCount] = (float)atof(s.c_str());
   419        |     |     |     |     |     |     |     +--- //
   420        |     |     |     |     |     |     |     |    //ここまで                                                                   
   421        |     |     |     |     |     |     |     |    //                                                                           
   422        |     |     |     |     |     |     |     |    /**************************************************************************/ 
              |     |     |     |     |     |     |   +-+---+ 
   423        |     |     |     |     |     |     |   |  }  | 
              |     |     |     |     |     |     |   +-+---+ 
              |     |     |     |     |     |     |   +-+---------------------+ 
   423        |     |     |     |     |     |     |   |  else if(s == &quot;to&quot;){  | 
              |     |     |     |     |     |     |   +-+---------------------+ 
   424        |     |     |     |     |     |     |     +--- s = Script-&gt;TokStrList-&gt;Strings[j+1];
   425        |     |     |     |     |     |     |     +--- /**************************************************************************/
   426        |     |     |     |     |     |     |     |    //                                                                           
   427        |     |     |     |     |     |     |     |    //Kogakuin Irie                                                              
   428        |     |     |     |     |     |     |     |    //PPの変動範囲を実数にも対応                                                 
   429        |     |     |     |     |     |     |     |    //既存コードはコメントアウト                                                 
   430        |     |     |     |     |     |     |     |    //                                                                           
   431        |     |     |     |     |     |     |     |    //variedToValue[variedCount] = atoi(s.c_str());                              
   432        |     |     |     |     |     |     |     +--- variedToValue[variedCount] = (float)atof(s.c_str());
   433        |     |     |     |     |     |     |     +--- //
   434        |     |     |     |     |     |     |     |    //ここまで                                                                   
   435        |     |     |     |     |     |     |     |    //                                                                           
   436        |     |     |     |     |     |     |     |    /**************************************************************************/ 
   437        |     |     |     |     |     |     |     |                                                                                 
   438        |     |     |     |     |     |     |     |    /*****************************************/                                  
   439        |     |     |     |     |     |     |     |    //                                                                           
   440        |     |     |     |     |     |     |     |    //Kogakuin Irie                                                              
   441        |     |     |     |     |     |     |     |    //step（増分値の任意設定）対応のための処理                                   
   442        |     |     |     |     |     |     |     |    //                                                                           
   443        |     |     |     |     |     |     |     +--- variedStepValue[variedCount] = 1;
   444        |     |     |     |     |     |     |     +--- //
   445        |     |     |     |     |     |     |     |    //ここまで                                   
   446        |     |     |     |     |     |     |     |    //                                           
   447        |     |     |     |     |     |     |     |    /*****************************************/  
              |     |     |     |     |     |     |   +-+---+ 
   448        |     |     |     |     |     |     |   |  }  | 
              |     |     |     |     |     |     |   +-----+ 
   449        |     |     |     |     |     |     +--- /************************************************************/
   450        |     |     |     |     |     |     |    //                                                             
   451        |     |     |     |     |     |     |    //Kogakuin Irie                                                
   452        |     |     |     |     |     |     |    //step（増分値の任意設定）対応のための処理                     
   453        |     |     |     |     |     |     |    //                                                             
              |     |     |     |     |     |     |   +-+-----------------------+ 
   454        |     |     |     |     |     |     |   |  else if(s == &quot;step&quot;){  | 
              |     |     |     |     |     |     |   +-+-----------------------+ 
   455        |     |     |     |     |     |     |     +--- s = Script-&gt;TokStrList-&gt;Strings[j+1];
   456        |     |     |     |     |     |     |     +--- variedStepValue[variedCount] = (float)atof(s.c_str());
              |     |     |     |     |     |     |   +-+---+ 
   457        |     |     |     |     |     |     |   |  }  | 
              |     |     |     |     |     |     |   +-----+ 
   458        |     |     |     |     |     |     +--- //
   459        |     |     |     |     |     |     |    //ここまで                                                     
   460        |     |     |     |     |     |     |    //                                                             
   461        |     |     |     |     |     |     |    /************************************************************/ 
              |     |     |     |     |     |   +-+---+ 
   462        |     |     |     |     |     |   |  }  | 
              |     |     |     |     |     |   +-----+ 
   463        |     |     |     |     |     +--- variedCount++;
              |     |     |     |     |   +-+---+ 
   464        |     |     |     |     |   |  }  | 
              |     |     |     |     |   +-----+ 
              |     |     |     |   +-+---+ 
   465        |     |     |     |   |  }  | 
              |     |     |     |   +-----+ 
              |     |     |   +-+---+ 
   466        |     |     |   |  }  | 
              |     |     |   +-+---+ 
              |     |     |   +-+-----------------------------------------+ 
   466        |     |     |   |  else if(Script-&gt;ScType == sct_fitting){  | 
              |     |     |   +-+-----------------------------------------+ 
   467        |     |     |     +--- //
   468        |     |     |     |    // Fitting指定子の処理を行う。（TuneRegionへデータ複写のみ)  
   469        |     |     |     |    //                                                           
   470        |     |     |     |                                                                 
   471        |     |     |     +--- //d-spline用コード追加部分
   472        |     |     |     +--- FittingDspline = Script-&gt;FittingDspline;
   473        |     |     |     +--- FittingDynamic = Script-&gt;FittingDynamic;
   474        |     |     |     +--- //d-spline用コード追加部分　ここまで
   475        |     |     |     |                                         
   476        |     |     |     +--- FittingType = Script-&gt;FittingType;
   477        |     |     |     +--- FittingDegree = Script-&gt;FittingDegree;
   478        |     |     |     +--- SampledList = Script-&gt;SampledList;
   479        |     |     |     +--- //          }else if(Script-&gt;ScRegion == scr_substart){ // Sub region Start
              |     |     |   +-+---+ 
   480        |     |     |   |  }  | 
              |     |     |   +-+---+ 
              |     |     |   +-+-------------------------------------------------------------------+ 
   480        |     |     |   |  else if((Script-&gt;ScRegion == scr_substart)                         | 
   481        |     |     |   |         &amp;&amp;(Script-&gt;ScType == sct_select)){      // Sub region Start | 
              |     |     |   +-+-------------------------------------------------------------------+ 
   482        |     |     |     +--- InSubRegionF = true;
   483        |     |     |     +--- SubRegion = new TSubRegion();
   484        |     |     |     +--- SubRegion-&gt;TokenStartPos = i;
   485        |     |     |     +--- SubRegion-&gt;ScType = Script-&gt;ScType;
   486        |     |     |     +--- SubRegion-&gt;AccordingStr = AccordingStr;
   487        |     |     |     +--- SubRegionList-&gt;Add((void *)SubRegion);
   488        |     |     |     |    
              |     |     |     |  +----------------------------------------------------------+ 
   489        |     |     |     +--+ for(j = 0 ; j &lt; variedCount ; j++){ // varidCountを継承  | 
              |     |     |     |  +--+-------------------------------------------------------+ 
   490        |     |     |     |     +--- SubRegion-&gt;variedValName[j] = variedValName[j];
   491        |     |     |     |     +--- SubRegion-&gt;variedValData[j] = variedValData[j];
   492        |     |     |     |     +--- SubRegion-&gt;variedFromValue[j] = variedFromValue[j];
   493        |     |     |     |     +--- /************************************************************/
   494        |     |     |     |     |    //                                                             
   495        |     |     |     |     |    //Kogakuin Irie                                                
   496        |     |     |     |     |    //step（増分値の任意設定）対応のための処理                     
   497        |     |     |     |     |    //                                                             
   498        |     |     |     |     +--- SubRegion-&gt;variedStepValue[j] = variedStepValue[j];
   499        |     |     |     |     +--- //
   500        |     |     |     |     |    //ここまで                                                     
   501        |     |     |     |     |    //                                                             
   502        |     |     |     |     |    /************************************************************/ 
   503        |     |     |     |     +--- SubRegion-&gt;variedToValue[j] = variedToValue[j];
              |     |     |     |   +-+---+ 
   504        |     |     |     |   |  }  | 
              |     |     |     |   +-----+ 
   505        |     |     |     +--- SubRegion-&gt;variedCount = variedCount;
   506        |     |     |     |    
              |     |     |     |  +--------------------------------------+ 
   507        |     |     |     +--+ for(j = i ; j &lt;= TokenEndPos ; j++){ | 
              |     |     |     |  +--+-----------------------------------+ 
   508        |     |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[j];
              |     |     |     |     |  +----------------------------+ 
   509        |     |     |     |     +--+ if(Token-&gt;Script != NULL){ | 
              |     |     |     |     |  +--+-------------------------+ 
   510        |     |     |     |     |     +--- Script = (TScript *)Token-&gt;Script;
              |     |     |     |     |     |  +------------------------------------+ 
   511        |     |     |     |     |     +--+ if(Script-&gt;ScRegion == scr_start){ | 
              |     |     |     |     |     |  +--+---------------------------------+ 
   512        |     |     |     |     |     |     +--- // Nestしている場合は、region end まで Skipする。
              |     |     |     |     |     |     |  +----------------------------------+ 
   513        |     |     |     |     |     |     +--+ for( ; j &lt;= TokenEndPos ; j++){  | 
              |     |     |     |     |     |     |  +--+-------------------------------+ 
   514        |     |     |     |     |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[j];
              |     |     |     |     |     |     |     |  +----------------------------+ 
   515        |     |     |     |     |     |     |     +--+ if(Token-&gt;Script != NULL){ | 
              |     |     |     |     |     |     |     |  +--+-------------------------+ 
   516        |     |     |     |     |     |     |     |     +--- Script = (TScript *)Token-&gt;Script;
              |     |     |     |     |     |     |     |     |  +----------------------------------+ 
   517        |     |     |     |     |     |     |     |     +--+ if(Script-&gt;ScRegion == scr_end){ | 
              |     |     |     |     |     |     |     |     |  +--+-------------------------------+ 
              |     |     |     |     |     |     |     |     |     |  +--------+ 
   518        |     |     |     |     |     |     |     |     |     +--+ break; | 
              |     |     |     |     |     |     |     |     |     |  +--------+ 
              |     |     |     |     |     |     |     |     |   +-+---+ 
   519        |     |     |     |     |     |     |     |     |   |  }  | 
              |     |     |     |     |     |     |     |     |   +-----+ 
              |     |     |     |     |     |     |     |   +-+---+ 
   520        |     |     |     |     |     |     |     |   |  }  | 
              |     |     |     |     |     |     |     |   +-----+ 
              |     |     |     |     |     |     |   +-+---+ 
   521        |     |     |     |     |     |     |   |  }  | 
              |     |     |     |     |     |     |   +-----+ 
              |     |     |     |     |     |   +-+---+ 
   522        |     |     |     |     |     |   |  }  | 
              |     |     |     |     |     |   +-+---+ 
              |     |     |     |     |     |   +-+-----------------------------------------+ 
   522        |     |     |     |     |     |   |  else if(Script-&gt;ScRegion == scr_subend){ | 
              |     |     |     |     |     |   +-+-----------------------------------------+ 
              |     |     |     |     |     |     |  +--------+ 
   523        |     |     |     |     |     |     +--+ break; | 
              |     |     |     |     |     |     |  +--------+ 
              |     |     |     |     |     |   +-+---+ 
   524        |     |     |     |     |     |   |  }  | 
              |     |     |     |     |     |   +-+---+ 
              |     |     |     |     |     |   +-+---------------------------------------------------------+ 
   524        |     |     |     |     |     |   |  else if(Script-&gt;ScType == sct_according){  // Acoording  | 
              |     |     |     |     |     |   +-+---------------------------------------------------------+ 
   525        |     |     |     |     |     |     +--- TToken *Token2;
   526        |     |     |     |     |     |     |    
   527        |     |     |     |     |     |     +--- UseAccordingF = true;
   528        |     |     |     |     |     |     +--- SubRegion-&gt;AccordingStr = &quot;&quot;;
              |     |     |     |     |     |     |  +------------------------------------------+ 
   529        |     |     |     |     |     |     +--+ for(int k = j ; k &lt;= TokenEndPos ; k++){ | 
              |     |     |     |     |     |     |  +--+---------------------------------------+ 
   530        |     |     |     |     |     |     |     +--- Token2 = (TToken *)TokenList-&gt;Items[k];
              |     |     |     |     |     |     |     |  +------------------------------------+ 
   531        |     |     |     |     |     |     |     +--+ if(Token2-&gt;TokId == tid_LineEnd){  | 
              |     |     |     |     |     |     |     |  +--+---------------------------------+ 
              |     |     |     |     |     |     |     |     |  +--------+ 
   532        |     |     |     |     |     |     |     |     +--+ break; | 
              |     |     |     |     |     |     |     |     |  +--------+ 
              |     |     |     |     |     |     |     |   +-+---+ 
   533        |     |     |     |     |     |     |     |   |  }  | 
              |     |     |     |     |     |     |     |   +-----+ 
   534        |     |     |     |     |     |     |     +--- SubRegion-&gt;AccordingStr += Token2-&gt;OrgStr;
              |     |     |     |     |     |     |   +-+---+ 
   535        |     |     |     |     |     |     |   |  }  | 
              |     |     |     |     |     |     |   +-----+ 
              |     |     |     |     |     |   +-+---+ 
   536        |     |     |     |     |     |   |  }  | 
              |     |     |     |     |     |   +-+---+ 
              |     |     |     |     |     |   +-+---------------------------------------+ 
   536        |     |     |     |     |     |   |  else if(Script-&gt;ScType == sct_varied){ | 
              |     |     |     |     |     |   +-+---------------------------------------+ 
   537        |     |     |     |     |     |     +--- //
   538        |     |     |     |     |     |     |    // varried処理を行う。 
   539        |     |     |     |     |     |     +--- //
              |     |     |     |     |     |     |  +------------------------------------+ 
   540        |     |     |     |     |     |     +--+ if(Script-&gt;ScValDataList == NULL){ | 
              |     |     |     |     |     |     |  +--+---------------------------------+ 
   541        |     |     |     |     |     |     |     +--- MainF-&gt;ErrMessage(i,&quot;varied の変数指定が見つかりません。&quot;);
              |     |     |     |     |     |     |     |  +----------+ 
   542        |     |     |     |     |     |     |     +--+ return;  | 
              |     |     |     |     |     |     |     |  +----------+ 
              |     |     |     |     |     |     |   +-+---+ 
   543        |     |     |     |     |     |     |   |  }  | 
              |     |     |     |     |     |     |   +-----+ 
              |     |     |     |     |     |     |  +----------------------------------------+ 
   544        |     |     |     |     |     |     +--+ if(Script-&gt;ScValDataList-&gt;Count == 0){ | 
              |     |     |     |     |     |     |  +--+-------------------------------------+ 
   545        |     |     |     |     |     |     |     +--- MainF-&gt;ErrMessage(i,&quot;varied の変数指定が見つかりません。&quot;);
              |     |     |     |     |     |     |     |  +----------+ 
   546        |     |     |     |     |     |     |     +--+ return;  | 
              |     |     |     |     |     |     |     |  +----------+ 
              |     |     |     |     |     |     |   +-+---+ 
   547        |     |     |     |     |     |     |   |  }  | 
              |     |     |     |     |     |     |   +-----+ 
              |     |     |     |     |     |     |  +------------------------------------------------------+ 
   548        |     |     |     |     |     |     +--+ for(k = 0 ; k &lt; Script-&gt;ScValDataList-&gt;Count ; k++){ | 
              |     |     |     |     |     |     |  +--+---------------------------------------------------+ 
   549        |     |     |     |     |     |     |     +--- ScValData = (TScValData *)Script-&gt;ScValDataList-&gt;Items[k];
   550        |     |     |     |     |     |     |     +--- SubRegion-&gt;variedValName[variedCount] = ScValData-&gt;Str;
   551        |     |     |     |     |     |     |     +--- SubRegion-&gt;variedValData[variedCount] = ScValData;
              |     |     |     |     |     |     |     |  +--------------------------------------------------------+ 
   552        |     |     |     |     |     |     |     +--+ for(k2 = 0 ; k2 &lt; Script-&gt;TokStrList-&gt;Count-1 ; k2++){ | 
              |     |     |     |     |     |     |     |  +--+-----------------------------------------------------+ 
   553        |     |     |     |     |     |     |     |     +--- s = Script-&gt;TokStrList-&gt;Strings[k2];
              |     |     |     |     |     |     |     |     |  +------------------+ 
   554        |     |     |     |     |     |     |     |     +--+ if(s == &quot;from&quot;){ | 
              |     |     |     |     |     |     |     |     |  +--+---------------+ 
   555        |     |     |     |     |     |     |     |     |     +--- s = Script-&gt;TokStrList-&gt;Strings[k2+1];
   556        |     |     |     |     |     |     |     |     |     +--- /**************************************************************************/
   557        |     |     |     |     |     |     |     |     |     |    //                                                                           
   558        |     |     |     |     |     |     |     |     |     |    //Kogakuin Irie                                                              
   559        |     |     |     |     |     |     |     |     |     |    //PPの変動範囲を実数にも対応                                                 
   560        |     |     |     |     |     |     |     |     |     |    //既存コードはコメントアウト                                                 
   561        |     |     |     |     |     |     |     |     |     |    //                                                                           
   562        |     |     |     |     |     |     |     |     |     |    //SubRegion-&gt;variedFromValue[variedCount] = atoi(s.c_str());                 
   563        |     |     |     |     |     |     |     |     |     +--- SubRegion-&gt;variedFromValue[variedCount] = (float)atof(s.c_str());   //実数に対応
   564        |     |     |     |     |     |     |     |     |     +--- //
   565        |     |     |     |     |     |     |     |     |     |    //ここまで                                                                   
   566        |     |     |     |     |     |     |     |     |     |    //                                                                           
   567        |     |     |     |     |     |     |     |     |     |    /**************************************************************************/ 
              |     |     |     |     |     |     |     |     |   +-+---+ 
   568        |     |     |     |     |     |     |     |     |   |  }  | 
              |     |     |     |     |     |     |     |     |   +-+---+ 
              |     |     |     |     |     |     |     |     |   +-+---------------------+ 
   568        |     |     |     |     |     |     |     |     |   |  else if(s == &quot;to&quot;){  | 
              |     |     |     |     |     |     |     |     |   +-+---------------------+ 
   569        |     |     |     |     |     |     |     |     |     +--- s = Script-&gt;TokStrList-&gt;Strings[k2+1];
   570        |     |     |     |     |     |     |     |     |     +--- /**************************************************************************/
   571        |     |     |     |     |     |     |     |     |     |    //                                                                           
   572        |     |     |     |     |     |     |     |     |     |    //Kogakuin Irie                                                              
   573        |     |     |     |     |     |     |     |     |     |    //PPの変動範囲を実数にも対応                                                 
   574        |     |     |     |     |     |     |     |     |     |    //既存コードはコメントアウト                                                 
   575        |     |     |     |     |     |     |     |     |     |    //                                                                           
   576        |     |     |     |     |     |     |     |     |     |    //SubRegion-&gt;variedToValue[variedCount] = atoi(s.c_str());                   
   577        |     |     |     |     |     |     |     |     |     +--- SubRegion-&gt;variedToValue[variedCount] = (float)atof(s.c_str());     //実数に対応
   578        |     |     |     |     |     |     |     |     |     +--- //
   579        |     |     |     |     |     |     |     |     |     |    //ここまで                                                                   
   580        |     |     |     |     |     |     |     |     |     |    //                                                                           
   581        |     |     |     |     |     |     |     |     |     |    /**************************************************************************/ 
   582        |     |     |     |     |     |     |     |     |     |                                                                                 
   583        |     |     |     |     |     |     |     |     |     |    /*******************************************/                                
   584        |     |     |     |     |     |     |     |     |     |    //                                                                           
   585        |     |     |     |     |     |     |     |     |     |    //Kogakuin Irie                                                              
   586        |     |     |     |     |     |     |     |     |     |    //step（増分値の任意設定）対応のための処理                                   
   587        |     |     |     |     |     |     |     |     |     |    //                                                                           
   588        |     |     |     |     |     |     |     |     |     +--- SubRegion-&gt;variedStepValue[variedCount] = 1;
   589        |     |     |     |     |     |     |     |     |     +--- //
   590        |     |     |     |     |     |     |     |     |     |    //ここまで                                     
   591        |     |     |     |     |     |     |     |     |     |    //                                             
   592        |     |     |     |     |     |     |     |     |     |    /*******************************************/  
              |     |     |     |     |     |     |     |     |   +-+---+ 
   593        |     |     |     |     |     |     |     |     |   |  }  | 
              |     |     |     |     |     |     |     |     |   +-----+ 
   594        |     |     |     |     |     |     |     |     +--- /***********************************************************************/
   595        |     |     |     |     |     |     |     |     |    //                                                                         
   596        |     |     |     |     |     |     |     |     |    //Kogakuin Irie                                                            
   597        |     |     |     |     |     |     |     |     |    //step（増分値の任意設定）対応のための処理                                 
   598        |     |     |     |     |     |     |     |     |    //                                                                         
              |     |     |     |     |     |     |     |     |   +-+-----------------------+ 
   599        |     |     |     |     |     |     |     |     |   |  else if(s == &quot;step&quot;){  | 
              |     |     |     |     |     |     |     |     |   +-+-----------------------+ 
   600        |     |     |     |     |     |     |     |     |     +--- s = Script-&gt;TokStrList-&gt;Strings[k2+1];
   601        |     |     |     |     |     |     |     |     |     +--- SubRegion-&gt;variedStepValue[variedCount] = (float)atof(s.c_str());
              |     |     |     |     |     |     |     |     |   +-+---+ 
   602        |     |     |     |     |     |     |     |     |   |  }  | 
              |     |     |     |     |     |     |     |     |   +-----+ 
   603        |     |     |     |     |     |     |     |     +--- //
   604        |     |     |     |     |     |     |     |     |    //ここまで                                                                 
   605        |     |     |     |     |     |     |     |     |    //                                                                         
   606        |     |     |     |     |     |     |     |     |    /***********************************************************************/  
              |     |     |     |     |     |     |     |   +-+---+ 
   607        |     |     |     |     |     |     |     |   |  }  | 
              |     |     |     |     |     |     |     |   +-----+ 
   608        |     |     |     |     |     |     |     +--- SubRegion-&gt;variedCount++;
              |     |     |     |     |     |     |   +-+---+ 
   609        |     |     |     |     |     |     |   |  }  | 
              |     |     |     |     |     |     |   +-----+ 
              |     |     |     |     |     |   +-+---+ 
   610        |     |     |     |     |     |   |  }  | 
              |     |     |     |     |     |   +-----+ 
              |     |     |     |     |   +-+---+ 
   611        |     |     |     |     |   |  }  | 
              |     |     |     |     |   +-----+ 
              |     |     |     |   +-+---+ 
   612        |     |     |     |   |  }  | 
              |     |     |     |   +-----+ 
   613        |     |     |     +--- SubRegion-&gt;TokenEndPos = j;
              |     |     |     |  +------------------------+ 
   614        |     |     |     +--+ if(j &gt;= TokenEndPos){  | 
              |     |     |     |  +--+---------------------+ 
   615        |     |     |     |     +--- MainF-&gt;ErrMessage(i,&quot;sub region endが見つかりません。&quot;);
              |     |     |     |   +-+---+ 
   616        |     |     |     |   |  }  | 
              |     |     |     |   +-----+ 
   617        |     |     |     |    
              |     |     |   +-+---+ 
   618        |     |     |   |  }  | 
              |     |     |   +-+---+ 
              |     |     |   +-+-----------------------------------------+ 
   618        |     |     |   |  else if(Script-&gt;ScRegion == scr_subend){ | 
              |     |     |   +-+-----------------------------------------+ 
   619        |     |     |     +--- InSubRegionF = false;
              |     |     |   +-+---+ 
   620        |     |     |   |  }  | 
              |     |     |   +-----+ 
              |     |   +-+---+ 
   621        |     |   |  }  | 
              |     |   +-----+ 
              |   +-+---+ 
   622        |   |  }  | 
              |   +-----+ 
   623        +--- MakeArgValList();   // TRのサブルーチンに渡す引数リストを生成する。
   624        +--- //
   625        |    // Case数を計算する。                                              
   626        |    // SubRegionがある場合は、各SubReguionの varied数だけのCaseの総和  
   627        |    // SubRegionがない場合は、varied数だけのCase                       
   628        |    //                                                                 
              |  +--------------------------------+ 
   629        +--+ if(SubRegionList-&gt;Count &gt; 0){  | 
              |  +--+-----------------------------+ 
   630        |     +--- int SubCaseCount;
   631        |     |    
   632        |     +--- CaseCount = 0;
              |     |  +----------------------------------------------+ 
   633        |     +--+ for(j = 0 ; j &lt; SubRegionList-&gt;Count; j++){  | 
              |     |  +--+-------------------------------------------+ 
   634        |     |     +--- SubRegion = (TSubRegion *)SubRegionList-&gt;Items[j];
   635        |     |     +--- SubCaseCount = 1;
              |     |     |  +--------------------------------------------------------------------------+ 
   636        |     |     +--+ for(k = 0 ; k &lt; SubRegion-&gt;variedCount ; k++){ // SubRegionがない場合の  | 
              |     |     |  +--+-----------------------------------------------------------------------+ 
   637        |     |     |     +--- /***********************************************************************************************************************/
   638        |     |     |     |    //                                                                                                                         
   639        |     |     |     |    //Kogakuin Irie                                                                                                            
   640        |     |     |     |    //PPの実数対応とstep対応のための処理                                                                                       
   641        |     |     |     |    //既存コードはコメントアウト                                                                                               
   642        |     |     |     |    //                                                                                                                         
   643        |     |     |     |    //SubCaseCount *= (SubRegion-&gt;variedToValue[k] - SubRegion-&gt;variedFromValue[k] + 1);                                       
   644        |     |     |     +--- SubCaseCount *= (int)((SubRegion-&gt;variedToValue[k] - SubRegion-&gt;variedFromValue[k]) / SubRegion-&gt;variedStepValue[k] + 1);
   645        |     |     |     +--- //
   646        |     |     |     |    //ここまで                                                                                                                 
   647        |     |     |     |    //                                                                                                                         
   648        |     |     |     |    /***********************************************************************************************************************/  
              |     |     |   +-+---+ 
   649        |     |     |   |  }  | 
              |     |     |   +-----+ 
   650        |     |     +--- SubRegion-&gt;CaseCount = SubCaseCount;
   651        |     |     +--- CaseCount += SubCaseCount;
              |     |   +-+---+ 
   652        |     |   |  }  | 
              |     |   +-----+ 
              |   +-+---+ 
   653        |   |  }  | 
              |   +-+---+ 
              |   +-+-------+ 
   653        |   |  else{  | 
              |   +-+-------+ 
   654        |     +--- // SubRegionがない場合の処理
   655        |     +--- CaseCount = 1;
              |     |  +--------------------------------------------------------------+ 
   656        |     +--+ for(k = 0 ; k &lt; variedCount ; k++){ // SubRegionがない場合の | 
              |     |  +--+-----------------------------------------------------------+ 
   657        |     |     +--- /*******************************************************************************************************/
   658        |     |     |    //                                                                                                         
   659        |     |     |    //Kogakuin Irie                                                                                            
   660        |     |     |    //PPの実数対応とstep対応のための処理                                                                       
   661        |     |     |    //既存コードはコメントアウト                                                                               
   662        |     |     |    //                                                                                                         
   663        |     |     |    //CaseCount *= (variedToValue[k] - variedFromValue[k] + 1);                                                
   664        |     |     +--- CaseCount *= (int)((variedToValue[k] - variedFromValue[k]) / variedStepValue[k] + 1);
   665        |     |     +--- //
   666        |     |     |    //ここまで                                                                                                 
   667        |     |     |    //                                                                                                         
   668        |     |     |    /*******************************************************************************************************/  
              |     |   +-+---+ 
   669        |     |   |  }  | 
              |     |   +-----+ 
              |   +-+---+ 
   670        |   |  }  | 
              |   +-----+ 
   671        +--- //
   672        |    // varied from to で定数に置換される変数は、引数リストから参照扱いをCUT        
   673        |    // 現状、同一名で、片側は変数として使用、もう一方は引数と指定使用は出来ない。  
   674        |    // 最終的には、エラーメッセージが必要？                                        
   675        |    //                                                                             
              |  +----------------------------------------------+ 
   676        +--+ for(i = 0 ; i &lt; SubRegionList-&gt;Count; i++){  | 
              |  +--+-------------------------------------------+ 
   677        |     +--- SubRegion = (TSubRegion *)SubRegionList-&gt;Items[i];
              |     |  +------------------------------------------------+ 
   678        |     +--+ for(k = 0 ; k &lt; SubRegion-&gt;variedCount ; k++){ | 
              |     |  +--+---------------------------------------------+ 
   679        |     |     +--- s = SubRegion-&gt;variedValName[k];
              |     |     |  +--------------------------------------------+ 
   680        |     |     +--+ for(j = 0 ; j &lt; ArgValList-&gt;Count ; j++){  | 
              |     |     |  +--+-----------------------------------------+ 
              |     |     |     |  +----------------------------------+ 
   681        |     |     |     +--+ if(ArgValList-&gt;Strings[j] == s){ | 
              |     |     |     |  +--+-------------------------------+ 
   682        |     |     |     |     +--- ArgValList-&gt;Strings[j] = &quot;&quot;;
              |     |     |     |   +-+---+ 
   683        |     |     |     |   |  }  | 
              |     |     |     |   +-----+ 
              |     |     |   +-+---+ 
   684        |     |     |   |  }  | 
              |     |     |   +-----+ 
              |     |   +-+---+ 
   685        |     |   |  }  | 
              |     |   +-----+ 
              |   +-+---+ 
   686        |   |  }  | 
              |   +-----+ 
              |  +--------------------------------------+ 
   687        +--+ for(k = 0 ; k &lt; variedCount ; k++){  | 
              |  +--+-----------------------------------+ 
   688        |     +--- s = variedValName[k];
              |     |  +--------------------------------------------+ 
   689        |     +--+ for(j = 0 ; j &lt; ArgValList-&gt;Count ; j++){  | 
              |     |  +--+-----------------------------------------+ 
              |     |     |  +----------------------------------+ 
   690        |     |     +--+ if(ArgValList-&gt;Strings[j] == s){ | 
              |     |     |  +--+-------------------------------+ 
   691        |     |     |     +--- ArgValList-&gt;Strings[j] = &quot;&quot;;
              |     |     |   +-+---+ 
   692        |     |     |   |  }  | 
              |     |     |   +-----+ 
              |     |   +-+---+ 
   693        |     |   |  }  | 
              |     |   +-----+ 
              |   +-+---+ 
   694        |   |  }  | 
              |   +-----+ 
   695        +--- //
   696        |    // ArgValListを追加 &quot;&quot;(最初に代入で使用)も、必要なので、削除はしないこと 
   697        |    //                                                                       
   698        +--- AddArgValListToATExecArgList();
   699        +--- SaveAndResetValBits(TokenStartPos,TokenEndPos);  // 変数識別を、保存してリセット
            +-+---+ 
   700      |  }  | 
            +-----+ 
</pre>


</body>
</html>
