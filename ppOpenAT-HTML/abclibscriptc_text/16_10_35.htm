
<html>
<head>
<title>OutputFusionDo メンバ関数説明</title><base target="main">
<link rel ="stylesheet" type="text/css" href="stylesheet.css" title="stylesheet">
<meta http-equiv="Content-Type" content="text/html;charset=Shift_JIS">
</head>

<body bgcolor="#ffffff">

<div align="right"><font size="2">ABCLibScriptC プロジェクト</font></div>

<table width=100% bgcolor="#e6e6fa" class="titlebgcolor" border="1" cellpadding="7" cellspacing="0">
<tr>
    <td><font class="titlefont">14.10.35. OutputFusionDo メンバ関数説明</font></td>
</tr>
</table>

<p></p>
<table border="1">
<tr><th align="left" nowrap>メンバ関数名</th>  <td nowrap>OutputFusionDo</td></tr>
<tr><th align="left" nowrap>定義ファイル名</th><td nowrap>TuneRegion.cpp</td></tr>
<tr><th align="left" nowrap>定義行</th>        <td nowrap>12936</td></tr>
<tr><th align="left" nowrap>所属名</th>        <td nowrap>TTuneRegion</td></tr>
<tr><th align="left" nowrap>アクセス属性</th>  <td nowrap>public</td></tr>
<tr><th align="left" nowrap>宣言形式</th>      <td nowrap>void OutputFusionDo ( string FusionValName , FILE * fp , int DoNest , int FusionIdx )</td></tr>
<tr><th align="left" nowrap>概要</th>          <td nowrap>LoopFusionに対応したDo出力を行う。</td></tr>
<tr><th align="left" nowrap>戻り値</th>        <td nowrap>移動後のTokenPosを返す。</td></tr>
<tr><th align="left" nowrap>パラメタ説明</th>  <td nowrap>FusionValName<br>fp<br>DoNest<br>FusionIdx</td></tr>
<tr><th align="left" nowrap>機能説明</th>      <td nowrap></td></tr>
<tr><th align="left" nowrap>備考</th>          <td nowrap></td></tr>
</table>

<p></p>
呼出し元関数一覧表
<table border="1">
<tr>
<th nowrap>№</th>
<th nowrap>名称</th>
<th nowrap>定義ファイル名</th>
<th nowrap>定義行</th>
</tr>
<tr>
<td nowrap>1</td>
<td nowrap><a href="16_10_36.htm">TTuneRegion::OutputLoopFusionExecCode_Fortran</a></td>
<td nowrap><a href="5_7.htm">TuneRegion.cpp</a></td>
<td nowrap><a href="16_10_36.htm">8004</a></td>
</tr>
</table>

<p></p>
呼出し先関数一覧表
<table border="1">
<tr>
<th nowrap>№</th>
<th nowrap>名称</th>
<th nowrap>定義ファイル名</th>
<th nowrap>定義行</th>
</tr>
<tr>
<td nowrap>1</td>
<td nowrap><a href="31_21.htm">SepLongStr</a></td>
<td nowrap><a href="5_4.htm">pass3.cpp</a></td>
<td nowrap><a href="31_21.htm">950</a></td>
</tr>
<tr>
<td nowrap>2</td>
<td nowrap>Trim</td>
<td nowrap><a href="5_16.htm">VCL_Lib.h</a></td>
<td nowrap>105</td>
</tr>
<tr>
<td nowrap>3</td>
<td nowrap>c_str</td>
<td nowrap><br></td>
<td nowrap><br></td>
</tr>
<tr>
<td nowrap>4</td>
<td nowrap>find</td>
<td nowrap><br></td>
<td nowrap><br></td>
</tr>
<tr>
<td nowrap>5</td>
<td nowrap>fprintf</td>
<td nowrap><br></td>
<td nowrap><br></td>
</tr>
</table>

<p></p>

<p></p>
参照メンバ変数一覧表
<table border="1">
<tr>
<th nowrap>№</th>
<th nowrap>名称</th>
<th nowrap>定義ファイル名</th>
<th nowrap>定義行</th>
</tr>
<tr>
<td nowrap>1</td>
<td nowrap>TTuneRegion::DoEndEPos</td>
<td nowrap><a href="5_15.htm">TuneRegion.h</a></td>
<td nowrap>283</td>
</tr>
<tr>
<td nowrap>2</td>
<td nowrap>TTuneRegion::DoEndSPos</td>
<td nowrap><a href="5_15.htm">TuneRegion.h</a></td>
<td nowrap>282</td>
</tr>
<tr>
<td nowrap>3</td>
<td nowrap>TTuneRegion::DoStartEPos</td>
<td nowrap><a href="5_15.htm">TuneRegion.h</a></td>
<td nowrap>281</td>
</tr>
<tr>
<td nowrap>4</td>
<td nowrap>TTuneRegion::DoStartSPos</td>
<td nowrap><a href="5_15.htm">TuneRegion.h</a></td>
<td nowrap>280</td>
</tr>
<tr>
<td nowrap>5</td>
<td nowrap>TTuneRegion::DoValName</td>
<td nowrap><a href="5_15.htm">TuneRegion.h</a></td>
<td nowrap>158</td>
</tr>
<tr>
<td nowrap>6</td>
<td nowrap>TTuneRegion::TokenList</td>
<td nowrap><a href="5_15.htm">TuneRegion.h</a></td>
<td nowrap>187</td>
</tr>
</table>

<p></p>
参照先一覧表
<table border="1">
<tr>
<th nowrap>№</th>
<th nowrap>名称</th>
<th nowrap>種別</th>
<th nowrap>定義ファイル名</th>
<th nowrap>定義行</th>
</tr>
<tr>
<td nowrap>1</td>
<td nowrap><a href="16_9_1.htm">TToken</a></td>
<td nowrap>クラス</td>
<td nowrap><a href="5_10.htm">pass1.h</a></td>
<td nowrap><a href="16_9_1.htm">294</a></td>
</tr>
</table>

<p></p>
<pre>
関数論理チャート

        |  +------------------------------------------------------------------------------------------+ 
 12936  +--+ void TTuneRegion::OutputFusionDo(string FusionValName,FILE *fp,int DoNest,int FusionIdx) | 
 12937     | {                                                                                        | 
           +--+---------------------------------------------------------------------------------------+ 
 12938        +--- string s,s1,s2,s3,s4,s5;
 12939        +--- int k,k2,kk;
 12940        +--- TToken *Token;
 12941        |    
 12942        +--- //  fprintf(fp,&quot;OutputFusionDo DoNest %d FusionIdx %d \n&quot;,DoNest,FusionIdx);
 12943        |    //  if(DoNest == DoValCount-FusionIdx-1){   // 外側のFusionDoVal             
 12944        |    //  if(DoNest == FusionIdx){    // 外側のFusionDoVal                         
              |  +------------------------------------------+ 
 12945        +--+ if(DoNest == 0){    // 外側のFusionDoVal | 
              |  +--+---------------------------------------+ 
 12946        |     +--- s = &quot;      DO &quot;;
 12947        |     +--- s += FusionValName+&quot; = 1 , &quot;;
              |     |  +------------------------------------+ 
 12948        |     +--+ for(k = 0 ; k &lt;= FusionIdx ; k++){ | 
              |     |  +--+---------------------------------+ 
 12949        |     |     +--- s2 = &quot;&quot;;
 12950        |     |     +--- s3 = &quot;&quot;;
              |     |     |  +--------------------------------------------------+ 
 12951        |     |     +--+ for(kk = DoEndSPos[k];kk &lt; DoEndEPos[k]; kk++){  | 
              |     |     |  +--+-----------------------------------------------+ 
 12952        |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[kk];
 12953        |     |     |     +--- s2 += Token-&gt;Str;
              |     |     |   +-+---+ 
 12954        |     |     |   |  }  | 
              |     |     |   +-----+ 
              |     |     |  +------------------------------------------------------+ 
 12955        |     |     +--+ for(kk = DoStartSPos[k];kk &lt; DoStartEPos[k]; kk++){  | 
              |     |     |  +--+---------------------------------------------------+ 
 12956        |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[kk];
 12957        |     |     |     +--- s3 += Token-&gt;Str;
              |     |     |   +-+---+ 
 12958        |     |     |   |  }  | 
              |     |     |   +-----+ 
              |     |     |  +----------------------+ 
 12959        |     |     +--+ if(Trim(s3) != &quot;1&quot;){ | 
              |     |     |  +--+-------------------+ 
 12960        |     |     |     +--- s4 = &quot;(&quot;+s2+&quot;-&quot;+s3+&quot;+1)&quot;;
              |     |     |   +-+---+ 
 12961        |     |     |   |  }  | 
              |     |     |   +-+---+ 
              |     |     |   +-+-------+ 
 12961        |     |     |   |  else{  | 
              |     |     |   +-+-------+ 
 12962        |     |     |     +--- s4 = s2;
              |     |     |   +-+---+ 
 12963        |     |     |   |  }  | 
              |     |     |   +-----+ 
              |     |     |  +--------------+ 
 12964        |     |     +--+ if(k == 0){  | 
              |     |     |  +--+-----------+ 
 12965        |     |     |     +--- s += s4;
              |     |     |   +-+---+ 
 12966        |     |     |   |  }  | 
              |     |     |   +-+---+ 
              |     |     |   +-+-------+ 
 12966        |     |     |   |  else{  | 
              |     |     |   +-+-------+ 
 12967        |     |     |     +--- s += &quot;*&quot;+s4;
              |     |     |   +-+---+ 
 12968        |     |     |   |  }  | 
              |     |     |   +-----+ 
              |     |   +-+---+ 
 12969        |     |   |  }  | 
              |     |   +-----+ 
 12970        |     +--- fprintf(fp,&quot;%s\n&quot;,SepLongStr(s).c_str());
 12971        |     +--- // 元のDo変数をFusion用変数から作成する式を追加する。
 12972        |     +--- /*
 12973        |     |     do k_j = 1, (NZ01-NZ00+1)*(NY01-NY00+1)         
 12974        |     |          k = (k_j-1)/(NY01-NY00+1) + NZ00           
 12975        |     |          j = mod((k_j-1),(NY01-NY00+1)) + NY00      
 12976        |     |          j = mod((k_j-1),(NY01-NY00+1)) + NY00      
 12977        |     |    */                                               
 12978        |     |    /*                                               
 12979        |     |          k = (k_j-1)/(NY01-NY00+1) + NZ00           
 12980        |     |                                                     
 12981        |     |    */                                               
 12982        |     |    //      for(k = DoNest ; k &lt; DoValCount ; k++){  
              |     |  +------------------------------------+ 
 12983        |     +--+ for(k = 0 ; k &lt;= FusionIdx ; k++){ | 
              |     |  +--+---------------------------------+ 
 12984        |     |     +--- s = &quot;      &quot;;
 12985        |     |     +--- s += DoValName[k] + &quot; = &quot;;
 12986        |     |     +--- s1 = &quot;(&quot;+FusionValName+&quot;-1)&quot;;
 12987        |     |     +--- // 割る数を求める。
 12988        |     |     +--- s2 = &quot;&quot;;
 12989        |     |     +--- //          for(k2 = k+1 ; k2 &lt; DoValCount ; k2++){
              |     |     |  +------------------------------------------+ 
 12990        |     |     +--+ for(k2 = k+1 ; k2 &lt;= FusionIdx ; k2++){  | 
              |     |     |  +--+---------------------------------------+ 
              |     |     |     |  +----------------+ 
 12991        |     |     |     +--+ if(s2 != &quot;&quot;){  | 
              |     |     |     |  +--+-------------+ 
 12992        |     |     |     |     +--- s2 += &quot;*&quot;;
              |     |     |     |   +-+---+ 
 12993        |     |     |     |   |  }  | 
              |     |     |     |   +-----+ 
 12994        |     |     |     +--- s3 = &quot;&quot;;
 12995        |     |     |     +--- s4 = &quot;&quot;;
              |     |     |     |  +----------------------------------------------------+ 
 12996        |     |     |     +--+ for(kk = DoEndSPos[k2];kk &lt; DoEndEPos[k2]; kk++){  | 
              |     |     |     |  +--+-------------------------------------------------+ 
 12997        |     |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[kk];
 12998        |     |     |     |     +--- s3 += Token-&gt;Str;
              |     |     |     |   +-+---+ 
 12999        |     |     |     |   |  }  | 
              |     |     |     |   +-----+ 
              |     |     |     |  +--------------------------------------------------------+ 
 13000        |     |     |     +--+ for(kk = DoStartSPos[k2];kk &lt; DoStartEPos[k2]; kk++){  | 
              |     |     |     |  +--+-----------------------------------------------------+ 
 13001        |     |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[kk];
 13002        |     |     |     |     +--- s4 += Token-&gt;Str;
              |     |     |     |   +-+---+ 
 13003        |     |     |     |   |  }  | 
              |     |     |     |   +-----+ 
              |     |     |     |  +----------------------+ 
 13004        |     |     |     +--+ if(Trim(s4) != &quot;1&quot;){ | 
              |     |     |     |  +--+-------------------+ 
 13005        |     |     |     |     +--- s5 = &quot;(&quot;+s3+&quot;-&quot;+s4+&quot;+1)&quot;;
              |     |     |     |   +-+---+ 
 13006        |     |     |     |   |  }  | 
              |     |     |     |   +-+---+ 
              |     |     |     |   +-+-------+ 
 13006        |     |     |     |   |  else{  | 
              |     |     |     |   +-+-------+ 
 13007        |     |     |     |     +--- s5 = s3;
              |     |     |     |   +-+---+ 
 13008        |     |     |     |   |  }  | 
              |     |     |     |   +-----+ 
 13009        |     |     |     +--- s2 += s5;
              |     |     |   +-+---+ 
 13010        |     |     |   |  }  | 
              |     |     |   +-----+ 
              |     |     |  +------------------------------------+ 
 13011        |     |     +--+ if(s2.find('*') != string::npos){  | 
              |     |     |  +--+---------------------------------+ 
 13012        |     |     |     +--- s2 = &quot;(&quot;+s2+&quot;)&quot;;
              |     |     |   +-+---+ 
 13013        |     |     |   |  }  | 
              |     |     |   +-----+ 
 13014        |     |     +--- s3 = &quot;&quot;;    // 余りの計算用
              |     |     |  +--------------+ 
 13015        |     |     +--+ if(k != 0){  | 
              |     |     |  +--+-----------+ 
 13016        |     |     |     +--- k2 = k;
 13017        |     |     |     +--- s3 = &quot;&quot;;
 13018        |     |     |     +--- s4 = &quot;&quot;;
              |     |     |     |  +----------------------------------------------------+ 
 13019        |     |     |     +--+ for(kk = DoEndSPos[k2];kk &lt; DoEndEPos[k2]; kk++){  | 
              |     |     |     |  +--+-------------------------------------------------+ 
 13020        |     |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[kk];
 13021        |     |     |     |     +--- s3 += Token-&gt;Str;
              |     |     |     |   +-+---+ 
 13022        |     |     |     |   |  }  | 
              |     |     |     |   +-----+ 
              |     |     |     |  +--------------------------------------------------------+ 
 13023        |     |     |     +--+ for(kk = DoStartSPos[k2];kk &lt; DoStartEPos[k2]; kk++){  | 
              |     |     |     |  +--+-----------------------------------------------------+ 
 13024        |     |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[kk];
 13025        |     |     |     |     +--- s4 += Token-&gt;Str;
              |     |     |     |   +-+---+ 
 13026        |     |     |     |   |  }  | 
              |     |     |     |   +-----+ 
              |     |     |     |  +----------------------+ 
 13027        |     |     |     +--+ if(Trim(s4) != &quot;1&quot;){ | 
              |     |     |     |  +--+-------------------+ 
 13028        |     |     |     |     +--- s3 = &quot;(&quot;+s3+&quot;-&quot;+s4+&quot;+1)&quot;;
              |     |     |     |   +-+---+ 
 13029        |     |     |     |   |  }  | 
              |     |     |     |   +-----+ 
              |     |     |   +-+---+ 
 13030        |     |     |   |  }  | 
              |     |     |   +-----+ 
              |     |     |  +----------------+ 
 13031        |     |     +--+ if(s2 != &quot;&quot;){  | 
              |     |     |  +--+-------------+ 
 13032        |     |     |     +--- s1 = s1 + &quot;/&quot; + s2;
              |     |     |   +-+---+ 
 13033        |     |     |   |  }  | 
              |     |     |   +-----+ 
              |     |     |  +----------------+ 
 13034        |     |     +--+ if(s3 != &quot;&quot;){  | 
              |     |     |  +--+-------------+ 
 13035        |     |     |     +--- s1 = &quot;mod(&quot;+s1 + &quot;,&quot; + s3+&quot;)&quot;;
              |     |     |   +-+---+ 
 13036        |     |     |   |  }  | 
              |     |     |   +-----+ 
 13037        |     |     +--- s4 = &quot;&quot;;
              |     |     |  +------------------------------------------------------+ 
 13038        |     |     +--+ for(kk = DoStartSPos[k];kk &lt; DoStartEPos[k]; kk++){  | 
              |     |     |  +--+---------------------------------------------------+ 
 13039        |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[kk];
 13040        |     |     |     +--- s4 += Token-&gt;Str;
              |     |     |   +-+---+ 
 13041        |     |     |   |  }  | 
              |     |     |   +-----+ 
 13042        |     |     +--- s += s1 + &quot; + &quot;+s4;
 13043        |     |     +--- fprintf(fp,&quot;%s\n&quot;,SepLongStr(s).c_str());
              |     |   +-+---+ 
 13044        |     |   |  }  | 
              |     |   +-----+ 
              |   +-+---+ 
 13045        |   |  }  | 
              |   +-----+ 
            +-+---+ 
 13046      |  }  | 
            +-----+ 
</pre>


</body>
</html>
