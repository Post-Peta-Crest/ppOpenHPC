
<html>
<head>
<title>MakeIndexHTML メンバ関数説明</title><base target="main">
<link rel ="stylesheet" type="text/css" href="stylesheet.css" title="stylesheet">
<meta http-equiv="Content-Type" content="text/html;charset=Shift_JIS">
</head>

<body bgcolor="#ffffff">

<div align="right"><font size="2">ABCLibScriptC プロジェクト</font></div>

<table width=100% bgcolor="#e6e6fa" class="titlebgcolor" border="1" cellpadding="7" cellspacing="0">
<tr>
    <td><font class="titlefont">14.12.5. MakeIndexHTML メンバ関数説明</font></td>
</tr>
</table>

<p></p>
<table border="1">
<tr><th align="left" nowrap>メンバ関数名</th>  <td nowrap>MakeIndexHTML</td></tr>
<tr><th align="left" nowrap>定義ファイル名</th><td nowrap>Visual.cpp</td></tr>
<tr><th align="left" nowrap>定義行</th>        <td nowrap>209</td></tr>
<tr><th align="left" nowrap>所属名</th>        <td nowrap>TVisualDM</td></tr>
<tr><th align="left" nowrap>アクセス属性</th>  <td nowrap>private</td></tr>
<tr><th align="left" nowrap>宣言形式</th>      <td nowrap>void MakeIndexHTML ( )</td></tr>
<tr><th align="left" nowrap>概要</th>          <td nowrap>OAT_Index.htmlを作成する。</td></tr>
<tr><th align="left" nowrap>戻り値</th>        <td nowrap></td></tr>
<tr><th align="left" nowrap>パラメタ説明</th>  <td nowrap></td></tr>
<tr><th align="left" nowrap>機能説明</th>      <td nowrap></td></tr>
<tr><th align="left" nowrap>備考</th>          <td nowrap></td></tr>
</table>

<p></p>
呼出し元関数一覧表
<table border="1">
<tr>
<th nowrap>№</th>
<th nowrap>名称</th>
<th nowrap>定義ファイル名</th>
<th nowrap>定義行</th>
</tr>
<tr>
<td nowrap>1</td>
<td nowrap><a href="16_12_4.htm">TVisualDM::Exec</a></td>
<td nowrap><a href="5_8.htm">Visual.cpp</a></td>
<td nowrap><a href="16_12_4.htm">63</a></td>
</tr>
</table>

<p></p>
呼出し先関数一覧表
<table border="1">
<tr>
<th nowrap>№</th>
<th nowrap>名称</th>
<th nowrap>定義ファイル名</th>
<th nowrap>定義行</th>
</tr>
<tr>
<td nowrap>1</td>
<td nowrap><a href="16_2_6.htm">TMainF::ErrMessage</a></td>
<td nowrap><a href="5_1.htm">main.cpp</a></td>
<td nowrap><a href="16_2_6.htm">767</a></td>
</tr>
<tr>
<td nowrap>2</td>
<td nowrap><a href="16_12_8.htm">TVisualDM::StrToHTMLStr</a></td>
<td nowrap><a href="5_8.htm">Visual.cpp</a></td>
<td nowrap><a href="16_12_8.htm">727</a></td>
</tr>
<tr>
<td nowrap>3</td>
<td nowrap>IntToStr</td>
<td nowrap><a href="5_16.htm">VCL_Lib.h</a></td>
<td nowrap>107</td>
</tr>
<tr>
<td nowrap>4</td>
<td nowrap>c_str</td>
<td nowrap><br></td>
<td nowrap><br></td>
</tr>
<tr>
<td nowrap>5</td>
<td nowrap>fclose</td>
<td nowrap><br></td>
<td nowrap><br></td>
</tr>
<tr>
<td nowrap>6</td>
<td nowrap>fopen</td>
<td nowrap><br></td>
<td nowrap><br></td>
</tr>
<tr>
<td nowrap>7</td>
<td nowrap>fprintf</td>
<td nowrap><br></td>
<td nowrap><br></td>
</tr>
<tr>
<td nowrap>8</td>
<td nowrap>rfind</td>
<td nowrap><br></td>
<td nowrap><br></td>
</tr>
<tr>
<td nowrap>9</td>
<td nowrap>substr</td>
<td nowrap><br></td>
<td nowrap><br></td>
</tr>
</table>

<p></p>
参照外部変数一覧表
<table border="1">
<tr>
<th nowrap>№</th>
<th nowrap>名称</th>
<th nowrap>定義ファイル名</th>
<th nowrap>定義行</th>
</tr>
<tr>
<td nowrap>1</td>
<td nowrap>MainF</td>
<td nowrap><a href="5_1.htm">main.cpp</a></td>
<td nowrap>53</td>
</tr>
</table>

<p></p>
参照メンバ変数一覧表
<table border="1">
<tr>
<th nowrap>№</th>
<th nowrap>名称</th>
<th nowrap>定義ファイル名</th>
<th nowrap>定義行</th>
</tr>
<tr>
<td nowrap>1</td>
<td nowrap>TVisualDM::DirName</td>
<td nowrap><a href="5_17.htm">Visual.h</a></td>
<td nowrap>58</td>
</tr>
<tr>
<td nowrap>2</td>
<td nowrap>TVisualDM::RegionIndent</td>
<td nowrap><a href="5_17.htm">Visual.h</a></td>
<td nowrap>60</td>
</tr>
<tr>
<td nowrap>3</td>
<td nowrap>TVisualDM::TuneRegionList</td>
<td nowrap><a href="5_17.htm">Visual.h</a></td>
<td nowrap>59</td>
</tr>
</table>

<p></p>
参照先一覧表
<table border="1">
<tr>
<th nowrap>№</th>
<th nowrap>名称</th>
<th nowrap>種別</th>
<th nowrap>定義ファイル名</th>
<th nowrap>定義行</th>
</tr>
<tr>
<td nowrap>1</td>
<td nowrap><a href="16_1_1.htm">TList</a></td>
<td nowrap>クラス</td>
<td nowrap><a href="5_16.htm">VCL_Lib.h</a></td>
<td nowrap><a href="16_1_1.htm">57</a></td>
</tr>
<tr>
<td nowrap>2</td>
<td nowrap><a href="16_5_1.htm">TScript</a></td>
<td nowrap>クラス</td>
<td nowrap><a href="5_12.htm">pass3.h</a></td>
<td nowrap><a href="16_5_1.htm">209</a></td>
</tr>
<tr>
<td nowrap>3</td>
<td nowrap><a href="16_9_1.htm">TToken</a></td>
<td nowrap>クラス</td>
<td nowrap><a href="5_10.htm">pass1.h</a></td>
<td nowrap><a href="16_9_1.htm">294</a></td>
</tr>
<tr>
<td nowrap>4</td>
<td nowrap><a href="16_10_1.htm">TTuneRegion</a></td>
<td nowrap>クラス</td>
<td nowrap><a href="5_15.htm">TuneRegion.h</a></td>
<td nowrap><a href="16_10_1.htm">143</a></td>
</tr>
</table>

<p></p>
<pre>
関数論理チャート

        |  +----------------------------------+ 
   209  +--+ void TVisualDM::MakeIndexHTML()  | 
   210     | {                                | 
           +--+-------------------------------+ 
   211        +--- FILE *fp;
   212        +--- string FileName,s;
   213        +--- string SrcFileName;
   214        +--- TTuneRegion *TuneRegion;
   215        +--- int i;
   216        +--- TList *TokenList;
   217        +--- TToken *Token;
   218        +--- int RegionIdx = 0;
   219        |    
   220        +--- TokenList = MainF-&gt;TokenList;
   221        |    
   222        +--- FileName = DirName + &quot;/OAT/OATLog.html&quot;;
   223        +--- fp = fopen(FileName.c_str(),&quot;wt&quot;);
              |  +------------------+ 
   224        +--+ if(fp == NULL){  | 
              |  +--+---------------+ 
   225        |     +--- MainF-&gt;ErrMessage(-1,&quot;File Open Err &quot;+ FileName);
              |     |  +----------+ 
   226        |     +--+ return;  | 
              |     |  +----------+ 
              |   +-+---+ 
   227        |   |  }  | 
              |   +-----+ 
   228        +--- //
   229        |    // HTMLファイルを出力する。  
   230        |    //                           
   231        +--- fprintf(fp,&quot;&lt;html&gt;\n&quot;);
   232        +--- fprintf(fp,&quot;&lt;head&gt;\n&quot;);
   233        +--- fprintf(fp,&quot;&lt;meta http-equiv=\&quot;Content-Type\&quot; content=\&quot;text/html; charset=shift_jis\&quot;&gt;\n&quot;);
   234        +--- fprintf(fp,&quot;&lt;meta name=\&quot;GENERATOR\&quot; content=\&quot;OAT 1.0\&quot;&gt;\n&quot;);
   235        +--- fprintf(fp,&quot;&lt;title&gt;OAT&lt;/title&gt;\n&quot;);
   236        +--- fprintf(fp,&quot;&lt;/head&gt;\n&quot;);
   237        |    
   238        +--- fprintf(fp,&quot;&lt;body onLoad = \&quot;JSStart()\&quot; &gt;\n&quot;);
   239        +--- fprintf(fp,&quot;&lt;h1 align = \&quot;center\&quot;&gt;&lt;b&gt;OAT&lt;/b&gt;\n&quot;);
   240        +--- fprintf(fp,&quot;&lt;/h1&gt;\n&quot;);
   241        |    
   242        +--- //
   243        |    // ファイル名  
   244        |    //             
   245        +--- SrcFileName = MainF-&gt;SrcFileNameList.Strings[0];
   246        +--- s = &quot;SrcFile = &quot; + DirName +&quot;/&quot;+ SrcFileName.substr(SrcFileName.rfind(&quot;/&quot;)+1);
   247        +--- s = StrToHTMLStr(s);
   248        +--- fprintf(fp,&quot;&lt;h3 align = \&quot;center\&quot;&gt;&lt;b&gt;%s&lt;/b&gt;\n&quot;,s.c_str());
   249        +--- fprintf(fp,&quot;&lt;/h3&gt;\n&quot;);
   250        |    
   251        +--- //
   252        |    // 実行状態の表を出力  
   253        |    //                     
   254        +--- fprintf(fp,&quot;&lt;table border=\&quot;1\&quot; width=\&quot;100%%\&quot; height=\&quot;%d\&quot;&gt;\n&quot;,16*(TuneRegionList-&gt;Count+1));
   255        +--- fprintf(fp,&quot;&lt;tr&gt;\n&quot;);
   256        +--- fprintf(fp,&quot;&lt;td width=\&quot;35%%\&quot; height=\&quot;14\&quot;&gt;Auto tuning region name&lt;/td&gt;\n&quot;);
   257        +--- fprintf(fp,&quot;&lt;td width=\&quot;30%%\&quot; height=\&quot;14\&quot;&gt;Execute status&lt;/td&gt;\n&quot;);
   258        +--- fprintf(fp,&quot;&lt;td width=\&quot;25%%\&quot; height=\&quot;14\&quot;&gt;Link to result page&lt;/td&gt;\n&quot;);
   259        +--- fprintf(fp,&quot;&lt;/tr&gt;\n&quot;);
   260        |    
   261        +--- //
   262        |    // 各TuneRegionの名前・状態・リンクを出力  
   263        |    //                                         
              |  +------------------------------------------------+ 
   264        +--+ for(i = 0 ; i &lt; TuneRegionList-&gt;Count ; i++){  | 
              |  +--+---------------------------------------------+ 
   265        |     +--- TuneRegion = (TTuneRegion *)TuneRegionList-&gt;Items[i];
   266        |     |    
   267        |     +--- fprintf(fp,&quot;&lt;tr&gt;\n&quot;);
   268        |     +--- //    &lt;td width=&quot;46%&quot; height=&quot;16&quot;&gt;&lt;a href=&quot;#1&quot; name=&quot;0&quot;&gt;matmul1 [Select1.f :45- 56]&lt;/a&gt;&lt;/td&gt;
   269        |     +--- fprintf(fp,&quot;&lt;td width=\&quot;35%%\&quot; height=\&quot;16\&quot;&gt;&lt;a href=\&quot;#%d\&quot;&gt;%s&lt;/td&gt;\n&quot;,i,TuneRegion-&gt;Name.c_str());
   270        |     +--- fprintf(fp,&quot;&lt;td width=\&quot;30%%\&quot; height=\&quot;16\&quot;&gt;\n&quot;);
   271        |     +--- fprintf(fp,&quot;&lt;applet\n&quot;);
   272        |     +--- fprintf(fp,&quot;codebase = \&quot;./\&quot;\n&quot;);
   273        |     +--- fprintf(fp,&quot;code = \&quot;vlapplet.Applet1.class\&quot;\n&quot;);
   274        |     +--- fprintf(fp,&quot;archive = \&quot;vlapplet.jar\&quot;\n&quot;);
   275        |     |    
   276        |     +--- fprintf(fp,&quot;name = \&quot;bar%d\&quot;\n&quot;,i);
   277        |     +--- fprintf(fp,&quot;width = \&quot;100%%\&quot;\n&quot;);
   278        |     +--- fprintf(fp,&quot;height = \&quot;100%%\&quot;\n&quot;);
   279        |     +--- fprintf(fp,&quot;alt = \&quot;Java Applet\&quot;&gt;\n&quot;);
   280        |     +--- fprintf(fp,&quot;&lt;param name=\&quot;FolderName\&quot; value=\&quot;bar0-\&quot;&gt;\n&quot;);
   281        |     +--- //      fprintf(fp,&quot;&lt;param name=\&quot;BackColor\&quot; value=\&quot;16777215\&quot;&gt;\n&quot;);
              |     |  +------------------------------------------------+ 
   282        |     +--+ if(i == 0){ // Table読込みは、最初のAppletのみ | 
              |     |  +--+---------------------------------------------+ 
   283        |     |     +--- fprintf(fp,&quot;&lt;param name=\&quot;FILENAME\&quot; value=\&quot;OATLog.dat\&quot;&gt;\n&quot;);
              |     |   +-+---+ 
   284        |     |   |  }  | 
              |     |   +-----+ 
   285        |     +--- fprintf(fp,&quot;&lt;/applet&gt;&lt;/td&gt;\n&quot;);
   286        |     |    
   287        |     +--- fprintf(fp,&quot;&lt;td width=\&quot;25%%\&quot; height=\&quot;16\&quot; align=\&quot;center\&quot;&gt;\n&quot;);
   288        |     +--- fprintf(fp,&quot;&lt;p align=\&quot;center\&quot;&gt;&quot;);
   289        |     +--- fprintf(fp,&quot;&lt;a href=\&quot;./OATLog_%s.html\&quot; target=\&quot;_blank\&quot;&gt;Result&lt;/a&gt;&lt;/td&gt;\n&quot;,
   290        |     |                TuneRegion-&gt;Name.c_str());                                         
   291        |     +--- fprintf(fp,&quot;&lt;/tr&gt;\n&quot;);
              |   +-+---+ 
   292        |   |  }  | 
              |   +-----+ 
   293        +--- fprintf(fp,&quot;&lt;/table&gt;\n&quot;);
   294        +--- fprintf(fp,&quot;\n&quot;);
   295        +--- //  &lt;p&gt;
   296        |             
   297        |             
   298        +--- //
   299        |    // JavaScript部分を出力  
   300        |    //                       
   301        +--- fprintf(fp,&quot;&lt;script type=\&quot;text/javascript\&quot;&gt;\n&quot;);
   302        +--- fprintf(fp,&quot;&lt;!--\n&quot;);
   303        +--- fprintf(fp,&quot;var id = -1;\n&quot;);
              |  +------------------------------------------------+ 
   304        +--+ for(i = 0 ; i &lt; TuneRegionList-&gt;Count ; i++){  | 
              |  +--+---------------------------------------------+ 
   305        |     +--- fprintf(fp,&quot;var id%d = -1;\n&quot;,i);
              |   +-+---+ 
   306        |   |  }  | 
              |   +-----+ 
   307        |    
   308        +--- fprintf(fp,&quot;function JSStart() {\n&quot;);
   309        +--- fprintf(fp,&quot;if(id == -1){\n&quot;);
   310        +--- fprintf(fp,&quot;id = document.bar0.getId(\&quot;Table@d\&quot;);\n&quot;);
              |  +------------------------------------------------+ 
   311        +--+ for(i = 0 ; i &lt; TuneRegionList-&gt;Count ; i++){  | 
              |  +--+---------------------------------------------+ 
   312        |     +--- fprintf(fp,&quot;id%d = document.bar%d.getId(\&quot;@p\&quot;);\n&quot;,i,i);
              |   +-+---+ 
   313        |   |  }  | 
              |   +-----+ 
   314        +--- fprintf(fp,&quot;}\n&quot;);
              |  +------------------------------------------------+ 
   315        +--+ for(i = 0 ; i &lt; TuneRegionList-&gt;Count ; i++){  | 
              |  +--+---------------------------------------------+ 
   316        |     +--- fprintf(fp,&quot;bar%d.put(id%d,document.bar0.get(id,%d)/100.0);\n&quot;,i,i,i);
              |   +-+---+ 
   317        |   |  }  | 
              |   +-----+ 
   318        +--- fprintf(fp,&quot;window.setTimeout(\&quot;JSStart()\&quot;, 1000);\n&quot;);
   319        +--- fprintf(fp,&quot;}\n&quot;);
   320        +--- fprintf(fp,&quot;// --&gt;\n&quot;);
   321        +--- fprintf(fp,&quot;&lt;/script&gt;\n&quot;);
   322        +--- fprintf(fp,&quot;&lt;noscript&gt;\n&quot;);
   323        +--- fprintf(fp,&quot;JavaScript対応ブラウザで表示してください。&lt;/p&gt;\n&quot;);
   324        +--- fprintf(fp,&quot;&lt;p&gt;&lt;/noscript&gt;\n&quot;);
   325        +--- fprintf(fp,&quot;&lt;br&gt;\n&quot;);
   326        |    
   327        |     
   328        +--- //
   329        |    // ソースコード＋反転＋Ｌｉｎｋを出力                      
   330        |    // また、スペースや&lt;&gt;&quot;を置換して出力する。                 
   331        |    // さらにリージョンの深さに対応したインデントを付加する。  
   332        |    //                                                         
   333        +--- string ss;
   334        +--- TScript *Script;
   335        +--- RegionIndent = 0;
   336        +--- int RegionIdxStack[1024];
   337        |    
   338        +--- ss = &quot;&quot;;
              |  +------------------------------------------+ 
   339        +--+ for(i = 0 ; i &lt; TokenList-&gt;Count ; i++){ | 
              |  +--+---------------------------------------+ 
   340        |     +--- Token = (TToken *)TokenList-&gt;Items[i];
   341        |     +--- s = Token-&gt;OrgStr;
              |     |  +--------------------------------+ 
   342        |     +--+ if(Token-&gt;TokId == tid_null){  | 
              |     |  +--+-----------------------------+ 
   343        |     |     |    
              |     |   +-+---+ 
   344        |     |   |  }  | 
              |     |   +-+---+ 
              |     |   +-+---------------------------------------+ 
   344        |     |   |  else if(Token-&gt;TokId == tid_LineEnd){  | 
              |     |   +-+---------------------------------------+ 
              |     |     |  +----------------+ 
   345        |     |     +--+ if(ss != &quot;&quot;){  | 
              |     |     |  +--+-------------+ 
              |     |     |     |  +----------------------------------------------+ 
   346        |     |     |     +--+ for(int ii = 0 ; ii &lt; RegionIndent ; ii++){  | 
              |     |     |     |  +--+-------------------------------------------+ 
   347        |     |     |     |     +--- fprintf(fp,&quot;&amp;nbsp&amp;nbsp&quot;);   // インデント+2
              |     |     |     |   +-+---+ 
   348        |     |     |     |   |  }  | 
              |     |     |     |   +-----+ 
   349        |     |     |     +--- fprintf(fp,&quot;%s&lt;br&gt;\n&quot;,ss.c_str());
              |     |     |   +-+---+ 
   350        |     |     |   |  }  | 
              |     |     |   +-----+ 
   351        |     |     +--- ss = &quot;&quot;;
              |     |   +-+---+ 
   352        |     |   |  }  | 
              |     |   +-+---+ 
              |     |   +-+---------------------------------+ 
   352        |     |   |  else if(Token-&gt;Script != NULL){  | 
              |     |   +-+---------------------------------+ 
   353        |     |     +--- Script = (TScript *)Token-&gt;Script;
              |     |     |  +------------------------------------+ 
   354        |     |     +--+ if(Script-&gt;ScRegion == scr_start){ | 
              |     |     |  +--+---------------------------------+ 
   355        |     |     |     +--- TuneRegion = (TTuneRegion *)TuneRegionList-&gt;Items[RegionIdx];
   356        |     |     |     +--- ss += &quot;&lt;i&gt;&lt;a name=\&quot;&quot;+IntToStr(RegionIdx)+&quot;\&quot;&gt;&quot;;
   357        |     |     |     +--- ss += &quot;&lt;a href=\&quot;./OATLog_&quot;+TuneRegion-&gt;Name+&quot;.html\&quot;  target=\&quot;_blank\&quot;&quot; ;
   358        |     |     |     +--- ss += &quot;&lt;font color=\&quot;#0000FF\&quot;&gt;&quot;+StrToHTMLStr(s)+&quot;&lt;/font&gt;&quot;;
   359        |     |     |     +--- ss += &quot;&lt;/i&gt;&lt;/a&gt;&quot;;
              |     |     |     |  +----------------------------------------------+ 
   360        |     |     |     +--+ for(int ii = 0 ; ii &lt; RegionIndent ; ii++){  | 
              |     |     |     |  +--+-------------------------------------------+ 
   361        |     |     |     |     +--- fprintf(fp,&quot;&amp;nbsp&amp;nbsp&quot;);   // インデント+2
              |     |     |     |   +-+---+ 
   362        |     |     |     |   |  }  | 
              |     |     |     |   +-----+ 
   363        |     |     |     +--- fprintf(fp,&quot;%s&lt;br&gt;\n&quot;,ss.c_str());
   364        |     |     |     +--- ss = &quot;&quot;;
   365        |     |     |     +--- RegionIdxStack[RegionIndent] = RegionIdx;
   366        |     |     |     +--- RegionIdx++;
   367        |     |     |     +--- RegionIndent++;
              |     |     |   +-+---+ 
   368        |     |     |   |  }  | 
              |     |     |   +-+---+ 
              |     |     |   +-+---------------------------------------+ 
   368        |     |     |   |  else if(Script-&gt;ScRegion == scr_end){  | 
              |     |     |   +-+---------------------------------------+ 
   369        |     |     |     +--- RegionIndent--;
   370        |     |     |     +--- #if 0
   371        |     |     |     +--- ss += &quot;&lt;i&gt;&lt;font color=\&quot;#0000FF\&quot;&gt;&quot;+StrToHTMLStr(s)+&quot;&lt;/font&gt;&lt;/i&gt;&quot;;
   372        |     |     |     +--- #else
   373        |     |     |     +--- TuneRegion = (TTuneRegion *)TuneRegionList-&gt;Items[RegionIdxStack[RegionIndent]];
   374        |     |     |     +--- ss += &quot;&lt;i&gt;&lt;a name=\&quot;&quot;+IntToStr(RegionIdx)+&quot;\&quot;&gt;&quot;;
   375        |     |     |     +--- ss += &quot;&lt;a href=\&quot;./OATLog_&quot;+TuneRegion-&gt;Name+&quot;.html\&quot;  target=\&quot;_blank\&quot;&quot; ;
   376        |     |     |     +--- ss += &quot;&lt;font color=\&quot;#0000FF\&quot;&gt;&quot;+StrToHTMLStr(s)+&quot;&lt;/font&gt;&quot;;
   377        |     |     |     +--- ss += &quot;&lt;/i&gt;&lt;/a&gt;&quot;;
   378        |     |     |     +--- #endif
   379        |     |     |     |    
              |     |     |   +-+---+ 
   380        |     |     |   |  }  | 
              |     |     |   +-+---+ 
              |     |     |   +-+-------------------------------------------+ 
   380        |     |     |   |  else if(Script-&gt;ScRegion == scr_substart){ | 
              |     |     |   +-+-------------------------------------------+ 
   381        |     |     |     +--- ss += &quot;&lt;i&gt;&lt;font color=\&quot;#008000\&quot;&gt;&quot;+StrToHTMLStr(s)+&quot;&lt;/font&gt;&lt;/i&gt;&quot;;
   382        |     |     |     |    
              |     |     |     |  +----------------------------------------------+ 
   383        |     |     |     +--+ for(int ii = 0 ; ii &lt; RegionIndent ; ii++){  | 
              |     |     |     |  +--+-------------------------------------------+ 
   384        |     |     |     |     +--- fprintf(fp,&quot;&amp;nbsp&amp;nbsp&quot;);   // インデント+2
              |     |     |     |   +-+---+ 
   385        |     |     |     |   |  }  | 
              |     |     |     |   +-----+ 
   386        |     |     |     +--- fprintf(fp,&quot;%s&lt;br&gt;\n&quot;,ss.c_str());
   387        |     |     |     +--- ss = &quot;&quot;;
   388        |     |     |     |    
   389        |     |     |     +--- RegionIndent++;
              |     |     |   +-+---+ 
   390        |     |     |   |  }  | 
              |     |     |   +-+---+ 
              |     |     |   +-+-----------------------------------------+ 
   390        |     |     |   |  else if(Script-&gt;ScRegion == scr_subend){ | 
              |     |     |   +-+-----------------------------------------+ 
   391        |     |     |     +--- ss += &quot;&lt;i&gt;&lt;font color=\&quot;#008000\&quot;&gt;&quot;+StrToHTMLStr(s)+&quot;&lt;/font&gt;&lt;/i&gt;&quot;;
   392        |     |     |     +--- RegionIndent--;
              |     |     |   +-+---+ 
   393        |     |     |   |  }  | 
              |     |     |   +-+---+ 
              |     |     |   +-+-------+ 
   393        |     |     |   |  else{  | 
              |     |     |   +-+-------+ 
   394        |     |     |     +--- ss += &quot;&lt;i&gt;&lt;font color=\&quot;#000080\&quot;&gt;&quot;+StrToHTMLStr(s)+&quot;&lt;/font&gt;&lt;/i&gt;&quot;;
   395        |     |     |     +--- //              ss += &quot;&lt;i&gt;&quot;+StrToHTMLStr(s)+&quot;&lt;/i&gt;&quot;;
              |     |     |   +-+---+ 
   396        |     |     |   |  }  | 
              |     |     |   +-----+ 
              |     |   +-+---+ 
   397        |     |   |  }  | 
              |     |   +-+---+ 
              |     |   +-+-------+ 
   397        |     |   |  else{  | 
              |     |   +-+-------+ 
   398        |     |     +--- ss += StrToHTMLStr(s);
   399        |     |     +--- /*
   400        |     |     |                if(Token-&gt;TokId == tid_END){    // Endの後は、改行追加 
   401        |     |     |                    ss += &quot;&lt;br&gt;&quot;;                                      
   402        |     |     |                }                                                      
   403        |     |     |    */                                                                 
              |     |   +-+---+ 
   404        |     |   |  }  | 
              |     |   +-----+ 
              |   +-+---+ 
   405        |   |  }  | 
              |   +-----+ 
   406        +--- fprintf(fp,&quot;&lt;/body&gt;\n&quot;);
   407        +--- fprintf(fp,&quot;&lt;/html&gt;\n&quot;);
   408        |    
   409        +--- fclose(fp);
            +-+---+ 
   410      |  }  | 
            +-----+ 
</pre>


</body>
</html>
