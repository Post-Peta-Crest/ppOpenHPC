
<html>
<head>
<title>CheckAndDeleteLocalValDefine メンバ関数説明</title><base target="main">
<link rel ="stylesheet" type="text/css" href="stylesheet.css" title="stylesheet">
<meta http-equiv="Content-Type" content="text/html;charset=Shift_JIS">
</head>

<body bgcolor="#ffffff">

<div align="right"><font size="2">ABCLibScriptC プロジェクト</font></div>

<table width=100% bgcolor="#e6e6fa" class="titlebgcolor" border="1" cellpadding="7" cellspacing="0">
<tr>
    <td><font class="titlefont">14.4.5. CheckAndDeleteLocalValDefine メンバ関数説明</font></td>
</tr>
</table>

<p></p>
<table border="1">
<tr><th align="left" nowrap>メンバ関数名</th>  <td nowrap>CheckAndDeleteLocalValDefine</td></tr>
<tr><th align="left" nowrap>定義ファイル名</th><td nowrap>pass5.cpp</td></tr>
<tr><th align="left" nowrap>定義行</th>        <td nowrap>2833</td></tr>
<tr><th align="left" nowrap>所属名</th>        <td nowrap>TPass5</td></tr>
<tr><th align="left" nowrap>アクセス属性</th>  <td nowrap>private</td></tr>
<tr><th align="left" nowrap>宣言形式</th>      <td nowrap>void CheckAndDeleteLocalValDefine ( )</td></tr>
<tr><th align="left" nowrap>概要</th>          <td nowrap>モジュール内にリージョンを含んでいる場合に、リージョン内以外で使用されていない<br>変数定義を削除する</td></tr>
<tr><th align="left" nowrap>戻り値</th>        <td nowrap>なし</td></tr>
<tr><th align="left" nowrap>パラメタ説明</th>  <td nowrap></td></tr>
<tr><th align="left" nowrap>機能説明</th>      <td nowrap>変数のみ削除する場合は変数トークンを空白にする。<br>変数定義行を全てコメントにする場合は先頭から改行位置までをコメントにする</td></tr>
<tr><th align="left" nowrap>備考</th>          <td nowrap></td></tr>
</table>

<p></p>
呼出し元関数一覧表
<table border="1">
<tr>
<th nowrap>№</th>
<th nowrap>名称</th>
<th nowrap>定義ファイル名</th>
<th nowrap>定義行</th>
</tr>
<tr>
<td nowrap>1</td>
<td nowrap><a href="16_4_10.htm">TPass5::MakeFunctionCode_Fortran</a></td>
<td nowrap><a href="5_6.htm">pass5.cpp</a></td>
<td nowrap><a href="16_4_10.htm">1837</a></td>
</tr>
</table>

<p></p>
呼出し先関数一覧表
<table border="1">
<tr>
<th nowrap>№</th>
<th nowrap>名称</th>
<th nowrap>定義ファイル名</th>
<th nowrap>定義行</th>
</tr>
<tr>
<td nowrap>1</td>
<td nowrap>TList::Add</td>
<td nowrap><a href="5_16.htm">VCL_Lib.h</a></td>
<td nowrap>64</td>
</tr>
<tr>
<td nowrap>2</td>
<td nowrap>TList::IndexOf</td>
<td nowrap><a href="5_16.htm">VCL_Lib.h</a></td>
<td nowrap>68</td>
</tr>
</table>

<p></p>
参照外部変数一覧表
<table border="1">
<tr>
<th nowrap>№</th>
<th nowrap>名称</th>
<th nowrap>定義ファイル名</th>
<th nowrap>定義行</th>
</tr>
<tr>
<td nowrap>1</td>
<td nowrap>MainF</td>
<td nowrap><a href="5_1.htm">main.cpp</a></td>
<td nowrap>53</td>
</tr>
</table>

<p></p>
参照メンバ変数一覧表
<table border="1">
<tr>
<th nowrap>№</th>
<th nowrap>名称</th>
<th nowrap>定義ファイル名</th>
<th nowrap>定義行</th>
</tr>
<tr>
<td nowrap>1</td>
<td nowrap>TPass5::TokenList</td>
<td nowrap><a href="5_14.htm">pass5.h</a></td>
<td nowrap>69</td>
</tr>
<tr>
<td nowrap>2</td>
<td nowrap>TPass5::TuneRegionList</td>
<td nowrap><a href="5_14.htm">pass5.h</a></td>
<td nowrap>71</td>
</tr>
</table>

<p></p>
参照先一覧表
<table border="1">
<tr>
<th nowrap>№</th>
<th nowrap>名称</th>
<th nowrap>種別</th>
<th nowrap>定義ファイル名</th>
<th nowrap>定義行</th>
</tr>
<tr>
<td nowrap>1</td>
<td nowrap><a href="16_1_1.htm">TList</a></td>
<td nowrap>クラス</td>
<td nowrap><a href="5_16.htm">VCL_Lib.h</a></td>
<td nowrap><a href="16_1_1.htm">57</a></td>
</tr>
<tr>
<td nowrap>2</td>
<td nowrap><a href="16_9_1.htm">TToken</a></td>
<td nowrap>クラス</td>
<td nowrap><a href="5_10.htm">pass1.h</a></td>
<td nowrap><a href="16_9_1.htm">294</a></td>
</tr>
<tr>
<td nowrap>3</td>
<td nowrap><a href="16_10_1.htm">TTuneRegion</a></td>
<td nowrap>クラス</td>
<td nowrap><a href="5_15.htm">TuneRegion.h</a></td>
<td nowrap><a href="16_10_1.htm">143</a></td>
</tr>
<tr>
<td nowrap>4</td>
<td nowrap><a href="16_11_1.htm">TValData</a></td>
<td nowrap>クラス</td>
<td nowrap><a href="5_11.htm">pass2.h</a></td>
<td nowrap><a href="16_11_1.htm">106</a></td>
</tr>
</table>

<p></p>
<pre>
関数論理チャート

        |  +----------------------------------------------+ 
  2833  +--+ void TPass5::CheckAndDeleteLocalValDefine()  | 
  2834     | {                                            | 
           +--+-------------------------------------------+ 
  2835        +--- int i,j,k;
  2836        +--- TTuneRegion *TuneRegion;
  2837        +--- TList *ModuleList;
  2838        +--- string s,s1,s2;
  2839        +--- int TokPos,TokPos2,ModuleIdx;
  2840        +--- TToken *Token;
  2841        +--- TToken *Token2;
  2842        +--- int ModuleSPos, ModuleEPos;
  2843        |    
  2844        +--- //
  2845        |    // リージョンの属するモジュールの先頭と最後を探す。      
  2846        |    // 開始位置から先頭かモジュールが変化するまで検索する。  
  2847        |    //                                                       
  2848        +--- ModuleList = new TList;
              |  +------------------------------------------------+ 
  2849        +--+ for(i = 0 ; i &lt; TuneRegionList-&gt;Count ; i++){  | 
              |  +--+---------------------------------------------+ 
  2850        |     +--- TuneRegion = (TTuneRegion *)TuneRegionList-&gt;Items[i];
  2851        |     +--- TokPos = TuneRegion-&gt;TokenStartPos;
  2852        |     +--- Token = (TToken *)TokenList-&gt;Items[TokPos];
  2853        |     +--- ModuleIdx = Token-&gt;ModuleIdx;
              |     |  +--------------------------------+ 
  2854        |     +--+ for(;TokPos &gt;= 0 ; TokPos--){  | 
              |     |  +--+-----------------------------+ 
  2855        |     |     +--- Token = (TToken *)TokenList-&gt;Items[TokPos];
              |     |     |  +------------------------------------+ 
  2856        |     |     +--+ if(ModuleIdx != Token-&gt;ModuleIdx){ | 
              |     |     |  +--+---------------------------------+ 
              |     |     |     |  +--------+ 
  2857        |     |     |     +--+ break; | 
              |     |     |     |  +--------+ 
              |     |     |   +-+---+ 
  2858        |     |     |   |  }  | 
              |     |     |   +-----+ 
              |     |   +-+---+ 
  2859        |     |   |  }  | 
              |     |   +-----+ 
  2860        |     +--- ModuleSPos = TokPos+1;
  2861        |     +--- TokPos = TuneRegion-&gt;TokenEndPos;
              |     |  +----------------------------------------------+ 
  2862        |     +--+ for(;TokPos &lt; TokenList-&gt;Count ; TokPos++){  | 
              |     |  +--+-------------------------------------------+ 
  2863        |     |     +--- Token = (TToken *)TokenList-&gt;Items[TokPos];
              |     |     |  +------------------------------------+ 
  2864        |     |     +--+ if(ModuleIdx != Token-&gt;ModuleIdx){ | 
              |     |     |  +--+---------------------------------+ 
              |     |     |     |  +--------+ 
  2865        |     |     |     +--+ break; | 
              |     |     |     |  +--------+ 
              |     |     |   +-+---+ 
  2866        |     |     |   |  }  | 
              |     |     |   +-----+ 
              |     |   +-+---+ 
  2867        |     |   |  }  | 
              |     |   +-----+ 
  2868        |     +--- ModuleEPos = TokPos;
  2869        |     +--- ModuleList-&gt;Add((void *)(long)ModuleSPos);
  2870        |     +--- ModuleList-&gt;Add((void *)(long)ModuleEPos);
              |   +-+---+ 
  2871        |   |  }  | 
              |   +-----+ 
  2872        +--- //
  2873        |    //  モジュール内でのリージョン以外での変数の使用状態をチェックする。 
  2874        |    //                                                                   
  2875        |    //                                                                   
              |  +--------------------------------------------+ 
  2876        +--+ for(i = 0 ; i &lt; ModuleList-&gt;Count ; i+=2){ | 
              |  +--+-----------------------------------------+ 
  2877        |     +--- //
  2878        |     |    //  変数の定義、参照数をカウントする。 
  2879        |     |    //                                     
  2880        |     +--- TValData *ValData;
  2881        |     +--- TValData *ValData2;
  2882        |     +--- TList *UseValDataList;
  2883        |     +--- TList *UseValDataCountList;
  2884        |     +--- TList *DelValDefList;
  2885        |     +--- int Idx;
  2886        |     +--- int UseCount;
  2887        |     |    
  2888        |     +--- UseValDataList = new TList;
  2889        |     +--- UseValDataCountList = new TList;
  2890        |     +--- DelValDefList = new TList;
  2891        |     |    
  2892        |     +--- ModuleSPos = (long)ModuleList-&gt;Items[i];
  2893        |     +--- ModuleEPos = (long)ModuleList-&gt;Items[i+1];
              |     |  +------------------------------------------------------------+ 
  2894        |     +--+ for(TokPos = ModuleSPos ; TokPos &lt; ModuleEPos ; TokPos++){ | 
              |     |  +--+---------------------------------------------------------+ 
  2895        |     |     +--- Token = (TToken *)TokenList-&gt;Items[TokPos];
              |     |     |  +------------------------------+ 
  2896        |     |     +--+ if(Token-&gt;ValData != NULL){  | 
              |     |     |  +--+---------------------------+ 
  2897        |     |     |     +--- ValData = (TValData *)Token-&gt;ValData;
  2898        |     |     |     +--- Idx = UseValDataList-&gt;IndexOf(ValData);
              |     |     |     |  +----------------+ 
  2899        |     |     |     +--+ if(Idx == -1){ | 
              |     |     |     |  +--+-------------+ 
  2900        |     |     |     |     +--- UseValDataList-&gt;Add(ValData);
  2901        |     |     |     |     +--- UseValDataCountList-&gt;Add((void *)1);
              |     |     |     |   +-+---+ 
  2902        |     |     |     |   |  }  | 
              |     |     |     |   +-+---+ 
              |     |     |     |   +-+-------+ 
  2902        |     |     |     |   |  else{  | 
              |     |     |     |   +-+-------+ 
  2903        |     |     |     |     +--- UseCount = (long)UseValDataCountList-&gt;Items[Idx];
  2904        |     |     |     |     +--- UseCount++;
  2905        |     |     |     |     +--- UseValDataCountList-&gt;Items[Idx] = (void *)(long)UseCount;
              |     |     |     |   +-+---+ 
  2906        |     |     |     |   |  }  | 
              |     |     |     |   +-----+ 
              |     |     |   +-+---+ 
  2907        |     |     |   |  }  | 
              |     |     |   +-----+ 
              |     |   +-+---+ 
  2908        |     |   |  }  | 
              |     |   +-----+ 
  2909        |     +--- //
  2910        |     |    //  モジュール内のリージョンに関してカウント数から削除する。 
  2911        |     |    //                                                           
              |     |  +------------------------------------------------+ 
  2912        |     +--+ for(j = 0 ; j &lt; TuneRegionList-&gt;Count ; j++){  | 
              |     |  +--+---------------------------------------------+ 
  2913        |     |     +--- TuneRegion = (TTuneRegion *)TuneRegionList-&gt;Items[j];
              |     |     |  +----------------------------------------------+ 
  2914        |     |     +--+ if(TuneRegion-&gt;TokenStartPos &lt; ModuleSPos){  | 
              |     |     |  +--+-------------------------------------------+ 
              |     |     |     |  +------------+ 
  2915        |     |     |     +--+ continue;  | 
              |     |     |     |  +------------+ 
              |     |     |   +-+---+ 
  2916        |     |     |   |  }  | 
              |     |     |   +-----+ 
              |     |     |  +--------------------------------------------+ 
  2917        |     |     +--+ if(TuneRegion-&gt;TokenEndPos &gt; ModuleEPos){  | 
              |     |     |  +--+-----------------------------------------+ 
              |     |     |     |  +------------+ 
  2918        |     |     |     +--+ continue;  | 
              |     |     |     |  +------------+ 
              |     |     |   +-+---+ 
  2919        |     |     |   |  }  | 
              |     |     |   +-----+ 
              |     |     |  +----------------------------------------------------------------------------------------+ 
  2920        |     |     +--+ for(TokPos = TuneRegion-&gt;TokenStartPos; TokPos &lt; TuneRegion-&gt;TokenEndPos ; TokPos++){  | 
              |     |     |  +--+-------------------------------------------------------------------------------------+ 
  2921        |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[TokPos];
              |     |     |     |  +------------------------------+ 
  2922        |     |     |     +--+ if(Token-&gt;ValData != NULL){  | 
              |     |     |     |  +--+---------------------------+ 
  2923        |     |     |     |     +--- ValData = (TValData *)Token-&gt;ValData;
  2924        |     |     |     |     +--- Idx = UseValDataList-&gt;IndexOf(ValData);
              |     |     |     |     |  +----------------+ 
  2925        |     |     |     |     +--+ if(Idx != -1){ | 
              |     |     |     |     |  +--+-------------+ 
  2926        |     |     |     |     |     +--- UseCount = (long)UseValDataCountList-&gt;Items[Idx];
  2927        |     |     |     |     |     +--- UseCount--;
  2928        |     |     |     |     |     +--- UseValDataCountList-&gt;Items[Idx] = (void *)(long)UseCount;
              |     |     |     |     |   +-+---+ 
  2929        |     |     |     |     |   |  }  | 
              |     |     |     |     |   +-----+ 
              |     |     |     |   +-+---+ 
  2930        |     |     |     |   |  }  | 
              |     |     |     |   +-----+ 
              |     |     |   +-+---+ 
  2931        |     |     |   |  }  | 
              |     |     |   +-----+ 
              |     |   +-+---+ 
  2932        |     |   |  }  | 
              |     |   +-----+ 
  2933        |     +--- //
  2934        |     |    //  定義のみで参照がない変数（リージョン内の参照は除く）を削除する。 
  2935        |     |    //  引数(ArgF)の変数についてはそのままとする。                       
  2936        |     |    //  トークン自体は残す。                                             
  2937        |     |    //                                                                   
              |     |  +----------------------------------------------------+ 
  2938        |     +--+ for(j = 0 ; j &lt; MainF-&gt;ValDataList-&gt;Count ; j++){  | 
              |     |  +--+-------------------------------------------------+ 
  2939        |     |     +--- ValData = (TValData *)MainF-&gt;ValDataList-&gt;Items[j];
              |     |     |  +------------------------------------+ 
  2940        |     |     +--+ if(ValData-&gt;DefPos &lt; ModuleSPos){  | 
              |     |     |  +--+---------------------------------+ 
              |     |     |     |  +------------+ 
  2941        |     |     |     +--+ continue;  | 
              |     |     |     |  +------------+ 
              |     |     |   +-+---+ 
  2942        |     |     |   |  }  | 
              |     |     |   +-----+ 
              |     |     |  +------------------------------------+ 
  2943        |     |     +--+ if(ValData-&gt;DefPos &gt; ModuleEPos){  | 
              |     |     |  +--+---------------------------------+ 
              |     |     |     |  +------------+ 
  2944        |     |     |     +--+ continue;  | 
              |     |     |     |  +------------+ 
              |     |     |   +-+---+ 
  2945        |     |     |   |  }  | 
              |     |     |   +-----+ 
              |     |     |  +--------------------+ 
  2946        |     |     +--+ if(ValData-&gt;ArgF){ | 
              |     |     |  +--+-----------------+ 
              |     |     |     |  +------------+ 
  2947        |     |     |     +--+ continue;  | 
              |     |     |     |  +------------+ 
              |     |     |   +-+---+ 
  2948        |     |     |   |  }  | 
              |     |     |   +-----+ 
  2949        |     |     +--- Idx = UseValDataList-&gt;IndexOf(ValData);
              |     |     |  +----------------+ 
  2950        |     |     +--+ if(Idx != -1){ | 
              |     |     |  +--+-------------+ 
  2951        |     |     |     +--- UseCount = (long)UseValDataCountList-&gt;Items[Idx];
              |     |     |   +-+---+ 
  2952        |     |     |   |  }  | 
              |     |     |   +-+---+ 
              |     |     |   +-+-------+ 
  2952        |     |     |   |  else{  | 
              |     |     |   +-+-------+ 
  2953        |     |     |     +--- UseCount = 0;
              |     |     |   +-+---+ 
  2954        |     |     |   |  }  | 
              |     |     |   +-----+ 
              |     |     |  +--------------------+ 
  2955        |     |     +--+ if(UseCount != 0){ | 
              |     |     |  +--+-----------------+ 
              |     |     |     |  +------------+ 
  2956        |     |     |     +--+ continue;  | 
              |     |     |     |  +------------+ 
              |     |     |   +-+---+ 
  2957        |     |     |   |  }  | 
              |     |     |   +-----+ 
  2958        |     |     +--- DelValDefList-&gt;Add(ValData);
              |     |   +-+---+ 
  2959        |     |   |  }  | 
              |     |   +-----+ 
  2960        |     +--- //
  2961        |     |    //  使用されない変数を定義から削除する。                             
  2962        |     |    //  変数部分のみ削除の場合と定義文をコメントアウトの２種類がある。   
  2963        |     |    //                                                                   
  2964        |     |    //  定義行に含まれる変数が全て削除対象の場合はコメントアウトとする。 
  2965        |     |    //                                                                   
              |     |  +----------------------------------------------+ 
  2966        |     +--+ for(j = 0 ; j &lt; DelValDefList-&gt;Count ; j++){ | 
              |     |  +--+-------------------------------------------+ 
  2967        |     |     +--- ValData = (TValData *)DelValDefList-&gt;Items[j];
  2968        |     |     +--- //          printf(&quot;delete variable define %s\n&quot;, ValData-&gt;Str.c_str());
  2969        |     |     +--- //
  2970        |     |     |    //  変数定義行が他の削除対象以外の変数を含んでいるかをチェックする。 
  2971        |     |     |    //                                                                   
              |     |     |  +--------------------------------------------------+ 
  2972        |     |     +--+ for(k = 0 ; k &lt; MainF-&gt;ValDataList-&gt;Count; k++){ | 
              |     |     |  +--+-----------------------------------------------+ 
  2973        |     |     |     +--- ValData2 = (TValData *)MainF-&gt;ValDataList-&gt;Items[k];
              |     |     |     |  +--------------------------+ 
  2974        |     |     |     +--+ if(ValData2 == ValData){ | 
              |     |     |     |  +--+-----------------------+ 
              |     |     |     |     |  +------------+ 
  2975        |     |     |     |     +--+ continue;  | 
              |     |     |     |     |  +------------+ 
              |     |     |     |   +-+---+ 
  2976        |     |     |     |   |  }  | 
              |     |     |     |   +-----+ 
              |     |     |     |  +--------------------------------------------+ 
  2977        |     |     |     +--+ if(ValData-&gt;DefPosS != ValData2-&gt;DefPosS){ | 
              |     |     |     |  +--+-----------------------------------------+ 
              |     |     |     |     |  +----------------------------------+ 
  2978        |     |     |     |     +--+ continue; // 定義行が異なる変数  | 
              |     |     |     |     |  +----------------------------------+ 
              |     |     |     |   +-+---+ 
  2979        |     |     |     |   |  }  | 
              |     |     |     |   +-----+ 
              |     |     |     |  +----------------------------------------------+ 
  2980        |     |     |     +--+ if(DelValDefList-&gt;IndexOf(ValData2) != -1){  | 
              |     |     |     |  +--+-------------------------------------------+ 
              |     |     |     |     |  +------------------------------+ 
  2981        |     |     |     |     +--+ continue; // 削除対象変数。  | 
              |     |     |     |     |  +------------------------------+ 
              |     |     |     |   +-+---+ 
  2982        |     |     |     |   |  }  | 
              |     |     |     |   +-----+ 
              |     |     |     |  +--------+ 
  2983        |     |     |     +--+ break; | 
              |     |     |     |  +--------+ 
              |     |     |   +-+---+ 
  2984        |     |     |   |  }  | 
              |     |     |   +-----+ 
              |     |     |  +--------------------------------------+ 
  2985        |     |     +--+ if(k &gt;= MainF-&gt;ValDataList-&gt;Count){  | 
              |     |     |  +--+-----------------------------------+ 
  2986        |     |     |     +--- //
  2987        |     |     |     |    //  定義文自体をコメントにする。 
  2988        |     |     |     |    //                               
  2989        |     |     |     +--- TokPos = ValData-&gt;DefPosS;
  2990        |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[TokPos];
              |     |     |     |  +----------------------------------+ 
  2991        |     |     |     +--+ if(Token-&gt;TokId != tid_Comment){ | 
              |     |     |     |  +--+-------------------------------+ 
  2992        |     |     |     |     +--- Token-&gt;TokId = tid_Comment;
  2993        |     |     |     |     +--- Token-&gt;Str = &quot;!&quot; + Token-&gt;Str;
  2994        |     |     |     |     +--- /*********************************************************************/
  2995        |     |     |     |     |    //                                                                       
  2996        |     |     |     |     |    //Kogakuin Irie                                                          
  2997        |     |     |     |     |    //未使用でない変数もコメントアウトされる場合もあるため，コメントアウト   
  2998        |     |     |     |     |    //                                                                       
  2999        |     |     |     |     |    //Token-&gt;OrgStr = &quot;!&quot; + Token-&gt;OrgStr;                                   
  3000        |     |     |     |     |    //                                                                       
  3001        |     |     |     |     |    //ここまで                                                               
  3002        |     |     |     |     |    //                                                                       
  3003        |     |     |     |     |    /*********************************************************************/  
              |     |     |     |   +-+---+ 
  3004        |     |     |     |   |  }  | 
              |     |     |     |   +-----+ 
              |     |     |   +-+---+ 
  3005        |     |     |   |  }  | 
              |     |     |   +-+---+ 
              |     |     |   +-+-------+ 
  3005        |     |     |   |  else{  | 
              |     |     |   +-+-------+ 
  3006        |     |     |     +--- //
  3007        |     |     |     |    //  他の変数の定義があるので、変数部分（,を含む)のみ空白にする。 
  3008        |     |     |     |    //                                                               
  3009        |     |     |     +--- TokPos = ValData-&gt;DefPos;
  3010        |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[TokPos];
  3011        |     |     |     +--- Token-&gt;TokId = tid_Comment;
  3012        |     |     |     +--- ///*********************************************************************/
  3013        |     |     |     |    //                                                                         
  3014        |     |     |     |    //Kogakuin Irie                                                            
  3015        |     |     |     |    //未使用でない変数もコメントアウトされる場合もあるため，コメントアウト     
  3016        |     |     |     |    //                                                                         
  3017        |     |     |     |    //Token-&gt;Str = &quot;&quot;;                                                         
  3018        |     |     |     |    //Token-&gt;OrgStr = &quot;&quot;;                                                      
  3019        |     |     |     |    //                                                                         
  3020        |     |     |     |    //ここまで                                                                 
  3021        |     |     |     |    //                                                                         
  3022        |     |     |     |    /*********************************************************************/    
  3023        |     |     |     |    //                                                                         
  3024        |     |     |     |    //  後ろに カンマがあれば、そこまで空白にする。                            
  3025        |     |     |     |    //                                                                         
              |     |     |     |  +------------------------------------------------------------------+ 
  3026        |     |     |     +--+ for(TokPos2 = TokPos ; TokPos2 &lt; TokenList-&gt;Count ; TokPos2++){  | 
              |     |     |     |  +--+---------------------------------------------------------------+ 
  3027        |     |     |     |     +--- Token2 = (TToken *)TokenList-&gt;Items[TokPos2];
              |     |     |     |     |  +------------------------------------+ 
  3028        |     |     |     |     +--+ if(Token2-&gt;TokId == tid_LineEnd){  | 
              |     |     |     |     |  +--+---------------------------------+ 
  3029        |     |     |     |     |     +--- TokPos2 = -1;
              |     |     |     |     |     |  +--------+ 
  3030        |     |     |     |     |     +--+ break; | 
              |     |     |     |     |     |  +--------+ 
              |     |     |     |     |   +-+---+ 
  3031        |     |     |     |     |   |  }  | 
              |     |     |     |     |   +-----+ 
              |     |     |     |     |  +--------------------------------+ 
  3032        |     |     |     |     +--+ if(Token2-&gt;TokId == tid_Set){  | 
              |     |     |     |     |  +--+-----------------------------+ 
  3033        |     |     |     |     |     +--- TokPos2 = -1;
              |     |     |     |     |     |  +--------+ 
  3034        |     |     |     |     |     +--+ break; | 
              |     |     |     |     |     |  +--------+ 
              |     |     |     |     |   +-+---+ 
  3035        |     |     |     |     |   |  }  | 
              |     |     |     |     |   +-----+ 
              |     |     |     |     |  +----------------------------------+ 
  3036        |     |     |     |     +--+ if(Token2-&gt;TokId == tid_Kannma){ | 
              |     |     |     |     |  +--+-------------------------------+ 
              |     |     |     |     |     |  +------------------------------------------+ 
  3037        |     |     |     |     |     +--+ for(k = TokPos+1 ; k &lt;= TokPos2 ; k++){  | 
              |     |     |     |     |     |  +--+---------------------------------------+ 
  3038        |     |     |     |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[k];
  3039        |     |     |     |     |     |     +--- Token-&gt;TokId = tid_Comment;
  3040        |     |     |     |     |     |     +--- ///*********************************************************************/
  3041        |     |     |     |     |     |     |    //                                                                         
  3042        |     |     |     |     |     |     |    //Kogakuin Irie                                                            
  3043        |     |     |     |     |     |     |    //未使用でない変数もコメントアウトされる場合もあるため，コメントアウト     
  3044        |     |     |     |     |     |     |    //                                                                         
  3045        |     |     |     |     |     |     |    //Token-&gt;Str = &quot;&quot;;                                                         
  3046        |     |     |     |     |     |     |    //Token-&gt;OrgStr = &quot;&quot;;                                                      
  3047        |     |     |     |     |     |     |    //                                                                         
  3048        |     |     |     |     |     |     |    //ここまで                                                                 
  3049        |     |     |     |     |     |     |    //                                                                         
  3050        |     |     |     |     |     |     |    /*********************************************************************/    
              |     |     |     |     |     |   +-+---+ 
  3051        |     |     |     |     |     |   |  }  | 
              |     |     |     |     |     |   +-----+ 
              |     |     |     |     |     |  +--------+ 
  3052        |     |     |     |     |     +--+ break; | 
              |     |     |     |     |     |  +--------+ 
              |     |     |     |     |   +-+---+ 
  3053        |     |     |     |     |   |  }  | 
              |     |     |     |     |   +-----+ 
              |     |     |     |   +-+---+ 
  3054        |     |     |     |   |  }  | 
              |     |     |     |   +-----+ 
              |     |     |     |  +------------------------------------------------------------+ 
  3055        |     |     |     +--+ if(TokPos2 == -1){ // 後ろにカンマが見つからなかった場合。 | 
              |     |     |     |  +--+---------------------------------------------------------+ 
  3056        |     |     |     |     +--- //
  3057        |     |     |     |     |    //  前に カンマがあれば、そこまで空白にする。  
  3058        |     |     |     |     |    //                                             
              |     |     |     |     |  +----------------------------------------------------+ 
  3059        |     |     |     |     +--+ for(TokPos2 = TokPos ; TokPos2 &gt;= 0 ; TokPos2--){  | 
              |     |     |     |     |  +--+-------------------------------------------------+ 
  3060        |     |     |     |     |     +--- Token2 = (TToken *)TokenList-&gt;Items[TokPos2];
              |     |     |     |     |     |  +------------------------------------+ 
  3061        |     |     |     |     |     +--+ if(Token2-&gt;TokId == tid_LineEnd){  | 
              |     |     |     |     |     |  +--+---------------------------------+ 
  3062        |     |     |     |     |     |     +--- TokPos2 = -1;
              |     |     |     |     |     |     |  +--------+ 
  3063        |     |     |     |     |     |     +--+ break; | 
              |     |     |     |     |     |     |  +--------+ 
              |     |     |     |     |     |   +-+---+ 
  3064        |     |     |     |     |     |   |  }  | 
              |     |     |     |     |     |   +-----+ 
              |     |     |     |     |     |  +--------------------------------------+ 
  3065        |     |     |     |     |     +--+ if(Token2-&gt;TokId == tid_KoronKoron){ | 
              |     |     |     |     |     |  +--+-----------------------------------+ 
  3066        |     |     |     |     |     |     +--- TokPos2 = -1;
              |     |     |     |     |     |     |  +--------+ 
  3067        |     |     |     |     |     |     +--+ break; | 
              |     |     |     |     |     |     |  +--------+ 
              |     |     |     |     |     |   +-+---+ 
  3068        |     |     |     |     |     |   |  }  | 
              |     |     |     |     |     |   +-----+ 
              |     |     |     |     |     |  +----------------------------------+ 
  3069        |     |     |     |     |     +--+ if(Token2-&gt;TokId == tid_Kannma){ | 
              |     |     |     |     |     |  +--+-------------------------------+ 
              |     |     |     |     |     |     |  +--------------------------------------+ 
  3070        |     |     |     |     |     |     +--+ for(k = TokPos2 ; k &lt; TokPos ; k++){ | 
              |     |     |     |     |     |     |  +--+-----------------------------------+ 
  3071        |     |     |     |     |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[k];
  3072        |     |     |     |     |     |     |     +--- Token-&gt;TokId = tid_Comment;
  3073        |     |     |     |     |     |     |     +--- ///*********************************************************************/
  3074        |     |     |     |     |     |     |     |    //                                                                         
  3075        |     |     |     |     |     |     |     |    //Kogakuin Irie                                                            
  3076        |     |     |     |     |     |     |     |    //未使用でない変数もコメントアウトされる場合もあるため，コメントアウト     
  3077        |     |     |     |     |     |     |     |    //                                                                         
  3078        |     |     |     |     |     |     |     |    //Token-&gt;Str = &quot;&quot;;                                                         
  3079        |     |     |     |     |     |     |     |    //Token-&gt;OrgStr = &quot;&quot;;                                                      
  3080        |     |     |     |     |     |     |     |    //                                                                         
  3081        |     |     |     |     |     |     |     |    //ここまで                                                                 
  3082        |     |     |     |     |     |     |     |    //                                                                         
  3083        |     |     |     |     |     |     |     |    /*********************************************************************/    
              |     |     |     |     |     |     |   +-+---+ 
  3084        |     |     |     |     |     |     |   |  }  | 
              |     |     |     |     |     |     |   +-----+ 
              |     |     |     |     |     |     |  +--------+ 
  3085        |     |     |     |     |     |     +--+ break; | 
              |     |     |     |     |     |     |  +--------+ 
              |     |     |     |     |     |   +-+---+ 
  3086        |     |     |     |     |     |   |  }  | 
              |     |     |     |     |     |   +-----+ 
              |     |     |     |     |   +-+---+ 
  3087        |     |     |     |     |   |  }  | 
              |     |     |     |     |   +-----+ 
              |     |     |     |   +-+---+ 
  3088        |     |     |     |   |  }  | 
              |     |     |     |   +-----+ 
              |     |     |   +-+---+ 
  3089        |     |     |   |  }  | 
              |     |     |   +-----+ 
              |     |   +-+---+ 
  3090        |     |   |  }  | 
              |     |   +-----+ 
  3091        |     +--- delete UseValDataList;
  3092        |     +--- delete UseValDataCountList;
  3093        |     +--- delete DelValDefList;
  3094        |     |    
  3095        |     |     
              |   +-+-----------------------------------------+ 
  3096        |   |  }   // 対象モジュールに対して繰り返す。  | 
  3097        |   |                                           | 
  3098        |   |                                           | 
  3099        |   |                                           | 
              |   +-------------------------------------------+ 
  3100        +--- delete ModuleList;
  3101        |    
            +-+---+ 
  3102      |  }  | 
            +-----+ 
</pre>


</body>
</html>
