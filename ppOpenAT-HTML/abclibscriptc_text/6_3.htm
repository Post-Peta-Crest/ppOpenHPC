
<html>
<head>
<title>pass2.cpp ò_óùÉ`ÉÉÅ[Ég</title><base target="main">
<link rel ="stylesheet" type="text/css" href="stylesheet.css" title="stylesheet">
<meta http-equiv="Content-Type" content="text/html;charset=Shift_JIS">
</head>

<body bgcolor="#ffffff">

<div align="right"><font size="2">ABCLibScriptC ÉvÉçÉWÉFÉNÉg</font></div>

<table width=100% bgcolor="#e6e6fa" class="titlebgcolor" border="1" cellpadding="7" cellspacing="0">
<tr>
    <td><font class="titlefont">5.3. pass2.cpp ò_óùÉ`ÉÉÅ[Ég</font></td>
</tr>
</table>

<p></p>
<pre>
ÉtÉ@ÉCÉãò_óùÉ`ÉÉÅ[Ég

     1  +--- ÔªÉ\/*=====================================================================*
     2  |     *                                                                     *           
     3  |     *   Software Name : ppOpen-AT                                         *           
     4  |     *         Version : 0.1                                               *           
     5  |     *                                                                     *           
     6  |     *   License                                                           *           
     7  |     *     This file is part of ppOpen-AT.                                 *           
     8  |     *     ppOpen-AT is a free software, you can use it under the terms    *           
     9  |     *     of The MIT License (MIT). See LICENSE file and User's guide     *           
    10  |     *     for more details.                                               *           
    11  |     *                                                                     *           
    12  |     *   ppOpen-HPC project:                                               *           
    13  |     *     Open Source Infrastructure for Development and Execution of     *           
    14  |     *     Large-Scale Scientific Applications on Post-Peta-Scale          *           
    15  |     *     Supercomputers with Automatic Tuning (AT).                      *           
    16  |     *                                                                     *           
    17  |     *   Organizations:                                                    *           
    18  |     *     The University of Tokyo                                         *           
    19  |     *       - Information Technology Center                               *           
    20  |     *       - Atmosphere and Ocean Research Institute (AORI)              *           
    21  |     *       - Graduate School of Interdisciplinary Information Studies    *           
    22  |     *         /Earthquake Research Institute (ERI)                        *           
    23  |     *       - Graduate School of Frontier Science                         *           
    24  |     *     Kyoto University                                                *           
    25  |     *       - Academic Center for Computing and Media Studies             *           
    26  |     *     Japan Agency for Marine-Earth Science and Technology (JAMSTEC)  *           
    27  |     *                                                                     *           
    28  |     *   Sponsorship:                                                      *           
    29  |     *     Japan Science and Technology Agency (JST), Basic Research       *           
    30  |     *     Programs: CREST, Development of System Software Technologies    *           
    31  |     *     for post-Peta Scale High Performance Computing.                 *           
    32  |     *                                                                     *           
    33  |     *   Copyright (c) 2012                                                *           
    34  |     *      Information Technology Center, The University of Tokyo         *           
    35  |     *                                                                     *           
    36  |     *=====================================================================*/          
    37  |     /*----------------------------------------------------------------------------*/  
    38  |    //                                                                                 
    39  |    //  Ê¶ÇËÉíÅ                                                                        
    40  |    //    „Éë„ÇπÔºí                                                                    
    41  |    //                                                                                 
    42  |    //  ‰ΩúÊàêËÄÖ                                                                      
    43  |    //                                                                                 
    44  |    /*----------------------------------------------------------------------------*/   
    45  |                                                                                       
    46  +--- #include &quot;pass2.h&quot;
    47  +--- #include &quot;math.h&quot;
    48  |    
    49  +--- //---------------------------------------------------------------------------
    50  |                                                                                   
    51  +--- void ResetModule();
    52  +--- void Pass2_Fortran(TList *TokenList,int sPos,int ePos,TList *ValDataList);
    53  +--- int Pass2_C(TList *TokenList,int sPos,TList *ValDataList);
    54  +--- int Eval(TList *TokenList,int sPos,int ePos,TList *ValDataList,double *dData);
    55  +--- void IMPLICIT(TList *TokenList,int sPos,int ePos);
    56  +--- void AddSubFuncDef_Fortran(TList *TokenList,int sPos,int ePos,TList *ValDataList);
    57  +--- void AddSubFuncDef_C(TList *TokenList,int sPos,int ePos,TList *ValDataList);
    58  |    
    59  +--- static Enum_DataType ImplType[256];     // ÊöóÈÉTô„ÅÆÂÆÅvË®Ä„Åã„Å©„ÅÜ„Åã
    60  +--- bool EvalConstF = false;
    61  |    
    62  +--- /*----------------------------------------------------------------------------*/
    63  |    //                                                                                                                               
    64  |    //  1.ÊóÅEÊúÉÉË™ûÂêç                                                                                                             
    65  |    //                                                                                                                               
    66  |    //  2.„Éë„É©„ÉÅB„ÇÉ\Ë™ÉÉÊòé                                                                                                      
    67  |    //    TokenList   „Éà„Éº„ÇÉb„ÉÉE„ÉÉF„ÇÉP„Éà                                                                                      
    68  |    //    ValDataList Â§âÊï∞„ÉÉF„ÇÉP„Éà                                                                                              
    69  |    //                                                                                                                               
    70  |    //  3.Ê¶ÇËÉíÅ                                                                                                                    
    71  |    //    ÊßãÊñáËßÅvÊûê„Å®Â§âÊï∞„ÉÉF„ÇÉP„Éà„Çí‰ΩúÊàê„Åó„ÄÅÂÅAâÊï∞„ÅÉáÂûã„Å™„ÅÉD„ÇíËÉBÉÖÂÆö„Åô„Çã„ÄÇ                                  
    72  |    //                                                                                                                               
    73  |    //    „ÄÄÔºëÔÉVâ„É¢„ÇÉN„ÉÅE„ÉÉV„ÉÉHÊßãÈÄ†Ë≠òÂà•ÔºàModukeIdx„ÇíÂâ≤„ÇäÊåØ„ÅÅv„ÅÉí„ÄÅÁï∞„ÅÉF„Çã„É¢„ÇÉN„ÉÅE„ÉÉV„ÉÉH„ÅÉáÂåÉRÂàÅE)     
    74  |    //    „ÄÄÔºíÔÉVâÔÉXõÔÉXù„ÅÆ„Éç„Çπ„Éà„ÇíNestLevel„ÅÉH„ÇÉT„ÉÉ„Éà„Åô„Çã„ÄÇ                                                          
    75  |    //    „ÄÄÔºìÔÉVâfor , if „ÅÉáÁµÇ‰ÉRÜÂÖà„Çí„Çª„ÉÉ„Éà„Åô„Çã                                                                        
    76  |    //    „ÄÄÔºîÔÉVâÂÅAâÊï∞ÂÆöÁÉZÉD (int , double ) „ÅÉF„ÅÉD„ÅÉáÊÉÖÂ†ÉA„Åã„Çâ„ÄÅÂÅAâÊï∞‰∏ÄË¶É@(ValDataList)„Çí‰ÉXúÊàê„Åó             
    77  |    //    „ÄÄ„ÄÄ„ÄÄ„ÉÉF„ÉÉE„ÇÉb„ÇíËÉBÉÖÂÆö„Åô„Çã„ÄÇÔÉVà„É¢„ÇÉN„ÉÅE„ÉÉV„ÉÉH„ÅåÁï∞„ÅÉF„ÇãÂÅAâÊï∞„ÅÉb„ÄÅÂà•ÁâÉD„ÅÉB„Åô„ÇãÔºâ            
    78  |    //    „ÄÄ„ÄÄ„ÄÄÂ§âÊï∞„ÅÉáÂûã„ÄÅ„Éê„ÇÅA„Éà„Çµ„ÇÅA„ÇÉR„ÇÇ‰É\ùÊåÅ„Åô„Çã„Åì„Å®„ÄÇÔÉVà‰ÉNÄÊôÇÂÅAâÊï∞‰ΩúÊàê„ÅÉáÂ†ÉGÂêà„Å´ÂøÖËÉíÅÔÉVâ   
    79  |    //                                                                                                                               
    80  |    //  4.Ê©üËÉΩË™ÉÉÊòé                                                                                                              
    81  |    //                                                                                                                               
    82  |    //  5.ÊàÉT„ÇäÂÄÅA                                                                                                                
    83  |    //                                                                                                                               
    84  |    //  6.ÂÇôËÄÉ                                                                                                                     
    85  |    //                                                                                                                               
    86  |    /*----------------------------------------------------------------------------*/                                                 
        |  +--------------------------------------------------+ 
    87  +--+ void Pass2(TList *TokenList,TList *ValDataList)  | 
    88  |  | {                                                | 
        |  +--+-----------------------------------------------+ 
    89  |     +--- int i,j;
    90  |     +--- TToken *Token;
    91  |     +--- TToken *Token2;
    92  |     +--- int ModuleIdx = 0;      // ‰ΩïÁï™ÁõÉá„ÅÉá„ÉÅu„ÇÉN„ÉÅE„ÉÉV„ÉÉH„ÇíÂá¶ÁêÜ‰ÉNÉÖ„Åã
    93  |     +--- int NestLevel = 0;      // „Éó„É≠„ÇÅ[„ÉÉD„É†ÊßãÈÄ†„Éç„Çπ„Éà„ÅÆÁäÉJÊÖã
    94  |     +--- int BrNestLevel = 0;    // ÊãÉÉÂºÉ@„ÅÉá„Éç„Çπ„Éà„ÅÆÁäÉJÊÖã
    95  |     |                                                               
    96  |     +--- ModuleIdx = 0;
    97  |     +--- NestLevel = 0;
    98  |     +--- BrNestLevel = 0;
    99  |     +--- ResetModule();
        |     |  +------------------------------------------+ 
   100  |     +--+ for(i = 0 ; i &lt; TokenList-&gt;Count ;i++){  | 
        |     |  +--+---------------------------------------+ 
   101  |     |     +--- Token = (TToken *)TokenList-&gt;Items[i];
   102  |     |     +--- Token-&gt;ModuleIdx = ModuleIdx;   // „Éà„Éº„ÇÉb„ÉÉE„ÅÉH„ÉÅu„ÇÉN„ÉÅE„ÉÉV„ÉÉH„ÇÑ„Éç„ÇÉP„ÉàÁï™ÂèÉL„Çí„Çª„ÉÉ„Éà
   103  |     |     +--- Token-&gt;NestLevel = NestLevel;
   104  |     |     +--- Token-&gt;BrNestLevel = BrNestLevel;
        |     |     |  +------------------------+ 
   105  |     |     +--+ switch(Token-&gt;TokId){  | 
        |     |     |  +--+---------------------+ 
        |     |     |     +-----------------+ 
   106  |     |     |     |  case tid_END:  | 
        |     |     |     +-----------------+ 
   107  |     |     |     +--- // Fortran „ÉÅu„ÇÉN„ÉÅE„ÉÉV„ÉÉH„ÇíÁÉIÇ‰ÉRÜ„ÄÇÔÉVàÊÉÉÅBË°å„Åã„ÇâÊÉÉÅB„ÉÅu„ÇÉN„ÉÅE„ÉÉV„ÉÉH„ÅÉB„ÅÉF„ÇãÔÉVâ
   108  |     |     |     |    // End„ÅÉáÂæå„ÅÆÂêçÂâç„ÅÉb„ÄÅSkip„Åô„Çã„ÄÇ                                                                             
   109  |     |     |     |    // „ÇÉP„ÇÉb„ÉÉF„Éó„Éà„ÅÉáEnd„ÅÉáÂ†ÉGÂêà„Åå„ÅÇ„Çã„ÅÉá„ÅÉ@„ÄÅÂâç„ÅåÊÉEÉBÈáà„Åß„ÅÉF„ÅÑÔÉVàÊîπË°å„Åæ„ÅÉ@Ôºâ„Åã„ÉÅ„Çß„ÉÉ„ÇØ 
        |     |     |     |  +------------------------------+ 
   110  |     |     |     +--+ for(j = i-1; j &gt;= 0 ; j--){  | 
        |     |     |     |  +--+---------------------------+ 
   111  |     |     |     |     +--- Token2 = (TToken *)TokenList-&gt;Items[j];
        |     |     |     |     |  +------------------------------------------------+ 
   112  |     |     |     |     +--+ if((Token2-&gt;TokId == tid_LineEnd)||(j == 0)){  | 
        |     |     |     |     |  +--+---------------------------------------------+ 
   113  |     |     |     |     |     +--- NestLevel--; // ÊñáÊÉEï‰ÉNä„ÅÆEND
        |     |     |     |     |     |  +--------+ 
   114  |     |     |     |     |     +--+ break; | 
        |     |     |     |     |     |  +--------+ 
        |     |     |     |     |   +-+---+ 
   115  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |     |  +------------------------------------+ 
   116  |     |     |     |     +--+ if(Token2-&gt;TokId == tid_Comment){  | 
        |     |     |     |     |  +--+---------------------------------+ 
   117  |     |     |     |     |     +--- Token-&gt;TokId = tid_END_STR; // „ÇÉE„ÉÅB„ÉÉE„Éà„ÅÆÂæå„ÅÆ end (  region end )
        |     |     |     |     |     |  +--------+ 
   118  |     |     |     |     |     +--+ break; | 
        |     |     |     |     |     |  +--------+ 
        |     |     |     |     |   +-+---+ 
   119  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |   +-+---+ 
   120  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |     |  +------------------------------+ 
   121  |     |     |     +--+ if(Token-&gt;TokId == tid_END){ | 
        |     |     |     |  +--+---------------------------+ 
   122  |     |     |     |     +--- //
   123  |     |     |     |     |    //  CONTAINS „ÅÉHÂØÉZÂøú„Åô„Çã„Åü„ÇÅ„ÄÅNestLevel„Åå0„ÅÉ@„ÅÉF„Åè„Å¶„ÇÇÂà•„ÉÅu„ÇÉN„ÉÅE„ÉÉV„ÉÉH„ÄÇ      
   124  |     |     |     |     |    //  „ÇÉI„Éñ„É´„ÉÉV„ÉÅ„É≥„ÅÉáË®òËÉ\Å[„ÅÉá‰∏ÉÖ„ÅÉá„ÇÉI„Éñ„É´„ÉÉV„ÉÅ„É≥„ÅÉáË®òËÉ\Å[„ÅÉN„ÅÉáÂØÉZÂøú„ÄÇ   
   125  |     |     |     |     |    //                                                                                                   
   126  |     |     |     |     +--- #if 0   // end soubroutin Ë≠òÂà•ÁîÉB„ÅÉH‰øÉáÊ≠Åv 2016/02/25
        |     |     |     |     |  +--------------------------------------------------------------+ 
   127  |     |     |     |     +--+ if((i+1 &gt;= TokenList-&gt;Count)||                               | 
   128  |     |     |     |     |  |     (((TToken *)TokenList-&gt;Items[i+1])-&gt;TokId != tid_TYPE)){ | 
        |     |     |     |     |  +--+-----------------------------------------------------------+ 
   129  |     |     |     |     |     +--- ModuleIdx++;
   130  |     |     |     |     |     +--- ResetModule();
        |     |     |     |     |   +-+---+ 
   131  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |     |  +------------------------------------+ 
   132  |     |     |     |     +--+ for(; i &lt; TokenList-&gt;Count ;i++){  | 
        |     |     |     |     |  +--+---------------------------------+ 
   133  |     |     |     |     |     +--- Token2 = (TToken *)TokenList-&gt;Items[i];
   134  |     |     |     |     |     +--- Token2-&gt;ModuleIdx = ModuleIdx;   // „Éà„Éº„ÇÉb„ÉÉE„ÅÉH„ÉÅu„ÇÉN„ÉÅE„ÉÉV„ÉÉH„ÇÑ„Éç„ÇÉP„ÉàÁï™ÂèÉL„Çí„Çª„ÉÉ„Éà
   135  |     |     |     |     |     +--- Token2-&gt;NestLevel = NestLevel;
   136  |     |     |     |     |     +--- Token2-&gt;BrNestLevel = BrNestLevel;
        |     |     |     |     |     |  +------------------------------------+ 
   137  |     |     |     |     |     +--+ if(Token2-&gt;TokId == tid_LineEnd){  | 
        |     |     |     |     |     |  +--+---------------------------------+ 
        |     |     |     |     |     |     |  +--------------------------------------------------------------------------------+ 
   138  |     |     |     |     |     |     +--+ break; // LineEnd„ÅÉZ„ÅÉ@„ÇÉP„ÇÉÖ„ÉÉ„Éó END TYPE , END FUNCTION Á≠â„ÅÆÂØÉZÂøú  | 
        |     |     |     |     |     |     |  +--------------------------------------------------------------------------------+ 
        |     |     |     |     |     |   +-+---+ 
   139  |     |     |     |     |     |   |  }  | 
        |     |     |     |     |     |   +-----+ 
        |     |     |     |     |   +-+---+ 
   140  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
   141  |     |     |     |     +--- #else
        |     |     |     |     |  +------------------------------------+ 
   142  |     |     |     |     +--+ for(; i &lt; TokenList-&gt;Count ;i++){  | 
        |     |     |     |     |  +--+---------------------------------+ 
   143  |     |     |     |     |     +--- Token2 = (TToken *)TokenList-&gt;Items[i];
   144  |     |     |     |     |     +--- Token2-&gt;ModuleIdx = ModuleIdx;   // „Éà„Éº„ÇÉb„ÉÉE„ÅÉH„ÉÅu„ÇÉN„ÉÅE„ÉÉV„ÉÉH„ÇÑ„Éç„ÇÉP„ÉàÁï™ÂèÉL„Çí„Çª„ÉÉ„Éà
   145  |     |     |     |     |     +--- Token2-&gt;NestLevel = NestLevel;
   146  |     |     |     |     |     +--- Token2-&gt;BrNestLevel = BrNestLevel;
        |     |     |     |     |     |  +------------------------------------+ 
   147  |     |     |     |     |     +--+ if(Token2-&gt;TokId == tid_LineEnd){  | 
        |     |     |     |     |     |  +--+---------------------------------+ 
        |     |     |     |     |     |     |  +--------------------------------------------------------------------------------+ 
   148  |     |     |     |     |     |     +--+ break; // LineEnd„ÅÉZ„ÅÉ@„ÇÉP„ÇÉÖ„ÉÉ„Éó END TYPE , END FUNCTION Á≠â„ÅÆÂØÉZÂøú  | 
        |     |     |     |     |     |     |  +--------------------------------------------------------------------------------+ 
        |     |     |     |     |     |   +-+---+ 
   149  |     |     |     |     |     |   |  }  | 
        |     |     |     |     |     |   +-----+ 
        |     |     |     |     |   +-+---+ 
   150  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |     |  +--------------------------------------------------------------+ 
   151  |     |     |     |     +--+ if((i+1 &gt;= TokenList-&gt;Count)||                               | 
   152  |     |     |     |     |  |     (((TToken *)TokenList-&gt;Items[i+1])-&gt;TokId != tid_TYPE)){ | 
        |     |     |     |     |  +--+-----------------------------------------------------------+ 
   153  |     |     |     |     |     +--- ModuleIdx++;
   154  |     |     |     |     |     +--- ResetModule();
        |     |     |     |     |   +-+---+ 
   155  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
   156  |     |     |     |     +--- #endif
        |     |     |     |   +-+---+ 
   157  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |     |  +--------+ 
   158  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
   159  |     |     |     +--- // Fortran ProgramÈñÅuÈÄÅv
        |     |     |     +---------------------------------------+ 
   160  |     |     |     |  case tid_CONTAINS:      // CONTAINS  | 
        |     |     |     +---------------------------------------+ 
   161  |     |     |     +--- ModuleIdx++;
   162  |     |     |     +--- ResetModule();
        |     |     |     |  +--------+ 
   163  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-------------------------------------+ 
   164  |     |     |     |  case tid_PROGRAM:       // PROGRAM | 
        |     |     |     +-------------------------------------+ 
        |     |     |     +-------------------------------------+ 
   165  |     |     |     |  case tid_MODULE:        // MODULE  | 
        |     |     |     +-------------------------------------+ 
        |     |     |     +---------------------------------------+ 
   166  |     |     |     |  case tid_INTERFACE:     // INTERFACE | 
        |     |     |     +---------------------------------------+ 
        |     |     |     +-----------------------------------------+ 
   167  |     |     |     |  case tid_SUBROUTINE:    // SUBROUTINE  | 
        |     |     |     +-----------------------------------------+ 
        |     |     |     +---------------------------------------+ 
   168  |     |     |     |  case tid_FUNCTION:      // FUNCTION  | 
        |     |     |     +---------------------------------------+ 
   169  |     |     |     +--- NestLevel++;
        |     |     |     |  +--------+ 
   170  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-----------------+ 
   171  |     |     |     |  case tid_TYPE: | 
        |     |     |     +-----------------+ 
   172  |     |     |     +--- // TYPEÔºàÔÉVâ‰ÉTÅEÂ§ñ„ÅÆ TYPE ÊßãÈÄ†‰ΩìÂêç„ÅÉáÂ†ÉGÂêà„ÅÆ„ÅÉ\ „Éç„Çπ„Éà„ÅåÊúâÂäπ„ÄÇ
        |     |     |     |  +----------------------------------------------------------------------------------------+ 
   173  |     |     |     +--+ if((i+1 &lt; TokenList-&gt;Count)&amp;&amp;(((TToken *)TokenList-&gt;Items[i+1])-&gt;TokId != tid_Kakko)){ | 
        |     |     |     |  +--+-------------------------------------------------------------------------------------+ 
   174  |     |     |     |     +--- // TYPE ÊßãÈÄ†Âêç „ÅÉH„Çà„ÇãÂÆöÁÉZÉD„ÄÇ END TYPE„ÇíÊåÅ„ÅÅA„ÄÇ
   175  |     |     |     |     +--- NestLevel++;
        |     |     |     |   +-+---+ 
   176  |     |     |     |   |  }  | 
        |     |     |     |   +-+---+ 
        |     |     |     |   +-+-------+ 
   176  |     |     |     |   |  else{  | 
        |     |     |     |   +-+-------+ 
   177  |     |     |     |     +--- Token-&gt;TokId = tid_TYPE_REF;  // ÂÆöÁÉZÉD„ÅÉ@„ÅÉF„ÅÑType„ÄÇEND TYPE„ÇíÊåÅ„Åü„Å™„ÅÑ„ÄÇ
        |     |     |     |   +-+---+ 
   178  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |     |  +--------+ 
   179  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-----------------------------+ 
   180  |     |     |     |  case tid_DaiKakko:  // C { | 
        |     |     |     +-----------------------------+ 
   181  |     |     |     +--- NestLevel++;
   182  |     |     |     +--- BrNestLevel++;
        |     |     |     |  +--------+ 
   183  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-----------------------------+ 
   184  |     |     |     |  case tid_DaiKokka:  // C } | 
        |     |     |     +-----------------------------+ 
   185  |     |     |     +--- NestLevel--;
   186  |     |     |     +--- BrNestLevel--;
        |     |     |     |  +----------------------------------------------------------------------------------------------------------+ 
   187  |     |     |     +--+ if(NestLevel == 0){ // ÔºÅv„ÅÉáÂ†ÉGÂêà„ÅØ„ÄÅ‰ÉNÄÁïÉFÂ§ñÂÅ¥„ÅÉá}„ÅÉ@Ê¨ÅB„ÉÅu„ÇÉN„ÉÅE„ÉÉV„ÉÉH„ÅÉB„Åô„Çã„ÄÇ | 
        |     |     |     |  +--+-------------------------------------------------------------------------------------------------------+ 
   188  |     |     |     |     +--- ModuleIdx++;
        |     |     |     |   +-+---+ 
   189  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |     |  +--------+ 
   190  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-----------------------+ 
   191  |     |     |     |  case tid_Kakko: // ( | 
        |     |     |     +-----------------------+ 
        |     |     |     +---------------------------+ 
   192  |     |     |     |  case tid_KagiKakko: // [ | 
        |     |     |     +---------------------------+ 
   193  |     |     |     +--- BrNestLevel++;
        |     |     |     |  +--------+ 
   194  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-----------------------+ 
   195  |     |     |     |  case tid_Kokka: // ) | 
        |     |     |     +-----------------------+ 
        |     |     |     +---------------------------+ 
   196  |     |     |     |  case tid_KagiKokka: // ] | 
        |     |     |     +---------------------------+ 
   197  |     |     |     +--- BrNestLevel--;
        |     |     |     |  +--------+ 
   198  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-----------+ 
   199  |     |     |     |  default: | 
        |     |     |     +-----------+ 
        |     |     |     |  +--------+ 
   200  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |   +-+---+ 
   201  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |   +-+---+ 
   202  |     |   |  }  | 
        |     |   +-----+ 
   203  |     +--- //
   204  |     |    //  ÂêÑ„Éà„ÉÉV„ÇÉb„ÉÉE„ÅÉHÂêà„Çè„Åõ„ÅüÂáÉíÁêÜ„ÄÇ   
   205  |     |    //                                                 
        |     |  +--------------------------------------+ 
   206  |     +--+ for(i = 0 ; i &lt; TokenList-&gt;Count ;){ | 
        |     |  +--+-----------------------------------+ 
   207  |     |     +--- Token = (TToken *)TokenList-&gt;Items[i];
        |     |     |  +------------------------+ 
   208  |     |     +--+ switch(Token-&gt;TokId){  | 
        |     |     |  +--+---------------------+ 
        |     |     |     +-----------------+ 
   209  |     |     |     |  case tid_null: | 
        |     |     |     +-----------------+ 
        |     |     |     +-----------------------------------------------+ 
   210  |     |     |     |  case tid_Semikoron: // ; „ÇÉT„Éü„Ç≥„ÉÉÖ„ÉÉE  | 
        |     |     |     +-----------------------------------------------+ 
   211  |     |     |     +--- i++;
        |     |     |     |  +------------+ 
   212  |     |     |     +--+ continue;  | 
        |     |     |     |  +------------+ 
        |     |     |     +---------------------+ 
   213  |     |     |     |  case tid_Comment:  | 
        |     |     |     +---------------------+ 
        |     |     |     |  +----------------------------------------+ 
   214  |     |     |     +--+ if(MainF-&gt;SrcCodeType != MainF-&gt;sctC){ | 
        |     |     |     |  +--+-------------------------------------+ 
        |     |     |     |     |  +--------------------------------------+ 
   215  |     |     |     |     +--+ if((int)Token-&gt;Str.find(&quot;!&quot;) == 0){  | 
        |     |     |     |     |  +--+-----------------------------------+ 
        |     |     |     |     |     |  +--------------------------------------+ 
   216  |     |     |     |     |     +--+ for( ; i &lt; TokenList-&gt;Count ; i++){  | 
        |     |     |     |     |     |  +--+-----------------------------------+ 
   217  |     |     |     |     |     |     +--- Token2 = (TToken *)TokenList-&gt;Items[i];
   218  |     |     |     |     |     |     +--- //                      if(Token-&gt;LineNo != Token2-&gt;LineNo){
        |     |     |     |     |     |     |  +------------------------------------------------------------------------+ 
   219  |     |     |     |     |     |     +--+ if((Token2-&gt;TokId == tid_LineEnd)||(Token2-&gt;TokId == tid_Semikoron)){  | 
        |     |     |     |     |     |     |  +--+---------------------------------------------------------------------+ 
   220  |     |     |     |     |     |     |     +--- i++;
        |     |     |     |     |     |     |     |  +--------------------------------------------------------------------------------------------------------------------------+ 
   221  |     |     |     |     |     |     |     +--+ break; // Ë°åÊú´„Éà„Éº„ÇÉb„ÉÉE„ÅÉZ„ÅÉ@„ÇíËÅBå„Å®„Åó„Å¶ÊâÉA„ÅÜ„ÄÇÁÉJôÁÉJöËÅBå„ÅÆÂ†ÉGÂêà„ÅØÊúÄÂæå„Å´„ÇÉT„ÉÉ„Éà„Åï„Çå„Çã„ÄÇ | 
        |     |     |     |     |     |     |     |  +--------------------------------------------------------------------------------------------------------------------------+ 
        |     |     |     |     |     |     |   +-+---+ 
   222  |     |     |     |     |     |     |   |  }  | 
        |     |     |     |     |     |     |   +-----+ 
        |     |     |     |     |     |   +-+---+ 
   223  |     |     |     |     |     |   |  }  | 
        |     |     |     |     |     |   +-----+ 
        |     |     |     |     |   +-+---+ 
   224  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-+---+ 
        |     |     |     |     |   +-+-------+ 
   224  |     |     |     |     |   |  else{  | 
        |     |     |     |     |   +-+-------+ 
   225  |     |     |     |     |     +--- i++;
        |     |     |     |     |   +-+---+ 
   226  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |   +-+---+ 
   227  |     |     |     |   |  }  | 
        |     |     |     |   +-+---+ 
        |     |     |     |   +-+-------+ 
   227  |     |     |     |   |  else{  | 
        |     |     |     |   +-+-------+ 
   228  |     |     |     |     +--- i++;
        |     |     |     |   +-+---+ 
   229  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |     |  +------------+ 
   230  |     |     |     +--+ continue;  | 
        |     |     |     |  +------------+ 
        |     |     |     +-----------------------+ 
   231  |     |     |     |  case tid_SharpStart: | 
        |     |     |     +-----------------------+ 
        |     |     |     +-------------------------+ 
   232  |     |     |     |  case tid_SharpInclude: | 
        |     |     |     +-------------------------+ 
        |     |     |     +-------------------------+ 
   233  |     |     |     |  case tid_SharpDefine:  | 
        |     |     |     +-------------------------+ 
        |     |     |     +-----------------------+ 
   234  |     |     |     |  case tid_SharpUnDef: | 
        |     |     |     +-----------------------+ 
        |     |     |     +---------------------+ 
   235  |     |     |     |  case tid_SharpIf:  | 
        |     |     |     +---------------------+ 
        |     |     |     +-----------------------+ 
   236  |     |     |     |  case tid_SharpElse:  | 
        |     |     |     +-----------------------+ 
        |     |     |     +-----------------------+ 
   237  |     |     |     |  case tid_SharpElIf:  | 
        |     |     |     +-----------------------+ 
        |     |     |     +-----------------------+ 
   238  |     |     |     |  case tid_SharpEndIf: | 
        |     |     |     +-----------------------+ 
        |     |     |     +-----------------------+ 
   239  |     |     |     |  case tid_SharpIfDef: | 
        |     |     |     +-----------------------+ 
        |     |     |     +-------------------------+ 
   240  |     |     |     |  case tid_SharpIfnDef:  | 
        |     |     |     +-------------------------+ 
        |     |     |     +-------------------------+ 
   241  |     |     |     |  case tid_SharpPragma:  | 
        |     |     |     +-------------------------+ 
        |     |     |     +---------------------+ 
   242  |     |     |     |  case tid_SharpEnd: | 
        |     |     |     +---------------------+ 
        |     |     |     |  +--------------------------------------+ 
   243  |     |     |     +--+ for( ; i &lt; TokenList-&gt;Count ; i++){  | 
        |     |     |     |  +--+-----------------------------------+ 
   244  |     |     |     |     +--- Token2 = (TToken *)TokenList-&gt;Items[i];
        |     |     |     |     |  +------------------------------------------------------------------------+ 
   245  |     |     |     |     +--+ if((Token2-&gt;TokId == tid_LineEnd)||(Token2-&gt;TokId == tid_Semikoron)){  | 
        |     |     |     |     |  +--+---------------------------------------------------------------------+ 
   246  |     |     |     |     |     +--- i++;
        |     |     |     |     |     |  +--------------------------------------------------------------------------------------------------------------------------+ 
   247  |     |     |     |     |     +--+ break; // Ë°åÊú´„Éà„Éº„ÇÉb„ÉÉE„ÅÉZ„ÅÉ@„ÇíËÅBå„Å®„Åó„Å¶ÊâÉA„ÅÜ„ÄÇÁÉJôÁÉJöËÅBå„ÅÆÂ†ÉGÂêà„ÅØÊúÄÂæå„Å´„ÇÉT„ÉÉ„Éà„Åï„Çå„Çã„ÄÇ | 
        |     |     |     |     |     |  +--------------------------------------------------------------------------------------------------------------------------+ 
        |     |     |     |     |   +-+---+ 
   248  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |   +-+---+ 
   249  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |     |  +------------+ 
   250  |     |     |     +--+ continue;  | 
        |     |     |     |  +------------+ 
        |     |     |     +-----------+ 
   251  |     |     |     |  default: | 
        |     |     |     +-----------+ 
        |     |     |     |  +--------+ 
   252  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |   +-+---+ 
   253  |     |     |   |  }  | 
        |     |     |   +-----+ 
   254  |     |     +--- //
   255  |     |     |    //  Êñá„ÇíËßÅvÊûê„Åó„ÄÅ„Éà„ÉÉV„ÇÉb„ÉÉE„ÇíÈÄÉC„ÇÅ„Çã„ÄÇ                                                         
   256  |     |     |    //  ËßÅvÊûêÁÉIêÊûú„ÅÉb„ÄÅÂÅAâÊï∞„ÅÉáÂèÇÁÖß„ÇÑÈñ¢ÊïÅ[„ÅÉáÂºïÊï∞ÁäÉJÊÖãÁÉÖâ„Å®„Åó„Å¶„Éà„Éº„ÇÉb„ÉÉE„Éá„Éº„ÇÉ\„ÅÉH 
   257  |     |     |    //  Ê†ÉVÁ¥ç„Åï„Çå„ÄÅ‰ÉTÅEÂæå„ÅÆÂáÉíÁêÜ„ÅßÂèÇÁÖß„Åï„Çå„Çã„ÄÇ                                                    
   258  |     |     |    //                                                                                                             
        |     |     |  +----------------------------------------+ 
   259  |     |     +--+ if(MainF-&gt;SrcCodeType != MainF-&gt;sctC){ | 
        |     |     |  +--+-------------------------------------+ 
   260  |     |     |     +--- int ePos;
   261  |     |     |     |    
   262  |     |     |     +--- //          for(ePos = i+1 ; ePos &lt; TokenList-&gt;Count ; ePos++){
        |     |     |     |  +----------------------------------------------------+ 
   263  |     |     |     +--+ for(ePos = i ; ePos &lt; TokenList-&gt;Count ; ePos++){  | 
        |     |     |     |  +--+-------------------------------------------------+ 
   264  |     |     |     |     +--- Token2 = (TToken *)TokenList-&gt;Items[ePos];
   265  |     |     |     |     +--- //              if(Token-&gt;LineNo != Token2-&gt;LineNo){
        |     |     |     |     |  +------------------------------------------------------------------------+ 
   266  |     |     |     |     +--+ if((Token2-&gt;TokId == tid_LineEnd)||(Token2-&gt;TokId == tid_Semikoron)){  | 
        |     |     |     |     |  +--+---------------------------------------------------------------------+ 
   267  |     |     |     |     |     +--- ePos++;
        |     |     |     |     |     |  +--------------------------------------------------------------------------------------------------------------------------+ 
   268  |     |     |     |     |     +--+ break; // Ë°åÊú´„Éà„Éº„ÇÉb„ÉÉE„ÅÉZ„ÅÉ@„ÇíËÅBå„Å®„Åó„Å¶ÊâÉA„ÅÜ„ÄÇÁÉJôÁÉJöËÅBå„ÅÆÂ†ÉGÂêà„ÅØÊúÄÂæå„Å´„ÇÉT„ÉÉ„Éà„Åï„Çå„Çã„ÄÇ | 
        |     |     |     |     |     |  +--------------------------------------------------------------------------------------------------------------------------+ 
        |     |     |     |     |   +-+---+ 
   269  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |   +-+---+ 
   270  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
   271  |     |     |     +--- #if 0
   272  |     |     |     +--- string ss = &quot;&quot;;
        |     |     |     |  +----------------------------------+ 
   273  |     |     |     +--+ for(int j = i ; j &lt; ePos ; j++){ | 
        |     |     |     |  +--+-------------------------------+ 
   274  |     |     |     |     +--- Token2 = (TToken *)TokenList-&gt;Items[j];
   275  |     |     |     |     +--- ss += Token2-&gt;Str+&quot; &quot;;
        |     |     |     |   +-+---+ 
   276  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
   277  |     |     |     +--- MainF-&gt;print(&quot;[&quot;+ss+&quot;]&quot;);
   278  |     |     |     +--- #endif
   279  |     |     |     +--- Pass2_Fortran(TokenList,i,ePos,ValDataList);
   280  |     |     |     +--- i = ePos;
        |     |     |   +-+---+ 
   281  |     |     |   |  }  | 
        |     |     |   +-+---+ 
        |     |     |   +-+-------+ 
   281  |     |     |   |  else{  | 
        |     |     |   +-+-------+ 
   282  |     |     |     +--- i += Pass2_C(TokenList,i,ValDataList);
        |     |     |   +-+---+ 
   283  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |   +-+---+ 
   284  |     |   |  }  | 
        |     |   +-----+ 
        |   +-+---+ 
   285  |   |  }  | 
        |   +-----+ 
   286  +--- /*----------------------------------------------------------------------------*/
   287  |    //                                                                                                     
   288  |    //  1.ÊóÅEÊúÉÉË™ûÂêç                                                                                   
   289  |    //                                                                                                     
   290  |    //  2.„Éë„É©„ÉÅB„ÇÉ\Ë™ÉÉÊòé                                                                            
   291  |    //    TokenList   „Éà„Éº„ÇÉb„ÉÉE„ÉÉF„ÇÉP„Éà                                                            
   292  |    //    sPos    ÈñãÂÉ@ã‰ÉXçÁÉXÉá                                                                         
   293  |    //    ePos    ÁµÇ‰ÉRÜ‰ÉXçÁÉXÉá                                                                         
   294  |    //    ValDataList Â§âÊï∞„ÉÉF„ÇÉP„Éà                                                                    
   295  |    //                                                                                                     
   296  |    //  3.Ê¶ÇËÉíÅ                                                                                          
   297  |    //    ÊßãÊñáËßÅvÊûê„ÇíÔºëËÅBå„Åî„ÅÉB„ÅÉHË°å„ÅÜ                                                         
   298  |    //    sPos„Åã„ÇâePos„ÅÉá„Éà„Éº„ÇÉb„ÉÉE„ÇíÂÖ®„ÅÉíÂáÉíÁêÜ„Åô„Çã„Åì„ÅÉB„ÄÇ(ePos„ÅÉb„ÄÅLineEnd„ÇíÁÅAÉR„Åô) 
   299  |    //    „ÅÑ„Åè„ÅÅA„Åã„ÅÆ„ÅÉZ„ÅÉB„ÅÉZ„ÅÅv„ÅüÂá¶ÁêÜ„ÅØ„ÄÅ„Çµ„Éñ„É´„ÉÉV„ÉÅ„É≥„ÅÉB„Åô„Çã„Åì„Å®„ÄÇ            
   300  |    //                                                                                                     
   301  |    //  4.Ê©üËÉΩË™ÉÉÊòé                                                                                    
   302  |    //                                                                                                     
   303  |    //  5.ÊàÉT„ÇäÂÄÅA                                                                                      
   304  |    //                                                                                                     
   305  |    //  6.ÂÇôËÄÉ                                                                                           
   306  |    //                                                                                                     
   307  |    /*----------------------------------------------------------------------------*/                       
        |  +----------------------------------------------------------------------------+ 
   308  +--+ void Pass2_Fortran(TList *TokenList,int sPos,int ePos,TList *ValDataList)  | 
   309  |  | //void Pass2_Line(TList *TokenList,int sPos,int ePos,TList *ValDataList)   | 
   310  |  | {                                                                          | 
        |  +--+-------------------------------------------------------------------------+ 
   311  |     +--- TToken *Token,*ValToken;
   312  |     +--- int TokId;
   313  |     +--- int UseTokLen;
   314  |     +--- double dData;
   315  |     +--- string TokStr;
   316  |     +--- int ValIdx;
   317  |     +--- TValData *ValData = NULL;
   318  |     +--- int TmpRefCount;
   319  |     |    
   320  |     +--- Token = (TToken *)TokenList-&gt;Items[sPos];
   321  |     +--- TokId = Token-&gt;TokId;
   322  |     +--- //
   323  |     |    //  Ë°å„ÅÆÂÖàÈ†ÉÖ„ÅÉáË°åÁï™ÂèÉL„ÅÉB„ÉÉD„Éô„É´„ÅÉáÂáÉíÁêÜ„ÇíË°å„ÅÜ„ÄÇ   
   324  |     |    //                                                                     
        |     |  +--------------------------------------------------------------------------------------+ 
   325  |     +--+ if(TokId == tid_Label){ // „ÉÉD„Éô„É´IdËáÉF‰Ωì„ÅåPass1„ÅÉ@Ë®ÉÖÂÆö„Åï„Çå„ÅüÂ†ÉGÂêà„ÄÇ | 
        |     |  +--+-----------------------------------------------------------------------------------+ 
   326  |     |     +--- // „ÉÉD„Éô„É´„ÇíÈô§„ÅÑ„Å¶„ÄÅ„ÇÇ„ÅÜ‰ÉNÄÂ∫ÉíÂëÉV„ÅÉEÂáÉR„Åô„ÄÇ (Êñá„Åß„ÇÇÂèØËÉÉX„ÅÉF„Åü„ÇÅ)
   327  |     |     +--- sPos++;
   328  |     |     +--- Token = (TToken *)TokenList-&gt;Items[sPos];
   329  |     |     +--- TokId = Token-&gt;TokId;
        |     |   +-+---+ 
   330  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+---------------------------------------------------------------------------+ 
   331  |     |   |  else if(TokId == tid_ConstInt){ // Ë°å„ÅÆÂÖàÈ†ÉÖ„ÅÉáÊïÅ[ÂÄÅA„ÅÉbË°åÁï™ÂèÉL | 
        |     |   +-+---------------------------------------------------------------------------+ 
   332  |     |     +--- Token-&gt;TokId = tid_Label;
   333  |     |     +--- sPos++;
   334  |     |     +--- Token = (TToken *)TokenList-&gt;Items[sPos];
   335  |     |     +--- TokId = Token-&gt;TokId;
        |     |   +-+---+ 
   336  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-----------------------------------------------------------------+ 
   337  |     |   |  else if((TokId == tid_Val)&amp;&amp;(sPos+1 &lt; ePos)&amp;&amp;                    | 
   338  |     |   |      (((TToken *)TokenList-&gt;Items[sPos+1])-&gt;TokId == tid_Koron)){ | 
        |     |   +-+-----------------------------------------------------------------+ 
   339  |     |     +--- // Ë°å„ÅÆÂÖàÈ†ÉÖ„ÅÉá ÂêçÂâç: „ÅÉ@„ÉÉD„Éô„É´„ÅÉH„ÅÉF„Çã„ÄÇ
   340  |     |     +--- Token-&gt;TokId = tid_Label;
   341  |     |     +--- sPos+=2;
   342  |     |     +--- Token = (TToken *)TokenList-&gt;Items[sPos];
   343  |     |     +--- TokId = Token-&gt;TokId;
        |     |   +-+---+ 
   344  |     |   |  }  | 
        |     |   +-----+ 
   345  |     |    
        |     |  +----------------+ 
   346  |     +--+ switch(TokId){ | 
        |     |  +--+-------------+ 
   347  |     |     +--- //  case -1:
        |     |     +-----------------+ 
   348  |     |     |  case tid_Val:  | 
        |     |     +-----------------+ 
   349  |     |     +--- //
   350  |     |     |    // ‰ªÅvÂÖÅEÊñá„ÄÄÂÖàÈ†ÉÖ„ÅåÊú™ÂÆöÁÉZÉD„Éà„Éº„ÇÉb„ÉÉE (Â§âÊï∞ÂêçÔÉVâ                            
   351  |     |     |    // „ÇÉÖ„ÉÉV„ÉÉb„ÉÉV„Éâ„Å®‰∏ÄËáÉG„Åô„Çã DO „ÅÉF„ÅÉD„ÅÉáÂ§âÊï∞Âêç„ÅØ„ÇÉI„Éù„Éº„Éà„Åó„ÅÉF„ÅÑ„ÄÇ   
   352  |     |     |    // Ë°å„ÅÆÂÖàÈ†ÉÖ„ÅÉb„ÄÅÂÉNÉN„ÅÉHÂ§âÊï∞Âêç„Å®„ÅÉF„Çã„ÄÇ ÂêçÂâç„ÅÉáÊ¨ÅB„Åå(„ÅÉF„ÇâÈÖçÂàó„ÄÇ      
   353  |     |     |    //                                                                                             
   354  |     |     +--- ValToken = Token; // Â§âÊï∞„Éà„Éº„ÇÉb„ÉÉE
   355  |     |     +--- TokStr = Token-&gt;Str;
   356  |     |     +--- //
   357  |     |     |    // Â§âÊï∞„Çí vrf_set„ÅÉ@ËøÉXÂä†  
   358  |     |     |    //                               
        |     |     |  +------------------------------------------------------------+ 
   359  |     |     +--+ for(ValIdx = 0 ; ValIdx &lt; ValDataList-&gt;Count ; ValIdx++){  | 
        |     |     |  +--+---------------------------------------------------------+ 
   360  |     |     |     +--- ValData = (TValData *)ValDataList-&gt;Items[ValIdx];
        |     |     |     |  +------------------------------------------------------+ 
   361  |     |     |     +--+ if((LowerCase(ValData-&gt;Str) == LowerCase(TokStr))&amp;&amp;  | 
   362  |     |     |     |  |     (ValData-&gt;ModuleIdx == Token-&gt;ModuleIdx)){       | 
        |     |     |     |  +--+---------------------------------------------------+ 
   363  |     |     |     |     +--- Token-&gt;ValData = ValData; // „Éà„Éº„ÇÉb„ÉÉE„ÅÉHÂ§âÊï∞„ÇíÈñ¢ÈÄÅv‰ªò„Åë„Çã
   364  |     |     |     |     +--- ValData-&gt;SetCount++;
   365  |     |     |     |     +--- ValIdx = ValDataList-&gt;Count+10;
        |     |     |     |     |  +--------+ 
   366  |     |     |     |     +--+ break; | 
        |     |     |     |     |  +--------+ 
        |     |     |     |   +-+---+ 
   367  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |   +-+---+ 
   368  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +--------------------------------------+ 
   369  |     |     +--+ if(ValIdx != ValDataList-&gt;Count+10){ | 
        |     |     |  +--+-----------------------------------+ 
   370  |     |     |     +--- // ÊúÄÂàù„Å´ÂáÉRÁèÉZ„Åó„ÅüÂ§âÊï∞
   371  |     |     |     +--- ValData = new TValData(TokStr);
   372  |     |     |     +--- ValDataList-&gt;Add((void *)ValData);
   373  |     |     |     +--- ValData-&gt;ModuleIdx = Token-&gt;ModuleIdx;
   374  |     |     |     +--- ValData-&gt;DataType = ImplType[(int)TokStr[0]]; // ÊöóÈÉTô„ÅÆÂÆÅvË®Ä
   375  |     |     |     +--- Token-&gt;ValData = ValData; // „Éà„Éº„ÇÉb„ÉÉE„ÅÉHÂ§âÊï∞„ÇíÈñ¢ÈÄÅv‰ªò„Åë„Çã
   376  |     |     |     +--- ValData-&gt;SetCount++;
        |     |     |   +-+---+ 
   377  |     |     |   |  }  | 
        |     |     |   +-----+ 
   378  |     |     +--- TmpRefCount = ValData-&gt;RefCount;
   379  |     |     +--- Token = (TToken *)TokenList-&gt;Items[++sPos]; // Ê¨ÅB„ÅÉá„Éà„Éº„ÇÉb„ÉÉE„ÇíÊâÄÂæó
        |     |     |  +--------------------------------+ 
   380  |     |     +--+ if(Token-&gt;TokId == tid_Kakko){ | 
        |     |     |  +--+-----------------------------+ 
   381  |     |     |     +--- // ÈÖçÂàó„ÄÄa(i,j) = „ÅÉF„ÅÉD
   382  |     |     |     |    // ÈÖçÂàó„ÅÉáÊ∑ÉT„ÅàÂÉÖóÈÉ®ÂàÜ„ÅÆËßÅvÊûê„ÇíË°å„Å™„ÅÑ Token„ÅÉBValList„Çí„Çª„ÉÉ„Éà  
   383  |     |     |     |    //                                                                                 
   384  |     |     |     +--- ValData-&gt;ArrayOrFuncF = true;
   385  |     |     |     +--- sPos++; // skip &quot;(&quot;
        |     |     |     |  +------+ 
   386  |     |     |     +--+ do{  | 
        |     |     |     |  +--+---+ 
   387  |     |     |     |     +--- UseTokLen = Eval(TokenList,sPos,ePos,ValDataList,&amp;dData);
   388  |     |     |     |     +--- //              if(UseTokLen == -1){
        |     |     |     |     |  +----------------------+ 
   389  |     |     |     |     +--+ if(UseTokLen &lt;= 0){  | 
        |     |     |     |     |  +--+-------------------+ 
        |     |     |     |     |     |  +--------+ 
   390  |     |     |     |     |     +--+ break; | 
        |     |     |     |     |     |  +--------+ 
        |     |     |     |     |   +-+---+ 
   391  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
   392  |     |     |     |     +--- sPos += UseTokLen;
   393  |     |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[sPos]; // Ê¨ÅB„ÅÉá„Éà„Éº„ÇÉb„ÉÉE„ÇíÊâÄÂæó
        |     |     |     |     |  +------------------------------------------------------------------+ 
   394  |     |     |     |     +--+ if(Token-&gt;TokId == tid_Kannma){ // &quot;,&quot;„ÅÉáÂ†ÉGÂêà„ÅØ„ÄÅÊÉÉÅB„ÅÉN | 
        |     |     |     |     |  +--+---------------------------------------------------------------+ 
   395  |     |     |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[++sPos];
        |     |     |     |     |   +-+---+ 
   396  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |   +-+-----------------------------------+ 
   397  |     |     |     |   |  }while(Token-&gt;TokId != tid_Kokka); | 
        |     |     |     |   +-------------------------------------+ 
   398  |     |     |     +--- sPos++; // Skip &quot;)&quot;
   399  |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[sPos];
        |     |     |   +-+---+ 
   400  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +------------------------------+ 
   401  |     |     +--+ if(Token-&gt;TokId != tid_Set){ | 
        |     |     |  +--+---------------------------+ 
   402  |     |     |     +--- MainF-&gt;ErrMessage(sPos,&quot;Âºè„Å´'='„Åå„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ");
        |     |     |   +-+---+ 
   403  |     |     |   |  }  | 
        |     |     |   +-----+ 
   404  |     |     +--- sPos++; // Skip &quot;=&quot;
   405  |     |     +--- // ÂèÉEËæÉRÈÉÉBÂàÜ„ÅÆË©ï‰ÉZÅB„ÅÉB„Éà„Éº„ÇÉb„ÉÉE„ÅÉáÂáÉíÁêÜ„ÇíË°å„ÅÜ„ÄÇ
   406  |     |     +--- UseTokLen = Eval(TokenList,sPos,ePos,ValDataList,&amp;dData);
        |     |     |  +----------------------------------------+ 
   407  |     |     +--+ if(TmpRefCount != ValData-&gt;RefCount){  | 
        |     |     |  +--+-------------------------------------+ 
   408  |     |     |     +--- //
   409  |     |     |     |    // Val = „ÅÉáÂèÉEËæÉR„ÅÉ@ Val„ÅÉáÂèÇÁÖß„Åå„ÅÇ„ÅÅv„ÅüÂ†ÉGÂêà„ÅØ„ÄÅ  
   410  |     |     |     |    // Val = Val + ... „ÅÉB„Åó„Å¶ÊâÉA„ÅÅv„ÅÉí„ÅÑ„Çã„ÄÇ                 
   411  |     |     |     |    // if(TmpRefCount &lt; ValData-&gt;RefCount) „ÅÉBÂêåÁÉÖâ                 
   412  |     |     |     |    //                                                                 
   413  |     |     |     +--- ValToken-&gt;RefType = vrf_refset;
        |     |     |   +-+---+ 
   414  |     |     |   |  }  | 
        |     |     |   +-+---+ 
        |     |     |   +-+-------+ 
   414  |     |     |   |  else{  | 
        |     |     |   +-+-------+ 
   415  |     |     |     +--- ValToken-&gt;RefType = vrf_set;
        |     |     |   +-+---+ 
   416  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +--------+ 
   417  |     |     +--+ break; | 
        |     |     |  +--------+ 
        |     |     +-----------------------------------------+ 
   418  |     |     |  case tid_LineEnd:   // Ë°å„ÅÆÁµÇ„Çè„Çä | 
        |     |     +-----------------------------------------+ 
        |     |     |  +--------+ 
   419  |     |     +--+ break; | 
        |     |     |  +--------+ 
        |     |     +-----------------+ 
   420  |     |     |  case tid_null: | 
        |     |     +-----------------+ 
        |     |     +-----------------------------------------+ 
   421  |     |     |  case tid_Comment:   // „ÇÉE„ÉÅB„ÉÉE„Éà | 
        |     |     +-----------------------------------------+ 
        |     |     +-------------------------------------------+ 
   422  |     |     |  case tid_ConstStr:  // ÊñáÂÉÖóÂàóÂÆöÊï∞  | 
        |     |     +-------------------------------------------+ 
        |     |     +-----------------------------------------------------------------------------------------+ 
   423  |     |     |  case tid_Label:     // ÊñáÁï™ÂèÉL„ÄÅ„Åæ„Åü„ÅØ„ÉÉD„Éô„É´ (ÂøÖËÉíÅ„Å´Âøú„Åò„ÅÉíÊ§úÁÉGÅu) | 
        |     |     +-----------------------------------------------------------------------------------------+ 
        |     |     |  +--------+ 
   424  |     |     +--+ break; | 
        |     |     |  +--------+ 
        |     |     +-----------------+ 
   425  |     |     |  case tid_END:  | 
        |     |     +-----------------+ 
   426  |     |     +--- // „ÉÅu„ÇÉN„ÉÅE„ÉÉV„ÉÉH„ÇíÁÉIÇ‰ÉRÜ„ÄÇÔÉVàÊÉÉÅBË°å„Åã„ÇâÊÉÉÅB„ÉÅu„ÇÉN„ÉÅE„ÉÉV„ÉÉH„ÅÉB„ÅÉF„ÇãÔÉVâ
   427  |     |     |    // End„ÅÉáÂæå„ÅÆÂêçÂâç„ÅÉb„ÄÅSkip„Åô„Çã„ÄÇ                                                       
        |     |     |  +----------------------------+ 
   428  |     |     +--+ if(Token-&gt;NestLevel == 0){ | 
        |     |     |  +--+-------------------------+ 
   429  |     |     |     +--- ResetModule();
        |     |     |   +-+---+ 
   430  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +--------+ 
   431  |     |     +--+ break; | 
        |     |     |  +--------+ 
   432  |     |     +--- // ProgramÈñÅuÈÄÅv
        |     |     +-------------------------------------+ 
   433  |     |     |  case tid_PROGRAM:       // PROGRAM | 
        |     |     +-------------------------------------+ 
        |     |     +-------------------------------------+ 
   434  |     |     |  case tid_MODULE:        // MODULE  | 
        |     |     +-------------------------------------+ 
        |     |     +---------------------------------------+ 
   435  |     |     |  case tid_INTERFACE:     // INTERFACE | 
        |     |     +---------------------------------------+ 
   436  |     |     +--- // „ÅÉB„Çä„ÅÇ„Åà„Åö„ÅÉF„Åó„ÄÇÁèæÁäÉJ„ÅÉ@„ÅÉb„ÄÅ„Çµ„Éñ„ÅÆÂëÉV„ÅÉEÂáÉR„Åó„ÅØÂØÉZË±ÅBÂ§ñ
        |     |     |  +--------+ 
   437  |     |     +--+ break; | 
        |     |     |  +--------+ 
        |     |     +-----------------------------------------+ 
   438  |     |     |  case tid_SUBROUTINE:    // SUBROUTINE  | 
        |     |     +-----------------------------------------+ 
        |     |     +---------------------------------------+ 
   439  |     |     |  case tid_FUNCTION:      // FUNCTION  | 
        |     |     +---------------------------------------+ 
   440  |     |     +--- AddSubFuncDef_Fortran(TokenList,sPos,ePos,ValDataList);
        |     |     |  +--------+ 
   441  |     |     +--+ break; | 
        |     |     |  +--------+ 
        |     |     +---------------------------------------+ 
   442  |     |     |  case tid_CONTAINS:      // CONTAINS  | 
        |     |     +---------------------------------------+ 
        |     |     +---------------------------------+ 
   443  |     |     |  case tid_USE:           // USE | 
        |     |     +---------------------------------+ 
   444  |     |     +--- // „ÅÉB„Çä„ÅÇ„Åà„Åö„ÅÉF„Åó„ÄÇÁèæÁäÉJ„ÅÉ@„ÅÉb„ÄÅ„Çµ„Éñ„ÅÆÂëÉV„ÅÉEÂáÉR„Åó„ÅØÂØÉZË±ÅBÂ§ñ
        |     |     |  +--------+ 
   445  |     |     +--+ break; | 
        |     |     |  +--------+ 
   446  |     |     +--- // „Éá„Éº„ÇÉ\ÂÆÅvË®ÄÈñÅuÈÄÅv„ÄÅÂÅAâÊï∞(ÂÆöÊï∞ÔºâÂÉáöÁÉZÉD„ÇíValDataList„ÅÉHËøÉXÂä†„Åô„Çã„ÄÇ
        |     |     +---------------------+ 
   447  |     |     |  case tid_INTEGER:  | 
        |     |     +---------------------+ 
        |     |     +-----------------+ 
   448  |     |     |  case tid_REAL: | 
        |     |     +-----------------+ 
        |     |     +-----------------------------+ 
   449  |     |     |  case tid_DOUBLEPRECISION:  | 
        |     |     +-----------------------------+ 
        |     |     +-----------------------+ 
   450  |     |     |  case tid_CHARACTER:  | 
        |     |     +-----------------------+ 
        |     |     +---------------------+ 
   451  |     |     |  case tid_LOGICAL:  | 
        |     |     +---------------------+ 
        |     |     +---------------------+ 
   452  |     |     |  case tid_COMPLEX:  | 
        |     |     +---------------------+ 
        |     |     +-----------------------+ 
   453  |     |     |  case tid_DIMENSION:  | 
        |     |     +-----------------------+ 
        |     |     +-----------------------+ 
   454  |     |     |  case tid_PARAMETER:  | 
        |     |     +-----------------------+ 
   455  |     |     +--- //
   456  |     |     |    // „Éá„Éº„ÇÉ\ÂÆÅvË®ÄÈñÅuÈÄÅv„ÄÅÂÅAâÊï∞(ÂÆöÊï∞ÔºâÂÉáöÁÉZÉD„ÇíValDataList„ÅÉHËøÉXÂä†„Åô„Çã„ÄÇ                
   457  |     |     |    // Â§âÊï∞„ÅÉá„Éá„Éº„ÇÉ\Âûã„ÅåÂøÖËÉíÅ„Å®„ÅÉF„Çã„Åü„ÇÅÂÉ\ÖÈ†à                                                
   458  |     |     |    // PARAMETER„ÅÉáÂÆöÊï∞ÂáÉíÁêÜ„ÇÇ„ÄÅÂÉVè„ÅÆË©ï‰ÉZÅB„ÇíËÅBå„Å£„ÅÉíË®àÁÉáó„Åô„Çã„ÄÇÔÉVàÂèØËÉÉX„ÅÉFÈôê„ÇäÔºâ   
   459  |     |     |    //  Exp. REAL,PARAMETER ABC = 12*4 ; PARAMETER (N=3)                                                       
   460  |     |     |    //                                                                                                         
   461  |     |     +--- AddDataDef_Fortran(TokenList,sPos,ePos,ValDataList);
        |     |     |  +--------+ 
   462  |     |     +--+ break; | 
        |     |     |  +--------+ 
        |     |     +---------------------------------------------------------+ 
   463  |     |     |  case tid_IMPLICIT:      // ÊöóÈÉTô„ÅÆÂûãÂÉáÅvË®ÄÂ§âÊõ¥ | 
        |     |     +---------------------------------------------------------+ 
   464  |     |     +--- IMPLICIT(TokenList,sPos+1,ePos);
        |     |     |  +--------+ 
   465  |     |     +--+ break; | 
        |     |     |  +--------+ 
        |     |     +-----------------+ 
   466  |     |     |  case tid_TYPE: | 
        |     |     +-----------------+ 
        |     |     |  +--------+ 
   467  |     |     +--+ break; | 
        |     |     |  +--------+ 
        |     |     +---------------------------------------------------------------------+ 
   468  |     |     |  case tid_NAMELIST: // NameList„ÅÉb„ÄÅREAD,WRITE„ÅÉ@‰ΩÉ\„Çè„Çå„Çã.  | 
        |     |     +---------------------------------------------------------------------+ 
        |     |     +-------------------------+ 
   469  |     |     |  case tid_ALLOCATABLE:  | 
        |     |     +-------------------------+ 
        |     |     +---------------------+ 
   470  |     |     |  case tid_POINTER:  | 
        |     |     +---------------------+ 
        |     |     +-------------------+ 
   471  |     |     |  case tid_TARGET: | 
        |     |     +-------------------+ 
        |     |     +-----------------+ 
   472  |     |     |  case tid_SAVE: | 
        |     |     +-----------------+ 
        |     |     +---------------------+ 
   473  |     |     |  case tid_PRIVATE:  | 
        |     |     +---------------------+ 
        |     |     +-------------------+ 
   474  |     |     |  case tid_PUBLIC: | 
        |     |     +-------------------+ 
        |     |     +---------------------+ 
   475  |     |     |  case tid_EXTERNAL: | 
        |     |     +---------------------+ 
        |     |     +-----------------------+ 
   476  |     |     |  case tid_INTRINSIC:  | 
        |     |     +-----------------------+ 
        |     |     +-------------------+ 
   477  |     |     |  case tid_INTENT: | 
        |     |     +-------------------+ 
        |     |     +---------------------+ 
   478  |     |     |  case tid_OPTIONAL: | 
        |     |     +---------------------+ 
        |     |     +-------------------+ 
   479  |     |     |  case tid_WHERE:  | 
        |     |     +-------------------+ 
   480  |     |     +--- //ÂãïÁöÑË®òÊÜ∂ÂâÉC‰ªò„Åë
        |     |     +---------------------+ 
   481  |     |     |  case tid_ALLOCATE: | 
        |     |     +---------------------+ 
        |     |     +-----------------------+ 
   482  |     |     |  case tid_DEALLOCATE: | 
        |     |     +-----------------------+ 
        |     |     +---------------------+ 
   483  |     |     |  case tid_NULLIFY:  | 
        |     |     +---------------------+ 
   484  |     |     +--- // „Åô„Åπ„ÅÉí„ÄÅËÉFÉÖ„ÅÉ\È£õ„Å∞„Åô„ÄÇÔÉVàÂÉXìÈù¢„Éù„Ç§„ÉÉE„ÇÉ\„ÄÅÊÉ@ãÈÄ†‰Ωì„ÅØÂØÉZË±ÅBÂ§ñ„Å®„Åô„ÇãÔºâ
   485  |     |     |    // „Éù„Ç§„ÉÉE„ÇÉ\„ÄÅÊÉ@ãÈÄ†‰Ωì„ÇíÂêÉH„ÇÄÈÉÉBÂàÜ„ÅØ„ÄÅ„Çπ„ÇÉb„ÉÉF„Éó„Éà„ÅÉ@Â§âÊèõ‰∏çÂèØ„ÅÉB„Åô„Çã„ÄÇ    
        |     |     |  +--------+ 
   486  |     |     +--+ break; | 
        |     |     |  +--------+ 
        |     |     +-----------------+ 
   487  |     |     |  case tid_CALL: | 
        |     |     +-----------------+ 
   488  |     |     +--- // Call„ÅÉb„ÄÅ„Åù„ÅÉáÊ¨ÅB„ÅÉá„ÇÉI„Éñ„É´„ÉÉV„ÉÅ„É≥Âêç„ÇíSkip„Åó„Å¶„Åã„Çâ
   489  |     |     |    // Âæå„ÅÆÂ§âÊï∞„Çí RW„ÅÉáÂ±ûÊÄÉ@„Çí„Å§„Åë„Å¶Ë®ÉÖÂÆö„Åô„Çã„ÄÇÔÉVàÂûã„ÅÉá‰∏ÄËáÉG„ÉÅ„Çß„ÉÉ„ÇØ„ÅÉF„ÅÉD„ÅÉbË°å„Çè„ÅÉF„ÅÑÔÉVâ  
   490  |     |     +--- #if 1   // Call„ÅÉáÂ§âÊï∞
   491  |     |     +--- sPos++; // Skip „ÇÉI„Éñ„É´„ÉÉV„ÉÅ„É≥Âêç
   492  |     |     |                                             
   493  |     |     +--- Token = (TToken *)TokenList-&gt;Items[++sPos]; // Ê¨ÅB„ÅÉá„Éà„Éº„ÇÉb„ÉÉE„ÇíÊâÄÂæó
        |     |     |  +--------------------------------+ 
   494  |     |     +--+ if(Token-&gt;TokId == tid_Kakko){ | 
        |     |     |  +--+-----------------------------+ 
   495  |     |     |     +--- // ÈÖçÂàó„ÄÄa(i,j) = „ÅÉF„ÅÉD
   496  |     |     |     |    // ÈÖçÂàó„ÅÉáÊ∑ÉT„ÅàÂÉÖóÈÉ®ÂàÜ„ÅÆËßÅvÊûê„ÇíË°å„Å™„ÅÑ Token„ÅÉBValList„Çí„Çª„ÉÉ„Éà  
   497  |     |     |     |    //                                                                                 
   498  |     |     |     +--- sPos++; // skip &quot;(&quot;
        |     |     |     |  +------+ 
   499  |     |     |     +--+ do{  | 
        |     |     |     |  +--+---+ 
   500  |     |     |     |     +--- UseTokLen = Eval(TokenList,sPos,ePos,ValDataList,&amp;dData);
   501  |     |     |     |     +--- //                if(UseTokLen == -1){
        |     |     |     |     |  +----------------------+ 
   502  |     |     |     |     +--+ if(UseTokLen &lt;= 0){  | 
        |     |     |     |     |  +--+-------------------+ 
        |     |     |     |     |     |  +--------+ 
   503  |     |     |     |     |     +--+ break; | 
        |     |     |     |     |     |  +--------+ 
        |     |     |     |     |   +-+---+ 
   504  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
   505  |     |     |     |     +--- sPos += UseTokLen;
   506  |     |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[sPos]; // Ê¨ÅB„ÅÉá„Éà„Éº„ÇÉb„ÉÉE„ÇíÊâÄÂæó
        |     |     |     |     |  +------------------------------------------------------------------+ 
   507  |     |     |     |     +--+ if(Token-&gt;TokId == tid_Kannma){ // &quot;,&quot;„ÅÉáÂ†ÉGÂêà„ÅØ„ÄÅÊÉÉÅB„ÅÉN | 
        |     |     |     |     |  +--+---------------------------------------------------------------+ 
   508  |     |     |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[++sPos];
        |     |     |     |     |   +-+---+ 
   509  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |   +-+-----------------------------------+ 
   510  |     |     |     |   |  }while(Token-&gt;TokId != tid_Kokka); | 
        |     |     |     |   +-------------------------------------+ 
   511  |     |     |     +--- sPos++; // Skip &quot;)&quot;
   512  |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[sPos];
        |     |     |   +-+---+ 
   513  |     |     |   |  }  | 
        |     |     |   +-----+ 
   514  |     |     +--- #endif
        |     |     |  +--------+ 
   515  |     |     +--+ break; | 
        |     |     |  +--------+ 
        |     |     +-------------------------+ 
   516  |     |     |  case tid_DO: // DOÊñá  | 
        |     |     +-------------------------+ 
   517  |     |     +--- //      Token-&gt;JmpTokenPos = FindEndDo(TokenList,sPos);
   518  |     |     +--- Token = (TToken *)TokenList-&gt;Items[++sPos]; // Ê¨ÅB„ÅÉá„Éà„Éº„ÇÉb„ÉÉE„ÇíÊâÄÂæó
        |     |     |  +--------------------------------------------------------------------------------------+ 
   519  |     |     +--+ if(Token-&gt;TokId == tid_ConstInt){ // Ë°åÁï™ÂèÉL‰ΩÉ\ÁîÉB„ÅÉáDOÊñá DO 800 I = 1,10 Á≠â | 
        |     |     |  +--+-----------------------------------------------------------------------------------+ 
   520  |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[++sPos]; // Ê¨ÅB„ÅÉá„Éà„Éº„ÇÉb„ÉÉE„ÇíÊâÄÂæó
        |     |     |   +-+---+ 
   521  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +------------------------------+ 
   522  |     |     +--+ if(Token-&gt;TokId != tid_Val){ | 
        |     |     |  +--+---------------------------+ 
   523  |     |     |     +--- MainF-&gt;ErrMessage(sPos,&quot;DOÊñá„ÅÆÂ§âÊï∞„ÅåËÉíã„Å§„Åã„Çä„ÅÉZ„Åõ„Çì„ÄÇ");
        |     |     |   +-+---+ 
   524  |     |     |   |  }  | 
        |     |     |   +-----+ 
   525  |     |     +--- ValToken = Token; // Â§âÊï∞„Éà„Éº„ÇÉb„ÉÉE
   526  |     |     |                                               
   527  |     |     +--- TokStr = Token-&gt;Str;
   528  |     |     +--- //
   529  |     |     |    // Â§âÊï∞„Çí vrf_set„ÅÉ@ËøÉXÂä†  
   530  |     |     |    //                               
        |     |     |  +------------------------------------------------------------+ 
   531  |     |     +--+ for(ValIdx = 0 ; ValIdx &lt; ValDataList-&gt;Count ; ValIdx++){  | 
        |     |     |  +--+---------------------------------------------------------+ 
   532  |     |     |     +--- ValData = (TValData *)ValDataList-&gt;Items[ValIdx];
   533  |     |     |     +--- //          if((AnsiCompareText(ValData-&gt;Str,TokStr) == 0)&amp;&amp;
        |     |     |     |  +------------------------------------------------------+ 
   534  |     |     |     +--+ if((LowerCase(ValData-&gt;Str) == LowerCase(TokStr))&amp;&amp;  | 
   535  |     |     |     |  |     (ValData-&gt;ModuleIdx == Token-&gt;ModuleIdx)){       | 
        |     |     |     |  +--+---------------------------------------------------+ 
   536  |     |     |     |     +--- Token-&gt;ValData = ValData; // „Éà„Éº„ÇÉb„ÉÉE„ÅÉHÂ§âÊï∞„ÇíÈñ¢ÈÄÅv‰ªò„Åë„Çã
   537  |     |     |     |     +--- ValData-&gt;SetCount++;
   538  |     |     |     |     +--- ValIdx = ValDataList-&gt;Count+10;
        |     |     |     |     |  +--------+ 
   539  |     |     |     |     +--+ break; | 
        |     |     |     |     |  +--------+ 
        |     |     |     |   +-+---+ 
   540  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |   +-+---+ 
   541  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +--------------------------------------+ 
   542  |     |     +--+ if(ValIdx != ValDataList-&gt;Count+10){ | 
        |     |     |  +--+-----------------------------------+ 
   543  |     |     |     +--- // ÊúÄÂàù„Å´ÂáÉRÁèÉZ„Åó„ÅüÂ§âÊï∞
   544  |     |     |     +--- ValData = new TValData(TokStr);
   545  |     |     |     +--- ValDataList-&gt;Add((void *)ValData);
   546  |     |     |     +--- ValData-&gt;ModuleIdx = Token-&gt;ModuleIdx;
   547  |     |     |     +--- ValData-&gt;DataType = ImplType[(int)TokStr[0]]; // ÊöóÈÉTô„ÅÆÂÆÅvË®Ä
   548  |     |     |     +--- Token-&gt;ValData = ValData; // „Éà„Éº„ÇÉb„ÉÉE„ÅÉHÂ§âÊï∞„ÇíÈñ¢ÈÄÅv‰ªò„Åë„Çã
   549  |     |     |     +--- ValData-&gt;SetCount++;
        |     |     |   +-+---+ 
   550  |     |     |   |  }  | 
        |     |     |   +-----+ 
   551  |     |     +--- TmpRefCount = ValData-&gt;RefCount;
   552  |     |     +--- Token = (TToken *)TokenList-&gt;Items[++sPos]; // Ê¨ÅB„ÅÉá„Éà„Éº„ÇÉb„ÉÉE„ÇíÊâÄÂæó
        |     |     |  +--------------------------------+ 
   553  |     |     +--+ if(Token-&gt;TokId == tid_Kakko){ | 
        |     |     |  +--+-----------------------------+ 
   554  |     |     |     +--- // ÈÖçÂàó„ÄÄa(i,j) = „ÅÉF„ÅÉD
   555  |     |     |     |    // ÈÖçÂàó„ÅÉáÊ∑ÉT„ÅàÂÉÖóÈÉ®ÂàÜ„ÅÆËßÅvÊûê„ÇíË°å„Å™„ÅÑ Token„ÅÉBValList„Çí„Çª„ÉÉ„Éà  
   556  |     |     |     |    //                                                                                 
   557  |     |     |     +--- ValData-&gt;ArrayOrFuncF = true;
   558  |     |     |     +--- sPos++; // skip &quot;(&quot;
        |     |     |     |  +------+ 
   559  |     |     |     +--+ do{  | 
        |     |     |     |  +--+---+ 
   560  |     |     |     |     +--- UseTokLen = Eval(TokenList,sPos,ePos,ValDataList,&amp;dData);
        |     |     |     |     |  +----------------------+ 
   561  |     |     |     |     +--+ if(UseTokLen == -1){ | 
        |     |     |     |     |  +--+-------------------+ 
        |     |     |     |     |     |  +--------+ 
   562  |     |     |     |     |     +--+ break; | 
        |     |     |     |     |     |  +--------+ 
        |     |     |     |     |   +-+---+ 
   563  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
   564  |     |     |     |     +--- sPos += UseTokLen;
   565  |     |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[sPos]; // Ê¨ÅB„ÅÉá„Éà„Éº„ÇÉb„ÉÉE„ÇíÊâÄÂæó
        |     |     |     |     |  +------------------------------------------------------------------+ 
   566  |     |     |     |     +--+ if(Token-&gt;TokId == tid_Kannma){ // &quot;,&quot;„ÅÉáÂ†ÉGÂêà„ÅØ„ÄÅÊÉÉÅB„ÅÉN | 
        |     |     |     |     |  +--+---------------------------------------------------------------+ 
   567  |     |     |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[++sPos];
        |     |     |     |     |   +-+---+ 
   568  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |   +-+-----------------------------------+ 
   569  |     |     |     |   |  }while(Token-&gt;TokId != tid_Kokka); | 
        |     |     |     |   +-------------------------------------+ 
   570  |     |     |     +--- sPos++; // Skip &quot;)&quot;
   571  |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[sPos];
        |     |     |   +-+---+ 
   572  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +------------------------------+ 
   573  |     |     +--+ if(Token-&gt;TokId != tid_Set){ | 
        |     |     |  +--+---------------------------+ 
   574  |     |     |     +--- MainF-&gt;ErrMessage(sPos,&quot;Âºè„Å´'='„Åå„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ");
        |     |     |   +-+---+ 
   575  |     |     |   |  }  | 
        |     |     |   +-+---+ 
        |     |     |   +-+-------+ 
   575  |     |     |   |  else{  | 
        |     |     |   +-+-------+ 
   576  |     |     |     +--- sPos++; // Skip &quot;=&quot;
        |     |     |     |  +------+ 
   577  |     |     |     +--+ do{  | 
        |     |     |     |  +--+---+ 
   578  |     |     |     |     +--- UseTokLen = Eval(TokenList,sPos,ePos,ValDataList,&amp;dData);
        |     |     |     |     |  +----------------------+ 
   579  |     |     |     |     +--+ if(UseTokLen &lt;= 0){  | 
        |     |     |     |     |  +--+-------------------+ 
        |     |     |     |     |     |  +--------+ 
   580  |     |     |     |     |     +--+ break; | 
        |     |     |     |     |     |  +--------+ 
        |     |     |     |     |   +-+---+ 
   581  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
   582  |     |     |     |     +--- sPos += UseTokLen;
   583  |     |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[sPos]; // Ê¨ÅB„ÅÉá„Éà„Éº„ÇÉb„ÉÉE„ÇíÊâÄÂæó
        |     |     |     |     |  +------------------------------------------------------------------+ 
   584  |     |     |     |     +--+ if(Token-&gt;TokId == tid_Kannma){ // &quot;,&quot;„ÅÉáÂ†ÉGÂêà„ÅØ„ÄÅÊÉÉÅB„ÅÉN | 
        |     |     |     |     |  +--+---------------------------------------------------------------+ 
   585  |     |     |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[++sPos];
        |     |     |     |     |   +-+---+ 
   586  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |   +-+-----------------------------------+ 
   587  |     |     |     |   |  }while(Token-&gt;TokId != tid_Kokka); | 
        |     |     |     |   +-------------------------------------+ 
   588  |     |     |     +--- sPos++; // Skip &quot;)&quot;
   589  |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[sPos];
        |     |     |   +-+---+ 
   590  |     |     |   |  }  | 
        |     |     |   +-----+ 
   591  |     |     +--- //
   592  |     |     |    // Âºè„ÅÆÂèÉEËæÉR„ÅÉáËßÅvÊûê„ÇíË°å„ÅÜ„ÄÇ                               
   593  |     |     |    // ÂèÉEËæÉR„ÅåÂÉáöÊï∞„ÅÉáÂ†ÉGÂêà„ÅØ„ÄÅToken„ÅÉHÂÆöÊï∞„Çí„Çª„ÉÉ„ÉàÔºÅ   
   594  |     |     |    //                                                                     
   595  |     |     +--- UseTokLen = Eval(TokenList,sPos,ePos,ValDataList,&amp;dData);
        |     |     |  +----------------------------------------+ 
   596  |     |     +--+ if(TmpRefCount != ValData-&gt;RefCount){  | 
        |     |     |  +--+-------------------------------------+ 
   597  |     |     |     +--- ValToken-&gt;RefType = vrf_refset;
        |     |     |   +-+---+ 
   598  |     |     |   |  }  | 
        |     |     |   +-+---+ 
        |     |     |   +-+-------+ 
   598  |     |     |   |  else{  | 
        |     |     |   +-+-------+ 
   599  |     |     |     +--- ValToken-&gt;RefType = vrf_set;
        |     |     |   +-+---+ 
   600  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +--------+ 
   601  |     |     +--+ break; | 
        |     |     |  +--------+ 
   602  |     |     |    
   603  |     |     +--- // ÂàÉJÂæÅBÊñá
        |     |     +---------------+ 
   604  |     |     |  case tid_IF: | 
        |     |     +---------------+ 
   605  |     |     +--- //
   606  |     |     |    // IFÊñá„ÅØ„ÄÅ„Åù„ÅÉáÂæå„ÅÆÂ§âÊï∞„ÇíÂèÇÁÖÉ@„ÅÉB„Åó„Å¶ËøÉXÂä†„Åô„Çã„ÄÇ  
   607  |     |     |    //                                                                     
   608  |     |     +--- sPos++; // Skip IF
   609  |     |     +--- UseTokLen = Eval(TokenList,sPos,ePos,ValDataList,&amp;dData);
        |     |     |  +--------+ 
   610  |     |     +--+ break; | 
        |     |     |  +--------+ 
        |     |     +-------------------+ 
   611  |     |     |  case tid_SELECT: | 
        |     |     +-------------------+ 
        |     |     +---------------------+ 
   612  |     |     |  case tid_DOWHILE:  | 
        |     |     +---------------------+ 
        |     |     |  +--------+ 
   613  |     |     +--+ break; | 
        |     |     |  +--------+ 
        |     |     +-----------------+ 
   614  |     |     |  case tid_THEN: | 
        |     |     +-----------------+ 
        |     |     +-----------------+ 
   615  |     |     |  case tid_ELSE: | 
        |     |     +-----------------+ 
        |     |     +-------------------+ 
   616  |     |     |  case tid_ELSEIF: | 
        |     |     +-------------------+ 
        |     |     |  +--------+ 
   617  |     |     +--+ break; | 
        |     |     |  +--------+ 
        |     |     +-------------------+ 
   618  |     |     |  case tid_ENDIF:  | 
        |     |     +-------------------+ 
        |     |     +-------------------+ 
   619  |     |     |  case tid_ENDDO:  | 
        |     |     +-------------------+ 
        |     |     |  +--------+ 
   620  |     |     +--+ break; | 
        |     |     |  +--------+ 
        |     |     +-----------------+ 
   621  |     |     |  case tid_CASE: | 
        |     |     +-----------------+ 
        |     |     +-----------------+ 
   622  |     |     |  case tid_GOTO: | 
        |     |     +-----------------+ 
        |     |     +-------------------+ 
   623  |     |     |  case tid_RETURN: | 
        |     |     +-------------------+ 
        |     |     +-----------------+ 
   624  |     |     |  case tid_STOP: | 
        |     |     +-----------------+ 
        |     |     |  +--------+ 
   625  |     |     +--+ break; | 
        |     |     |  +--------+ 
   626  |     |     +--- // ÂÖÅEÂáÉRÂäõ
        |     |     +-----------------+ 
   627  |     |     |  case tid_READ: | 
        |     |     +-----------------+ 
        |     |     +-------------------+ 
   628  |     |     |  case tid_WRITE:  | 
        |     |     +-------------------+ 
        |     |     +-------------------+ 
   629  |     |     |  case tid_PRINT:  | 
        |     |     +-------------------+ 
        |     |     +-----------------------+ 
   630  |     |     |  case tid_BACKSPACE:  | 
        |     |     +-----------------------+ 
        |     |     +---------------------+ 
   631  |     |     |  case tid_INQUIRE:  | 
        |     |     +---------------------+ 
        |     |     +-------------------+ 
   632  |     |     |  case tid_REWIND: | 
        |     |     +-------------------+ 
        |     |     +-------------------+ 
   633  |     |     |  case tid_CLOSE:  | 
        |     |     +-------------------+ 
        |     |     +-----------------+ 
   634  |     |     |  case tid_OPEN: | 
        |     |     +-----------------+ 
        |     |     +---------------------+ 
   635  |     |     |  case tid_ENDFILE:  | 
        |     |     +---------------------+ 
        |     |     +-------------------+ 
   636  |     |     |  case tid_FORMAT: | 
        |     |     +-------------------+ 
   637  |     |     +--- // „Åô„Åπ„ÅÉí„ÄÅËÉFÉÖ„ÅÉ\È£õ„Å∞„Åô„ÄÇ
   638  |     |     |    // ÂÖÅEÂáÉRÂäõ„ÇíÂêÉH„ÇÄÈÉÉBÂàÜ„ÅØ„ÄÅ„Çπ„ÇÉb„ÉÉF„Éó„Éà„ÅÉ@Â§âÊèõ‰∏çÂèØ„ÅÉB„Åô„Çã„ÄÇ  
        |     |     |  +--------+ 
   639  |     |     +--+ break; | 
        |     |     |  +--------+ 
   640  |     |     +--- // „Åù„ÅÆ‰ªñ
        |     |     +-----------------------+ 
   641  |     |     |  case tid_ASSOCIATED: | 
        |     |     +-----------------------+ 
        |     |     +---------------------+ 
   642  |     |     |  case tid_CONTINUE: | 
        |     |     +---------------------+ 
        |     |     +-------------------+ 
   643  |     |     |  case tid_CYCLE:  | 
        |     |     +-------------------+ 
        |     |     +-----------------+ 
   644  |     |     |  case tid_DATA: | 
        |     |     +-----------------+ 
        |     |     +-----------------+ 
   645  |     |     |  case tid_EXIT: | 
        |     |     +-----------------+ 
   646  |     |     +--- // „Åô„Åπ„ÅÉí„ÄÅËÉFÉÖ„ÅÉ\È£õ„Å∞„Åô„ÄÇ
   647  |     |     |    // ÂÖÅEÂáÉRÂäõ„ÇíÂêÉH„ÇÄÈÉÉBÂàÜ„ÅØ„ÄÅ„Çπ„ÇÉb„ÉÉF„Éó„Éà„ÅÉ@Â§âÊèõ‰∏çÂèØ„ÅÉB„Åô„Çã„ÄÇ  
        |     |     |  +--------+ 
   648  |     |     +--+ break; | 
        |     |     |  +--------+ 
        |     |   +-+---+ 
   649  |     |   |  }  | 
        |     |   +-----+ 
        |   +-+---+ 
   650  |   |  }  | 
        |   +-----+ 
   651  +--- /*----------------------------------------------------------------------------*/
   652  |    //                                                                                               
   653  |    //  1.ÊóÅEÊúÉÉË™ûÂêç                                                                             
   654  |    //                                                                                               
   655  |    //  2.„Éë„É©„ÉÅB„ÇÉ\Ë™ÉÉÊòé                                                                      
   656  |    //    TokenList   „Éà„Éº„ÇÉb„ÉÉE„ÉÉF„ÇÉP„Éà                                                      
   657  |    //    sPos    ÈñãÂÉ@ã‰ÉXçÁÉXÉá                                                                   
   658  |    //    ValDataList Â§âÊï∞„ÉÉF„ÇÉP„Éà                                                              
   659  |    //                                                                                               
   660  |    //  3.Ê¶ÇËÉíÅ                                                                                    
   661  |    //    ÊßãÊñáËßÅvÊûê„ÇíÔºëÊñá„Åî„Å®„ÅÉHË°å„ÅÜ                                                     
   662  |    //    ‰∏ÉT„ÅÉFÁõÉáÁöÑ„ÅØ„ÄÅÂÅAâÊï∞„ÅÉH„ÅÅA„ÅÑ„Å¶„ÅÉáÂèÇÁÖßÈñÅu‰øÇ„ÇíÂêÉH„ÇÅ„ÅüÊÉÖÂ†ÉAÂèéÈõÜ„ÄÇ   
   663  |    //    sPos„Åã„Çâ„ÅÉá„Éà„Éº„ÇÉb„ÉÉE„ÇíÂá¶ÁêÜ„Åó„ÄÅ‰ÉXÉ\ÁîÉB„Åó„Åü„Éà„Éº„ÇÉb„ÉÉEÊïÅ[„ÇíËÉ\î„Åô„ÄÇ  
   664  |    //                                                                                               
   665  |    //  4.Ê©üËÉΩË™ÉÉÊòé                                                                              
   666  |    //                                                                                               
   667  |    //  5.ÊàÉT„ÇäÂÄÅA                                                                                
   668  |    //    ‰ΩÉ\ÁîÉB„Åó„Åü„Éà„Éº„ÇÉb„ÉÉEÊïÅ[                                                           
   669  |    //                                                                                               
   670  |    //  6.ÂÇôËÄÉ                                                                                     
   671  |    //                                                                                               
   672  |    /*----------------------------------------------------------------------------*/                 
        |  +------------------------------------------------------------+ 
   673  +--+ int Pass2_C(TList *TokenList,int sPos,TList *ValDataList)  | 
   674  |  | {                                                          | 
        |  +--+---------------------------------------------------------+ 
   675  |     +--- TToken *Token;
   676  |     +--- TToken *Token1;
   677  |     +--- TToken *Token2;
   678  |     +--- int TokId,TokId2;
   679  |     +--- string TokStr;
   680  |     +--- int ValIdx;
   681  |     +--- TValData *ValData;
   682  |     +--- int Nest;
   683  |     +--- int i,j,ePos,StartPos;
   684  |     |    
   685  |     +--- StartPos = sPos;
   686  |     +--- //
   687  |     |    // ÂÖàÈ†ÉÖ„ÅÉáÊîÉPË°å„ÇÑÂåÉRÂàá„Çä„ÇíSkip„Åô„Çã„ÄÇ   
   688  |     |    //                                                   
        |     |  +--------------------------------------------+ 
   689  |     +--+ for( ; sPos &lt; TokenList-&gt;Count ; sPos++){  | 
        |     |  +--+-----------------------------------------+ 
   690  |     |     +--- Token = (TToken *)TokenList-&gt;Items[sPos];
   691  |     |     +--- TokId = Token-&gt;TokId;
        |     |     |  +------------------------------+ 
   692  |     |     +--+ if(TokId == tid_Semikoron){  | 
        |     |     |  +--+---------------------------+ 
        |     |     |     |  +------------+ 
   693  |     |     |     +--+ continue;  | 
        |     |     |     |  +------------+ 
        |     |     |   +-+---+ 
   694  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +--------------------------+ 
   695  |     |     +--+ if(TokId == tid_Koron){  | 
        |     |     |  +--+-----------------------+ 
        |     |     |     |  +------------+ 
   696  |     |     |     +--+ continue;  | 
        |     |     |     |  +------------+ 
        |     |     |   +-+---+ 
   697  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +----------------------------+ 
   698  |     |     +--+ if(TokId == tid_DaiKakko){ | 
        |     |     |  +--+-------------------------+ 
        |     |     |     |  +------------+ 
   699  |     |     |     +--+ continue;  | 
        |     |     |     |  +------------+ 
        |     |     |   +-+---+ 
   700  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +----------------------------+ 
   701  |     |     +--+ if(TokId == tid_DaiKokka){ | 
        |     |     |  +--+-------------------------+ 
        |     |     |     |  +------------+ 
   702  |     |     |     +--+ continue;  | 
        |     |     |     |  +------------+ 
        |     |     |   +-+---+ 
   703  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +----------------------------+ 
   704  |     |     +--+ if(TokId == tid_LineEnd){  | 
        |     |     |  +--+-------------------------+ 
        |     |     |     |  +------------+ 
   705  |     |     |     +--+ continue;  | 
        |     |     |     |  +------------+ 
        |     |     |   +-+---+ 
   706  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +--------+ 
   707  |     |     +--+ break; | 
        |     |     |  +--------+ 
        |     |   +-+---+ 
   708  |     |   |  }  | 
        |     |   +-----+ 
   709  |     |    
   710  |     +--- //
   711  |     |    // ÂêÑÊñá„ÅÉH„ÅÅA„ÅÑ„Å¶„ÄÅËÉBàÁÉáó‰ÉNä„Åß„ÅÉáÂàÜÂâ≤ÁØÑÂõ≤„ÅÉ@„ÅÉáÂàÜÂâ≤„ÇíËÅBå„ÅÜ„ÄÇ   
   712  |     |    //  ;: „Åã {}„ÅÉZ„ÅÉ@„ÇíÁÉbÑÂõ≤„ÅÉB„Åô„Çã„ÄÇ                                           
   713  |     |    // if(a==0){ c = 3 ; d = 4: } „ÅÉáÂ†ÉGÂêà„ÅØ„ÄÅ                                        
   714  |     |    // if(a==0) „ÅÉB c = 4 „ÅÉB d = 4 „ÅÉáÂàÜÂâ≤„ÅÉB„ÅÉF„Çã„ÄÇ                             
   715  |     |    //                                                                                     
        |     |  +--------------------------------------------------------+ 
   716  |     +--+ for(ePos = sPos+1 ; ePos &lt; TokenList-&gt;Count ; ePos++){ | 
        |     |  +--+-----------------------------------------------------+ 
   717  |     |     +--- Token = (TToken *)TokenList-&gt;Items[ePos];
   718  |     |     +--- TokId = Token-&gt;TokId;
        |     |     |  +------------------------------+ 
   719  |     |     +--+ if(TokId == tid_Semikoron){  | 
        |     |     |  +--+---------------------------+ 
        |     |     |     |  +--------+ 
   720  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |   +-+---+ 
   721  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +--------------------------+ 
   722  |     |     +--+ if(TokId == tid_Koron){  | 
        |     |     |  +--+-----------------------+ 
        |     |     |     |  +--------+ 
   723  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |   +-+---+ 
   724  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +----------------------------+ 
   725  |     |     +--+ if(TokId == tid_DaiKakko){ | 
        |     |     |  +--+-------------------------+ 
        |     |     |     |  +--------+ 
   726  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |   +-+---+ 
   727  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +----------------------------+ 
   728  |     |     +--+ if(TokId == tid_DaiKokka){ | 
        |     |     |  +--+-------------------------+ 
        |     |     |     |  +--------+ 
   729  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |   +-+---+ 
   730  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +------------------------------------------------------------------------+ 
   731  |     |     +--+ if((Token-&gt;TokId &gt;= tid_SharpStart)&amp;&amp;(Token-&gt;TokId &lt;= tid_SharpEnd)){  | 
        |     |     |  +--+---------------------------------------------------------------------+ 
        |     |     |     |  +--------+ 
   732  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |   +-+---+ 
   733  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |   +-+---+ 
   734  |     |   |  }  | 
        |     |   +-----+ 
   735  |     +--- //
   736  |     |    //  Êñá„ÅÆÂÖàÈ†ÉÖ„ÅÉá„Éà„Éº„ÇÉb„ÉÉE„Çí„Åß„ÅÉáÂáÉíÁêÜ„ÇíË°å„ÅÜ„ÄÇ                               
   737  |     |    //  int ,double Á≠â„ÅÆÂÆöÁÉZÉD„ÅåÂÖàÈ†ÉÖ„ÅÉáÂ†ÉGÂêà„ÅØ„ÄÅÂÉáöÁÉZÉD„ÅÉB„Åó„Å¶ÂáÉíÁêÜ„Åô„Çã„ÄÇ   
   738  |     |    //  (int)„ÅÉbÂÖàÈ†ÉÖ„ÅÉ@„ÅÉF„ÅÑ„ÅÆ„ÅÉ@ÂØÉZË±ÅBÂ§ñ„ÄÇ                                           
   739  |     |    //                                                                                             
   740  |     +--- Token = (TToken *)TokenList-&gt;Items[sPos];
   741  |     +--- TokId = Token-&gt;TokId;
   742  |     +--- TokStr = Token-&gt;Str;
   743  |     |    
   744  |     +--- //
   745  |     |    // ÂÖàÈ†ÉÖ„Åå#„ÅÉá„Éû„ÇØ„ÉÉÖ„ÅÉáÂáÉíÁêÜ  
   746  |     |    //                                       
        |     |  +------------------------------------------------------------------------+ 
   747  |     +--+ if((Token-&gt;TokId &gt;= tid_SharpStart)&amp;&amp;(Token-&gt;TokId &lt;= tid_SharpEnd)){  | 
        |     |  +--+---------------------------------------------------------------------+ 
   748  |     |     +--- //
   749  |     |     |    //  #define N 500 „ÅÉáÂØÉZÂøú„ÄÇ   
   750  |     |     |    //                                 
        |     |     |  +--------------------------------------+ 
   751  |     |     +--+ if(Token-&gt;TokId == tid_SharpDefine){ | 
        |     |     |  +--+-----------------------------------+ 
        |     |     |     |  +--------------------------------+ 
   752  |     |     |     +--+ if(sPos+2 &lt; TokenList-&gt;Count){ | 
        |     |     |     |  +--+-----------------------------+ 
   753  |     |     |     |     +--- Token1 = (TToken *)TokenList-&gt;Items[sPos+1];
   754  |     |     |     |     +--- Token2 = (TToken *)TokenList-&gt;Items[sPos+2];
        |     |     |     |     |  +------------------------------------------------------------------+ 
   755  |     |     |     |     +--+ if((Token1-&gt;TokId == tid_Val)&amp;&amp;(Token2-&gt;TokId == tid_ConstNum)){ | 
        |     |     |     |     |  +--+---------------------------------------------------------------+ 
   755  |     |     |     |     |     +--- ;
   756  |     |     |     |     |     +--- TokStr = Token1-&gt;Str;
   757  |     |     |     |     |     +--- ValIdx = GetValIdx(ValDataList,TokStr,Token-&gt;ModuleIdx);
        |     |     |     |     |     |  +--------------------+ 
   758  |     |     |     |     |     +--+ if(ValIdx == -1){  | 
        |     |     |     |     |     |  +--+-----------------+ 
   759  |     |     |     |     |     |     +--- ValData = new TValData(TokStr);
   760  |     |     |     |     |     |     +--- ValIdx = ValDataList-&gt;Add((void *)ValData);
        |     |     |     |     |     |   +-+---+ 
   761  |     |     |     |     |     |   |  }  | 
        |     |     |     |     |     |   +-+---+ 
        |     |     |     |     |     |   +-+-------+ 
   761  |     |     |     |     |     |   |  else{  | 
        |     |     |     |     |     |   +-+-------+ 
   762  |     |     |     |     |     |     +--- ValData = (TValData *)ValDataList-&gt;Items[ValIdx];
        |     |     |     |     |     |   +-+---+ 
   763  |     |     |     |     |     |   |  }  | 
        |     |     |     |     |     |   +-----+ 
   764  |     |     |     |     |     +--- ValData-&gt;ModuleIdx = Token-&gt;ModuleIdx;
   765  |     |     |     |     |     +--- ValData-&gt;BrNestLevel = Token-&gt;BrNestLevel;
   766  |     |     |     |     |     +--- ValData-&gt;DataType = dt_Int;
   767  |     |     |     |     |     +--- Token-&gt;ValData = ValData;
   768  |     |     |     |     |     +--- ValData-&gt;ParamValF = true; // PARAMETERÁõÉNÂΩì
   769  |     |     |     |     |     +--- ValData-&gt;dData = atof(Token2-&gt;Str.c_str());
        |     |     |     |     |   +-+---+ 
   770  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |   +-+---+ 
   771  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |   +-+---+ 
   772  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +--------------------------------------------------------+ 
   773  |     |     +--+ for(ePos = sPos+1 ; ePos &lt; TokenList-&gt;Count ; ePos++){ | 
        |     |     |  +--+-----------------------------------------------------+ 
   774  |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[ePos];
   775  |     |     |     +--- TokId = Token-&gt;TokId;
        |     |     |     |  +----------------------------+ 
   776  |     |     |     +--+ if(TokId == tid_LineEnd){  | 
        |     |     |     |  +--+-------------------------+ 
        |     |     |     |     |  +--------+ 
   777  |     |     |     |     +--+ break; | 
        |     |     |     |     |  +--------+ 
        |     |     |     |   +-+---+ 
   778  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |   +-+---+ 
   779  |     |     |   |  }  | 
        |     |     |   +-----+ 
   780  |     |     +--- //      return ePos - sPos;
        |     |     |  +--------------------------+ 
   781  |     |     +--+ return ePos - StartPos;  | 
        |     |     |  +--------------------------+ 
        |     |   +-+---+ 
   782  |     |   |  }  | 
        |     |   +-----+ 
   783  |     +--- //
   784  |     |    //  ÈñÅuÊïÅ[„ÅÉBÂ§âÊï∞ÂÆöÁÉZÉD„ÇíËÉ\ÉXÂä†„Åô„Çã„ÄÇ   
   785  |     |    //                                                   
   786  |     +--- AddDataDef_C(TokenList,sPos,ePos,ValDataList);
   787  |     +--- #if 0
   788  |     +--- //
   789  |     |    //  NestLevel = 0 „ÅÉ@„ÅÉáÂ§âÊï∞ÂÆöÁÉZÉDÔºà„Ç∞„ÉÉÖ„ÉÉV„Éê„É´Ôºâ„Å´ÂØÉZÂøú 2011/07/27 
   790  |     |    //                                                                                   
        |     |  +----------------------------------------------------+ 
   791  |     +--+ if((Token-&gt;NestLevel == 0)&amp;&amp;(TokId == tid_Func)){  | 
        |     |  +--+-------------------------------------------------+ 
   792  |     |     +--- //
   793  |     |     |    // ÂÖàÈ†ÉÖ„ÅåÈñ¢ÊïÅ[„ÅãÂÅAâÊï∞„ÅÉáÂ†ÉGÂêà„Åß„ÄÅNest=0„ÅÉF„Çâ„Å∞„ÄÅint ÂÆöÁÉZÉD„ÅÉB„ÅÉF„Çã„ÄÇ   
   794  |     |     |    //                                                                                             
   795  |     |     +--- AddSubFuncDef_C(TokenList,sPos,ePos,ValDataList);
        |     |   +-+---+ 
   796  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+---------------------------+ 
   796  |     |   |  else if(TokId == tid_Val){ | 
        |     |   +-+---------------------------+ 
   797  |     |     +--- AddDataDef_C(TokenList,sPos,ePos,ValDataList);
        |     |   +-+---+ 
   798  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+---------------------------------------------------------------------------+ 
   798  |     |   |  else if((TokId == tid_int)||(TokId == tid_double)||(TokId == tid_char)||   | 
   799  |     |   |     (TokId == tid_float)||(TokId == tid_void)||                             | 
   800  |     |   |     (TokId == tid_signed)||(TokId == tid_unsigned)||(TokId == tid_static)){ | 
        |     |   +-+---------------------------------------------------------------------------+ 
   801  |     |     +--- //
   802  |     |     |    //  ÈñÅuÊïÅ[„ÅãÈÖçÂàóÂÉáöÁÉZÉD„ÄÇNest„ÅÉbÁÑÅBÈñÅu‰øÇ„ÄÇ  
   803  |     |     |    //                                                       
        |     |     |  +----------------------------------+ 
   804  |     |     +--+ for(i = sPos ; i &lt; ePos ; i++){  | 
        |     |     |  +--+-------------------------------+ 
   805  |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[i];
   806  |     |     |     +--- TokId = Token-&gt;TokId;
   807  |     |     |     +--- TokStr = Token-&gt;Str;
        |     |     |     |  +------------------------+ 
   808  |     |     |     +--+ if(TokId == tid_Val){  | 
        |     |     |     |  +--+---------------------+ 
   809  |     |     |     |     +--- AddDataDef_C(TokenList,sPos,ePos,ValDataList);
        |     |     |     |     |  +--------+ 
   810  |     |     |     |     +--+ break; | 
        |     |     |     |     |  +--------+ 
        |     |     |     |   +-+---+ 
   811  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |     |  +------------------------+ 
   812  |     |     |     +--+ if(TokId == tid_Func){ | 
        |     |     |     |  +--+---------------------+ 
   813  |     |     |     |     +--- AddSubFuncDataDef_C(TokenList,sPos,ePos,ValDataList);
        |     |     |     |     |  +--------+ 
   814  |     |     |     |     +--+ break; | 
        |     |     |     |     |  +--------+ 
        |     |     |     |   +-+---+ 
   815  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |   +-+---+ 
   816  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |   +-+---+ 
   817  |     |   |  }  | 
        |     |   +-----+ 
   818  |     +--- //
   819  |     |    //  Â§âÊï∞„ÇíÂÅAâÊï∞„ÉÉF„ÇÉP„Éà„Å´ËøÉXÂä†„Åô„Çã„ÄÇ                             
   820  |     |    //  ÈÖçÂàó„ÅÉáÂ†ÉGÂêà„ÅØ„ÄÅÈÖçÂàó„ÅÆÊ¨ÅBÂÖÉ„ÇÇË™É\„ÅÉP„ÅÉí„ÇÉT„ÉÉ„Éà„Åô„Çã„ÄÇ  
   821  |     |    //                                                                             
        |     |  +----------------------------------+ 
   822  |     +--+ for(i = sPos ; i &lt; ePos ; i++){  | 
        |     |  +--+-------------------------------+ 
   823  |     |     +--- Token = (TToken *)TokenList-&gt;Items[i];
        |     |     |  +--------------------------------------------------------------------------------------------------+ 
   824  |     |     +--+ if(Token-&gt;TokId == tid_Val){    // Â§âÊï∞ÂáÉRÁèÉZÊôÇ„ÅØ„ÄÅÂÅAâÊï∞„ÉÉF„ÇÉP„Éà„Å´ËøÉXÂä†„Åô„Çã„ÄÇ  | 
        |     |     |  +--+-----------------------------------------------------------------------------------------------+ 
   825  |     |     |     +--- //
   826  |     |     |     |    // ÂêçÂâç„ÅÉáÊ¨ÅB„Åå[„ÅÉF„ÇâÈÖçÂàó„ÄÇÂêçÂâç„ÅÆÂâç„Åå * „ÅÉáÂ†ÉGÂêà„ÇÇÈÖçÂàó„ÄÇ   
   827  |     |     |     |    //                                                                               
   828  |     |     |     +--- TokStr = Token-&gt;Str;
   829  |     |     |     +--- //
   830  |     |     |     |    // Â§âÊï∞„ÇíÂêçÂâç„Å®„ÉÅu„ÇÉN„ÉÅE„ÉÉV„ÉÉHIdx„ÅÉ@Ê§úÁÉGÅu„ÄÇ                                                
   831  |     |     |     |    // ÊúÄÂàù„ÅÆÂáÉRÁèÉZÊôÇ„ÄÅÂÅAâÊï∞„ÅÉáÂæå„ÅÆ [] „ÇíÊï∞„Åà„Å¶„ÄÅÈÖçÂàó„ÅÆÊ¨ÅBÂÖÉ„ÇíÊ±Ç„ÇÅ„Çã„ÄÇ              
   832  |     |     |     |    // ÈÄöÂÉNÉN„ÅÉb„ÄÅÂÉáöÁÉZÉD„ÅÉ@„ÅÉáÂëÉVÂáÉR„ÅåÂÖà„ÅÉF„ÅÉá„ÅÉ@„ÄÅ„Åô„ÅÉ@„ÅÉHÂûãÁÉÖâ„ÅØË®ÉÖÂÆöÊÉNà„Åø„ÄÇ„ÄÇ  
   833  |     |     |     |    //                                                                                                         
   834  |     |     |     +--- ValIdx = GetValIdx(ValDataList,TokStr,Token-&gt;ModuleIdx);
        |     |     |     |  +--------------------------------------------------------------------------------------------+ 
   835  |     |     |     +--+ if(ValIdx == -1){   // C„ÅÉáÂ†ÉGÂêà„ÅØ„ÄÅÊúÄÂàù„ÅÆÂáÉRÁèÉZ„ÅÉbÂÆöÁÉZÉD„ÅÉ@„ÅÇ„Çã„Åì„Å®„ÄÇ  | 
        |     |     |     |  +--+-----------------------------------------------------------------------------------------+ 
   836  |     |     |     |     +--- ValData = new TValData(TokStr);
   837  |     |     |     |     +--- ValDataList-&gt;Add((void *)ValData);
   838  |     |     |     |     +--- ValData-&gt;ModuleIdx = Token-&gt;ModuleIdx;
   839  |     |     |     |     +--- ValData-&gt;BrNestLevel = Token-&gt;BrNestLevel;
   840  |     |     |     |     +--- ValData-&gt;SetCount = 0;
   841  |     |     |     |     +--- Token-&gt;ValData = ValData;
   842  |     |     |     |     +--- Nest = 0;
   843  |     |     |     |     +--- ArrayLevel = 0;
        |     |     |     |     |  +--------------------------------+ 
   844  |     |     |     |     +--+ for(j = i+1 ; j &lt; ePos ; j++){ | 
        |     |     |     |     |  +--+-----------------------------+ 
   845  |     |     |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[j];
   846  |     |     |     |     |     +--- TokId = Token-&gt;TokId;
        |     |     |     |     |     |  +----------------------------------+ 
   847  |     |     |     |     |     +--+ if(TokId == tid_KagiKakko){ // [ | 
        |     |     |     |     |     |  +--+-------------------------------+ 
   848  |     |     |     |     |     |     +--- Nest++;
   849  |     |     |     |     |     |     +--- ArrayLevel++;
        |     |     |     |     |     |   +-+---+ 
   850  |     |     |     |     |     |   |  }  | 
        |     |     |     |     |     |   +-+---+ 
        |     |     |     |     |     |   +-+---------------------------------------+ 
   850  |     |     |     |     |     |   |  else if(TokId == tid_KagiKokka){ // ]  | 
        |     |     |     |     |     |   +-+---------------------------------------+ 
   851  |     |     |     |     |     |     +--- Nest--;
        |     |     |     |     |     |   +-+---+ 
   852  |     |     |     |     |     |   |  }  | 
        |     |     |     |     |     |   +-+---+ 
        |     |     |     |     |     |   +-+---------------------+ 
   852  |     |     |     |     |     |   |  else if(Nest == 0){  | 
        |     |     |     |     |     |   +-+---------------------+ 
        |     |     |     |     |     |     |  +--------+ 
   853  |     |     |     |     |     |     +--+ break; | 
        |     |     |     |     |     |     |  +--------+ 
        |     |     |     |     |     |   +-+---+ 
   854  |     |     |     |     |     |   |  }  | 
        |     |     |     |     |     |   +-----+ 
        |     |     |     |     |   +-+---+ 
   855  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |     |  +------------------------------+ 
   856  |     |     |     |     +--+ for(j = i-1 ; j &gt; 0 ; j--){  | 
        |     |     |     |     |  +--+---------------------------+ 
   857  |     |     |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[j];
        |     |     |     |     |     |  +------------------------------+ 
   858  |     |     |     |     |     +--+ if(Token-&gt;Str == &quot;*&quot;){  // * | 
        |     |     |     |     |     |  +--+---------------------------+ 
   859  |     |     |     |     |     |     +--- ArrayLevel++;
        |     |     |     |     |     |   +-+---+ 
   860  |     |     |     |     |     |   |  }  | 
        |     |     |     |     |     |   +-+---+ 
        |     |     |     |     |     |   +-+---------------------+ 
   860  |     |     |     |     |     |   |  else if(Nest == 0){  | 
        |     |     |     |     |     |   +-+---------------------+ 
        |     |     |     |     |     |     |  +--------+ 
   861  |     |     |     |     |     |     +--+ break; | 
        |     |     |     |     |     |     |  +--------+ 
        |     |     |     |     |     |   +-+---+ 
   862  |     |     |     |     |     |   |  }  | 
        |     |     |     |     |     |   +-----+ 
        |     |     |     |     |   +-+---+ 
   863  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
   864  |     |     |     |     +--- ValData-&gt;ArrayLevel = ArrayLevel; // ÈÖçÂàóÊ¨ÅBÂÖÉÊï∞
        |     |     |     |   +-+---+ 
   865  |     |     |     |   |  }  | 
        |     |     |     |   +-+---+ 
        |     |     |     |   +-+-------+ 
   865  |     |     |     |   |  else{  | 
        |     |     |     |   +-+-------+ 
   866  |     |     |     |     +--- ValData = (TValData *)ValDataList-&gt;Items[ValIdx];
   867  |     |     |     |     +--- Token-&gt;ValData = ValData;
        |     |     |     |   +-+---+ 
   868  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
   869  |     |     |     +--- ValData-&gt;RefCount++;
        |     |     |   +-+---+ 
   870  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |   +-+---+ 
   871  |     |   |  }  | 
        |     |   +-----+ 
   872  |     +--- #endif
   873  |     +--- //
   874  |     |    //  Ôºù„ÄÅÔÉVãÔÉVùÁÉÖâ„ÇíÊ§úÁÉGÅu„Åó„Å¶„ÄÅ„Åù„ÅÉáÂèÉEÂÅÉG„ÅÉáÂ§âÊï∞„ÅÉHÂèÇÁÖß„Çí„Çª„ÉÉ„Éà„Åô„Çã„ÄÇ   
   875  |     |    //      Add 2010/08/20                                                                               
   876  |     |    //  = „ÅÉF„Åó„Åß„ÄÅ( „ÅåÂá∫ÁèÉZ„Åó„ÅüÂ†ÉGÂêà„ÇÇÂèÇÁÖß„ÅÉB„Åô„Çã„ÄÇ                                   
   877  |     |    //                                                                                                   
        |     |  +----------------------------------+ 
   878  |     +--+ for(i = sPos ; i &lt; ePos ; i++){  | 
        |     |  +--+-------------------------------+ 
   879  |     |     +--- Token = (TToken *)TokenList-&gt;Items[i];
   880  |     |     +--- TokId = Token-&gt;TokId;
        |     |     |  +----------------------------------------------+ 
   881  |     |     +--+ if((TokId == tid_Set)||(TokId == tid_Set2)){ | 
        |     |     |  +--+-------------------------------------------+ 
   882  |     |     |     +--- // = „ÇÑ += „ÅÉF„ÅÉD„ÅÉáÂáÉRÁèÉZ‰ΩçÁÉXÉá„Åã„ÇâÂèÉEÂÅÉG„ÅÉáÂ§âÊï∞„ÅÉHÂÄÅA„ÅÉáÂèÇÁÖßÂ±ûÊÄÉ@„Çí„Çª„ÉÉ„Éà„Åô„Çã„ÄÇ
   883  |     |     |     +--- Nest = 0;
        |     |     |     |  +--------------------------------+ 
   884  |     |     |     +--+ for(j = i+1; j &lt; ePos ; j++){  | 
        |     |     |     |  +--+-----------------------------+ 
   885  |     |     |     |     +--- Token2 = (TToken *)TokenList-&gt;Items[j];
   886  |     |     |     |     +--- TokId2 = Token2-&gt;TokId;
   887  |     |     |     |     |    
        |     |     |     |     |  +------------------------+ 
   888  |     |     |     |     +--+ if(TokId2 == tid_Val){ | 
        |     |     |     |     |  +--+---------------------+ 
   889  |     |     |     |     |     +--- //                  MainF-&gt;print(&quot;Ref[&quot;+Token2-&gt;Str+&quot;]&quot;);
   890  |     |     |     |     |     +--- Token2-&gt;RefType = vrf_ref;
   891  |     |     |     |     |     +--- ValData = (TValData *)Token2-&gt;ValData;
   892  |     |     |     |     |     +--- ValData-&gt;RefCount++;
        |     |     |     |     |   +-+---+ 
   893  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |   +-+---+ 
   894  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |     |  +--------+ 
   895  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |   +-+---+ 
   896  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |   +-+---+ 
   897  |     |   |  }  | 
        |     |   +-----+ 
        |     |  +----------------------------------------------------------------------------------------------------------+ 
   898  |     +--+ if(i == ePos){  // = , += Á≠â„Åå„ÅÉF„ÅÑÂ†ÉGÂêà„ÅØ„ÄÅÂÅAâÊï∞„ÅÉb„Åô„Åπ„ÅÉíÂèÇÁÖß„ÅÉ@‰ΩÉ\ÁîÉB„Åï„Çå„Çã„ÄÇ  | 
        |     |  +--+-------------------------------------------------------------------------------------------------------+ 
        |     |     |  +--------------------------------+ 
   899  |     |     +--+ for(j = sPos; j &lt; ePos ; j++){ | 
        |     |     |  +--+-----------------------------+ 
   900  |     |     |     +--- Token2 = (TToken *)TokenList-&gt;Items[j];
   901  |     |     |     +--- TokId2 = Token2-&gt;TokId;
   902  |     |     |     |    
        |     |     |     |  +------------------------+ 
   903  |     |     |     +--+ if(TokId2 == tid_Val){ | 
        |     |     |     |  +--+---------------------+ 
   904  |     |     |     |     +--- //          MainF-&gt;print(&quot;Ref[&quot;+Token2-&gt;Str+&quot;]&quot;);
   905  |     |     |     |     +--- Token2-&gt;RefType = vrf_ref;
   906  |     |     |     |     +--- ValData = (TValData *)Token2-&gt;ValData;
        |     |     |     |     |  +----------------------+ 
   907  |     |     |     |     +--+ if(ValData != NULL){ | 
        |     |     |     |     |  +--+-------------------+ 
   908  |     |     |     |     |     +--- ValData-&gt;RefCount++;
        |     |     |     |     |   +-+---+ 
   909  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |   +-+---+ 
   910  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |   +-+---+ 
   911  |     |     |   |  }  | 
        |     |     |   +-----+ 
   912  |     |     |    
        |     |   +-+---+ 
   913  |     |   |  }  | 
        |     |   +-----+ 
   914  |     +--- //
   915  |     |    //  Ôºù„ÄÅÔÉVãÔÉVùÁÉÖâ„ÇíÊ§úÁÉGÅu„Åó„Å¶„ÄÅÂÅAâÊï∞„ÅÉB„Éà„Éº„ÇÉb„ÉÉE„ÅÉHË®ÉÖÂÆö„ÅÇ„Çä„Åã„ÅÉD„ÅÜ„Åã„ÇíËÉ\ÉXÂä†„Åô„Çã„ÄÇ  
   916  |     |    //                                                                                                                     
        |     |  +------------------------------------+ 
   917  |     +--+ for(i = ePos-1 ; i &gt;= sPos ; i--){ | 
        |     |  +--+---------------------------------+ 
   918  |     |     +--- Token = (TToken *)TokenList-&gt;Items[i];
   919  |     |     +--- TokId = Token-&gt;TokId;
        |     |     |  +----------------------------------------------+ 
   920  |     |     +--+ if((TokId == tid_Set)||(TokId == tid_Set2)){ | 
        |     |     |  +--+-------------------------------------------+ 
   921  |     |     |     +--- // = „ÇÑ += „ÅÉF„ÅÉD„ÅÉáÂáÉRÁèÉZ‰ΩçÁÉXÉá„Åã„ÇâÂ∑ÉíÂÅÉG„ÅÉáÂ§âÊï∞„ÅÉHÂÄÅA„ÅÉáË®ÉÖÂÆö„ÅÆÂ±ûÊÄÉ@„Çí„Çª„ÉÉ„Éà„Åô„Çã„ÄÇ
   922  |     |     |     |    // „Å†„Å†„Åó„ÄÅ[][]ÂÜÖ„ÅÆÊ∑ÉT„ÅàÂÉÖó„ÅÆÂ§âÊï∞„ÅÉbÂØÉZË±ÅBÂ§ñ„Å®„Åô„Çã„ÄÇ                                           
   923  |     |     |     +--- Nest = 0;
        |     |     |     |  +------------------------------+ 
   924  |     |     |     +--+ for(j = sPos ; j &lt; i ; j++){ | 
        |     |     |     |  +--+---------------------------+ 
   925  |     |     |     |     +--- Token2 = (TToken *)TokenList-&gt;Items[j];
   926  |     |     |     |     +--- TokId2 = Token2-&gt;TokId;
        |     |     |     |     |  +--------------------------------------+ 
   927  |     |     |     |     +--+ if(TokId2 == tid_KagiKakko){    // [ | 
        |     |     |     |     |  +--+-----------------------------------+ 
   928  |     |     |     |     |     +--- Nest++;
        |     |     |     |     |   +-+---+ 
   929  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-+---+ 
        |     |     |     |     |   +-+---------------------------------------+ 
   929  |     |     |     |     |   |  else if(TokId2 == tid_KagiKokka){ // ] | 
        |     |     |     |     |   +-+---------------------------------------+ 
   930  |     |     |     |     |     +--- Nest--;
        |     |     |     |     |   +-+---+ 
   931  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |     |  +----------------------------------------+ 
   932  |     |     |     |     +--+ if((TokId2 == tid_Val)&amp;&amp;(Nest == 0)){  | 
        |     |     |     |     |  +--+-------------------------------------+ 
   933  |     |     |     |     |     +--- //                  MainF-&gt;print(&quot;Set[&quot;+Token2-&gt;Str+&quot;]&quot;);
   934  |     |     |     |     |     +--- Token2-&gt;RefType = vrf_set;
   935  |     |     |     |     |     +--- ValData = (TValData *)Token2-&gt;ValData;
   936  |     |     |     |     |     +--- ValData-&gt;SetCount++;
   937  |     |     |     |     |     +--- //                  if(TokId == tid_Set){
   938  |     |     |     |     |     |    //                      ValData-&gt;RefCount--; 
   939  |     |     |     |     |     |    //                  }                        
        |     |     |     |     |   +-+---+ 
   940  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |   +-+---+ 
   941  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |     |  +--------+ 
   942  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |   +-+---+ 
   943  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |   +-+---+ 
   944  |     |   |  }  | 
        |     |   +-----+ 
   945  |     +--- //  return ePos-sPos;
        |     |  +------------------------+ 
   946  |     +--+ return ePos-StartPos;  | 
        |     |  +------------------------+ 
        |   +-+---+ 
   947  |   |  }  | 
        |   +-----+ 
   948  |    
   949  +--- /*----------------------------------------------------------------------------*/
   950  |    //                                                                                                                                     
   951  |    //  1.ÊóÅEÊúÉÉË™ûÂêç                                                                                                                   
   952  |    //                                                                                                                                     
   953  |    //  2.„Éë„É©„ÉÅB„ÇÉ\Ë™ÉÉÊòé                                                                                                            
   954  |    //    TokenList   ÂáÉíÁêÜ„Åô„Çã„Éà„ÉÉV„ÇÉb„ÉÉE„ÉÉF„ÇÉP„Éà                                                                              
   955  |    //    sPos    TokenList‰∏ä„Åß„ÅÉáÈñãÂÉ@ã‰ÉXçÁÉXÉá                                                                                      
   956  |    //    ePos    TokenList‰∏ä„Åß„ÅÉáÁµÇ‰ÉRÜ‰ÉXçÁÉXÉá                                                                                      
   957  |    //    ValDataList Â§âÊï∞„Éá„Éº„ÇÉ\„ÉÉF„ÇÉP„Éà                                                                                          
   958  |    //                                                                                                                                     
   959  |    //  3.Ê¶ÇËÉíÅ                                                                                                                          
   960  |    //    SUBROUTINE , FUNCTION„ÅÉáÊñáÔÉVàËÅBåÔÉVâ„ÅÆÂáÉíÁêÜ„ÇíË°å„ÅÜ„ÄÇ                                                                   
   961  |    //    ÂºïÊï∞„ÅÉáValData„ÇíÁîüÊàê„Åó„ÅÉí„ÄÅ ValData„ÅÉH ArgF=true„Çí„Çª„ÉÉ„Éà„Åô„Çã„ÄÇ                                                  
   962  |    //                                                                                                                                     
   963  |    //  4.Ê©üËÉΩË™ÉÉÊòé                                                                                                                    
   964  |    //    SUBROUTINE , FUNCTION„ÅÉáÊñáÔÉVàËÅBåÔÉVâ„ÅÆÂáÉíÁêÜ„ÇíË°å„ÅÜ„ÄÇ                                                                   
   965  |    //    ÂáÉRÁèÉZ„Åó„ÅüÂ§âÊï∞Âêç„ÇíValDataList„ÅÉHËøÉXÂä†„Åô„Çã„ÄÇ„Åì„ÅÉáÊôÇValData„ÅÉHArgF=true„Çí„Çª„ÉÉ„Éà„Åó                           
   966  |    //    „ÅÉí„ÄÅ„Çµ„Éñ„É´„ÉÉV„ÉÅ„É≥„ÇÑÔÉVÉíÔΩïÔÉXéÔÉXÉÔÉXîÔÉXâÔÉXèÔÉXé„ÅÆÂºïÊï∞„ÅÉB„Åó„Å¶Â§âÊï∞„Åå‰ÉXÉ\„Çè„Çå„ÅÉí„ÅÑ„Çã„Åì„Å®„ÇíËÉBÉÖÂÆö  
   967  |    //    „Åô„Çã„ÄÇ                                                                                                                        
   968  |    //                                                                                                                                     
   969  |    //  5.ÊàÉT„ÇäÂÄÅA                                                                                                                      
   970  |    //    „ÅÉF„Åó                                                                                                                          
   971  |    //                                                                                                                                     
   972  |    //  6.ÂÇôËÄÉ                                                                                                                           
   973  |    //                                                                                                                                     
   974  |    /*----------------------------------------------------------------------------*/                                                       
        |  +------------------------------------------------------------------------------------+ 
   975  +--+ void AddSubFuncDef_Fortran(TList *TokenList,int sPos,int ePos,TList *ValDataList)  | 
   976  |  | {                                                                                  | 
        |  +--+---------------------------------------------------------------------------------+ 
   977  |     +--- int i,j;
   978  |     +--- TToken *Token;
   979  |     +--- int TokId;
   980  |     +--- string TokStr,ValName;
   981  |     |    
   982  |     +--- //  for(i = sPos ; i &lt;= ePos ; i++){
        |     |  +----------------------------------+ 
   983  |     +--+ for(i = sPos ; i &lt; ePos ; i++){  | 
        |     |  +--+-------------------------------+ 
   984  |     |     +--- Token = (TToken *)TokenList-&gt;Items[i];
   985  |     |     +--- TokId = Token-&gt;TokId;
   986  |     |     +--- TokStr = Token-&gt;Str;
   987  |     |     |    
        |     |     |  +------------------------------------------------+ 
   988  |     |     +--+ if(TokId == tid_LineEnd){   // ÔºëËÅBåÁÉIÇ‰ÉRÜ | 
        |     |     |  +--+---------------------------------------------+ 
        |     |     |     |  +--------+ 
   989  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |   +-+---+ 
   990  |     |     |   |  }  | 
        |     |     |   +-----+ 
   991  |     |     +--- //        if(TokId != -1){  // Â§âÊï∞„Éà„Éº„ÇÉb„ÉÉE„ÅÉá„ÅÉ\„ÅåÂÉbÉZË±ÅB
        |     |     |  +----------------------------------------------------------------------+ 
   992  |     |     +--+ if(TokId != tid_Val){   // Â§âÊï∞„Éà„Éº„ÇÉb„ÉÉE„ÅÉá„ÅÉ\„ÅåÂÉbÉZË±ÅB  | 
        |     |     |  +--+-------------------------------------------------------------------+ 
        |     |     |     |  +------------+ 
   993  |     |     |     +--+ continue;  | 
        |     |     |     |  +------------+ 
        |     |     |   +-+---+ 
   994  |     |     |   |  }  | 
        |     |     |   +-----+ 
   995  |     |     +--- //
   996  |     |     |    // „Åô„Åß„ÅÉH„ÄÅÂêå„ÅòMoudelIdx„ÅÉ@„ÄÅÂÉáÅvË®Ä„Åï„Çå„ÅÉí„ÅÑ„ÇãÂêåÂêçÂ§âÊï∞„Åå„ÅÇ„Çã„Åã„ÇíËÉFÉ\„ÅÉP„Çã„ÄÇ               
   997  |     |     |    // „ÅÇ„Çå„ÅÅ[„ÄÅËÉ\ÉXÂä†„Åó„Å™„ÅÑ„ÄÇÔÉVàÂûã„ÅÉá‰∏ÄËáÉG„Åã„Å©„ÅÜ„Åã„ÅÉáÂàÅAÂÆö„ÅØ„ÄÅ„Ç≥„ÉÉE„Éë„Éë„ÇÅA„ÉÉD„ÅÉZ„Åã„ÅõÔºâ  
   998  |     |     |    //                                                                                                                     
   999  |     |     +--- TValData *ValData;
  1000  |     |     +--- bool NewValDataF = true;
  1001  |     |     |    
  1002  |     |     +--- ValName = Trim(TokStr);
        |     |     |  +--------------------------------------------+ 
  1003  |     |     +--+ for(j = 0 ; j &lt; ValDataList-&gt;Count ; j++){ | 
        |     |     |  +--+-----------------------------------------+ 
  1004  |     |     |     +--- ValData = (TValData *)ValDataList-&gt;Items[j];
  1005  |     |     |     +--- //          if((AnsiCompareText(ValData-&gt;Str,ValName) == 0)&amp;&amp;
        |     |     |     |  +------------------------------------------------------+ 
  1006  |     |     |     +--+ if((LowerCase(ValData-&gt;Str) == LowerCase(ValName))&amp;&amp; | 
  1007  |     |     |     |  |     (ValData-&gt;ModuleIdx == Token-&gt;ModuleIdx)){       | 
        |     |     |     |  +--+---------------------------------------------------+ 
  1008  |     |     |     |     +--- NewValDataF = false;
        |     |     |     |     |  +--------+ 
  1009  |     |     |     |     +--+ break; | 
        |     |     |     |     |  +--------+ 
        |     |     |     |   +-+---+ 
  1010  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |   +-+---+ 
  1011  |     |     |   |  }  | 
        |     |     |   +-----+ 
  1012  |     |     +--- //
  1013  |     |     |    // Â§âÊï∞„ÉÉF„ÇÉP„Éà„Å´ËøÉXÂä†„Åô„Çã„ÄÇ  
  1014  |     |     |    //                                       
        |     |     |  +------------------+ 
  1015  |     |     +--+ if(NewValDataF){ | 
        |     |     |  +--+---------------+ 
  1016  |     |     |     +--- ValData = new TValData(ValName);
  1017  |     |     |     +--- ValDataList-&gt;Add((void *)ValData);
  1018  |     |     |     +--- ValData-&gt;ModuleIdx = Token-&gt;ModuleIdx;
  1019  |     |     |     +--- ValData-&gt;DataType = ImplType[(int)ValName[0]]; // ÊöóÈÉTô„ÅÆÂÆÅvË®Ä
  1020  |     |     |     +--- ValData-&gt;DefPos = -1;
  1021  |     |     |     +--- ValData-&gt;ArgF = true;   // ArgF„Çí„Çª„ÉÉ„Éà
        |     |     |   +-+---+ 
  1022  |     |     |   |  }  | 
        |     |     |   +-+---+ 
        |     |     |   +-+-------+ 
  1022  |     |     |   |  else{  | 
        |     |     |   +-+-------+ 
  1023  |     |     |     +--- ValData-&gt;ArgF = true;   // ArgF„Çí„Çª„ÉÉ„Éà
        |     |     |   +-+---+ 
  1024  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |   +-+---+ 
  1025  |     |   |  }  | 
        |     |   +-----+ 
        |   +-+---+ 
  1026  |   |  }  | 
        |   +-----+ 
  1027  +--- /*----------------------------------------------------------------------------*/
  1028  |    //                                                                                                                         
  1029  |    //  1.ÊóÅEÊúÉÉË™ûÂêç                                                                                                       
  1030  |    //                                                                                                                         
  1031  |    //  2.„Éë„É©„ÉÅB„ÇÉ\Ë™ÉÉÊòé                                                                                                
  1032  |    //    TokenList   ÂáÉíÁêÜ„Åô„Çã„Éà„ÉÉV„ÇÉb„ÉÉE„ÉÉF„ÇÉP„Éà                                                                  
  1033  |    //    sPos    TokenList‰∏ä„Åß„ÅÉáÈñãÂÉ@ã‰ÉXçÁÉXÉá                                                                          
  1034  |    //    ePos    TokenList‰∏ä„Åß„ÅÉáÁµÇ‰ÉRÜ‰ÉXçÁÉXÉá                                                                          
  1035  |    //    ValDataList Â§âÊï∞„Éá„Éº„ÇÉ\„ÉÉF„ÇÉP„Éà                                                                              
  1036  |    //                                                                                                                         
  1037  |    //  3.Ê¶ÇËÉíÅ                                                                                                              
  1038  |    //    int„ÇÑdouble„ÅÉF„ÅÉD„ÅÉá„Éá„Éº„ÇÉ\ÂÆÅvË®Ä„ÅÉáÂáÉíÁêÜ„ÇíË°å„Å™„ÅÑ„ÄÅÂÅAâÊï∞„ÉÉF„ÇÉP„Éà„Å´Â§âÊï∞„ÅÉBÂûã„ÇíËøÉXÂä†„Åô   
  1039  |    //    „Çã„ÄÇÂÅAâÊï∞„ÅÉBÈñÅuÊïÅ[„ÅÉá‰∏ÅBÊñÉP„ÅåÂÉbÉZË±ÅB„ÅÉB„ÅÉF„Çã„ÄÇ                                                      
  1040  |    //  „ÄÄÂÆöÁÉZÉD„ÅÉáÈ†ÜÁï™„ÅÉHÊ≤É\„ÅÅv„ÅüËÉ@ÅvÊûê„ÇíË°å„ÅÜ„ÄÇÂÖÉ„ÅÉáÂÆöÁÉZÉDÊñáÂÉÖóÂàó„Çí‰É\ùÊåÅ„Åô„Çã„ÄÇ                   
  1041  |    //                                                                                                                         
  1042  |    //  4.Ê©üËÉΩË™ÉÉÊòé                                                                                                        
  1043  |    //    int„ÇÑdouble„ÅÉF„ÅÉD„ÅÉá„Éá„Éº„ÇÉ\ÂÆÅvË®Ä„ÅÉáÂáÉíÁêÜ„ÇíË°å„Å™„ÅÑ„ÄÅÂÅAâÊï∞„ÉÉF„ÇÉP„Éà„Å´Â§âÊï∞„ÅÉBÂûã„ÇíËøÉXÂä†„ÄÇ   
  1044  |    //    ValData„ÅÉH„ÅÉb„ÄÅ„Å©„ÅÉá„ÉÅu„ÇÉN„ÉÅE„ÉÉV„ÉÉH„ÅÉ@„ÅÉáÂÆÅvË®Ä„Åã„Åå„ÄÅModuleIdx„Åã„Åã„Åã„ÇâË®ÉÖÂÆö„Åï„Çå„Çã„ÄÇ        
  1045  |    //    Â§âÊï∞„ÅÉH„ÅÉb„ÄÅModuleIdx„ÇÇ‰É\ùÊåÅ„Åó„Å¶„ÄÅModuleIdx„ÅåÁï∞„ÅÉF„ÇãÂ†ÉGÂêà„ÅØÂàÅEÂ§âÊï∞„ÅÉB„Åô„Çã„ÄÇ                 
  1046  |    //                                                                                                                         
  1047  |    //  5.ÊàÉT„ÇäÂÄÅA                                                                                                          
  1048  |    //    „ÅÉF„Åó                                                                                                              
  1049  |    //                                                                                                                         
  1050  |    //  6.ÂÇôËÄÉ                                                                                                               
  1051  |    //                                                                                                                         
  1052  |    /*----------------------------------------------------------------------------*/                                           
  1053  +--- #if 1
        |  +--------------------------------------------------------------------------+ 
  1054  +--+ void AddDataDef_C(TList *TokenList,int sPos,int ePos,TList *ValDataList) | 
  1055  |  | {                                                                        | 
        |  +--+-----------------------------------------------------------------------+ 
  1056  |     +--- int i,j;
  1057  |     +--- TToken *Token,*Token2;
  1058  |     +--- int TokId;
  1059  |     +--- string TokStr,ValName;
  1060  |     +--- Enum_DataType DataType;
  1061  |     +--- int Nest,ArrayLevel;
  1062  |     +--- int DefPosS;
  1063  |     +--- string DefBaseStr,DefStr;
  1064  |     +--- bool SepF = false;
  1065  |     +--- bool NotValDefF = false;
  1066  |     |    
  1067  |     +--- DefPosS = sPos;
  1068  |     +--- DataType = dt_Int;
  1069  |     +--- DefBaseStr = &quot;&quot;;
  1070  |     +--- DefStr = &quot;&quot;;
  1071  |     +--- Token = (TToken *)TokenList-&gt;Items[sPos];
        |     |  +----------------------------------+ 
  1072  |     +--+ for(i = sPos ; i &lt; ePos ; i++){  | 
        |     |  +--+-------------------------------+ 
        |     |     |  +----------------------------------------+ 
  1073  |     |     +--+ if(i &gt;= TokenList-&gt;Count){ // tid_null | 
        |     |     |  +--+-------------------------------------+ 
        |     |     |     |  +--------+ 
  1074  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |   +-+---+ 
  1075  |     |     |   |  }  | 
        |     |     |   +-----+ 
  1076  |     |     +--- Token = (TToken *)TokenList-&gt;Items[i];
  1077  |     |     +--- TokId = Token-&gt;TokId;
  1078  |     |     +--- TokStr = Token-&gt;Str;
  1079  |     |     |    
        |     |     |  +----------------+ 
  1080  |     |     +--+ switch(TokId){ | 
        |     |     |  +--+-------------+ 
        |     |     |     +-----------------+ 
  1081  |     |     |     |  case tid_Val:  | 
        |     |     |     +-----------------+ 
        |     |     |     +-----------------+ 
  1082  |     |     |     |  case tid_Func: | 
        |     |     |     +-----------------+ 
        |     |     |     |  +--------+ 
  1083  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +---------------------+ 
  1084  |     |     |     |  case tid_LineEnd:  | 
        |     |     |     +---------------------+ 
        |     |     |     +---------------------+ 
  1085  |     |     |     |  case tid_ConstNum: | 
        |     |     |     +---------------------+ 
        |     |     |     |  +--------+ 
  1086  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-----------------------+ 
  1087  |     |     |     |  case tid_KagiKakko:  | 
        |     |     |     +-----------------------+ 
        |     |     |     +-----------------------+ 
  1088  |     |     |     |  case tid_KagiKokka:  | 
        |     |     |     +-----------------------+ 
        |     |     |     |  +--------+ 
  1089  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-------------------+ 
  1090  |     |     |     |  case tid_Kakko:  | 
        |     |     |     +-------------------+ 
        |     |     |     +-------------------+ 
  1091  |     |     |     |  case tid_Kokka:  | 
        |     |     |     +-------------------+ 
  1092  |     |     |     +--- // C„ÅÉáÂ†ÉGÂêà„ÄÅÔÉVà)„ÅåÂá∫ÁèÉZ„Åó„ÅüÂ†ÉGÂêà„ÅØ„ÄÅ„Åù„Çå‰ÉTÅEÂâç„Çí„ÇÉb„ÉÉF„ÇÅu„ÄÇÔÉVàÁÅ[ÅBÁïÅEÂåñÔÉVâ
  1093  |     |     |     |    // Exp.  void func(int a); „ÅÉá void„ÅÉba„ÅÉáÂÆöÁÉZÉD„ÅÉ@„ÅÉb„ÅÉF„ÅÑ„ÄÇ                                  
  1094  |     |     |     +--- SepF = true;
  1095  |     |     |     +--- DefStr = &quot;&quot;;
        |     |     |     |  +--------+ 
  1096  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-----------------+ 
  1097  |     |     |     |  case tid_Set:  | 
        |     |     |     +-----------------+ 
        |     |     |     +-----------------+ 
  1098  |     |     |     |  case tid_Set2: | 
        |     |     |     +-----------------+ 
        |     |     |     +---------------------+ 
  1099  |     |     |     |  case tid_Comment:  | 
        |     |     |     +---------------------+ 
  1100  |     |     |     +--- DefBaseStr = &quot;&quot;;
  1101  |     |     |     +--- DefStr = &quot;&quot;;
        |     |     |     |  +--------+ 
  1102  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +---------------------------+ 
  1103  |     |     |     |  case tid_Semikoron: // ; | 
        |     |     |     +---------------------------+ 
  1104  |     |     |     +--- NotValDefF = false; // ÂÆöÁÉZÉD„ÅÉ@„ÅÉF„ÅÑÂÉVè„Éï„ÉÉD„ÇÅ[„Çí„ÇØ„ÉÉF„ÇÅu
        |     |     |     |  +--------+ 
  1105  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-----------------------------------------------+ 
  1106  |     |     |     |  case tid_Kannma:    // Â§âÊï∞„ÅÉáÂåÉRÂàá„Çä  | 
        |     |     |     +-----------------------------------------------+ 
  1107  |     |     |     +--- SepF = true;
  1108  |     |     |     +--- DefStr = &quot;&quot;;
        |     |     |     |  +--------+ 
  1109  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-----------------+ 
  1110  |     |     |     |  case tid_Opr:  | 
        |     |     |     +-----------------+ 
        |     |     |     |  +--------------------+ 
  1111  |     |     |     +--+ if(TokStr == &quot;*&quot;){ | 
        |     |     |     |  +--+-----------------+ 
  1112  |     |     |     |     +--- DefStr += Token-&gt;OrgStr;    // „Éù„Ç§„ÉÉE„ÇÉ\
        |     |     |     |   +-+---+ 
  1113  |     |     |     |   |  }  | 
        |     |     |     |   +-+---+ 
        |     |     |     |   +-+-------+ 
  1113  |     |     |     |   |  else{  | 
        |     |     |     |   +-+-------+ 
  1114  |     |     |     |     +--- DefBaseStr = &quot;&quot;;
  1115  |     |     |     |     +--- DefStr = &quot;&quot;;
        |     |     |     |   +-+---+ 
  1116  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |     |  +--------+ 
  1117  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +---------------------------------------------------------------------------------+ 
  1118  |     |     |     |  case tid_static:    // static „ÅÉbÂÆöÁÉZÉDÊñáÂÉÖó„Å®„Åó„Å¶„ÅÉbÂêÉH„ÇÅ„Å™„ÅÑ„ÄÇ | 
        |     |     |     +---------------------------------------------------------------------------------+ 
        |     |     |     +---------------------------------------------------------------------------------+ 
  1119  |     |     |     |  case tid_const:     // const „ÅÉbÂÆöÁÉZÉDÊñáÂÉÖó„Å®„Åó„Å¶„ÅÉbÂêÉH„ÇÅ„Å™„ÅÑ„ÄÇ  | 
        |     |     |     +---------------------------------------------------------------------------------+ 
  1120  |     |     |     +--- DefBaseStr = &quot;&quot;;
        |     |     |     |  +--------+ 
  1121  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-----------------------------------+ 
  1122  |     |     |     |  case tid_void:      // ÂÆöÁÉZÉD  | 
        |     |     |     +-----------------------------------+ 
        |     |     |     +-----------------+ 
  1123  |     |     |     |  case tid_int:  | 
        |     |     |     +-----------------+ 
        |     |     |     +-------------------+ 
  1124  |     |     |     |  case tid_double: | 
        |     |     |     +-------------------+ 
        |     |     |     +-----------------+ 
  1125  |     |     |     |  case tid_char: | 
        |     |     |     +-----------------+ 
        |     |     |     +-------------------+ 
  1126  |     |     |     |  case tid_float:  | 
        |     |     |     +-------------------+ 
        |     |     |     +-------------------+ 
  1127  |     |     |     |  case tid_struct: | 
        |     |     |     +-------------------+ 
        |     |     |     |  +------------+ 
  1128  |     |     |     +--+ if(SepF){  | 
        |     |     |     |  +--+---------+ 
  1129  |     |     |     |     +--- DefBaseStr = &quot;&quot;;
        |     |     |     |   +-+---+ 
  1130  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
  1131  |     |     |     +--- DefBaseStr += Token-&gt;OrgStr;
  1132  |     |     |     +--- // Ê¨ÅB„ÅÉá„Éà„Éº„ÇÉb„ÉÉE„Åå,()„ÅÉáÂ†ÉGÂêà„ÅØ„ÄÅ„ÇØ„ÉÉF„ÇÅu„Åô„Çã„ÄÇ
  1133  |     |     |     |    // Exp.  printf(&quot;%d&quot;,c); „ÅÉá &quot;%d&quot;„ÅÉbÂÆöÁÉZÉD„ÅÉ@„ÅÉb„ÅÉF„ÅÑ„ÄÇ     
        |     |     |     |  +------------------------------+ 
  1134  |     |     |     +--+ if(i+1 &lt; TokenList-&gt;Count){  | 
        |     |     |     |  +--+---------------------------+ 
  1135  |     |     |     |     +--- Token2 = (TToken *)TokenList-&gt;Items[i+1];
        |     |     |     |     |  +------------------------------------+ 
  1136  |     |     |     |     +--+ if((Token2-&gt;TokId == tid_Kannma)|| | 
  1137  |     |     |     |     |  |     (Token2-&gt;TokId == tid_Kakko)|| | 
  1138  |     |     |     |     |  |     (Token2-&gt;TokId == tid_Kokka)){ | 
        |     |     |     |     |  +--+---------------------------------+ 
  1139  |     |     |     |     |     +--- DefBaseStr = &quot;&quot;;
        |     |     |     |     |   +-+---+ 
  1140  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |   +-+---+ 
  1141  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |     |  +--------+ 
  1142  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-----------+ 
  1143  |     |     |     |  default: | 
        |     |     |     +-----------+ 
        |     |     |     |  +------------+ 
  1144  |     |     |     +--+ if(SepF){  | 
        |     |     |     |  +--+---------+ 
  1145  |     |     |     |     +--- DefBaseStr = &quot;&quot;;
        |     |     |     |   +-+---+ 
  1146  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
  1147  |     |     |     +--- // ÊúÉFÂÆöÁÉZÉD„ÅÉáÂçòËÉFû„ÇÇÂÆöÁÉZÉDÁîÉB„ÅÉB„Åó„Å¶ËøÉXÂä†„ÄÇWORDÁ≠â„ÅÆ„Éû„ÇØ„ÉÉÖ„ÅÉN„ÅÉáÂØÉZÊäó
  1148  |     |     |     +--- DefBaseStr += Token-&gt;OrgStr;
  1149  |     |     |     +--- // Ê¨ÅB„ÅÉá„Éà„Éº„ÇÉb„ÉÉE„Åå,()„ÅÉáÂ†ÉGÂêà„ÅØ„ÄÅ„ÇØ„ÉÉF„ÇÅu„Åô„Çã„ÄÇ
  1150  |     |     |     |    // Exp.  printf(&quot;%d&quot;,c); „ÅÉá &quot;%d&quot;„ÅÉbÂÆöÁÉZÉD„ÅÉ@„ÅÉb„ÅÉF„ÅÑ„ÄÇ     
        |     |     |     |  +------------------------------+ 
  1151  |     |     |     +--+ if(i+1 &lt; TokenList-&gt;Count){  | 
        |     |     |     |  +--+---------------------------+ 
  1152  |     |     |     |     +--- Token2 = (TToken *)TokenList-&gt;Items[i+1];
        |     |     |     |     |  +------------------------------------+ 
  1153  |     |     |     |     +--+ if((Token2-&gt;TokId == tid_Kannma)|| | 
  1154  |     |     |     |     |  |     (Token2-&gt;TokId == tid_Kakko)|| | 
  1155  |     |     |     |     |  |     (Token2-&gt;TokId == tid_Kokka)){ | 
        |     |     |     |     |  +--+---------------------------------+ 
  1156  |     |     |     |     |     +--- DefBaseStr = &quot;&quot;;
        |     |     |     |     |   +-+---+ 
  1157  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |   +-+---+ 
  1158  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |     |  +--------+ 
  1159  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |   +-+---+ 
  1160  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +----------------+ 
  1161  |     |     +--+ switch(TokId){ | 
        |     |     |  +--+-------------+ 
        |     |     |     +-----------------+ 
  1162  |     |     |     |  case tid_void: | 
        |     |     |     +-----------------+ 
  1163  |     |     |     +--- DataType = dt_Void;
        |     |     |     |  +--------+ 
  1164  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-----------------+ 
  1165  |     |     |     |  case tid_int:  | 
        |     |     |     +-----------------+ 
  1166  |     |     |     +--- DataType = dt_Int;
        |     |     |     |  +--------+ 
  1167  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-------------------+ 
  1168  |     |     |     |  case tid_double: | 
        |     |     |     +-------------------+ 
  1169  |     |     |     +--- DataType = dt_Real; // „ÅÉB„Çä„ÅÇ„Åà„Åö„ÄÅFortanÁâà„Å´Âêà„Çè„Åõ„Çã„ÄÇ
        |     |     |     |  +--------+ 
  1170  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-----------------+ 
  1171  |     |     |     |  case tid_char: | 
        |     |     |     +-----------------+ 
  1172  |     |     |     +--- DataType = dt_Char;
        |     |     |     |  +--------+ 
  1173  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-------------------+ 
  1174  |     |     |     |  case tid_float:  | 
        |     |     |     +-------------------+ 
  1175  |     |     |     +--- DataType = dt_Float;
        |     |     |     |  +--------+ 
  1176  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-------------------+ 
  1177  |     |     |     |  case tid_struct: | 
        |     |     |     +-------------------+ 
  1178  |     |     |     +--- DataType = dt_Void;
        |     |     |     |  +--------+ 
  1179  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |   +-+---+ 
  1180  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +----------------------------------------------+ 
  1181  |     |     +--+ if((TokId != tid_Val)&amp;&amp;(TokId != tid_Func)){ | 
        |     |     |  +--+-------------------------------------------+ 
  1182  |     |     |     +--- // Â§âÊï∞„ÅÉBÈñÅuÊïÅ[„Éà„Éº„ÇÉb„ÉÉE‰ªÅEÂ§ñÊÉÉÅB„ÅÉN
        |     |     |     |  +------------+ 
  1183  |     |     |     +--+ continue;  | 
        |     |     |     |  +------------+ 
        |     |     |   +-+---+ 
  1184  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +------------------------+ 
  1185  |     |     +--+ if(DefBaseStr == &quot;&quot;){  | 
        |     |     |  +--+---------------------+ 
  1186  |     |     |     +--- // ÂÆöÁÉZÉDÊñáÂÉÖó„Å™„Åó„Åß„ÅÉáÂ§âÊï∞„ÇÑÈñ¢ÊïÅ[„ÅÉáÂáÉRÁèÉZ„ÅÉb„ÄÅÂÉVè„Å´„ÅÉF„Çã„ÅÆ„ÅÉ@„ÄÅ
  1187  |     |     |     |    // „ÇÉT„Éü„Ç≥„ÉÉÖ„ÉÉE„ÅÉZ„ÅÉ@ÂÆöÁÉZÉD„ÅÉF„Åó„Å´„ÅÉF„Çã„ÄÇ                                  
  1188  |     |     |     +--- NotValDefF = true;
        |     |     |   +-+---+ 
  1189  |     |     |   |  }  | 
        |     |     |   +-----+ 
  1190  |     |     +--- //
  1191  |     |     |    // „Åô„Åß„ÅÉH„ÄÅÂêå„ÅòÂêçÂâç„Åß„ÄÅÂÉáÅvË®Ä„Åï„Çå„ÅÉí„ÅÑ„ÇãÈñÅuÊïÅ[„ÅãÂÅAâÊï∞„Åå„ÅÇ„Çã„Åã„ÇíËÉFÉ\„ÅÉP„Çã„ÄÇ         
  1192  |     |     |    // „ÅÇ„Çå„ÅÅ[„ÄÅËÉ\ÉXÂä†„Åó„Å™„ÅÑ„ÄÇÔÉVàÂûã„ÅÉá‰∏ÄËáÉG„Åã„Å©„ÅÜ„Åã„ÅÉáÂàÅAÂÆö„ÅØ„ÄÅ„Ç≥„ÉÉE„Éë„Ç§„ÉÉD„ÅÉZ„Åã„ÅõÔºâ  
  1193  |     |     |    //                                                                                                                 
  1194  |     |     +--- TValData *ValData = NULL;
  1195  |     |     +--- bool NewValDataF = true;
  1196  |     |     |    
  1197  |     |     +--- ValName = Trim(TokStr);
  1198  |     |     |    
        |     |     |  +--------------------------------+ 
  1199  |     |     +--+ if(Token-&gt;TokId == tid_Func){  | 
        |     |     |  +--+-----------------------------+ 
  1200  |     |     |     +--- NewValDataF = false;     // ÈñÅuÊïÅ[
        |     |     |   +-+---+ 
  1201  |     |     |   |  }  | 
        |     |     |   +-----+ 
  1202  |     |     +--- //      for(j = 0 ; j &lt; ValDataList-&gt;Count ; j++){
        |     |     |  +------------------------------------------------+ 
  1203  |     |     +--+ for(j = ValDataList-&gt;Count-1 ; j &gt;= 0 ; j--){  | 
        |     |     |  +--+---------------------------------------------+ 
  1204  |     |     |     +--- ValData = (TValData *)ValDataList-&gt;Items[j];
        |     |     |     |  +------------------------------------------+ 
  1205  |     |     |     +--+ if(ValData-&gt;Str.compare(ValName) == 0){  | 
        |     |     |     |  +--+---------------------------------------+ 
        |     |     |     |     |  +--------------------------------+ 
  1206  |     |     |     |     +--+ if(Token-&gt;TokId == tid_Func){  | 
        |     |     |     |     |  +--+-----------------------------+ 
  1207  |     |     |     |     |     +--- NewValDataF = false;     // ÈñÅuÊïÅ[„ÅÉ@2ÂõûÁõÆ„ÅÉáÂáÉRÁèÉZ
        |     |     |     |     |     |  +--------+ 
  1208  |     |     |     |     |     +--+ break; | 
        |     |     |     |     |     |  +--------+ 
        |     |     |     |     |   +-+---+ 
  1209  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-+---+ 
        |     |     |     |     |   +-+-----------------------------------+ 
  1209  |     |     |     |     |   |  else if(Token-&gt;BrNestLevel == 0){  | 
        |     |     |     |     |   +-+-----------------------------------+ 
  1210  |     |     |     |     |     +--- NewValDataF = false;    // „Éç„Çπ„Éà„Å™„Åó„Åß„ÅÉá2ÂõûÁõÆ„ÅÉáÂáÉRÁèÉZ
        |     |     |     |     |     |  +--------+ 
  1211  |     |     |     |     |     +--+ break; | 
        |     |     |     |     |     |  +--------+ 
        |     |     |     |     |   +-+---+ 
  1212  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-+---+ 
        |     |     |     |     |   +-+-------------------------------------------------+ 
  1212  |     |     |     |     |   |  else if(ValData-&gt;ModuleIdx == Token-&gt;ModuleIdx){ | 
        |     |     |     |     |   +-+-------------------------------------------------+ 
  1213  |     |     |     |     |     +--- // Âêå„Åò„ÉÅu„ÇÉN„ÉÅE„ÉÉV„ÉÉHÂÜÖ„Åß„ÅÉáÂêå„ÅòÂêçÂâç„ÅÉá2ÂõûÁõÆ„ÅÉáÂ§âÊï∞„ÇÇÂÉáöÁÉZÉDÊ∏à„Å®„Åó„Å¶„ÅÑ„Çã„ÄÇ
  1214  |     |     |     |     |     +--- NewValDataF = false;
        |     |     |     |     |     |  +--------+ 
  1215  |     |     |     |     |     +--+ break; | 
        |     |     |     |     |     |  +--------+ 
        |     |     |     |     |   +-+---+ 
  1216  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-+---+ 
        |     |     |     |     |   +-+-----------------------------------------------------------+ 
  1216  |     |     |     |     |   |  else if((DefBaseStr == &quot;&quot;)&amp;&amp;(ValData-&gt;BrNestLevel == 0)){  | 
        |     |     |     |     |   +-+-----------------------------------------------------------+ 
  1217  |     |     |     |     |     +--- // ÂÆöÁÉZÉD„ÅÉ@„ÅÉF„Åè„ÄÅ„Ç∞„ÉÉÖ„ÉÉV„Éê„É´Â§âÊï∞„ÇíÂèÇÁÖÉ@
  1218  |     |     |     |     |     +--- NewValDataF = false;
        |     |     |     |     |     |  +--------+ 
  1219  |     |     |     |     |     +--+ break; | 
        |     |     |     |     |     |  +--------+ 
        |     |     |     |     |   +-+---+ 
  1220  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |   +-+---+ 
  1221  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |   +-+---+ 
  1222  |     |     |   |  }  | 
        |     |     |   +-----+ 
  1223  |     |     +--- #if 0
        |     |     |  +------------------------------------------------+ 
  1224  |     |     +--+ if((NotValDefF)&amp;&amp;(Token-&gt;TokId != tid_Func)){  | 
        |     |     |  +--+---------------------------------------------+ 
  1225  |     |     |     +--- // ÂÆöÁÉZÉD„ÅÉF„Åó„Åß„ÄÅÂÅAâÊï∞ÂáÉRÁèÉZ„ÅÉáÂ†ÉGÂêà„ÅØ„ÄÅÂÉáöÁÉZÉD„ÅÉ@„ÅÉF„ÅÑÂÉVè„Å®„Åô„Çã„ÄÇ
  1226  |     |     |     +--- NewValDataF = false;
        |     |     |   +-+---+ 
  1227  |     |     |   |  }  | 
        |     |     |   +-----+ 
  1228  |     |     +--- #endif
        |     |     |  +--------------------------------------------------------------------+ 
  1229  |     |     +--+ if((NotValDefF)&amp;&amp;(DefBaseStr == &quot;&quot;)&amp;&amp;(Token-&gt;TokId != tid_Func)){  | 
        |     |     |  +--+-----------------------------------------------------------------+ 
  1230  |     |     |     +--- // ÂÆöÁÉZÉD„ÅÉF„Åó„Åß„ÄÅÂÅAâÊï∞ÂáÉRÁèÉZ„ÅÉáÂ†ÉGÂêà„ÅØ„ÄÅÂÉáöÁÉZÉD„ÅÉ@„ÅÉF„ÅÑÂÉVè„Å®„Åô„Çã„ÄÇ
  1231  |     |     |     +--- NewValDataF = false;
        |     |     |   +-+---+ 
  1232  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +--------------------+ 
  1233  |     |     +--+ if(!NewValDataF){  | 
        |     |     |  +--+-----------------+ 
  1234  |     |     |     +--- Token-&gt;ValData = ValData;
        |     |     |     |  +------------+ 
  1235  |     |     |     +--+ continue;  | 
        |     |     |     |  +------------+ 
        |     |     |   +-+---+ 
  1236  |     |     |   |  }  | 
        |     |     |   +-----+ 
  1237  |     |     +--- //
  1238  |     |     |    // Â§âÊï∞„ÉÉF„ÇÉP„Éà„Å´ËøÉXÂä†„Åô„Çã„ÄÇ  
  1239  |     |     |    //                                       
  1240  |     |     +--- ValData = new TValData(ValName);
  1241  |     |     +--- Token-&gt;ValData = ValData;
  1242  |     |     +--- ValDataList-&gt;Add((void *)ValData);
  1243  |     |     +--- ValData-&gt;ModuleIdx = Token-&gt;ModuleIdx;
  1244  |     |     +--- ValData-&gt;BrNestLevel = Token-&gt;BrNestLevel;
  1245  |     |     +--- ValData-&gt;DataType = DataType;
        |     |     |  +------------------------+ 
  1246  |     |     +--+ if(TokId == tid_Func){ | 
        |     |     |  +--+---------------------+ 
  1247  |     |     |     +--- ValData-&gt;DataType = (Enum_DataType)(DataType+dt_IntFunc-dt_Int);
  1248  |     |     |     +--- //      }else if(ValData-&gt;BrNestLevel &gt; FuncBrNestLevel){
        |     |     |   +-+---+ 
  1249  |     |     |   |  }  | 
        |     |     |   +-+---+ 
        |     |     |   +-+-------------------------------------------------------------+ 
  1249  |     |     |   |  else if((Token-&gt;NestLevel == 0)&amp;&amp;(Token-&gt;BrNestLevel &gt; 0)){  | 
        |     |     |   +-+-------------------------------------------------------------+ 
  1250  |     |     |     +--- // ÈñÅuÊïÅ[ÂÆöÁÉZÉD Func( xxx ) „ÅÉáÂºïÊï∞„ÅÉáÂ†ÉGÂêà„Å´ArgF„Çí„Çª„ÉÉ„Éà
  1251  |     |     |     +--- ValData-&gt;ArgF = true;   // ÂºïÊï∞„ÅÉ@„ÅÇ„ÇãArgF„Çí„Çª„ÉÉ„Éà
        |     |     |   +-+---+ 
  1252  |     |     |   |  }  | 
        |     |     |   +-----+ 
  1253  |     |     +--- ValData-&gt;SetCount = 0;
  1254  |     |     +--- ValData-&gt;DefPos = i;    // Â§âÊï∞ËáÉF‰Ωì„ÅÆ‰ΩçÁÉXÉá
  1255  |     |     +--- ValData-&gt;DefStr1 = DefBaseStr;
  1256  |     |     +--- ValData-&gt;DefStr2 = DefStr;
  1257  |     |     +--- ValData-&gt;DefPosS = DefPosS;     // ÂÆü‰ÉXì„Å®„ÅÉbÁïÅ[„ÅÉF„Çã„Åå„ÇÉT„ÉÉ„Éà
  1258  |     |     +--- ValData-&gt;DefPosE = i;
  1259  |     |     +--- ValData-&gt;ArrayDefPosS = i+1;
  1260  |     |     +--- Token-&gt;ValData = ValData;
  1261  |     |     +--- Nest = 0;
  1262  |     |     +--- ArrayLevel = 0;
        |     |     |  +------------------------------------------------------------------------+ 
  1263  |     |     +--+ for(j = i-1 ; j &gt;= sPos ; j--){ // Â§âÊï∞„ÅÉáÂâç„ÅÆ * „Çí„ÉÅ„ÇÉ@„ÉÉ„ÇØ | 
        |     |     |  +--+---------------------------------------------------------------------+ 
  1264  |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[j];
        |     |     |     |  +------------------------------+ 
  1265  |     |     |     +--+ if(Token-&gt;Str == &quot;*&quot;){  // * | 
        |     |     |     |  +--+---------------------------+ 
  1266  |     |     |     |     +--- ArrayLevel++;
        |     |     |     |   +-+---+ 
  1267  |     |     |     |   |  }  | 
        |     |     |     |   +-+---+ 
        |     |     |     |   +-+-------+ 
  1267  |     |     |     |   |  else{  | 
        |     |     |     |   +-+-------+ 
        |     |     |     |     |  +--------+ 
  1268  |     |     |     |     +--+ break; | 
        |     |     |     |     |  +--------+ 
        |     |     |     |   +-+---+ 
  1269  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |   +-+---+ 
  1270  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +------------------------------------------------------------------------+ 
  1271  |     |     +--+ for(j = i+1 ; j &lt; ePos ; j++){ // Â§âÊï∞„ÅÉáÂæå„ÅÆ [] „Çí„ÉÅ„ÇÉ@„ÉÉ„ÇØ | 
        |     |     |  +--+---------------------------------------------------------------------+ 
  1272  |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[j];
  1273  |     |     |     +--- TokId = Token-&gt;TokId;
        |     |     |     |  +----------------------------------+ 
  1274  |     |     |     +--+ if(TokId == tid_KagiKakko){ // [ | 
        |     |     |     |  +--+-------------------------------+ 
  1275  |     |     |     |     +--- Nest++;
  1276  |     |     |     |     +--- ArrayLevel++;
        |     |     |     |   +-+---+ 
  1277  |     |     |     |   |  }  | 
        |     |     |     |   +-+---+ 
        |     |     |     |   +-+---------------------------------------+ 
  1277  |     |     |     |   |  else if(TokId == tid_KagiKokka){ // ]  | 
        |     |     |     |   +-+---------------------------------------+ 
  1278  |     |     |     |     +--- Nest--;
        |     |     |     |   +-+---+ 
  1279  |     |     |     |   |  }  | 
        |     |     |     |   +-+---+ 
        |     |     |     |   +-+---------------------+ 
  1279  |     |     |     |   |  else if(Nest == 0){  | 
        |     |     |     |   +-+---------------------+ 
        |     |     |     |     |  +--------+ 
  1280  |     |     |     |     +--+ break; | 
        |     |     |     |     |  +--------+ 
        |     |     |     |   +-+---+ 
  1281  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |   +-+---+ 
  1282  |     |     |   |  }  | 
        |     |     |   +-----+ 
  1283  |     |     +--- ValData-&gt;ArrayDefPosE = j;
  1284  |     |     +--- ValData-&gt;ArrayLevel = ArrayLevel; // ÈÖçÂàóÊ¨ÅBÂÖÉÊï∞
        |     |   +-+---+ 
  1285  |     |   |  }  | 
        |     |   +-----+ 
        |   +-+---+ 
  1286  |   |  }  | 
        |   +-----+ 
  1287  +--- #else
        |  +--------------------------------------------------------------------------+ 
  1288  +--+ void AddDataDef_C(TList *TokenList,int sPos,int ePos,TList *ValDataList) | 
  1289  |  | {                                                                        | 
        |  +--+-----------------------------------------------------------------------+ 
  1290  |     +--- int i,j;
  1291  |     +--- TToken *Token;
  1292  |     +--- int TokId;
  1293  |     +--- string TokStr,ValName;
  1294  |     +--- Enum_DataType DataType;
  1295  |     +--- int Nest,ArrayLevel;
  1296  |     +--- int DefPosS,DefPosE;
  1297  |     +--- string DefBaseStr,DefStr;
  1298  |     +--- int FuncBrNestLevel;
  1299  |     +--- bool SepF = false;
  1300  |     |    
  1301  |     +--- DefPosS = sPos;
  1302  |     +--- DefPosE = sPos;
  1303  |     +--- DataType = dt_Int;
  1304  |     +--- DefBaseStr = &quot;&quot;;
  1305  |     +--- DefStr = &quot;&quot;;
  1306  |     +--- Token = (TToken *)TokenList-&gt;Items[sPos];
  1307  |     +--- FuncBrNestLevel = Token-&gt;BrNestLevel;
        |     |  +----------------------------------+ 
  1308  |     +--+ for(i = sPos ; i &lt; ePos ; i++){  | 
        |     |  +--+-------------------------------+ 
        |     |     |  +----------------------------------------+ 
  1309  |     |     +--+ if(i &gt;= TokenList-&gt;Count){ // tid_null | 
        |     |     |  +--+-------------------------------------+ 
        |     |     |     |  +--------+ 
  1310  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |   +-+---+ 
  1311  |     |     |   |  }  | 
        |     |     |   +-----+ 
  1312  |     |     +--- Token = (TToken *)TokenList-&gt;Items[i];
  1313  |     |     +--- TokId = Token-&gt;TokId;
  1314  |     |     +--- TokStr = Token-&gt;Str;
  1315  |     |     |    
        |     |     |  +----------------+ 
  1316  |     |     +--+ switch(TokId){ | 
        |     |     |  +--+-------------+ 
        |     |     |     +-----------------+ 
  1317  |     |     |     |  case tid_Val:  | 
        |     |     |     +-----------------+ 
        |     |     |     +-----------------+ 
  1318  |     |     |     |  case tid_Func: | 
        |     |     |     +-----------------+ 
        |     |     |     |  +--------+ 
  1319  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-----------------------+ 
  1320  |     |     |     |  case tid_KagiKakko:  | 
        |     |     |     +-----------------------+ 
        |     |     |     +-----------------------+ 
  1321  |     |     |     |  case tid_KagiKokka:  | 
        |     |     |     +-----------------------+ 
        |     |     |     |  +--------+ 
  1322  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-------------------+ 
  1323  |     |     |     |  case tid_Kakko:  | 
        |     |     |     +-------------------+ 
        |     |     |     +-------------------+ 
  1324  |     |     |     |  case tid_Kokka:  | 
        |     |     |     +-------------------+ 
  1325  |     |     |     +--- DefBaseStr = &quot;&quot;;
  1326  |     |     |     +--- DefStr = &quot;&quot;;
        |     |     |     |  +--------+ 
  1327  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-----------------------------------------------+ 
  1328  |     |     |     |  case tid_Kannma:    // Â§âÊï∞„ÅÉáÂåÉRÂàá„Çä  | 
        |     |     |     +-----------------------------------------------+ 
  1329  |     |     |     +--- SepF = true;
  1330  |     |     |     +--- DefStr = &quot;&quot;;
        |     |     |     |  +--------+ 
  1331  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-----------------+ 
  1332  |     |     |     |  case tid_Opr:  | 
        |     |     |     +-----------------+ 
        |     |     |     |  +--------------------+ 
  1333  |     |     |     +--+ if(TokStr == &quot;*&quot;){ | 
        |     |     |     |  +--+-----------------+ 
  1334  |     |     |     |     +--- DefStr += Token-&gt;OrgStr;    // „Éù„Ç§„ÉÉE„ÇÉ\
        |     |     |     |   +-+---+ 
  1335  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |     |  +--------+ 
  1336  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-----------------------------------+ 
  1337  |     |     |     |  case tid_static:    // ÂÆöÁÉZÉD  | 
        |     |     |     +-----------------------------------+ 
        |     |     |     +-----------------+ 
  1338  |     |     |     |  case tid_void: | 
        |     |     |     +-----------------+ 
        |     |     |     +-----------------+ 
  1339  |     |     |     |  case tid_int:  | 
        |     |     |     +-----------------+ 
        |     |     |     +-------------------+ 
  1340  |     |     |     |  case tid_double: | 
        |     |     |     +-------------------+ 
        |     |     |     +-----------------+ 
  1341  |     |     |     |  case tid_char: | 
        |     |     |     +-----------------+ 
        |     |     |     +-------------------+ 
  1342  |     |     |     |  case tid_float:  | 
        |     |     |     +-------------------+ 
        |     |     |     |  +------------+ 
  1343  |     |     |     +--+ if(SepF){  | 
        |     |     |     |  +--+---------+ 
  1344  |     |     |     |     +--- DefBaseStr = &quot;&quot;;
        |     |     |     |   +-+---+ 
  1345  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
  1346  |     |     |     +--- DefBaseStr += Token-&gt;OrgStr;
        |     |     |     |  +--------+ 
  1347  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-----------+ 
  1348  |     |     |     |  default: | 
        |     |     |     +-----------+ 
        |     |     |     |  +------------+ 
  1349  |     |     |     +--+ if(SepF){  | 
        |     |     |     |  +--+---------+ 
  1350  |     |     |     |     +--- DefBaseStr = &quot;&quot;;
        |     |     |     |   +-+---+ 
  1351  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
  1352  |     |     |     +--- DefBaseStr += Token-&gt;OrgStr;
        |     |     |     |  +--------+ 
  1353  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |   +-+---+ 
  1354  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +----------------+ 
  1355  |     |     +--+ switch(TokId){ | 
        |     |     |  +--+-------------+ 
        |     |     |     +-----------------+ 
  1356  |     |     |     |  case tid_void: | 
        |     |     |     +-----------------+ 
  1357  |     |     |     +--- DataType = dt_Void;
        |     |     |     |  +--------+ 
  1358  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-----------------+ 
  1359  |     |     |     |  case tid_int:  | 
        |     |     |     +-----------------+ 
  1360  |     |     |     +--- DataType = dt_Int;
        |     |     |     |  +--------+ 
  1361  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-------------------+ 
  1362  |     |     |     |  case tid_double: | 
        |     |     |     +-------------------+ 
  1363  |     |     |     +--- DataType = dt_Real; // „ÅÉB„Çä„ÅÇ„Åà„Åö„ÄÅFortanÁâà„Å´Âêà„Çè„Åõ„Çã„ÄÇ
        |     |     |     |  +--------+ 
  1364  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-----------------+ 
  1365  |     |     |     |  case tid_char: | 
        |     |     |     +-----------------+ 
  1366  |     |     |     +--- DataType = dt_Char;
        |     |     |     |  +--------+ 
  1367  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-------------------+ 
  1368  |     |     |     |  case tid_float:  | 
        |     |     |     +-------------------+ 
  1369  |     |     |     +--- DataType = dt_Float;
        |     |     |     |  +--------+ 
  1370  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |   +-+---+ 
  1371  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +----------------------------------------------+ 
  1372  |     |     +--+ if((TokId != tid_Val)&amp;&amp;(TokId != tid_Func)){ | 
        |     |     |  +--+-------------------------------------------+ 
  1373  |     |     |     +--- // Â§âÊï∞„ÅÉBÈñÅuÊïÅ[„Éà„Éº„ÇÉb„ÉÉE‰ªÅEÂ§ñÊÉÉÅB„ÅÉN
        |     |     |     |  +------------+ 
  1374  |     |     |     +--+ continue;  | 
        |     |     |     |  +------------+ 
        |     |     |   +-+---+ 
  1375  |     |     |   |  }  | 
        |     |     |   +-----+ 
  1376  |     |     +--- //
  1377  |     |     |    // „Åô„Åß„ÅÉH„ÄÅÂêå„ÅòÂêçÂâç„Åß„ÄÅÂÉáÅvË®Ä„Åï„Çå„ÅÉí„ÅÑ„ÇãÈñÅuÊïÅ[„ÅãÂÅAâÊï∞„Åå„ÅÇ„Çã„Åã„ÇíËÉFÉ\„ÅÉP„Çã„ÄÇ         
  1378  |     |     |    // „ÅÇ„Çå„ÅÅ[„ÄÅËÉ\ÉXÂä†„Åó„Å™„ÅÑ„ÄÇÔÉVàÂûã„ÅÉá‰∏ÄËáÉG„Åã„Å©„ÅÜ„Åã„ÅÉáÂàÅAÂÆö„ÅØ„ÄÅ„Ç≥„ÉÉE„Éë„Ç§„ÉÉD„ÅÉZ„Åã„ÅõÔºâ  
  1379  |     |     |    //                                                                                                                 
  1380  |     |     +--- TValData *ValData;
  1381  |     |     +--- bool NewValDataF = true;
  1382  |     |     |    
  1383  |     |     +--- DefPosE = i;
  1384  |     |     +--- ValName = Trim(TokStr);
        |     |     |  +--------------------------------------------+ 
  1385  |     |     +--+ for(j = 0 ; j &lt; ValDataList-&gt;Count ; j++){ | 
        |     |     |  +--+-----------------------------------------+ 
  1386  |     |     |     +--- ValData = (TValData *)ValDataList-&gt;Items[j];
        |     |     |     |  +------------------------------------------+ 
  1387  |     |     |     +--+ if(ValData-&gt;Str.compare(ValName) == 0){  | 
        |     |     |     |  +--+---------------------------------------+ 
        |     |     |     |     |  +--------------------------------+ 
  1388  |     |     |     |     +--+ if(Token-&gt;TokId == tid_Func){  | 
        |     |     |     |     |  +--+-----------------------------+ 
  1389  |     |     |     |     |     +--- NewValDataF = false;     // ÈñÅuÊïÅ[„ÅÉ@2ÂõûÁõÆ„ÅÉáÂáÉRÁèÉZ
        |     |     |     |     |     |  +--------+ 
  1390  |     |     |     |     |     +--+ break; | 
        |     |     |     |     |     |  +--------+ 
        |     |     |     |     |   +-+---+ 
  1391  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-+---+ 
        |     |     |     |     |   +-+-----------------------------------+ 
  1391  |     |     |     |     |   |  else if(Token-&gt;BrNestLevel == 0){  | 
        |     |     |     |     |   +-+-----------------------------------+ 
  1392  |     |     |     |     |     +--- NewValDataF = false;    // „Éç„Çπ„Éà„Å™„Åó„Åß„ÅÉá2ÂõûÁõÆ„ÅÉáÂáÉRÁèÉZ
        |     |     |     |     |     |  +--------+ 
  1393  |     |     |     |     |     +--+ break; | 
        |     |     |     |     |     |  +--------+ 
        |     |     |     |     |   +-+---+ 
  1394  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-+---+ 
        |     |     |     |     |   +-+-------------------------------------------------+ 
  1394  |     |     |     |     |   |  else if(ValData-&gt;ModuleIdx == Token-&gt;ModuleIdx){ | 
        |     |     |     |     |   +-+-------------------------------------------------+ 
  1395  |     |     |     |     |     +--- // Âêå„Åò„ÉÅu„ÇÉN„ÉÅE„ÉÉV„ÉÉHÂÜÖ„Åß„ÅÉáÂêå„ÅòÂêçÂâç„ÅÉá2ÂõûÁõÆ„ÅÉáÂ§âÊï∞„ÇÇÂÉáöÁÉZÉDÊ∏à„Å®„Åó„Å¶„ÅÑ„Çã„ÄÇ
  1396  |     |     |     |     |     +--- NewValDataF = false;
        |     |     |     |     |     |  +--------+ 
  1397  |     |     |     |     |     +--+ break; | 
        |     |     |     |     |     |  +--------+ 
        |     |     |     |     |   +-+---+ 
  1398  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |   +-+---+ 
  1399  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |   +-+---+ 
  1400  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +--------------------+ 
  1401  |     |     +--+ if(!NewValDataF){  | 
        |     |     |  +--+-----------------+ 
  1402  |     |     |     +--- Token-&gt;ValData = ValData;
        |     |     |     |  +------------+ 
  1403  |     |     |     +--+ continue;  | 
        |     |     |     |  +------------+ 
        |     |     |   +-+---+ 
  1404  |     |     |   |  }  | 
        |     |     |   +-----+ 
  1405  |     |     +--- //
  1406  |     |     |    // Â§âÊï∞„ÉÉF„ÇÉP„Éà„Å´ËøÉXÂä†„Åô„Çã„ÄÇ  
  1407  |     |     |    //                                       
  1408  |     |     +--- ValData = new TValData(ValName);
  1409  |     |     +--- Token-&gt;ValData = ValData;
  1410  |     |     +--- ValDataList-&gt;Add((void *)ValData);
  1411  |     |     +--- ValData-&gt;ModuleIdx = Token-&gt;ModuleIdx;
  1412  |     |     +--- ValData-&gt;BrNestLevel = Token-&gt;BrNestLevel;
  1413  |     |     +--- ValData-&gt;DataType = DataType;
        |     |     |  +------------------------+ 
  1414  |     |     +--+ if(TokId == tid_Func){ | 
        |     |     |  +--+---------------------+ 
  1415  |     |     |     +--- ValData-&gt;DataType = (Enum_DataType)(DataType+dt_IntFunc-dt_Int);
  1416  |     |     |     +--- //      }else if(ValData-&gt;BrNestLevel &gt; FuncBrNestLevel){
        |     |     |   +-+---+ 
  1417  |     |     |   |  }  | 
        |     |     |   +-+---+ 
        |     |     |   +-+-------------------------------------------------------------+ 
  1417  |     |     |   |  else if((Token-&gt;NestLevel == 0)&amp;&amp;(Token-&gt;BrNestLevel &gt; 0)){  | 
        |     |     |   +-+-------------------------------------------------------------+ 
  1418  |     |     |     +--- // ÈñÅuÊïÅ[ÂÆöÁÉZÉD Func( xxx ) „ÅÉáÂºïÊï∞„ÅÉáÂ†ÉGÂêà„Å´ArgF„Çí„Çª„ÉÉ„Éà
  1419  |     |     |     +--- ValData-&gt;ArgF = true;   // ÂºïÊï∞„ÅÉ@„ÅÇ„ÇãArgF„Çí„Çª„ÉÉ„Éà
        |     |     |   +-+---+ 
  1420  |     |     |   |  }  | 
        |     |     |   +-----+ 
  1421  |     |     +--- ValData-&gt;SetCount = 0;
  1422  |     |     +--- ValData-&gt;DefPos = i;    // Â§âÊï∞ËáÉF‰Ωì„ÅÆ‰ΩçÁÉXÉá
  1423  |     |     +--- ValData-&gt;DefStr1 = DefBaseStr;
  1424  |     |     +--- ValData-&gt;DefStr2 = DefStr;
  1425  |     |     +--- ValData-&gt;DefPosS = DefPosS;     // ÂÆü‰ÉXì„Å®„ÅÉbÁïÅ[„ÅÉF„Çã„Åå„ÇÉT„ÉÉ„Éà
  1426  |     |     +--- ValData-&gt;DefPosE = i;
  1427  |     |     +--- ValData-&gt;ArrayDefPosS = i+1;
  1428  |     |     +--- Token-&gt;ValData = ValData;
  1429  |     |     +--- Nest = 0;
  1430  |     |     +--- ArrayLevel = 0;
        |     |     |  +------------------------------------------------------------------------+ 
  1431  |     |     +--+ for(j = i-1 ; j &gt;= sPos ; j--){ // Â§âÊï∞„ÅÉáÂâç„ÅÆ * „Çí„ÉÅ„ÇÉ@„ÉÉ„ÇØ | 
        |     |     |  +--+---------------------------------------------------------------------+ 
  1432  |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[j];
        |     |     |     |  +------------------------------+ 
  1433  |     |     |     +--+ if(Token-&gt;Str == &quot;*&quot;){  // * | 
        |     |     |     |  +--+---------------------------+ 
  1434  |     |     |     |     +--- ArrayLevel++;
        |     |     |     |   +-+---+ 
  1435  |     |     |     |   |  }  | 
        |     |     |     |   +-+---+ 
        |     |     |     |   +-+-------+ 
  1435  |     |     |     |   |  else{  | 
        |     |     |     |   +-+-------+ 
        |     |     |     |     |  +--------+ 
  1436  |     |     |     |     +--+ break; | 
        |     |     |     |     |  +--------+ 
        |     |     |     |   +-+---+ 
  1437  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |   +-+---+ 
  1438  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +--------------------------------+ 
  1439  |     |     +--+ for(j = i+1 ; j &lt; ePos ; j++){ | 
        |     |     |  +--+-----------------------------+ 
  1440  |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[j];
  1441  |     |     |     +--- TokId = Token-&gt;TokId;
        |     |     |     |  +----------------------------------+ 
  1442  |     |     |     +--+ if(TokId == tid_KagiKakko){ // [ | 
        |     |     |     |  +--+-------------------------------+ 
  1443  |     |     |     |     +--- Nest++;
  1444  |     |     |     |     +--- ArrayLevel++;
        |     |     |     |   +-+---+ 
  1445  |     |     |     |   |  }  | 
        |     |     |     |   +-+---+ 
        |     |     |     |   +-+---------------------------------------+ 
  1445  |     |     |     |   |  else if(TokId == tid_KagiKokka){ // ]  | 
        |     |     |     |   +-+---------------------------------------+ 
  1446  |     |     |     |     +--- Nest--;
        |     |     |     |   +-+---+ 
  1447  |     |     |     |   |  }  | 
        |     |     |     |   +-+---+ 
        |     |     |     |   +-+---------------------+ 
  1447  |     |     |     |   |  else if(Nest == 0){  | 
        |     |     |     |   +-+---------------------+ 
        |     |     |     |     |  +--------+ 
  1448  |     |     |     |     +--+ break; | 
        |     |     |     |     |  +--------+ 
        |     |     |     |   +-+---+ 
  1449  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |   +-+---+ 
  1450  |     |     |   |  }  | 
        |     |     |   +-----+ 
  1451  |     |     +--- ValData-&gt;ArrayDefPosE = j;
  1452  |     |     +--- ValData-&gt;ArrayLevel = ArrayLevel; // ÈÖçÂàóÊ¨ÅBÂÖÉÊï∞
        |     |   +-+---+ 
  1453  |     |   |  }  | 
        |     |   +-----+ 
        |   +-+---+ 
  1454  |   |  }  | 
        |   +-----+ 
  1455  +--- #endif
  1456  +--- /*----------------------------------------------------------------------------*/
  1457  |    //                                                                                                                                 
  1458  |    //  1.ÊóÅEÊúÉÉË™ûÂêç                                                                                                               
  1459  |    //                                                                                                                                 
  1460  |    //  2.„Éë„É©„ÉÅB„ÇÉ\Ë™ÉÉÊòé                                                                                                        
  1461  |    //    TokenList   ÂáÉíÁêÜ„Åô„Çã„Éà„ÉÉV„ÇÉb„ÉÉE„ÉÉF„ÇÉP„Éà                                                                          
  1462  |    //    sPos    TokenList‰∏ä„Åß„ÅÉáÈñãÂÉ@ã‰ÉXçÁÉXÉá                                                                                  
  1463  |    //    ePos    TokenList‰∏ä„Åß„ÅÉáÁµÇ‰ÉRÜ‰ÉXçÁÉXÉá                                                                                  
  1464  |    //    ValDataList Â§âÊï∞„Éá„Éº„ÇÉ\„ÉÉF„ÇÉP„Éà                                                                                      
  1465  |    //                                                                                                                                 
  1466  |    //  3.Ê¶ÇËÉíÅ                                                                                                                      
  1467  |    //    INTEGER„ÇÑREAL„ÅÉF„ÅÉD„ÅÉá„Éá„Éº„ÇÉ\ÂÆÅvË®Ä„ÅÉáÂáÉíÁêÜ„ÇíË°å„Å™„ÅÑ„ÄÅÂÅAâÊï∞„ÉÉF„ÇÉP„Éà„Å´Â§âÊï∞„ÅÉBÂûã„ÇíËøÉXÂä†„Åô         
  1468  |    //    „Çã„ÄÇ                                                                                                                       
  1469  |    //                                                                                                                                 
  1470  |    //  4.Ê©üËÉΩË™ÉÉÊòé                                                                                                                
  1471  |    //    INTEGER„ÇÑREAL„ÅÉF„ÅÉD„ÅÉá„Éá„Éº„ÇÉ\ÂÆÅvË®Ä„ÅÉáÂáÉíÁêÜ„ÇíË°å„Å™„ÅÑ„ÄÅÂÅAâÊï∞„ÉÉF„ÇÉP„Éà„Å´Â§âÊï∞„ÅÉBÂûã„ÇíËøÉXÂä†„Åô         
  1472  |    //    „Çã„ÄÇ                                                                                                                       
  1473  |    //    ValData„ÅÉH„ÅÉb„ÄÅ„Å©„ÅÉá„ÉÅu„ÇÉN„ÉÅE„ÉÉV„ÉÉH„ÅÉ@„ÅÉáÂÆÅvË®Ä„Åã„Åå„ÄÅModuleIdx„Åã„ÇâË®ÉÖÂÆö„Åï„Çå„Çã„ÄÇ                      
  1474  |    //    PARAMETER„ÇíÂê´„ÇÄÂÆÅvË®Ä„ÅÉáÂ†ÉGÂêà„Å´„ÅÉb„ÄÅÂÄÅA„ÅÉáË®àÁÉáó„ÇÇË°å„ÅÜ„ÄÇ                                                    
  1475  |    //    Â§âÊï∞„ÅÉH„ÅÉb„ÄÅModuleIdx„ÇÇ‰É\ùÊåÅ„Åó„Å¶„ÄÅModuleIdx„ÅåÁï∞„ÅÉF„ÇãÂ†ÉGÂêà„ÅØÂàÅEÂ§âÊï∞„ÅÉB„Åô„Çã„ÄÇ                         
  1476  |    //    „Éë„É©„ÉÅB„ÉÉV„ÇÉ\‰ªÅEÂ§ñ„ÅÆÂÆöÊï∞„ÅÉ@„ÅÉá‰ªÅvÂÖÅEÊñá„Å™„ÅÉD„ÅÉb„ÄÅÂÅAâÊï∞„ÅÉB„Åó„Å¶ÊâÉA„ÅÜ„ÄÇÔÉVàÂàÜÂ≤ê,COMMON„ÅÉF„ÅÉD„Åå   
  1477  |    //    „ÅÇ„ÇãÔºâ                                                                                                                    
  1478  |    //                                                                                                                                 
  1479  |    //  5.ÊàÉT„ÇäÂÄÅA                                                                                                                  
  1480  |    //    „ÅÉF„Åó                                                                                                                      
  1481  |    //                                                                                                                                 
  1482  |    //  6.ÂÇôËÄÉ                                                                                                                       
  1483  |    //                                                                                                                                 
  1484  |    /*----------------------------------------------------------------------------*/                                                   
        |  +--------------------------------------------------------------------------------+ 
  1485  +--+ void AddDataDef_Fortran(TList *TokenList,int sPos,int ePos,TList *ValDataList) | 
  1486  |  | {                                                                              | 
        |  +--+-----------------------------------------------------------------------------+ 
  1487  |     +--- int i,j;
  1488  |     +--- TToken *Token;
  1489  |     +--- int TokId;
  1490  |     +--- string TokStr;
  1491  |     +--- bool IntF = false;
  1492  |     +--- bool RealF = false;
  1493  |     +--- bool CharF = false;
  1494  |     +--- bool LogicF = false;
  1495  |     +--- bool ComplexF = false;
  1496  |     +--- bool ParamaterF = false;
  1497  |     +--- bool DimensionF = false;
  1498  |     +--- int UseTokLen;
  1499  |     +--- double dData;
  1500  |     +--- int ArrayLevel = 0;
  1501  |     +--- int ArrayCount[100];
  1502  |     +--- int ArrayStart[100];
  1503  |     +--- int DimAttr_ArrayLevel = 0;     // DimensionÂ±ûÊÄÉ@„ÅÉ@„ÅÉáArrayLevel(DimensionF=true)
  1504  |     +--- int DimAttr_ArrayCount[100];
  1505  |     +--- int DimAttr_ArrayStart[100];
  1506  |     +--- int DataLength = 0;
  1507  |     +--- bool ParamValF;
  1508  |     +--- double ParamData = 0;
  1509  |     +--- string ValName;
  1510  |     +--- int DefPos;
  1511  |     +--- int DefPosS,DefPosE;
  1512  |     +--- int ArrayDefPosS,ArrayDefPosE;
  1513  |     |    
  1514  |     +--- ArrayDefPosS = ArrayDefPosE = -1;
  1515  |     |    
  1516  |     +--- //
  1517  |     |    // ÂÆÅvË®ÄÈÉÉBÂàÜ„ÅÆÂáÉíÁêÜ  
  1518  |     |    //                           
  1519  |     +--- DefPosS = -1;
  1520  |     +--- //  for(i = sPos ; i &lt;= ePos ; i++){
        |     |  +----------------------------------+ 
  1521  |     +--+ for(i = sPos ; i &lt; ePos ; i++){  | 
        |     |  +--+-------------------------------+ 
  1522  |     |     +--- Token = (TToken *)TokenList-&gt;Items[i];
  1523  |     |     +--- TokId = Token-&gt;TokId;
  1524  |     |     +--- TokStr = Token-&gt;Str;
  1525  |     |     |    
        |     |     |  +------------------------------------+ 
  1526  |     |     +--+ switch(TokId){  // ÂÆöÁÉZÉDÈñãÂÉ@ã | 
        |     |     |  +--+---------------------------------+ 
        |     |     |     +---------------------+ 
  1527  |     |     |     |  case tid_INTEGER:  | 
        |     |     |     +---------------------+ 
        |     |     |     +-----------------+ 
  1528  |     |     |     |  case tid_REAL: | 
        |     |     |     +-----------------+ 
        |     |     |     +-----------------------------+ 
  1529  |     |     |     |  case tid_DOUBLEPRECISION:  | 
        |     |     |     +-----------------------------+ 
        |     |     |     +-----------------------+ 
  1530  |     |     |     |  case tid_CHARACTER:  | 
        |     |     |     +-----------------------+ 
        |     |     |     +---------------------+ 
  1531  |     |     |     |  case tid_LOGICAL:  | 
        |     |     |     +---------------------+ 
        |     |     |     +---------------------+ 
  1532  |     |     |     |  case tid_COMPLEX:  | 
        |     |     |     +---------------------+ 
        |     |     |     |  +--------------------+ 
  1533  |     |     |     +--+ if(DefPosS == -1){ | 
        |     |     |     |  +--+-----------------+ 
  1534  |     |     |     |     +--- DefPosS = sPos;
        |     |     |     |   +-+---+ 
  1535  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |     |  +--------+ 
  1536  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-----------------------+ 
  1537  |     |     |     |  case tid_DIMENSION:  | 
        |     |     |     +-----------------------+ 
        |     |     |     |  +--------------------+ 
  1538  |     |     |     +--+ if(DefPosS == -1){ | 
        |     |     |     |  +--+-----------------+ 
  1539  |     |     |     |     +--- DefPosS = sPos;
        |     |     |     |   +-+---+ 
  1540  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |     |  +--------+ 
  1541  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |   +-+---+ 
  1542  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +----------------+ 
  1543  |     |     +--+ switch(TokId){ | 
        |     |     |  +--+-------------+ 
        |     |     |     +---------------------+ 
  1544  |     |     |     |  case tid_INTEGER:  | 
        |     |     |     +---------------------+ 
  1545  |     |     |     +--- IntF = true;
        |     |     |     |  +--------+ 
  1546  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-----------------+ 
  1547  |     |     |     |  case tid_REAL: | 
        |     |     |     +-----------------+ 
  1548  |     |     |     +--- RealF = true;
        |     |     |     |  +--------+ 
  1549  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-----------------------------+ 
  1550  |     |     |     |  case tid_DOUBLEPRECISION:  | 
        |     |     |     +-----------------------------+ 
  1551  |     |     |     +--- RealF = true;
        |     |     |     |  +--------+ 
  1552  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-----------------------+ 
  1553  |     |     |     |  case tid_CHARACTER:  | 
        |     |     |     +-----------------------+ 
  1554  |     |     |     +--- CharF = true;
        |     |     |     |  +--------+ 
  1555  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +---------------------+ 
  1556  |     |     |     |  case tid_LOGICAL:  | 
        |     |     |     +---------------------+ 
  1557  |     |     |     +--- LogicF = true;
        |     |     |     |  +--------+ 
  1558  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +---------------------+ 
  1559  |     |     |     |  case tid_COMPLEX:  | 
        |     |     |     +---------------------+ 
  1560  |     |     |     +--- ComplexF = true;
        |     |     |     |  +--------+ 
  1561  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-----------------------+ 
  1562  |     |     |     |  case tid_DIMENSION:  | 
        |     |     |     +-----------------------+ 
  1563  |     |     |     +--- //
  1564  |     |     |     |    //  F90„ÅÉHÂØÉZÂøú„Åô„Çã„Åü„ÇÅ„ÄÅÊÉÉÅB„Åå(„ÅÉáÂ†ÉGÂêà„Å´„ÅÉb„ÄÅDimensionÂ±ûÊÄÉ@„ÅÉB„Åó„Å¶ÊâÉA„ÅÜ„ÄÇ  
  1565  |     |     |     |    //  („ÅÉ@„ÅÉF„ÅÑÂ†ÉGÂêà„ÅØ„ÄÅDIMENSIONÊñá„Å®„ÅÉF„Çã„ÄÇ  2007/1/19                                    
  1566  |     |     |     |    //  „ÅÉZ„Åü„ÄÅÂÉáöÊï∞„ÅÉ@„ÅÉF„ÅÑÂ†ÉGÂêà„ÇÇOKÔºà„Éá„Éï„Ç©„ÉÉH„Éà„ÅÆÂÄÅAÔºâ„Å®„Åô„Çã„ÄÇ                
  1567  |     |     |     |    //                                                                                                   
        |     |     |     |  +------------------------------------------------------------------+ 
  1568  |     |     |     +--+ if((i+1 &lt; TokenList-&gt;Count)                                      | 
  1569  |     |     |     |  |     &amp;&amp;(((TToken *)TokenList-&gt;Items[i+1])-&gt;TokId == tid_Kakko)){  | 
        |     |     |     |  +--+---------------------------------------------------------------+ 
  1570  |     |     |     |     +--- int TokId2;
  1571  |     |     |     |     +--- string TokStr2;
  1572  |     |     |     |     |    
  1573  |     |     |     |     +--- DimensionF = true;
  1574  |     |     |     |     +--- i+=2;
  1575  |     |     |     |     +--- //
  1576  |     |     |     |     |    // )„ÅÉZ„ÅÉ@„ÇíÂÉbÉZË±ÅB„ÅÉB„ÅÉF„Çä„ÄÅDim_ArrayLevel„ÇíÊÉAÇ„ÇÅ„Çã„ÄÇ   
  1577  |     |     |     |     |    //                                                                     
  1578  |     |     |     |     |    //  Exp: DIMENSION(1:3,2) Á≠â                                          
  1579  |     |     |     |     |    //                                                                     
        |     |     |     |     |  +----------------------------------------------------------------------------+ 
  1580  |     |     |     |     +--+ while((i &lt; ePos)&amp;&amp;(((TToken *)TokenList-&gt;Items[i])-&gt;TokId != tid_Kokka)){  | 
        |     |     |     |     |  +--+-------------------------------------------------------------------------+ 
  1581  |     |     |     |     |     +--- TokId2 = ((TToken *)TokenList-&gt;Items[i])-&gt;TokId;
  1582  |     |     |     |     |     +--- TokStr2 = ((TToken *)TokenList-&gt;Items[i])-&gt;Str;
        |     |     |     |     |     |  +------------------------------------------------------------+ 
  1583  |     |     |     |     |     +--+ if(TokId2 == tid_Koron){    // ÂÖàÈ†ÉÖ„ÅÉF„Åó„ÄÄExp. (:3)  | 
        |     |     |     |     |     |  +--+---------------------------------------------------------+ 
  1584  |     |     |     |     |     |     +--- i++;
        |     |     |     |     |     |   +-+---+ 
  1585  |     |     |     |     |     |   |  }  | 
        |     |     |     |     |     |   +-----+ 
  1586  |     |     |     |     |     +--- // ÊïÅ[ÂÄÅA„ÅÉáÂáÉíÁêÜ
  1587  |     |     |     |     |     +--- UseTokLen = Eval(TokenList,i,ePos,ValDataList,&amp;dData);
        |     |     |     |     |     |  +------------------+ 
  1588  |     |     |     |     |     +--+ if(!EvalConstF){ | 
        |     |     |     |     |     |  +--+---------------+ 
  1589  |     |     |     |     |     |     +--- //                      ErrMsg(TokenList,i,&quot;ÂÆÅvË®ÄÈÉÉB„ÇÉB„ÉÉD„ÉÉV&quot;);
  1590  |     |     |     |     |     |     +--- dData = 0;
        |     |     |     |     |     |   +-+---+ 
  1591  |     |     |     |     |     |   |  }  | 
        |     |     |     |     |     |   +-----+ 
  1592  |     |     |     |     |     +--- i += UseTokLen;
  1593  |     |     |     |     |     +--- TokId2 = ((TToken *)TokenList-&gt;Items[i])-&gt;TokId;
  1594  |     |     |     |     |     +--- TokStr2 = ((TToken *)TokenList-&gt;Items[i])-&gt;Str;
        |     |     |     |     |     |  +--------------------------------------------------------+ 
  1595  |     |     |     |     |     +--+ if(TokId2 == tid_Koron){    // ÂÖàÈ†ÉÖ„ÅÇ„Çä Exp (1:3) | 
        |     |     |     |     |     |  +--+-----------------------------------------------------+ 
  1596  |     |     |     |     |     |     +--- DimAttr_ArrayStart[DimAttr_ArrayLevel] = (int)dData;
  1597  |     |     |     |     |     |     +--- i++;
  1598  |     |     |     |     |     |     +--- TokId2 = ((TToken *)TokenList-&gt;Items[i])-&gt;TokId;
  1599  |     |     |     |     |     |     +--- TokStr2 = ((TToken *)TokenList-&gt;Items[i])-&gt;Str;
  1600  |     |     |     |     |     |     +--- UseTokLen = Eval(TokenList,i,ePos,ValDataList,&amp;dData);
        |     |     |     |     |     |     |  +------------------+ 
  1601  |     |     |     |     |     |     +--+ if(!EvalConstF){ | 
        |     |     |     |     |     |     |  +--+---------------+ 
  1602  |     |     |     |     |     |     |     +--- //                          ErrMsg(TokenList,i,&quot;ÂÆÅvË®ÄÈÉÉB„ÇÉB„ÉÉD„ÉÉV&quot;);
  1603  |     |     |     |     |     |     |     +--- dData = 0;
        |     |     |     |     |     |     |   +-+---+ 
  1604  |     |     |     |     |     |     |   |  }  | 
        |     |     |     |     |     |     |   +-----+ 
  1605  |     |     |     |     |     |     +--- i += UseTokLen;
  1606  |     |     |     |     |     |     +--- DimAttr_ArrayCount[DimAttr_ArrayLevel] = (int)dData-
  1607  |     |     |     |     |     |     |        DimAttr_ArrayStart[DimAttr_ArrayLevel] + 1;      
        |     |     |     |     |     |   +-+---+ 
  1608  |     |     |     |     |     |   |  }  | 
        |     |     |     |     |     |   +-+---+ 
        |     |     |     |     |     |   +-+-------+ 
  1608  |     |     |     |     |     |   |  else{  | 
        |     |     |     |     |     |   +-+-------+ 
  1609  |     |     |     |     |     |     +--- DimAttr_ArrayStart[DimAttr_ArrayLevel] = 1;
  1610  |     |     |     |     |     |     +--- DimAttr_ArrayCount[DimAttr_ArrayLevel] = (int)dData;
        |     |     |     |     |     |   +-+---+ 
  1611  |     |     |     |     |     |   |  }  | 
        |     |     |     |     |     |   +-----+ 
  1612  |     |     |     |     |     +--- TokId2 = ((TToken *)TokenList-&gt;Items[i])-&gt;TokId;
  1613  |     |     |     |     |     +--- TokStr2 = ((TToken *)TokenList-&gt;Items[i])-&gt;Str;
        |     |     |     |     |     |  +----------------------------+ 
  1614  |     |     |     |     |     +--+ if(TokId2 == tid_Kannma){  | 
        |     |     |     |     |     |  +--+-------------------------+ 
  1615  |     |     |     |     |     |     +--- DimAttr_ArrayLevel++;
        |     |     |     |     |     |   +-+---+ 
  1616  |     |     |     |     |     |   |  }  | 
        |     |     |     |     |     |   +-+---+ 
        |     |     |     |     |     |   +-+-------------------------------+ 
  1616  |     |     |     |     |     |   |  else if(TokId2 == tid_Kokka){  | 
        |     |     |     |     |     |   +-+-------------------------------+ 
  1617  |     |     |     |     |     |     +--- DimAttr_ArrayLevel++;
        |     |     |     |     |     |     |  +--------+ 
  1618  |     |     |     |     |     |     +--+ break; | 
        |     |     |     |     |     |     |  +--------+ 
        |     |     |     |     |     |   +-+---+ 
  1619  |     |     |     |     |     |   |  }  | 
        |     |     |     |     |     |   +-----+ 
  1620  |     |     |     |     |     +--- i++;
        |     |     |     |     |   +-+---+ 
  1621  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |   +-+---+ 
  1622  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |     |  +--------+ 
  1623  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-----------------------+ 
  1624  |     |     |     |  case tid_PARAMETER:  | 
        |     |     |     +-----------------------+ 
  1625  |     |     |     +--- ParamaterF = true;
        |     |     |     |  +--------+ 
  1626  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +---------------------------------------------------------------------------------------------------------+ 
  1627  |     |     |     |  case tid_INTENT: // ()„Çí„Çπ„ÇÉÖ„ÉÉ„Éó„Åô„Çã„ÄÇ INTENT (OUT) „ÅÉ@ OUT„ÇíÂÅAâÊï∞ÊâÉA„ÅÑ„Åó„ÅÉF„ÅÑ„Åü„ÇÅ | 
        |     |     |     +---------------------------------------------------------------------------------------------------------+ 
        |     |     |     |  +------------------------+ 
  1628  |     |     |     +--+ for(; i &lt; ePos ; i++){ | 
        |     |     |     |  +--+---------------------+ 
  1629  |     |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[i];
        |     |     |     |     |  +--------------------------------------------------------------------+ 
  1630  |     |     |     |     +--+ if(Token-&gt;TokId == tid_Kokka){ // Ê¨ÅB„ÅÉá ) „ÅÉZ„ÅÉ@ÈÄÉC„ÇÅ„Çã„ÄÇ | 
        |     |     |     |     |  +--+-----------------------------------------------------------------+ 
        |     |     |     |     |     |  +--------+ 
  1631  |     |     |     |     |     +--+ break; | 
        |     |     |     |     |     |  +--------+ 
        |     |     |     |     |   +-+---+ 
  1632  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |   +-+---+ 
  1633  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |     |  +--------+ 
  1634  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +---------------------------------------------------+ 
  1635  |     |     |     |  case tid_ALLOCATABLE:   // „Åù„ÅÆ‰ªñ„ÅÆÂÆöÁÉZÉD  | 
        |     |     |     +---------------------------------------------------+ 
        |     |     |     +---------------------+ 
  1636  |     |     |     |  case tid_POINTER:  | 
        |     |     |     +---------------------+ 
        |     |     |     +-------------------+ 
  1637  |     |     |     |  case tid_TARGET: | 
        |     |     |     +-------------------+ 
        |     |     |     +-----------------+ 
  1638  |     |     |     |  case tid_SAVE: | 
        |     |     |     +-----------------+ 
        |     |     |     +---------------------+ 
  1639  |     |     |     |  case tid_PRIVATE:  | 
        |     |     |     +---------------------+ 
        |     |     |     +-------------------+ 
  1640  |     |     |     |  case tid_PUBLIC: | 
        |     |     |     +-------------------+ 
        |     |     |     +---------------------+ 
  1641  |     |     |     |  case tid_EXTERNAL: | 
        |     |     |     +---------------------+ 
        |     |     |     +-----------------------+ 
  1642  |     |     |     |  case tid_INTRINSIC:  | 
        |     |     |     +-----------------------+ 
  1643  |     |     |     +--- //      case tid_INTENT:
        |     |     |     +---------------------+ 
  1644  |     |     |     |  case tid_OPTIONAL: | 
        |     |     |     +---------------------+ 
        |     |     |     |  +--------+ 
  1645  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +---------------------------+ 
  1646  |     |     |     |  case tid_Kannma:    // , | 
        |     |     |     +---------------------------+ 
  1647  |     |     |     +--- // ,„ÅÉb„ÄÅArrayLevel„Çí Up„Åô„Çã„ÄÇ
  1648  |     |     |     +--- ArrayLevel++;
        |     |     |     |  +--------+ 
  1649  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +---------------------------------+ 
  1650  |     |     |     |  case tid_KoronKoron:    // ::  | 
        |     |     |     +---------------------------------+ 
  1651  |     |     |     +--- // ÂÆÅvË®ÄÈÉÉBÂàÜÁÉIÇ‰ÉRÜ
  1652  |     |     |     +--- sPos = i+1;
  1653  |     |     |     +--- i = ePos+1;
        |     |     |     |  +--------+ 
  1654  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-----------------------+ 
  1655  |     |     |     |  case tid_Kakko: // ( | 
        |     |     |     +-----------------------+ 
  1656  |     |     |     +--- //
  1657  |     |     |     |    // (Len=xx) „ÇÑ (xx,xx)„ÅÉ@ÈÖçÂàóË¶ÅÁÉG†ÊïÅ[„ÇíÊåáÂÆö„ÄÄ')'„ÅÉZ„ÅÉ@„ÅÉáÂáÉíÁêÜ„ÇíË°å„ÅÜ„ÄÇ   
  1658  |     |     |     |    // „Åü„Å†„Åó„ÄÅPARAMETER„ÅÉáÁõÉGÂæå„ÅØ„ÄÅ()„ÅÉb„Éë„É©„ÉÅB„ÉÉV„ÇÉ\„ÅÉáË®ÉÖÂÆö„Å´„ÅÉF„Çã„ÄÇ    
  1659  |     |     |     |    //                                                                                           
        |     |     |     |  +----------------------------------------------------------------+ 
  1660  |     |     |     +--+ if(((TToken *)TokenList-&gt;Items[i-1])-&gt;TokId == tid_PARAMETER){ | 
        |     |     |     |  +--+-------------------------------------------------------------+ 
  1661  |     |     |     |     +--- // ÂÆÅvË®ÄÈÉÉBÂàÜÁÉIÇ‰ÉRÜ
  1662  |     |     |     |     +--- sPos = i+1;
  1663  |     |     |     |     +--- i = ePos+1;
        |     |     |     |   +-+---+ 
  1664  |     |     |     |   |  }  | 
        |     |     |     |   +-+---+ 
        |     |     |     |   +-+-------+ 
  1664  |     |     |     |   |  else{  | 
        |     |     |     |   +-+-------+ 
  1665  |     |     |     |     +--- // (Len=xx)„Åã (xx,xx) Ê≥ÉB:xx„ÅÉb„ÄÅPARAMETER„ÅÉ@„ÅÉáÂÄÅA„ÇÇÂèØËÉÉX
  1666  |     |     |     |     +--- i++;
  1667  |     |     |     |     +--- //              if((AnsiCompareText(((TToken *)TokenList-&gt;Items[i])-&gt;Str,&quot;LEN&quot;) == 0)
        |     |     |     |     |  +----------------------------------------------------------------+ 
  1668  |     |     |     |     +--+ if((LowerCase(((TToken *)TokenList-&gt;Items[i])-&gt;Str) == &quot;len&quot;)  | 
  1669  |     |     |     |     |  |     &amp;&amp;(((TToken *)TokenList-&gt;Items[i+1])-&gt;TokId == tid_Set)){  | 
        |     |     |     |     |  +--+-------------------------------------------------------------+ 
  1670  |     |     |     |     |     +--- // Len = „ÅÉáÂáÉíÁêÜ
  1671  |     |     |     |     |     +--- i++;
        |     |     |     |     |   +-+---+ 
  1672  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
  1673  |     |     |     |     +--- //              if((AnsiCompareText(((TToken *)TokenList-&gt;Items[i])-&gt;Str,&quot;KIND&quot;) == 0)
        |     |     |     |     |  +----------------------------------------------------------------+ 
  1674  |     |     |     |     +--+ if((LowerCase(((TToken *)TokenList-&gt;Items[i])-&gt;Str) == &quot;kind&quot;) | 
  1675  |     |     |     |     |  |     &amp;&amp;(((TToken *)TokenList-&gt;Items[i+1])-&gt;TokId == tid_Set)){  | 
        |     |     |     |     |  +--+-------------------------------------------------------------+ 
  1676  |     |     |     |     |     +--- // KIND = „ÅÉáÂáÉíÁêÜ
  1677  |     |     |     |     |     +--- i++;
        |     |     |     |     |   +-+---+ 
  1678  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
  1679  |     |     |     |     +--- // ÊïÅ[ÂÄÅA„ÅÉáÂáÉíÁêÜ
  1680  |     |     |     |     +--- UseTokLen = Eval(TokenList,i,ePos,ValDataList,&amp;dData);
        |     |     |     |     |  +------------------+ 
  1681  |     |     |     |     +--+ if(!EvalConstF){ | 
        |     |     |     |     |  +--+---------------+ 
  1682  |     |     |     |     |     +--- //                  ErrMsg(TokenList,i,&quot;ÂÆÅvË®ÄÈÉÉB„ÇÉB„ÉÉD„ÉÉV&quot;);
  1683  |     |     |     |     |     +--- dData = 0;
        |     |     |     |     |   +-+---+ 
  1684  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
  1685  |     |     |     |     +--- i += UseTokLen;
  1686  |     |     |     |     +--- DataLength = (int)dData; // ÊñáÂÉÖóÂàóÈïÉL„Åï„ÅØ„ÄÅDataLength
        |     |     |     |   +-+---+ 
  1687  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |     |  +--------+ 
  1688  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-----------+ 
  1689  |     |     |     |  default: | 
        |     |     |     +-----------+ 
        |     |     |     |  +--------------------+ 
  1690  |     |     |     +--+ if(TokStr == &quot;*&quot;){ | 
        |     |     |     |  +--+-----------------+ 
  1691  |     |     |     |     +--- // REAL*8 „ÇÑ INTEGER*4 „ÅÉF„ÅÉD„ÅÉáÂáÉíÁêÜ
  1692  |     |     |     |     +--- i++;
  1693  |     |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[i];
        |     |     |     |     |  +------------------------------------+ 
  1694  |     |     |     |     +--+ if(Token-&gt;TokId == tid_ConstInt){  | 
        |     |     |     |     |  +--+---------------------------------+ 
  1695  |     |     |     |     |     +--- DataLength = (int)Token-&gt;dData; // ÊñáÂÉÖóÂàóÈïÉL„Åï„ÅØ„ÄÅDataLength
        |     |     |     |     |   +-+---+ 
  1696  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
  1697  |     |     |     |     |    
        |     |     |     |   +-+---+ 
  1698  |     |     |     |   |  }  | 
        |     |     |     |   +-+---+ 
        |     |     |     |   +-+-------+ 
  1698  |     |     |     |   |  else{  | 
        |     |     |     |   +-+-------+ 
  1699  |     |     |     |     +--- // ÂÆÅvË®ÄÈÉÉBÂàÜÁÉIÇ‰ÉRÜ
  1700  |     |     |     |     +--- sPos = i;
  1701  |     |     |     |     +--- i = ePos+1;
        |     |     |     |   +-+---+ 
  1702  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |   +-+---+ 
  1703  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +------------------------------------+ 
  1704  |     |     +--+ switch(TokId){  // ÂÆöÁÉZÉDÈñãÂÉ@ã | 
        |     |     |  +--+---------------------------------+ 
        |     |     |     +---------------------+ 
  1705  |     |     |     |  case tid_INTEGER:  | 
        |     |     |     +---------------------+ 
        |     |     |     +-----------------+ 
  1706  |     |     |     |  case tid_REAL: | 
        |     |     |     +-----------------+ 
        |     |     |     +-----------------------------+ 
  1707  |     |     |     |  case tid_DOUBLEPRECISION:  | 
        |     |     |     +-----------------------------+ 
        |     |     |     +-----------------------+ 
  1708  |     |     |     |  case tid_CHARACTER:  | 
        |     |     |     +-----------------------+ 
        |     |     |     +---------------------+ 
  1709  |     |     |     |  case tid_LOGICAL:  | 
        |     |     |     +---------------------+ 
        |     |     |     +---------------------+ 
  1710  |     |     |     |  case tid_COMPLEX:  | 
        |     |     |     +---------------------+ 
  1711  |     |     |     +--- // ÂÆÅvË®Ä„ÅÉáÊ¨ÅB„Åå ( „ÅÉáÂ†ÉGÂêà„ÅØ„ÄÅ )„ÅÉZ„ÅÉ@„ÅÉb Á®ÉáÂàÅE(KIND)„ÅÉF„ÅÉá„ÅÉ@„ÇÉP„ÇÉÖ„ÉÉ„Éó„Åô„Çã„ÄÇ
        |     |     |     |  +----------------------------------------------------------------------------+ 
  1712  |     |     |     +--+ if((i+1&lt; ePos)&amp;&amp;(((TToken *)TokenList-&gt;Items[i+1])-&gt;TokId == tid_Kakko)){  | 
        |     |     |     |  +--+-------------------------------------------------------------------------+ 
  1713  |     |     |     |     +--- int brLevel = 0;
        |     |     |     |     |  +------------------------+ 
  1714  |     |     |     |     +--+ for(; i &lt; ePos ; i++){ | 
        |     |     |     |     |  +--+---------------------+ 
  1715  |     |     |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[i];
        |     |     |     |     |     |  +--------------------------------+ 
  1716  |     |     |     |     |     +--+ if(Token-&gt;TokId == tid_Kakko){ | 
        |     |     |     |     |     |  +--+-----------------------------+ 
  1717  |     |     |     |     |     |     +--- brLevel++;
        |     |     |     |     |     |   +-+---+ 
  1718  |     |     |     |     |     |   |  }  | 
        |     |     |     |     |     |   +-----+ 
        |     |     |     |     |     |  +--------------------------------+ 
  1719  |     |     |     |     |     +--+ if(Token-&gt;TokId == tid_Kokka){ | 
        |     |     |     |     |     |  +--+-----------------------------+ 
  1720  |     |     |     |     |     |     +--- brLevel--;
        |     |     |     |     |     |     |  +--------------------+ 
  1721  |     |     |     |     |     |     +--+ if(brLevel == 0){  | 
        |     |     |     |     |     |     |  +--+-----------------+ 
        |     |     |     |     |     |     |     |  +--------+ 
  1722  |     |     |     |     |     |     |     +--+ break; | 
        |     |     |     |     |     |     |     |  +--------+ 
        |     |     |     |     |     |     |   +-+---+ 
  1723  |     |     |     |     |     |     |   |  }  | 
        |     |     |     |     |     |     |   +-----+ 
        |     |     |     |     |     |   +-+---+ 
  1724  |     |     |     |     |     |   |  }  | 
        |     |     |     |     |     |   +-----+ 
        |     |     |     |     |   +-+---+ 
  1725  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |   +-+---+ 
  1726  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |   +-+---+ 
  1727  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |   +-+---+ 
  1728  |     |   |  }  | 
        |     |   +-----+ 
  1729  |     +--- DefPosE = sPos;
  1730  |     +--- //
  1731  |     |    // Â§âÊï∞ÈÉÉBÂàÜ„ÅÆÂáÉíÁêÜ                                                                       
  1732  |     |    // Â§âÊï∞„ÅÉáÂÆöÁÉZÉD„ÇíËÉ\ÉXÂä†„Åô„Çã„ÄÇÂÉáÅvË®ÄÔºàPARAMETER„ÇíÂê´„ÇÄÔºâ„ÅÆ„ÅÉ\„ÅåÂÉbÉZË±ÅB„ÄÇ  
  1733  |     |    //  „ÇÇ„Åó„ÄÅÂÅAâÊï∞Âêç„ÅÆ„ÅÉ\„ÅÉ@„ÄÅDimensonF=treu(DimensionÂ±ûÊÄÉ@„ÅÇ„ÇäÔºâ„ÅÆÂ†ÉGÂêà„ÅØ„ÄÅ    
  1734  |     |    //  Dim_ArrayLevelÁ≠â„Çí‰ΩÉ\ÁîÉB„Åô„Çã„ÄÇ Add 2007/01/18                                         
  1735  |     |    //                                                                                               
  1736  |     +--- //  for(i = sPos ; i &lt;= ePos ; i++){
        |     |  +----------------------------------+ 
  1737  |     +--+ for(i = sPos ; i &lt; ePos ; i++){  | 
        |     |  +--+-------------------------------+ 
  1738  |     |     +--- Token = (TToken *)TokenList-&gt;Items[i];
  1739  |     |     +--- TokId = Token-&gt;TokId;
  1740  |     |     +--- TokStr = Token-&gt;Str;
  1741  |     |     |    
        |     |     |  +------------------------------------+ 
  1742  |     |     +--+ if(TokId == tid_ContinuedLineStr){ | 
        |     |     |  +--+---------------------------------+ 
        |     |     |     |  +------------+ 
  1743  |     |     |     +--+ continue;  | 
        |     |     |     |  +------------+ 
        |     |     |   +-+---+ 
  1744  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +----------------------------------------------------------------------+ 
  1745  |     |     +--+ if(TokId != tid_Val){   // Â§âÊï∞„Éà„Éº„ÇÉb„ÉÉE„ÅÉá„ÅÉ\„ÅåÂÉbÉZË±ÅB  | 
        |     |     |  +--+-------------------------------------------------------------------+ 
        |     |     |     |  +--------+ 
  1746  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |   +-+---+ 
  1747  |     |     |   |  }  | 
        |     |     |   +-----+ 
  1748  |     |     +--- DefPos = i;
  1749  |     |     +--- ValName = TokStr;
  1750  |     |     +--- i++;
  1751  |     |     +--- Token = (TToken *)TokenList-&gt;Items[i];
  1752  |     |     +--- TokId = Token-&gt;TokId;
  1753  |     |     +--- TokStr = Token-&gt;Str;
  1754  |     |     +--- ArrayLevel = 0;
        |     |     |  +--------------------+ 
  1755  |     |     +--+ if(TokStr == &quot;(&quot;){ | 
        |     |     |  +--+-----------------+ 
  1756  |     |     |     +--- //
  1757  |     |     |     |    // ÈÖçÂàóÂÆÅvË®Ä„ÅÉáÊ∑ÉT„ÅàÂÉÖó„ÅÆÂáÉíÁêÜ  
  1758  |     |     |     |    // REAL D(3,4)                             
  1759  |     |     |     |    //                                         
  1760  |     |     |     +--- ArrayDefPosS = i;
  1761  |     |     |     +--- i++;
        |     |     |     |  +--------------+ 
  1762  |     |     |     +--+ while(true){ | 
        |     |     |     |  +--+-----------+ 
  1763  |     |     |     |     +--- UseTokLen = Eval(TokenList,i,ePos,ValDataList,&amp;dData);
        |     |     |     |     |  +------------------+ 
  1764  |     |     |     |     +--+ if(!EvalConstF){ | 
        |     |     |     |     |  +--+---------------+ 
  1765  |     |     |     |     |     +--- i += UseTokLen;
  1766  |     |     |     |     |     +--- ArrayStart[ArrayLevel] = 1;
  1767  |     |     |     |     |     +--- ArrayCount[ArrayLevel] = 0;
        |     |     |     |     |   +-+---+ 
  1768  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-+---+ 
        |     |     |     |     |   +-+-------+ 
  1768  |     |     |     |     |   |  else{  | 
        |     |     |     |     |   +-+-------+ 
  1769  |     |     |     |     |     +--- i += UseTokLen;
  1770  |     |     |     |     |     +--- ArrayCount[ArrayLevel] = (int)dData;
  1771  |     |     |     |     |     +--- ArrayStart[ArrayLevel] = 1;
  1772  |     |     |     |     |     +--- //                  if(((TToken *)TokenList-&gt;Items[i+1])-&gt;TokId == tid_Koron){
        |     |     |     |     |     |  +----------------------------------------------------------+ 
  1773  |     |     |     |     |     +--+ if(((TToken *)TokenList-&gt;Items[i])-&gt;TokId == tid_Koron){ | 
        |     |     |     |     |     |  +--+-------------------------------------------------------+ 
  1774  |     |     |     |     |     |     +--- // : „ÇíÂê´„Çì„Å†ÂÆÅvË®Ä„ÅÉáÂáÉíÁêÜ
  1775  |     |     |     |     |     |     +--- i++;
  1776  |     |     |     |     |     |     +--- ArrayStart[ArrayLevel] = ArrayCount[ArrayLevel];
  1777  |     |     |     |     |     |     +--- UseTokLen = Eval(TokenList,i,ePos,ValDataList,&amp;dData);
        |     |     |     |     |     |     |  +------------------+ 
  1778  |     |     |     |     |     |     +--+ if(!EvalConstF){ | 
        |     |     |     |     |     |     |  +--+---------------+ 
  1779  |     |     |     |     |     |     |     +--- i += UseTokLen;
  1780  |     |     |     |     |     |     |     +--- ArrayCount[ArrayLevel] = 0;
        |     |     |     |     |     |     |   +-+---+ 
  1781  |     |     |     |     |     |     |   |  }  | 
        |     |     |     |     |     |     |   +-+---+ 
        |     |     |     |     |     |     |   +-+-------+ 
  1781  |     |     |     |     |     |     |   |  else{  | 
        |     |     |     |     |     |     |   +-+-------+ 
  1782  |     |     |     |     |     |     |     +--- i += UseTokLen;
  1783  |     |     |     |     |     |     |     +--- ArrayCount[ArrayLevel] = (int)dData - ArrayStart[ArrayLevel]+1;
        |     |     |     |     |     |     |   +-+---+ 
  1784  |     |     |     |     |     |     |   |  }  | 
        |     |     |     |     |     |     |   +-----+ 
        |     |     |     |     |     |   +-+---+ 
  1785  |     |     |     |     |     |   |  }  | 
        |     |     |     |     |     |   +-----+ 
        |     |     |     |     |   +-+---+ 
  1786  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
  1787  |     |     |     |     +--- ArrayLevel++;
  1788  |     |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[i];
  1789  |     |     |     |     +--- TokId = Token-&gt;TokId;
  1790  |     |     |     |     +--- TokStr = Token-&gt;Str;
        |     |     |     |     |  +--------------------------+ 
  1791  |     |     |     |     +--+ if(TokId != tid_Kannma){ | 
        |     |     |     |     |  +--+-----------------------+ 
        |     |     |     |     |     |  +--------+ 
  1792  |     |     |     |     |     +--+ break; | 
        |     |     |     |     |     |  +--------+ 
        |     |     |     |     |   +-+---+ 
  1793  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
  1794  |     |     |     |     +--- i++;
        |     |     |     |   +-+---+ 
  1795  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
  1796  |     |     |     +--- ArrayDefPosE = i+1;
        |     |     |   +-+---+ 
  1797  |     |     |   |  }  | 
        |     |     |   +-----+ 
  1798  |     |     +--- //
  1799  |     |     |    //  „ÇÇ„Åó„ÄÅÈÖçÂàóÂÉáÅvË®Ä„ÅÉF„Åó„ÅÆÂ§âÊï∞Âêç„ÅÆ„ÅÉ\„ÅÉ@„ÄÅDimensionÂ±ûÊÄÉ@„ÅÇ„Çä„ÅÉáÂ†ÉGÂêà„ÅØ„ÄÅ  
  1800  |     |     |    //  DimensionÂ±ûÊÄÉ@„Çí„Çª„ÉÉ„Éà„Åô„Çã„ÄÇ                                                            
  1801  |     |     |    //  Add 2007/01/19                                                                                   
  1802  |     |     |    //                                                                                                   
        |     |     |  +--------------------------------------+ 
  1803  |     |     +--+ if((ArrayLevel == 0)&amp;&amp;(DimensionF)){ | 
        |     |     |  +--+-----------------------------------+ 
  1804  |     |     |     +--- ArrayLevel = DimAttr_ArrayLevel;
  1805  |     |     |     +--- memcpy(ArrayStart,DimAttr_ArrayStart,sizeof(ArrayStart));
  1806  |     |     |     +--- memcpy(ArrayCount,DimAttr_ArrayCount,sizeof(ArrayCount));
        |     |     |   +-+---+ 
  1807  |     |     |   |  }  | 
        |     |     |   +-----+ 
  1808  |     |     +--- //
  1809  |     |     |    // „Éë„É©„ÉÅB„ÉÉV„ÇÉ\Êñá„ÅÆÂ†ÉGÂêà„ÅØ„ÄÅ„ÄÄxxx = xxx „ÅÉ@„ÅÉáÂÄÅA„ÇíÊâÄÂæó„Åô„Çã„ÄÇ                                
  1810  |     |     |    // „ÇÇ„Åó„Éë„É©„ÉÅB„ÉÉV„ÇÉ\Êñá„Åß„ÅÉF„ÅÑÂ†ÉGÂêà„ÅØ„ÄÅÂàùÊúüÂÄÅA„ÅÉF„ÅÉá„ÅÉ@„ÇÉH„ÉÉE„Éû„Åæ„ÅÉ@Ë™ÉÖ„ÅÉ\È£õ„Å∞„Åô„ÄÇ  
  1811  |     |     |    //                                                                                                                 
  1812  |     |     +--- Token = (TToken *)TokenList-&gt;Items[i];
  1813  |     |     +--- TokId = Token-&gt;TokId;
  1814  |     |     +--- ParamValF = false;
        |     |     |  +------------------------+ 
  1815  |     |     +--+ if(TokId == tid_Set){  | 
        |     |     |  +--+---------------------+ 
  1816  |     |     |     +--- UseTokLen = 0;
        |     |     |     |  +------------------+ 
  1817  |     |     |     +--+ if(ParamaterF){  | 
        |     |     |     |  +--+---------------+ 
  1818  |     |     |     |     +--- i++;
  1819  |     |     |     |     +--- UseTokLen = Eval(TokenList,i,ePos,ValDataList,&amp;dData);
        |     |     |     |     |  +------------------+ 
  1820  |     |     |     |     +--+ if(EvalConstF){  | 
        |     |     |     |     |  +--+---------------+ 
  1821  |     |     |     |     |     +--- ParamValF = true;
  1822  |     |     |     |     |     +--- ParamData = dData;
        |     |     |     |     |   +-+---+ 
  1823  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
  1824  |     |     |     |     +--- i += UseTokLen;
        |     |     |     |   +-+---+ 
  1825  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |     |  +----------------------+ 
  1826  |     |     |     +--+ if(UseTokLen &lt;= 0){  | 
        |     |     |     |  +--+-------------------+ 
  1827  |     |     |     |     +--- //              for( ; i &lt;= ePos ; i++){
        |     |     |     |     |  +--------------------------+ 
  1828  |     |     |     |     +--+ for( ; i &lt; ePos ; i++){  | 
        |     |     |     |     |  +--+-----------------------+ 
        |     |     |     |     |     |  +------------------------------------------------------------+ 
  1829  |     |     |     |     |     +--+ if(((TToken *)TokenList-&gt;Items[i])-&gt;TokId == tid_Kannma){  | 
        |     |     |     |     |     |  +--+---------------------------------------------------------+ 
        |     |     |     |     |     |     |  +--------+ 
  1830  |     |     |     |     |     |     +--+ break; | 
        |     |     |     |     |     |     |  +--------+ 
        |     |     |     |     |     |   +-+---+ 
  1831  |     |     |     |     |     |   |  }  | 
        |     |     |     |     |     |   +-----+ 
        |     |     |     |     |   +-+---+ 
  1832  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |   +-+---+ 
  1833  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |   +-+---+ 
  1834  |     |     |   |  }  | 
        |     |     |   +-----+ 
  1835  |     |     +--- //
  1836  |     |     |    // „Åô„Åß„ÅÉH„ÄÅÂêå„ÅòMoudelIdx„ÅÉ@„ÄÅÂÉáÅvË®Ä„Åï„Çå„ÅÉí„ÅÑ„ÇãÂêåÂêçÂ§âÊï∞„Åå„ÅÇ„Çã„Åã„ÇíËÉFÉ\„ÅÉP„Çã„ÄÇ           
  1837  |     |     |    // „ÅÇ„Çå„ÅÅ[„ÄÅËÉ\ÉXÂä†„Åó„Å™„ÅÑ„ÄÇÔÉVàÂûã„ÅÉá‰∏ÄËáÉG„Åã„Å©„ÅÜ„Åã„ÅÉáÂàÅAÂÆö„ÅØ„ÄÅ„Ç≥„ÉÉE„Éë„Ç§„ÉÉD„ÅÉZ„Åã„ÅõÔºâ  
  1838  |     |     |    //                                                                                                                 
  1839  |     |     +--- TValData *ValData;
  1840  |     |     +--- bool NewValDataF = true;
  1841  |     |     |    
        |     |     |  +--------------------------------------------+ 
  1842  |     |     +--+ for(j = 0 ; j &lt; ValDataList-&gt;Count ; j++){ | 
        |     |     |  +--+-----------------------------------------+ 
  1843  |     |     |     +--- ValData = (TValData *)ValDataList-&gt;Items[j];
  1844  |     |     |     +--- //          if((AnsiCompareText(ValData-&gt;Str,ValName) == 0)&amp;&amp;
        |     |     |     |  +------------------------------------------------------+ 
  1845  |     |     |     +--+ if((LowerCase(ValData-&gt;Str) == LowerCase(ValName))&amp;&amp; | 
  1846  |     |     |     |  |     (ValData-&gt;ModuleIdx == Token-&gt;ModuleIdx)){       | 
        |     |     |     |  +--+---------------------------------------------------+ 
  1847  |     |     |     |     +--- NewValDataF = false;
        |     |     |     |     |  +--------+ 
  1848  |     |     |     |     +--+ break; | 
        |     |     |     |     |  +--------+ 
        |     |     |     |   +-+---+ 
  1849  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |   +-+---+ 
  1850  |     |     |   |  }  | 
        |     |     |   +-----+ 
  1851  |     |     +--- //
  1852  |     |     |    // Â§âÊï∞„ÉÉF„ÇÉP„Éà„Å´ËøÉXÂä†„Åô„Çã„ÄÇ                            
  1853  |     |     |    // SUBRuntine„ÅÉF„ÅÉD„ÅÉ@„ÄÅÂÖà„ÅÉHÂáÉRÁèÉZ„Åó„ÅüÂ†ÉGÂêà„ÇÇË°å„ÅÜ  
  1854  |     |     |    //                                                                 
        |     |     |  +----------------------------------------------+ 
  1855  |     |     +--+ if(NewValDataF || (ValData-&gt;DefPos == -1)){  | 
        |     |     |  +--+-------------------------------------------+ 
        |     |     |     |  +------------------+ 
  1856  |     |     |     +--+ if(NewValDataF){ | 
        |     |     |     |  +--+---------------+ 
  1857  |     |     |     |     +--- ValData = new TValData(ValName);
  1858  |     |     |     |     +--- ValDataList-&gt;Add((void *)ValData);
  1859  |     |     |     |     +--- ValData-&gt;ModuleIdx = Token-&gt;ModuleIdx;
        |     |     |     |   +-+---+ 
  1860  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
  1861  |     |     |     +--- ValData-&gt;DataType = ImplType[(int)ValName[0]]; // ÊöóÈÉTô„ÅÆÂÆÅvË®Ä
  1862  |     |     |     +--- ValData-&gt;DefPos = DefPos;
  1863  |     |     |     +--- ValData-&gt;DefPosS = DefPosS;
  1864  |     |     |     +--- ValData-&gt;DefPosE = DefPosE;
  1865  |     |     |     +--- ValData-&gt;ArrayDefPosS = ArrayDefPosS;
  1866  |     |     |     +--- ValData-&gt;ArrayDefPosE = ArrayDefPosE;
        |     |     |     |  +------------+ 
  1867  |     |     |     +--+ if(RealF){ | 
        |     |     |     |  +--+---------+ 
  1868  |     |     |     |     +--- ValData-&gt;DataType = dt_Real;
        |     |     |     |   +-+---+ 
  1869  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |     |  +------------+ 
  1870  |     |     |     +--+ if(IntF){  | 
        |     |     |     |  +--+---------+ 
  1871  |     |     |     |     +--- ValData-&gt;DataType = dt_Int;
        |     |     |     |   +-+---+ 
  1872  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |     |  +------------+ 
  1873  |     |     |     +--+ if(CharF){ | 
        |     |     |     |  +--+---------+ 
  1874  |     |     |     |     +--- ValData-&gt;DataType = dt_Char;
        |     |     |     |   +-+---+ 
  1875  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |     |  +--------------+ 
  1876  |     |     |     +--+ if(LogicF){  | 
        |     |     |     |  +--+-----------+ 
  1877  |     |     |     |     +--- ValData-&gt;DataType = dt_Logic;
        |     |     |     |   +-+---+ 
  1878  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |     |  +----------------+ 
  1879  |     |     |     +--+ if(ComplexF){  | 
        |     |     |     |  +--+-------------+ 
  1880  |     |     |     |     +--- ValData-&gt;DataType = dt_Complex;
        |     |     |     |   +-+---+ 
  1881  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
  1882  |     |     |     +--- ValData-&gt;DataLength = DataLength;
  1883  |     |     |     +--- ValData-&gt;ArrayLevel = ArrayLevel;
        |     |     |     |  +----------------------+ 
  1884  |     |     |     +--+ if(ArrayLevel != 0){ | 
        |     |     |     |  +--+-------------------+ 
  1885  |     |     |     |     +--- ValData-&gt;ArrayOrFuncF = true;
  1886  |     |     |     |     +--- //              ValData-&gt;ArrayStart = new int[ArrayLevel];
  1887  |     |     |     |     |    //              ValData-&gt;ArrayCount = new int[ArrayLevel]; 
        |     |     |     |     |  +----------------------------------------+ 
  1888  |     |     |     |     +--+ for(int k = 0 ; k &lt; ArrayLevel ; k++){ | 
        |     |     |     |     |  +--+-------------------------------------+ 
  1889  |     |     |     |     |     +--- ValData-&gt;ArrayStart[k] = ArrayStart[k];
  1890  |     |     |     |     |     +--- ValData-&gt;ArrayCount[k] = ArrayCount[k];
        |     |     |     |     |   +-+---+ 
  1891  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |   +-+---+ 
  1892  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |   +-+---+ 
  1893  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +----------------+ 
  1894  |     |     +--+ if(ParamValF){ | 
        |     |     |  +--+-------------+ 
  1895  |     |     |     +--- ValData-&gt;ParamValF = ParamValF;
  1896  |     |     |     +--- ValData-&gt;dData = ParamData;
        |     |     |   +-+---+ 
  1897  |     |     |   |  }  | 
        |     |     |   +-----+ 
  1898  |     |     +--- //
  1899  |     |     |    // Ê¨ÅB„ÅÉáÂ§âÊï∞„ÅÉN  
  1900  |     |     |    //                     
  1901  |     |     +--- Token = (TToken *)TokenList-&gt;Items[i];
  1902  |     |     +--- TokId = Token-&gt;TokId;
        |     |     |  +--------------------------+ 
  1903  |     |     +--+ if(TokId == tid_Kokka){  | 
        |     |     |  +--+-----------------------+ 
  1904  |     |     |     +--- i++;
        |     |     |   +-+---+ 
  1905  |     |     |   |  }  | 
        |     |     |   +-----+ 
  1906  |     |     +--- Token = (TToken *)TokenList-&gt;Items[i];
  1907  |     |     +--- TokId = Token-&gt;TokId;
        |     |     |  +--------------------------+ 
  1908  |     |     +--+ if(TokId != tid_Kannma){ | 
        |     |     |  +--+-----------------------+ 
        |     |     |     |  +--------+ 
  1909  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |   +-+---+ 
  1910  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |   +-+---+ 
  1911  |     |   |  }  | 
        |     |   +-----+ 
        |   +-+---+ 
  1912  |   |  }  | 
        |   +-----+ 
  1913  +--- /*----------------------------------------------------------------------------*/
  1914  |    //                                                                                             
  1915  |    //  1.ÊóÅEÊúÉÉË™ûÂêç                                                                           
  1916  |    //                                                                                             
  1917  |    //  2.„Éë„É©„ÉÅB„ÇÉ\Ë™ÉÉÊòé                                                                    
  1918  |    //    TokenList   „Éà„Éº„ÇÉb„ÉÉE„ÉÉF„ÇÉP„Éà                                                    
  1919  |    //    sPos    ÈñãÂÉ@ã‰ÉXçÁÉXÉá                                                                 
  1920  |    //                                                                                             
  1921  |    //  3.Ê¶ÇËÉíÅ                                                                                  
  1922  |    //    Ôºà„Å´ÂØÉZÂøú„Åô„Çã )„ÅÉá Pos„ÇíËÉ\î„Åô„ÄÇ„Éç„ÇÉP„Éà„Å´ÈñÅu„Åó„Å¶„ÇÇÂá¶ÁêÜ„Åï„Çå„Çã„ÄÇ   
  1923  |    //    Ë¶ã„Å§„Åã„Çâ„ÅÉF„ÅÑÂ†ÉGÂêà„ÅØ„ÄÅ-1„ÇíËÉ\î„Åô„ÄÇ                                          
  1924  |    //                                                                                             
  1925  |    //  4.Ê©üËÉΩË™ÉÉÊòé                                                                            
  1926  |    //                                                                                             
  1927  |    //  5.ÊàÉT„ÇäÂÄÅA                                                                              
  1928  |    //    ÂØÉZÂøú„Åô„Çã ()„ÅÉá Pos„ÇíËÉ\î„Åô„ÄÇËÉíã„Å§„Åã„Çâ„ÅÉF„ÅÑÂ†ÉGÂêà„ÅØ„ÄÅ-1„ÇíËÉ\î„Åô„ÄÇ    
  1929  |    //                                                                                             
  1930  |    //  6.ÂÇôËÄÉ                                                                                   
  1931  |    //                                                                                             
  1932  |    /*----------------------------------------------------------------------------*/               
        |  +------------------------------------------+ 
  1933  +--+ int FindBrace(TList *TokenList,int sPos) | 
  1934  |  | {                                        | 
        |  +--+---------------------------------------+ 
  1935  |     +--- int i;
  1936  |     +--- int Level = 0;
  1937  |     +--- TToken *Token;
  1938  |     |    
        |     |  +----------------------------------------------+ 
  1939  |     +--+ for(i = sPos ; i &lt; TokenList-&gt;Count ; i++){  | 
        |     |  +--+-------------------------------------------+ 
  1940  |     |     +--- Token = (TToken *)TokenList-&gt;Items[i];
        |     |     |  +--------------------------------+ 
  1941  |     |     +--+ if(Token-&gt;TokId == tid_Kakko){ | 
        |     |     |  +--+-----------------------------+ 
  1942  |     |     |     +--- Level++;
        |     |     |   +-+---+ 
  1943  |     |     |   |  }  | 
        |     |     |   +-+---+ 
        |     |     |   +-+-------------------------------------+ 
  1943  |     |     |   |  else if(Token-&gt;TokId == tid_Kokka){  | 
        |     |     |   +-+-------------------------------------+ 
  1944  |     |     |     +--- Level--;
        |     |     |     |  +------------------+ 
  1945  |     |     |     +--+ if(Level == 0){  | 
        |     |     |     |  +--+---------------+ 
        |     |     |     |     |  +------------+ 
  1946  |     |     |     |     +--+ return i;  | 
        |     |     |     |     |  +------------+ 
        |     |     |     |   +-+---+ 
  1947  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |   +-+---+ 
  1948  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |   +-+---+ 
  1949  |     |   |  }  | 
        |     |   +-----+ 
        |     |  +------------+ 
  1950  |     +--+ return -1; | 
        |     |  +------------+ 
        |   +-+---+ 
  1951  |   |  }  | 
        |   +-----+ 
  1952  +--- /*----------------------------------------------------------------------------*/
  1953  |    //                                                                               
  1954  |    //  1.ÊóÅEÊúÉÉË™ûÂêç                                                             
  1955  |    //                                                                               
  1956  |    //  2.„Éë„É©„ÉÅB„ÇÉ\Ë™ÉÉÊòé                                                      
  1957  |    //    aStr Â§âÊï∞Âêç                                                             
  1958  |    //                                                                               
  1959  |    //  3.Ê¶ÇËÉíÅ                                                                    
  1960  |    //    Â§âÊï∞„Éá„Éº„ÇÉ\ÁîüÊàê„ÄÇ                                                  
  1961  |    //                                                                               
  1962  |    //  4.Ê©üËÉΩË™ÉÉÊòé                                                              
  1963  |    //                                                                               
  1964  |    //  5.ÊàÉT„ÇäÂÄÅA                                                                
  1965  |    //                                                                               
  1966  |    //  6.ÂÇôËÄÉ                                                                     
  1967  |    //                                                                               
  1968  |    /*----------------------------------------------------------------------------*/ 
        |  +----------------------------------+ 
  1969  +--+ TValData::TValData(string aStr)  | 
  1970  |  | {                                | 
        |  +--+-------------------------------+ 
  1971  |     +--- Str = aStr;
  1972  |     +--- DataType = (Enum_DataType)-1;
  1973  |     +--- DataLength = 0;
  1974  |     +--- ParamValF = false;
  1975  |     +--- ArrayOrFuncF = false;
  1976  |     +--- ArgF = false;       // SUBRUTION,FUNCTION„ÅÉáÂºïÊï∞„ÅÉB„Åó„Å¶‰ΩÉ\ÁîÉB„Åï„Çå„ÅÉí„ÅÑ„Çã„ÄÇ
  1977  |     +--- ArrayLevel = 0;
  1978  |     +--- RefCount = 0;       // Â§âÊï∞ÂèÇÁÖßCount
  1979  |     +--- SetCount = 0;       // Â§âÊï∞Ë®ÉÖÂÆöCount
  1980  |     +--- DefPos = -11;
  1981  |     +--- DefPosS = DefPosE = -1;    // ÂÆöÁÉZÉDÊôÇ„ÅÆTokenPos A(N,N) „ÅÉF„ÅÉD„ÅÉáÁØÑÂõ≤
  1982  |     +--- ArrayDefPosS = ArrayDefPosE = -1;    // ÂÆöÁÉZÉDÊôÇ„ÅÆTokenPos A(N,N) „ÅÉF„ÅÉD„ÅÉáÁØÑÂõ≤
  1983  |     +--- RefDoValBits = 0;
  1984  |     +--- DoValBits = 0;  // Add 2004/08/26
  1985  |     |                                       
        |   +-+---+ 
  1986  |   |  }  | 
        |   +-----+ 
  1987  |    
  1988  +--- /*----------------------------------------------------------------------------*/
  1989  |    //                                                                               
  1990  |    //  1.ÊóÅEÊúÉÉË™ûÂêç                                                             
  1991  |    //                                                                               
  1992  |    //  2.„Éë„É©„ÉÅB„ÇÉ\Ë™ÉÉÊòé                                                      
  1993  |    //                                                                               
  1994  |    //  3.Ê¶ÇËÉíÅ                                                                    
  1995  |    //    Â§âÊï∞„Éá„Éº„ÇÉ\Á†ÉGÊ£Ñ                                                    
  1996  |    //                                                                               
  1997  |    //  4.Ê©üËÉΩË™ÉÉÊòé                                                              
  1998  |    //                                                                               
  1999  |    //  5.ÊàÉT„ÇäÂÄÅA                                                                
  2000  |    //                                                                               
  2001  |    //  6.ÂÇôËÄÉ                                                                     
  2002  |    //                                                                               
  2003  |    /*----------------------------------------------------------------------------*/ 
        |  +------------------------+ 
  2004  +--+ TValData::~TValData()  | 
  2005  |  | {                      | 
        |  +--+---------------------+ 
        |   +-+---+ 
  2006  |   |  }  | 
        |   +-----+ 
  2007  +--- /*----------------------------------------------------------------------------*/
  2008  |    //                                                                               
  2009  |    //  1.ÊóÅEÊúÉÉË™ûÂêç                                                             
  2010  |    //                                                                               
  2011  |    //  2.„Éë„É©„ÉÅB„ÇÉ\Ë™ÉÉÊòé                                                      
  2012  |    //                                                                               
  2013  |    //  3.Ê¶ÇËÉíÅ                                                                    
  2014  |    //    Â§âÊï∞„ÅÉáÊÉÖÂ†ÉA„ÇíÊñáÂ≠óÂàó„ÅÉ@ÊâÄÂæó„Åô„Çã„ÄÇ                           
  2015  |    //                                                                               
  2016  |    //  4.Ê©üËÉΩË™ÉÉÊòé                                                              
  2017  |    //                                                                               
  2018  |    //  5.ÊàÉT„ÇäÂÄÅA                                                                
  2019  |    //    Â§âÊï∞ÊÉÖÂ†ÉA„ÅÉáÊñáÂÉÖóÂàó                                                
  2020  |    //                                                                               
  2021  |    //  6.ÂÇôËÄÉ                                                                     
  2022  |    //                                                                               
  2023  |    /*----------------------------------------------------------------------------*/ 
        |  +------------------------------+ 
  2024  +--+ string TValData::ToString()  | 
  2025  |  | {                            | 
        |  +--+---------------------------+ 
  2026  |     +--- string s;
  2027  |     +--- string DataTypeStr[] = {&quot;Int&quot;,&quot;Real&quot;,&quot;Char&quot;,&quot;Logic&quot;,&quot;Complex&quot;,&quot;Float&quot;,&quot;Void&quot;,
  2028  |     |        &quot;IntFunc&quot;,&quot;RealFunc&quot;,&quot;CharFunc&quot;,&quot;LogicFunc&quot;,&quot;ComplexFunc&quot;,&quot;FloatFunc&quot;,     
  2029  |     |        &quot;VoidFunc&quot;  };                                                             
  2030  |     |    
  2031  |     +--- s = &quot; (MIdx=&quot;+IntToStr(ModuleIdx)+&quot;) &quot;;
        |     |  +----------------------+ 
  2032  |     +--+ if(DataLength != 0){ | 
        |     |  +--+-------------------+ 
        |     |     |  +----------------------+ 
  2033  |     |     +--+ if(DataType == -1){  | 
        |     |     |  +--+-------------------+ 
  2034  |     |     |     +--- s += (string)(&quot;??&quot;)+&quot;*&quot;+IntToStr(DataLength);
        |     |     |   +-+---+ 
  2035  |     |     |   |  }  | 
        |     |     |   +-+---+ 
        |     |     |   +-+-------+ 
  2035  |     |     |   |  else{  | 
        |     |     |   +-+-------+ 
  2036  |     |     |     +--- s += (string)(DataTypeStr[DataType])+&quot;*&quot;+IntToStr(DataLength);
        |     |     |   +-+---+ 
  2037  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |   +-+---+ 
  2038  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-------+ 
  2038  |     |   |  else{  | 
        |     |   +-+-------+ 
        |     |     |  +----------------------+ 
  2039  |     |     +--+ if(DataType == -1){  | 
        |     |     |  +--+-------------------+ 
  2040  |     |     |     +--- s += (string)(&quot;??&quot;);
        |     |     |   +-+---+ 
  2041  |     |     |   |  }  | 
        |     |     |   +-+---+ 
        |     |     |   +-+-------+ 
  2041  |     |     |   |  else{  | 
        |     |     |   +-+-------+ 
  2042  |     |     |     +--- s += (string)(DataTypeStr[DataType]);
        |     |     |   +-+---+ 
  2043  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |   +-+---+ 
  2044  |     |   |  }  | 
        |     |   +-----+ 
  2045  |     +--- s += &quot; &quot;+Str;
        |     |  +----------------------------------------+ 
  2046  |     +--+ for(int i = 0 ; i &lt; ArrayLevel ; i++){ | 
        |     |  +--+-------------------------------------+ 
  2047  |     |     +--- s += &quot;(&quot;;
        |     |     |  +--------------------------+ 
  2048  |     |     +--+ if(ArrayStart[i] != 1){  | 
        |     |     |  +--+-----------------------+ 
  2049  |     |     |     +--- s += IntToStr(ArrayStart[i])+&quot;:&quot;+IntToStr(ArrayStart[i]+ArrayCount[i]);
        |     |     |   +-+---+ 
  2050  |     |     |   |  }  | 
        |     |     |   +-+---+ 
        |     |     |   +-+-------+ 
  2050  |     |     |   |  else{  | 
        |     |     |   +-+-------+ 
  2051  |     |     |     +--- s += IntToStr(ArrayCount[i]);
        |     |     |   +-+---+ 
  2052  |     |     |   |  }  | 
        |     |     |   +-----+ 
  2053  |     |     +--- s += &quot;)&quot;;
        |     |   +-+---+ 
  2054  |     |   |  }  | 
        |     |   +-----+ 
        |     |  +----------------+ 
  2055  |     +--+ if(ParamValF){ | 
        |     |  +--+-------------+ 
  2056  |     |     +--- s += &quot;=&quot;+FloatToStr(dData);
        |     |   +-+---+ 
  2057  |     |   |  }  | 
        |     |   +-----+ 
  2058  |     +--- s += &quot; (RW=&quot;+IntToStr(RefCount)+&quot;,&quot;+IntToStr(SetCount)+&quot;)&quot;;
  2059  |     |    
        |     |  +------------+ 
  2060  |     +--+ if(ArgF){  | 
        |     |  +--+---------+ 
  2061  |     |     +--- s += &quot;(Arg)&quot;;
        |     |   +-+---+ 
  2062  |     |   |  }  | 
        |     |   +-----+ 
  2063  |     |    
        |     |  +------------+ 
  2064  |     +--+ return s;  | 
        |     |  +------------+ 
  2065  |     +--- /*
  2066  |     |        char *DataTypeStr[] = {&quot;Int&quot;,&quot;Real&quot;,&quot;Char&quot;,&quot;Logic&quot;,&quot;Complex&quot;,    
  2067  |     |            &quot;IntFunc&quot;,&quot;RealFunc&quot;,&quot;CharFunc&quot;,&quot;LogicFunc&quot;,&quot;ComplexFunc&quot;};  
  2068  |     |                                                                         
  2069  |     |        s = &quot; (MIdx=&quot;+IntToStr(ModuleIdx)+&quot;) &quot;;                          
  2070  |     |        s += &quot;(Nest = &quot;+IntToStr(BrNestLevel)+&quot;) &quot;;                      
  2071  |     |        s += &quot;(Type = &quot;+IntToStr(DataType)+&quot;) &quot;;                         
  2072  |     |        s += &quot; &quot;+Str;                                                    
  2073  |     |        for(int i = 1 ; i &lt; ArrayLevel ; i++){                           
  2074  |     |            s += &quot;[]&quot;;                                                   
  2075  |     |        }                                                                
  2076  |     |        if(ParamValF){                                                   
  2077  |     |            s += &quot;=&quot;+FloatToStr(dData);                                  
  2078  |     |        }                                                                
  2079  |     |        s += &quot; (RW=&quot;+IntToStr(RefCount)+&quot;,&quot;+IntToStr(SetCount)+&quot;)&quot;;      
  2080  |     |                                                                         
  2081  |     |        return s;                                                        
  2082  |     |    */                                                                   
        |   +-+---+ 
  2083  |   |  }  | 
        |   +-----+ 
  2084  |    
  2085  +--- /*----------------------------------------------------------------------------*/
  2086  |    //                                                                                   
  2087  |    //  1.ÊóÅEÊúÉÉË™ûÂêç                                                                 
  2088  |    //                                                                                   
  2089  |    //  2.„Éë„É©„ÉÅB„ÇÉ\Ë™ÉÉÊòé                                                          
  2090  |    //    ValDataList  Â§âÊï∞„ÉÉF„ÇÉP„Éà                                                 
  2091  |    //    ValName Â§âÊï∞Âêç                                                              
  2092  |    //    ModuleIdx „ÉÅu„ÇÉN„ÉÅE„ÉÉV„ÉÉH„ÇÅA„ÉÉE„Éá„ÉÉ„ÇÉb„ÇÉP                           
  2093  |    //                                                                                   
  2094  |    //  3.Ê¶ÇËÉíÅ                                                                        
  2095  |    //    ÂêçÂâç„ÅÉB„ÉÅu„ÇÉN„ÉÅE„ÉÉV„ÉÉHIdx„ÅÉH‰∏ÄËáÉG„Åô„ÇãÂ§âÊï∞ÁïÉFÂèÉL„ÇíËÉ\î„Åô„ÄÇ  
  2096  |    //                                                                                   
  2097  |    //  4.Ê©üËÉΩË™ÉÉÊòé                                                                  
  2098  |    //                                                                                   
  2099  |    //  5.ÊàÉT„ÇäÂÄÅA                                                                    
  2100  |    //    Â§âÊï∞ÁïÉFÂèÉL                                                                 
  2101  |    //  6.ÂÇôËÄÉ                                                                         
  2102  |    //                                                                                   
  2103  |    /*----------------------------------------------------------------------------*/     
        |  +----------------------------------------------------------------+ 
  2104  +--+ int GetValIdx(TList *ValDataList,string ValName,int ModuleIdx) | 
  2105  |  | {                                                              | 
        |  +--+-------------------------------------------------------------+ 
  2106  |     +--- int ValIdx;
  2107  |     +--- TValData *ValData;
  2108  |     |    
  2109  |     +--- //
  2110  |     |    //  Âêå„ÅòMoudeIdx„ÇíÊé¢„Åó„Å™„Åë„Çå„ÅÅ[„ÄÅ„Ç∞„ÉÉÖ„ÉÉV„Éê„É´„ÇíÊé¢„Åô„ÄÇ 2011/07/28  
  2111  |     |    //                                                                                   
        |     |  +------------------------------------------------------------+ 
  2112  |     +--+ for(ValIdx = 0 ; ValIdx &lt; ValDataList-&gt;Count ; ValIdx++){  | 
        |     |  +--+---------------------------------------------------------+ 
  2113  |     |     +--- ValData = (TValData *)ValDataList-&gt;Items[ValIdx];
        |     |     |  +------------------------------------------+ 
  2114  |     |     +--+ if((ValData-&gt;Str == ValName)&amp;&amp;           | 
  2115  |     |     |  |     (ValData-&gt;ModuleIdx == ModuleIdx)){  | 
        |     |     |  +--+---------------------------------------+ 
        |     |     |     |  +----------------+ 
  2116  |     |     |     +--+ return ValIdx; | 
        |     |     |     |  +----------------+ 
        |     |     |   +-+---+ 
  2117  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |   +-+---+ 
  2118  |     |   |  }  | 
        |     |   +-----+ 
        |     |  +------------------------------------------------------------+ 
  2119  |     +--+ for(ValIdx = 0 ; ValIdx &lt; ValDataList-&gt;Count ; ValIdx++){  | 
        |     |  +--+---------------------------------------------------------+ 
  2120  |     |     +--- ValData = (TValData *)ValDataList-&gt;Items[ValIdx];
        |     |     |  +------------------------------------------------------------------------+ 
  2121  |     |     +--+ if((ValData-&gt;Str == ValName)&amp;&amp;                                         | 
  2122  |     |     |  |     ((ValData-&gt;ModuleIdx == ModuleIdx)||(ValData-&gt;BrNestLevel == 0))){ | 
        |     |     |  +--+---------------------------------------------------------------------+ 
        |     |     |     |  +----------------+ 
  2123  |     |     |     +--+ return ValIdx; | 
        |     |     |     |  +----------------+ 
        |     |     |   +-+---+ 
  2124  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |   +-+---+ 
  2125  |     |   |  }  | 
        |     |   +-----+ 
        |     |  +------------+ 
  2126  |     +--+ return -1; | 
        |     |  +------------+ 
        |   +-+---+ 
  2127  |   |  }  | 
        |   +-----+ 
  2128  +--- /*----------------------------------------------------------------------------*/
  2129  |    //                                                                                   
  2130  |    //  1.ÊóÅEÊúÉÉË™ûÂêç                                                                 
  2131  |    //                                                                                   
  2132  |    //  2.„Éë„É©„ÉÅB„ÇÉ\Ë™ÉÉÊòé                                                          
  2133  |    //                                                                                   
  2134  |    //  3.Ê¶ÇËÉíÅ                                                                        
  2135  |    //    Fortran ÂêÑ„É¢„ÇÉN„ÉÅE„ÉÉV„ÉÉH„ÅÉ@„ÅÉáÂÆöÁÉZÉD„Çí„É™„ÇÉT„ÉÉ„Éà„Åô„Çã„ÄÇ        
  2136  |    //    ÊúÄÂàù„ÅÆ„ÉÅu„ÇÉN„ÉÅE„ÉÉV„ÉÉH„ÅÉB„ÄÅÔÉVÅEÔºÉáÔºÅA„ÅÉáÂæå„ÅßÂëÉV„ÅÅ[„Çå„Çã„ÄÇ   
  2137  |    //                                                                                   
  2138  |    //  4.Ê©üËÉΩË™ÉÉÊòé                                                                  
  2139  |    //                                                                                   
  2140  |    //  5.ÊàÉT„ÇäÂÄÅA                                                                    
  2141  |    //                                                                                   
  2142  |    //  6.ÂÇôËÄÉ                                                                         
  2143  |    //                                                                                   
  2144  |    /*----------------------------------------------------------------------------*/     
        |  +--------------------+ 
  2145  +--+ void ResetModule() | 
  2146  |  | {                  | 
        |  +--+-----------------+ 
        |     |  +----------------------------------+ 
  2147  |     +--+ for(int i = 0 ; i &lt; 256 ; i++){  | 
        |     |  +--+-------------------------------+ 
  2148  |     |     +--- ImplType[i] = dt_Real;
        |     |     |  +------------------------------+ 
  2149  |     |     +--+ if((i &gt;= 'i')&amp;&amp;(i &lt;= 'n')){  | 
        |     |     |  +--+---------------------------+ 
  2150  |     |     |     +--- ImplType[i] = dt_Int;
        |     |     |   +-+---+ 
  2151  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +------------------------------+ 
  2152  |     |     +--+ if((i &gt;= 'I')&amp;&amp;(i &lt;= 'N')){  | 
        |     |     |  +--+---------------------------+ 
  2153  |     |     |     +--- ImplType[i] = dt_Int;
        |     |     |   +-+---+ 
  2154  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |   +-+---+ 
  2155  |     |   |  }  | 
        |     |   +-----+ 
        |   +-+---+ 
  2156  |   |  }  | 
        |   +-----+ 
  2157  |    
  2158  +--- /*----------------------------------------------------------------------------*/
  2159  |    //                                                                                                                           
  2160  |    //  1.ÊóÅEÊúÉÉË™ûÂêç                                                                                                         
  2161  |    //                                                                                                                           
  2162  |    //  2.„Éë„É©„ÉÅB„ÇÉ\Ë™ÉÉÊòé                                                                                                  
  2163  |    //    TokenList   „Éà„Éº„ÇÉb„ÉÉE„ÉÉF„ÇÉP„Éà                                                                                  
  2164  |    //    sPos    ÈñãÂÉ@ã‰ÉXçÁÉXÉá                                                                                               
  2165  |    //    ePos    ÁµÇ‰ÉRÜ‰ÉXçÁÉXÉá                                                                                               
  2166  |    //    ValDataList Â§âÊï∞„Éá„Éº„ÇÉ\„ÉÉF„ÇÉP„Éà                                                                                
  2167  |    //    dData   ÁµêÊûú„Éá„Éº„ÇÉ\Ê†ÉVÁ¥çÂÖà                                                                                     
  2168  |    //                                                                                                                           
  2169  |    //  3.Ê¶ÇËÉíÅ                                                                                                                
  2170  |    //    sPos„Åã„ÇâePos„ÅÉáÂºè„ÅÆËßÅvÊûê„Å®Ë©ï‰ÉZÅB„ÇíÂÉáüËÅBå„Åô„Çã„ÄÇ                                                         
  2171  |    //    ‰ΩÉ\ÁîÉB„Åó„Åü„Éà„Éº„ÇÉb„ÉÉE„ÅÉáÊïÅ[„ÇíËÉ\î„Åô„ÄÇ                                                                      
  2172  |    //    ÂÆöÊï∞„ÅÉB„Åó„Å¶Ë©ï‰ÉZÅBÂáÉRÊùÅE„ÅüÂ†ÉGÂêàÔÉVàParameter,ConstÔºâ„ÅØ„ÄÅEvalConstF=true„ÇíËÉBÉÖÂÆö „ÄÇ                   
  2173  |    //    ParamaterÊñá„ÅÆÂÆöÊï∞„ÅÉáË®àÁÉáó„Å´‰ΩÉ\ÁîÉB„Åï„Çå„Çã„ÄÇ                                                                
  2174  |    //                                                                                                                           
  2175  |    //    ÂØÉZË±ÅB„Éà„Éº„ÇÉb„ÉÉE„ÅÉb„ÄÅ tid_Opr„ÅÉBÊïÅ[ÂÄÅAÔºàÊï¥ÊïÅ[„ÄÅÂÉáüÊï∞Ôºâ„ÄÅÊï∞ÂÄÅA„ÄÅ‰ÉNÄÈÉÉB„ÅÉáÈñÅuÊïÅ[„ÄÇ           
  2176  |    //    ÈñÅuÊïÅ[„ÅÉáÂºïÊï∞ÈÉÉBÂàÜ„ÅÆËßÅvÊûê„ÇÇË°å„Çè„Çå„Çã„ÄÇ                                                                  
  2177  |    //     = „ÇíÂê´„ÇÄ‰ªÅvÂÖÅEÊñá„Å´ÈñÅu„Åó„Å¶„ÅÉáÂáÉíÁêÜ„ÅØ„ÄÅÂëº„ÅÉEÂáÉR„ÅóÂÅ¥„ÅÉ@Ë°å„ÅÜ„ÄÇÔÉVàÂè≥ËæÉR„ÅÉá„ÅÉ\„ÅåÂÉbÉZË±ÅBÔºâ  
  2178  |    //                                                                                                                           
  2179  |    //  4.Ê©üËÉΩË™ÉÉÊòé                                                                                                          
  2180  |    //                                                                                                                           
  2181  |    //  5.ÊàÉT„ÇäÂÄÅA                                                                                                            
  2182  |    //    ‰ΩÉ\ÁîÉB„Åó„Åü„Éà„Éº„ÇÉb„ÉÉE„ÅÉáÊïÅ[„ÇíËÉ\î„Åô„ÄÇ                                                                      
  2183  |    //                                                                                                                           
  2184  |    //  6.ÂÇôËÄÉ                                                                                                                 
  2185  |    //    ÁèÉZÂúÉB„ÅÉbFortran„ÅÉáParamaterÊñáÁî®                                                                                 
  2186  |    //                                                                                                                           
  2187  |    /*----------------------------------------------------------------------------*/                                             
        |  +--------------------------------------------------------------------------------+ 
  2188  +--+ int Eval(TList *TokenList,int sPos,int ePos,TList *ValDataList,double *dData)  | 
  2189  |  | {                                                                              | 
        |  +--+-----------------------------------------------------------------------------+ 
  2190  |     +--- int i;
  2191  |     +--- TToken *Token,*LastTokData;
  2192  |     +--- int TokId,LastTokId;
  2193  |     +--- string TokStr,LastTokStr;
  2194  |     +--- int UseToken = 0;
  2195  |     +--- TList *DestList = new TList;
  2196  |     +--- TList *OpcList = new TList;
  2197  |     +--- int brLevel = 0;
  2198  |     |    
  2199  |     +--- *dData = 0.0;
  2200  |     +--- LastTokId = -1;
  2201  |     +--- EvalConstF = false;
  2202  |     +--- //  for(i = sPos ; i &lt;= ePos ; i++){
        |     |  +----------------------------------+ 
  2203  |     +--+ for(i = sPos ; i &lt; ePos ; i++){  | 
        |     |  +--+-------------------------------+ 
  2204  |     |     +--- Token = (TToken *)TokenList-&gt;Items[i];
  2205  |     |     +--- TokId = Token-&gt;TokId;
  2206  |     |     +--- TokStr = Token-&gt;Str;
  2207  |     |     |    
        |     |     |  +----------------+ 
  2208  |     |     +--+ switch(TokId){ | 
        |     |     |  +--+-------------+ 
        |     |     |     +-----------------------------+ 
  2209  |     |     |     |  case tid_ContinuedLineStr: | 
        |     |     |     +-----------------------------+ 
        |     |     |     |  +------------+ 
  2210  |     |     |     +--+ continue;  | 
        |     |     |     |  +------------+ 
        |     |     |     +---------------------------------+ 
  2211  |     |     |     |  case tid_ConstInt:  // ÂÆöÊï∞  | 
        |     |     |     +---------------------------------+ 
        |     |     |     +---------------------------------+ 
  2212  |     |     |     |  case tid_ConstReal: // ÂÆöÊï∞  | 
        |     |     |     +---------------------------------+ 
  2213  |     |     |     +--- DestList-&gt;Add((void *)Token);
        |     |     |     |  +--------+ 
  2214  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +---------------------------------+ 
  2215  |     |     |     |  case tid_Opr:   // ÊºîÁÉáóÂÉÖê | 
        |     |     |     +---------------------------------+ 
        |     |     |     +-----------------------------------------------------------------------+ 
  2216  |     |     |     |  case tid_Koron: // ÈÉÉBÂàÜÈÖçÂàóÁî®ÊºîÁÉáóÂÉÖê f90ÂØÉZÂøú.2013/03/07 | 
        |     |     |     +-----------------------------------------------------------------------+ 
  2217  |     |     |     +--- //
  2218  |     |     |     |    // ÊºîÁÉáóÂÉÖê„ÅÆÂçòÈ†Ö„Åã„ÅÉD„ÅÜ„Åã„ÅÉBÂÑÉFÂÖàÈ†Ü‰ÉXç„ÇíÊ±Ç„ÇÅ„Çã„ÄÇ  
  2219  |     |     |     |    // Ââç„ÅåÁ©ÉR„Åã„ÄÅÊÉVîÁÉáóÂÉÖê„Åã„ÄÅÔÉVà„Å™„Çâ„Å∞ÂçòÈ†Ö„Å®„ÅÉF„Çã„ÄÇ  
  2220  |     |     |     |    //                                                                     
        |     |     |     |  +--------------------------------------------------------------------+ 
  2221  |     |     |     +--+ if((i == sPos)||(LastTokId == tid_Opr)||(LastTokId == tid_Kakko)){ | 
        |     |     |     |  +--+-----------------------------------------------------------------+ 
  2222  |     |     |     |     +--- // ÂçòÈ†ÖÊÉVîÁÉáóÂÉÖê
  2223  |     |     |     |     +--- Token-&gt;priority = 10; // ÂÑÉFÂÖàÂÉRÉí„ÇíÂÅAâÊõ¥
  2224  |     |     |     |     +--- OpcList-&gt;Add((void *)Token);
        |     |     |     |     |  +--------+ 
  2225  |     |     |     |     +--+ break; | 
        |     |     |     |     |  +--------+ 
        |     |     |     |   +-+---+ 
  2226  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
  2227  |     |     |     +--- //
  2228  |     |     |     |    // ÔºíÈ†ÖÊÉVîÁÉáóÂÉÖê„ÅÆÂáÉíÁêÜÔÉVàÂÑ™ÂÖàÈ†Ü‰ÉXç„ÇíÊ±Ç„ÇÅ„Çã„Åì„ÅÉBÔºâ   
  2229  |     |     |     |    //                                                                       
        |     |     |     |  +--------------------------+ 
  2230  |     |     |     +--+ if(OpcList-&gt;Count &gt; 0){  | 
        |     |     |     |  +--+-----------------------+ 
  2231  |     |     |     |     +--- LastTokData = (TToken *)OpcList-&gt;Items[OpcList-&gt;Count-1];
  2232  |     |     |     |     +--- LastTokStr = LastTokData-&gt;Str;
        |     |     |     |     |  +--------------------------------------+ 
  2233  |     |     |     |     +--+ if(LastTokData-&gt;TokId == tid_Kakko){ | 
        |     |     |     |     |  +--+-----------------------------------+ 
  2234  |     |     |     |     |     +--- OpcList-&gt;Add((void *)Token); // „ÇÉP„ÇÉ\„ÉÉ„ÇØ„ÅÉHÁ©ç„ÇÄ
        |     |     |     |     |   +-+---+ 
  2235  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-+---+ 
        |     |     |     |     |   +-+-----------------------------------------------------------------------+ 
  2235  |     |     |     |     |   |  else if((Token-&gt;priority &lt;= LastTokData-&gt;priority)&amp;&amp;(TokStr == &quot;**&quot;)){ | 
        |     |     |     |     |   +-+-----------------------------------------------------------------------+ 
  2236  |     |     |     |     |     +--- // ** ÊºîÁÉáóÂÉÖê„ÅØ„ÄÅÂè≥ÂÅÉGÁµêÂêà
  2237  |     |     |     |     |     +--- OpcList-&gt;Add((void *)Token); // „ÇÉP„ÇÉ\„ÉÉ„ÇØ„ÅÉHÁ©ç„ÇÄ
        |     |     |     |     |   +-+---+ 
  2238  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-+---+ 
        |     |     |     |     |   +-+---------------------------------------------------+ 
  2238  |     |     |     |     |   |  else if(Token-&gt;priority &lt; LastTokData-&gt;priority){  | 
        |     |     |     |     |   +-+---------------------------------------------------+ 
  2239  |     |     |     |     |     +--- OpcList-&gt;Add((void *)Token); // „ÇÉP„ÇÉ\„ÉÉ„ÇØ„ÅÉHÁ©ç„ÇÄ
        |     |     |     |     |   +-+---+ 
  2240  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-+---+ 
        |     |     |     |     |   +-+-------+ 
  2240  |     |     |     |     |   |  else{  | 
        |     |     |     |     |   +-+-------+ 
        |     |     |     |     |     |  +----------------------------+ 
  2241  |     |     |     |     |     +--+ while(OpcList-&gt;Count &gt; 0){ | 
        |     |     |     |     |     |  +--+-------------------------+ 
  2242  |     |     |     |     |     |     +--- //
  2243  |     |     |     |     |     |     |    //  „ÇÉP„ÇÉ\„ÉÉ„ÇØ„ÅÉáÂÜÖÂÉáÉP„ÇíÂèñ„ÇäÂá∫„Åô„ÄÇ   
  2244  |     |     |     |     |     |     |    //                                                 
  2245  |     |     |     |     |     |     +--- LastTokData = (TToken *)OpcList-&gt;Items[OpcList-&gt;Count-1];
  2246  |     |     |     |     |     |     +--- LastTokStr = LastTokData-&gt;Str;
        |     |     |     |     |     |     |  +----------------------------------------------+ 
  2247  |     |     |     |     |     |     +--+ if(Token-&gt;priority &lt; LastTokData-&gt;priority){ | 
        |     |     |     |     |     |     |  +--+-------------------------------------------+ 
        |     |     |     |     |     |     |     |  +----------------------------+ 
  2248  |     |     |     |     |     |     |     +--+ if(Token-&gt;priority != 10){ | 
        |     |     |     |     |     |     |     |  +--+-------------------------+ 
        |     |     |     |     |     |     |     |     |  +--------+ 
  2249  |     |     |     |     |     |     |     |     +--+ break; | 
        |     |     |     |     |     |     |     |     |  +--------+ 
        |     |     |     |     |     |     |     |   +-+---+ 
  2250  |     |     |     |     |     |     |     |   |  }  | 
        |     |     |     |     |     |     |     |   +-+---+ 
        |     |     |     |     |     |     |     |   +-+-------+ 
  2250  |     |     |     |     |     |     |     |   |  else{  | 
        |     |     |     |     |     |     |     |   +-+-------+ 
  2251  |     |     |     |     |     |     |     |     +--- // ÂçòÈ†ÖÊÉVîÁÉáóÂÉÖê„Å©„Åä„Åó„ÅÉáÂ†ÉGÂêà„ÅØ„ÄÅÂÉZåÊñπ„Åã„Çâ
        |     |     |     |     |     |     |     |     |  +------------------------------------------------+ 
  2252  |     |     |     |     |     |     |     |     +--+ if(Token-&gt;priority &lt;= LastTokData-&gt;priority){  | 
        |     |     |     |     |     |     |     |     |  +--+---------------------------------------------+ 
        |     |     |     |     |     |     |     |     |     |  +--------+ 
  2253  |     |     |     |     |     |     |     |     |     +--+ break; | 
        |     |     |     |     |     |     |     |     |     |  +--------+ 
        |     |     |     |     |     |     |     |     |   +-+---+ 
  2254  |     |     |     |     |     |     |     |     |   |  }  | 
        |     |     |     |     |     |     |     |     |   +-----+ 
        |     |     |     |     |     |     |     |   +-+---+ 
  2255  |     |     |     |     |     |     |     |   |  }  | 
        |     |     |     |     |     |     |     |   +-----+ 
        |     |     |     |     |     |     |   +-+---+ 
  2256  |     |     |     |     |     |     |   |  }  | 
        |     |     |     |     |     |     |   +-----+ 
  2257  |     |     |     |     |     |     +--- DestList-&gt;Add((void *)LastTokData);
  2258  |     |     |     |     |     |     +--- OpcList-&gt;Delete(OpcList-&gt;Count-1);
        |     |     |     |     |     |   +-+---+ 
  2259  |     |     |     |     |     |   |  }  | 
        |     |     |     |     |     |   +-----+ 
  2260  |     |     |     |     |     +--- OpcList-&gt;Add((void *)Token); // „ÇÉP„ÇÉ\„ÉÉ„ÇØ„ÅÉHÁ©ç„ÇÄ
        |     |     |     |     |   +-+---+ 
  2261  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |   +-+---+ 
  2262  |     |     |     |   |  }  | 
        |     |     |     |   +-+---+ 
        |     |     |     |   +-+-------+ 
  2262  |     |     |     |   |  else{  | 
        |     |     |     |   +-+-------+ 
  2263  |     |     |     |     +--- OpcList-&gt;Add((void *)Token); // „ÇÉP„ÇÉ\„ÉÉ„ÇØ„ÅÉHÁ©ç„ÇÄ
        |     |     |     |   +-+---+ 
  2264  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |     |  +--------+ 
  2265  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-------------------+ 
  2266  |     |     |     |  case tid_Kakko:  | 
        |     |     |     +-------------------+ 
  2267  |     |     |     +--- brLevel++;
        |     |     |     |  +--------+ 
  2268  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-----------------------------------------------------------------+ 
  2269  |     |     |     |  case tid_Kokka: // Nest = 0„ÅÉáÂ†ÉGÂêà„ÅØÁµÇ‰ÉRÜ„Å®„ÅÉF„Çã„ÄÇ  | 
        |     |     |     +-----------------------------------------------------------------+ 
        |     |     |     |  +--------------------+ 
  2270  |     |     |     +--+ if(brLevel &lt;= 0){  | 
        |     |     |     |  +--+-----------------+ 
  2271  |     |     |     |     +--- // )„ÅÉZ„ÅÉ@ËßÅvÊûê„Åå„ÅÇ„Çã„ÅÉá„ÅÉ@„ÄÅ„Ç®„ÉÉD„ÉÉV„ÅÉB„ÅÉb„Åó„Å™„ÅÑ
  2272  |     |     |     |     +--- UseToken = i-sPos;
  2273  |     |     |     |     +--- i = ePos+1;
        |     |     |     |     |  +--------+ 
  2274  |     |     |     |     +--+ break; | 
        |     |     |     |     |  +--------+ 
        |     |     |     |   +-+---+ 
  2275  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
  2276  |     |     |     +--- brLevel--;
        |     |     |     |  +----------------------------+ 
  2277  |     |     |     +--+ while(OpcList-&gt;Count &gt; 0){ | 
        |     |     |     |  +--+-------------------------+ 
  2278  |     |     |     |     +--- LastTokData = (TToken *)OpcList-&gt;Items[OpcList-&gt;Count-1];
  2279  |     |     |     |     +--- LastTokStr = LastTokData-&gt;Str;
        |     |     |     |     |  +----------------------------------------+ 
  2280  |     |     |     |     +--+ if(LastTokData -&gt;TokId == tid_Kakko){  | 
        |     |     |     |     |  +--+-------------------------------------+ 
  2281  |     |     |     |     |     +--- // ÊúÄÂæå„ÅåÔºà„Å™„ÇâÂâäÈôÅA„ÅÉ@ÁµÇ„Çè„Çä
  2282  |     |     |     |     |     +--- OpcList-&gt;Delete(OpcList-&gt;Count-1);
        |     |     |     |     |     |  +--------+ 
  2283  |     |     |     |     |     +--+ break; | 
        |     |     |     |     |     |  +--------+ 
        |     |     |     |     |   +-+---+ 
  2284  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
  2285  |     |     |     |     +--- DestList-&gt;Add((void *)LastTokData);
  2286  |     |     |     |     +--- OpcList-&gt;Delete(OpcList-&gt;Count-1);
        |     |     |     |     |  +--------------------------+ 
  2287  |     |     |     |     +--+ if(OpcList-&gt;Count == 0){ | 
        |     |     |     |     |  +--+-----------------------+ 
  2288  |     |     |     |     |     +--- // )„ÅÉZ„ÅÉ@ËßÅvÊûê„Åå„ÅÇ„Çã„ÅÉá„ÅÉ@„ÄÅ„Ç®„ÉÉD„ÉÉV„ÅÉB„ÅÉb„Åó„Å™„ÅÑ
  2289  |     |     |     |     |     +--- //                  ErrMsg(TokenList,i,&quot;ÂØÉZÂøú„Åô„Çã'('„Åå„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ");
        |     |     |     |     |     |  +--------+ 
  2290  |     |     |     |     |     +--+ break; | 
        |     |     |     |     |     |  +--------+ 
        |     |     |     |     |   +-+---+ 
  2291  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |   +-+---+ 
  2292  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |     |  +--------+ 
  2293  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-------------------+ 
  2294  |     |     |     |  case tid_Kannma: | 
        |     |     |     +-------------------+ 
        |     |     |     |  +--------------------------------------------------------------------------+ 
  2295  |     |     |     +--+ if(brLevel == 0){ // ()ÂÜÖ‰ÉTÅEÂ§ñ„ÅÆ&quot;,&quot;„ÅÉbË©ï‰ÉZÅB„ÇíÁÉIÇ‰ÉRÜ„Åô„Çã„ÄÇ | 
        |     |     |     |  +--+-----------------------------------------------------------------------+ 
  2296  |     |     |     |     +--- UseToken = i-sPos;
  2297  |     |     |     |     +--- i = ePos+1;
        |     |     |     |   +-+---+ 
  2298  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |     |  +--------+ 
  2299  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
  2300  |     |     |     +--- //      case tid_Koron:
        |     |     |     +-----------------------+ 
  2301  |     |     |     |  case tid_KoronKoron: | 
        |     |     |     +-----------------------+ 
        |     |     |     +-----------------+ 
  2302  |     |     |     |  case tid_Set:  | 
        |     |     |     +-----------------+ 
        |     |     |     +---------------------+ 
  2303  |     |     |     |  case tid_LineEnd:  | 
        |     |     |     +---------------------+ 
  2304  |     |     |     +--- UseToken = i-sPos;
  2305  |     |     |     +--- i = ePos+1;
        |     |     |     |  +--------+ 
  2306  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
  2307  |     |     |     +--- //      case -1:    // Â§âÊï∞„ÉÉTÈñÅuÊïÅ[„Éà„Éº„ÇÉb„ÉÉE
        |     |     |     +-------------------------------------------------------+ 
  2308  |     |     |     |  case tid_Val:    // Â§âÊï∞„ÉÉTÈñÅuÊïÅ[„Éà„Éº„ÇÉb„ÉÉE | 
        |     |     |     +-------------------------------------------------------+ 
  2309  |     |     |     +--- //
  2310  |     |     |     |    // ÊúÉFÂÆöÁÉZÉD„Éà„Éº„ÇÉb„ÉÉE„ÄÅPARAMETERÂ§âÊï∞„ÅÉ@„ÅÉF„ÅÑ„Åã„Çí„ÉÅ„ÇÉ@„ÉÉ„ÇØ„Åô„Çã  
  2311  |     |     |     |    // PARAMETERÂ§âÊï∞„ÅÉáÂ†ÉGÂêà„ÅØ„ÄÅÂÉáöÊï∞„ÅÉBÂêå„ÅòÊâÉA„ÅÑ„Å®„Åô„Çã„ÄÇ              
  2312  |     |     |     |    // „Åù„Çå‰ªÅEÂ§ñ„ÅÆÂ†ÉGÂêà„ÅØ„ÄÅÁÉIÇ‰ÉRÜ„Åô„Çã„ÄÇ                                    
  2313  |     |     |     |    // Nest„ÅåÔÉVê„ÅÆÂ†ÉGÂêà„ÅØ„ÄÅ„Ç®„ÉÉD„ÉÉV„ÅÉB„ÅÉb„Åó„Å™„ÅÑ„ÄÇ                        
  2314  |     |     |     |    // Exp.  12*34*??? „ÅÉb„ÇÉB„ÉÉD„ÉÉVÔºà„Çπ„ÇÉ\„ÉÉ„ÇØ„ÅÉHÊÆã„ÇãÔºâ                     
  2315  |     |     |     |    // Exp.  12*34 ??? „ÅÉb„ÇÉB„ÉÉD„ÉÉVÔºà„Çπ„ÇÉ\„ÉÉ„ÇØ„ÅÉHÊÆã„Çâ„ÅÉF„ÅÑÔÉVâ             
  2316  |     |     |     |    //                                                                                   
  2317  |     |     |     +--- int ValIdx;
  2318  |     |     |     +--- TValData *ValData;
  2319  |     |     |     |    
  2320  |     |     |     +--- Token-&gt;RefType = vrf_ref; // Â§âÊï∞ÂèÇÁÖß
        |     |     |     |  +------------------------------------------------------------+ 
  2321  |     |     |     +--+ for(ValIdx = 0 ; ValIdx &lt; ValDataList-&gt;Count ; ValIdx++){  | 
        |     |     |     |  +--+---------------------------------------------------------+ 
  2322  |     |     |     |     +--- // ÊúâÂäπ„ÅÉFPARAMETERÂ§âÊï∞„ÅåËÉíã„Å§„Åã„Å£„ÅüÂ†ÉGÂêà„Å´„ÅÉb„ÄÅ
  2323  |     |     |     |     |    // „Åù„ÅÆÂÄÅA„ÇíToken-&gt;dData„ÅÉH„ÇÉT„ÉÉ„Éà„Åó„Å¶Êäú„Åë„Çã        
  2324  |     |     |     |     +--- ValData = (TValData *)ValDataList-&gt;Items[ValIdx];
        |     |     |     |     |  +------------------------------------------------------+ 
  2325  |     |     |     |     +--+ if((LowerCase(ValData-&gt;Str) == LowerCase(TokStr))&amp;&amp;  | 
  2326  |     |     |     |     |  |     (ValData-&gt;ModuleIdx == Token-&gt;ModuleIdx)){       | 
        |     |     |     |     |  +--+---------------------------------------------------+ 
  2327  |     |     |     |     |     +--- Token-&gt;ValData = ValData; // „Éà„Éº„ÇÉb„ÉÉE„ÅÉHÂ§âÊï∞„ÇíÈñ¢ÈÄÅv‰ªò„Åë„Çã
  2328  |     |     |     |     |     +--- ValData-&gt;RefCount++;
  2329  |     |     |     |     |     +--- Token-&gt;dData = ValData-&gt;dData;
  2330  |     |     |     |     |     +--- DestList-&gt;Add((void *)Token);
  2331  |     |     |     |     |     +--- ValIdx = ValDataList-&gt;Count+10;
        |     |     |     |     |     |  +--------+ 
  2332  |     |     |     |     |     +--+ break; | 
        |     |     |     |     |     |  +--------+ 
        |     |     |     |     |   +-+---+ 
  2333  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |   +-+---+ 
  2334  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |     |  +--------------------------------------+ 
  2335  |     |     |     +--+ if(ValIdx != ValDataList-&gt;Count+10){ | 
        |     |     |     |  +--+-----------------------------------+ 
  2336  |     |     |     |     +--- // ÊúÄÂàù„Å´ÂáÉRÁèÉZ„Åó„ÅüÂ§âÊï∞
  2337  |     |     |     |     |    // ÊúÉÉÊùÅE„ÅÉb„ÄÅ„Ç®„ÉÉD„ÉÉVÔºàËÉÖÉíÂëäÔÉVâ„Å†„Åå„ÄÅÂÅAâÊï∞„ÅÉB„Åó„Å¶ËøÉXÂä†„Åô„ÇãÂΩÅu„ÅÉB„Åó„Å¶„ÅÇ„Çã„ÄÇ   
  2338  |     |     |     |     +--- ValData = new TValData(TokStr);
  2339  |     |     |     |     +--- ValDataList-&gt;Add((void *)ValData);
  2340  |     |     |     |     +--- ValData-&gt;ModuleIdx = Token-&gt;ModuleIdx;
  2341  |     |     |     |     +--- ValData-&gt;DataType = ImplType[(int)TokStr[0]]; // ÊöóÈÉTô„ÅÆÂÆÅvË®Ä
  2342  |     |     |     |     +--- Token-&gt;ValData = ValData; // „Éà„Éº„ÇÉb„ÉÉE„ÅÉHÂ§âÊï∞„ÇíÈñ¢ÈÄÅv‰ªò„Åë„Çã
  2343  |     |     |     |     +--- ValData-&gt;RefCount++;
  2344  |     |     |     |     +--- Token-&gt;dData = ValData-&gt;dData;
  2345  |     |     |     |     +--- DestList-&gt;Add((void *)Token);
  2346  |     |     |     |     |    
  2347  |     |     |     |     +--- // Ê¨ÅB„Åå(„ÅÉ@ ÂÆöÁÉZÉD„Åå‰ÉTÅEÂâç„Å´„ÅÉF„ÅÑÂ†ÉGÂêà„ÅØ„ÄÅÈñ¢ÊïÅ[
  2348  |     |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[i+1];
        |     |     |     |     |  +--------------------------------+ 
  2349  |     |     |     |     +--+ if(Token-&gt;TokId == tid_Kakko){ | 
        |     |     |     |     |  +--+-----------------------------+ 
  2350  |     |     |     |     |     +--- ValData-&gt;ArrayOrFuncF = true;
  2351  |     |     |     |     |     +--- ValData-&gt;DataType = (Enum_DataType)(ImplType[(int)TokStr[0]] + (int)dt_IntFunc);
        |     |     |     |     |   +-+---+ 
  2352  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |   +-+---+ 
  2353  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |     |  +--------+ 
  2354  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-------------------------------------------------+ 
  2355  |     |     |     |  default:    // „Åù„ÅÆ‰ªñ„ÅÆ„Éà„Éº„ÇÉb„ÉÉE then | 
        |     |     |     +-------------------------------------------------+ 
  2356  |     |     |     +--- UseToken = i-sPos;
  2357  |     |     |     +--- i = ePos+1;
        |     |     |     |  +--------+ 
  2358  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |   +-+---+ 
  2359  |     |     |   |  }  | 
        |     |     |   +-----+ 
  2360  |     |     +--- LastTokId = TokId;
        |     |   +-+---+ 
  2361  |     |   |  }  | 
        |     |   +-----+ 
  2362  |     +--- //
  2363  |     |    //  „ÇÉP„ÇÉ\„ÉÉ„ÇØ‰∏ä„Å´ÊÆã„Å£„Åü„Éà„ÉÉV„ÇÉb„ÉÉE„ÇíÊéÉ„ÅçÂá∫„Åô  
  2364  |     |    //                                                               
        |     |  +------------------------------+ 
  2365  |     +--+ while(OpcList-&gt;Count != 0){  | 
        |     |  +--+---------------------------+ 
  2366  |     |     +--- Token = (TToken *)OpcList-&gt;Items[OpcList-&gt;Count-1];
  2367  |     |     +--- TokStr = Token-&gt;Str;
        |     |     |  +--------------------------------+ 
  2368  |     |     +--+ if(Token-&gt;TokId == tid_Kakko){ | 
        |     |     |  +--+-----------------------------+ 
  2369  |     |     |     +--- MainF-&gt;ErrMessage(i,&quot;ÂØÉZÂøú„Åô„Çã')'„Åå„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ");
        |     |     |   +-+---+ 
  2370  |     |     |   |  }  | 
        |     |     |   +-----+ 
  2371  |     |     +--- DestList-&gt;Add((void *)Token);
  2372  |     |     +--- OpcList-&gt;Delete(OpcList-&gt;Count-1);
        |     |   +-+---+ 
  2373  |     |   |  }  | 
        |     |   +-----+ 
  2374  |     +--- //
  2375  |     |    // ÂÆüÈöõ„ÅÉáÊºîÁÉáó„ÇíÂÆüËÅBå„Åô„Çã„ÄÇ                                        
  2376  |     |    // Âûã„Å®„Åó„Å¶„ÅÉb„ÄÅ Int,Real„ÅÉáÔºíÁÉBÉáÈ°û„Å†„Åë„Çí„ÇÉI„Éù„Éº„Éà„Åô„Çã„ÄÇ  
  2377  |     |    // Ë´ñÁêÜÂûã„ÄÅËÅAáÁÉG†ÊïÅ[„ÄÅÊñáÂ≠óÂûã„ÅÉb„ÄÅ„Ç®„ÉÉD„ÉÉV„ÅÉB„Åó„Å¶ÊâÉA„ÅÜ„ÄÇ  
  2378  |     |    //                                                                             
  2379  |     +--- double stack[1024];
  2380  |     +--- double IntF[1024];
  2381  |     +--- int sp = 0;
  2382  |     |    
  2383  |     +--- EvalConstF = true;
        |     |  +------------------------------------------+ 
  2384  |     +--+ for(i = 0 ; i &lt; DestList-&gt;Count ; i++){  | 
        |     |  +--+---------------------------------------+ 
        |     |     |  +------------------+ 
  2385  |     |     +--+ if(!EvalConstF){ | 
        |     |     |  +--+---------------+ 
        |     |     |     |  +--------+ 
  2386  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |   +-+---+ 
  2387  |     |     |   |  }  | 
        |     |     |   +-----+ 
  2388  |     |     +--- Token = (TToken *)DestList-&gt;Items[i];
  2389  |     |     +--- TokStr = Token-&gt;Str;
        |     |     |  +------------------------+ 
  2390  |     |     +--+ switch(Token-&gt;TokId){  | 
        |     |     |  +--+---------------------+ 
        |     |     |     +---------------------------------+ 
  2391  |     |     |     |  case tid_ConstInt:  // ÂÆöÊï∞  | 
        |     |     |     +---------------------------------+ 
  2392  |     |     |     +--- IntF[sp] = true;
  2393  |     |     |     +--- stack[sp++] = Token-&gt;dData;
        |     |     |     |  +--------+ 
  2394  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +---------------------------------+ 
  2395  |     |     |     |  case tid_ConstReal: // ÂÆöÊï∞  | 
        |     |     |     +---------------------------------+ 
  2396  |     |     |     +--- IntF[sp] = false;
  2397  |     |     |     +--- stack[sp++] = Token-&gt;dData;
        |     |     |     |  +--------+ 
  2398  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-----------------+ 
  2399  |     |     |     |  case tid_Opr:  | 
        |     |     |     +-----------------+ 
        |     |     |     |  +--------------------------------------------------+ 
  2400  |     |     |     +--+ if(Token-&gt;priority == 10){ // ÂçòÈ†ÖÊÉVîÁÉáóÂÉÖê | 
        |     |     |     |  +--+-----------------------------------------------+ 
        |     |     |     |     |  +--------------+ 
  2401  |     |     |     |     +--+ if(sp &lt; 1){  | 
        |     |     |     |     |  +--+-----------+ 
  2402  |     |     |     |     |     +--- UseToken = -1;
        |     |     |     |     |     |  +--------+ 
  2403  |     |     |     |     |     +--+ break; | 
        |     |     |     |     |     |  +--------+ 
        |     |     |     |     |   +-+---+ 
  2404  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |     |  +--------------------+ 
  2405  |     |     |     |     +--+ if(TokStr == &quot;-&quot;){ | 
        |     |     |     |     |  +--+-----------------+ 
  2406  |     |     |     |     |     +--- stack[sp-1] = -stack[sp-1];
        |     |     |     |     |   +-+---+ 
  2407  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |     |  +--------+ 
  2408  |     |     |     |     +--+ break; | 
        |     |     |     |     |  +--------+ 
        |     |     |     |   +-+---+ 
  2409  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
  2410  |     |     |     +--- //
  2411  |     |     |     |    // ÔºíÈ†ÖÊÉVîÁÉáóÂÉÖê  
  2412  |     |     |     |    //                     
        |     |     |     |  +--------------+ 
  2413  |     |     |     +--+ if(sp &lt; 2){  | 
        |     |     |     |  +--+-----------+ 
  2414  |     |     |     |     +--- UseToken = -1;
        |     |     |     |     |  +--------+ 
  2415  |     |     |     |     +--+ break; | 
        |     |     |     |     |  +--------+ 
        |     |     |     |   +-+---+ 
  2416  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |     |  +--------------------+ 
  2417  |     |     |     +--+ if(TokStr == &quot;+&quot;){ | 
        |     |     |     |  +--+-----------------+ 
  2418  |     |     |     |     +--- stack[sp-2] = stack[sp-2] + stack[sp-1];
        |     |     |     |   +-+---+ 
  2419  |     |     |     |   |  }  | 
        |     |     |     |   +-+---+ 
        |     |     |     |   +-+-------------------------+ 
  2419  |     |     |     |   |  else if(TokStr == &quot;-&quot;){  | 
        |     |     |     |   +-+-------------------------+ 
  2420  |     |     |     |     +--- stack[sp-2] = stack[sp-2] - stack[sp-1];
        |     |     |     |   +-+---+ 
  2421  |     |     |     |   |  }  | 
        |     |     |     |   +-+---+ 
        |     |     |     |   +-+-------------------------+ 
  2421  |     |     |     |   |  else if(TokStr == &quot;*&quot;){  | 
        |     |     |     |   +-+-------------------------+ 
  2422  |     |     |     |     +--- stack[sp-2] = stack[sp-2] * stack[sp-1];
        |     |     |     |   +-+---+ 
  2423  |     |     |     |   |  }  | 
        |     |     |     |   +-+---+ 
        |     |     |     |   +-+-------------------------+ 
  2423  |     |     |     |   |  else if(TokStr == &quot;/&quot;){  | 
        |     |     |     |   +-+-------------------------+ 
        |     |     |     |     |  +------------------------------------------------+ 
  2424  |     |     |     |     +--+ if(stack[sp-1] == 0){   // 0ÈôÅAÁÆó„Ç®„ÉÉD„ÉÉV | 
        |     |     |     |     |  +--+---------------------------------------------+ 
  2425  |     |     |     |     |     +--- EvalConstF = false;
        |     |     |     |     |   +-+---+ 
  2426  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-+---+ 
        |     |     |     |     |   +-+-------+ 
  2426  |     |     |     |     |   |  else{  | 
        |     |     |     |     |   +-+-------+ 
  2427  |     |     |     |     |     +--- stack[sp-2] = stack[sp-2] / stack[sp-1];
        |     |     |     |     |   +-+---+ 
  2428  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |   +-+---+ 
  2429  |     |     |     |   |  }  | 
        |     |     |     |   +-+---+ 
        |     |     |     |   +-+-------------------------+ 
  2429  |     |     |     |   |  else if(TokStr == &quot;**&quot;){ | 
        |     |     |     |   +-+-------------------------+ 
  2430  |     |     |     |     +--- stack[sp-2] = pow(stack[sp-2],stack[sp-1]);
        |     |     |     |   +-+---+ 
  2431  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |     |  +--------------------------------+ 
  2432  |     |     |     +--+ if(IntF[sp-2] &amp;&amp; IntF[sp-1]){  | 
        |     |     |     |  +--+-----------------------------+ 
  2433  |     |     |     |     +--- stack[sp-2] = (int)stack[sp-2];
        |     |     |     |   +-+---+ 
  2434  |     |     |     |   |  }  | 
        |     |     |     |   +-+---+ 
        |     |     |     |   +-+-------+ 
  2434  |     |     |     |   |  else{  | 
        |     |     |     |   +-+-------+ 
  2435  |     |     |     |     +--- IntF[sp-2] = false;
        |     |     |     |   +-+---+ 
  2436  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
  2437  |     |     |     +--- sp--;
        |     |     |     |  +--------+ 
  2438  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-----------------------------------------------------+ 
  2439  |     |     |     |  default:    // „Éë„É©„ÉÅB„ÉÉV„ÇÉ\Â§âÊï∞„ÅÉáÂáÉíÁêÜ | 
        |     |     |     +-----------------------------------------------------+ 
        |     |     |     |  +----------------------------------------------------------------------------+ 
  2440  |     |     |     +--+ if((Token-&gt;ValData == NULL)||(!((TValData *)Token-&gt;ValData)-&gt;ParamValF)){  | 
        |     |     |     |  +--+-------------------------------------------------------------------------+ 
  2441  |     |     |     |     +--- EvalConstF = false;
        |     |     |     |   +-+---+ 
  2442  |     |     |     |   |  }  | 
        |     |     |     |   +-+---+ 
        |     |     |     |   +-+-------+ 
  2442  |     |     |     |   |  else{  | 
        |     |     |     |   +-+-------+ 
        |     |     |     |     |  +--------------------------------------------------------+ 
  2443  |     |     |     |     +--+ if(((TValData *)Token-&gt;ValData)-&gt;DataType == dt_Int){  | 
        |     |     |     |     |  +--+-----------------------------------------------------+ 
  2444  |     |     |     |     |     +--- IntF[sp] = true;
        |     |     |     |     |   +-+---+ 
  2445  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-+---+ 
        |     |     |     |     |   +-+-------+ 
  2445  |     |     |     |     |   |  else{  | 
        |     |     |     |     |   +-+-------+ 
  2446  |     |     |     |     |     +--- IntF[sp] = false;
        |     |     |     |     |   +-+---+ 
  2447  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |   +-+---+ 
  2448  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
  2449  |     |     |     +--- stack[sp++] = Token-&gt;dData;
        |     |     |     |  +--------+ 
  2450  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |   +-+---+ 
  2451  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |   +-+---+ 
  2452  |     |   |  }  | 
        |     |   +-----+ 
        |     |  +--------------+ 
  2453  |     +--+ if(sp != 1){ | 
        |     |  +--+-----------+ 
  2454  |     |     +--- EvalConstF = false;
        |     |   +-+---+ 
  2455  |     |   |  }  | 
        |     |   +-----+ 
  2456  |     +--- *dData = stack[0]; // ÊúÄÂæå„ÅÆ„ÇÉP„ÇÉ\„ÉÉ„ÇØ„ÅåÂÄÅA„ÅÉB„ÅÉF„Çã„ÄÇ
  2457  |     |                                                                       
  2458  |     +--- delete DestList;
  2459  |     +--- delete OpcList;
        |     |  +------------------+ 
  2460  |     +--+ return UseToken; | 
        |     |  +------------------+ 
        |   +-+---+ 
  2461  |   |  }  | 
        |   +-----+ 
  2462  |    
  2463  +--- /*----------------------------------------------------------------------------*/
  2464  |    //                                                                                                                       
  2465  |    //  1.ÊóÅEÊúÉÉË™ûÂêç                                                                                                     
  2466  |    //                                                                                                                       
  2467  |    //  2.„Éë„É©„ÉÅB„ÇÉ\Ë™ÉÉÊòé                                                                                              
  2468  |    //    TokenList   „Éà„Éº„ÇÉb„ÉÉE„ÉÉF„ÇÉP„Éà                                                                              
  2469  |    //    sPos    ÈñãÂÉ@ã‰ÉXçÁÉXÉá                                                                                           
  2470  |    //    ePos    ÁµÇ‰ÉRÜ‰ÉXçÁÉXÉá                                                                                           
  2471  |    //                                                                                                                       
  2472  |    //  3.Ê¶ÇËÉíÅ                                                                                                            
  2473  |    //    ÊöóÈÉTô„ÅÆÂûãÂÉáÅvË®Ä„ÅÉáÂ§âÊõ¥                                                                                    
  2474  |    //    ÊöóÈÉTô„ÅÆÂûãÂÉáÅvË®Ä„ÅÉáÂ§âÊõ¥„ÅÉH‰ºÉG„ÅÅv„ÅÉí„ÄÅÊöóÈªô„ÅÆÂûãÂÉáÅvË®Ä„ÉÜ„Éº„Éñ„É´„ÅÉáÂÜÖÂÉáÉP„ÇíÂÅAâÊõ¥„Åô„Çã„ÄÇ  
  2475  |    //                                                                                                                       
  2476  |    //     „ÄÄIMPLICIT NONE„ÄÅ                                                                                               
  2477  |    //     „ÄÄIMPLICIT ÂûãÊåáÂÆöÂÉÖê(x1,x2-x3,‚ÄÉí)                                                                          
  2478  |    //                                                                                                                       
  2479  |    //  4.Ê©üËÉΩË™ÉÉÊòé                                                                                                      
  2480  |    //                                                                                                                       
  2481  |    //  5.ÊàÉT„ÇäÂÄÅA                                                                                                        
  2482  |    //                                                                                                                       
  2483  |    //  6.ÂÇôËÄÉ                                                                                                             
  2484  |    //                                                                                                                       
  2485  |    /*----------------------------------------------------------------------------*/                                         
        |  +----------------------------------------------------+ 
  2486  +--+ void IMPLICIT(TList *TokenList,int sPos,int ePos)  | 
  2487  |  | {                                                  | 
        |  +--+-------------------------------------------------+ 
  2488  |     +--- TToken *Token;
  2489  |     +--- int i,j;
  2490  |     +--- int Nest;
  2491  |     +--- char c,c2;
  2492  |     +--- Enum_DataType Type;
  2493  |     |    
  2494  |     +--- Nest = 0;
  2495  |     +--- c = 0;
  2496  |     +--- Type = dt_Real;
  2497  |     +--- //  for(i = sPos; i &lt;= ePos ; i++){
        |     |  +--------------------------------+ 
  2498  |     +--+ for(i = sPos; i &lt; ePos ; i++){ | 
        |     |  +--+-----------------------------+ 
  2499  |     |     +--- Token = (TToken *)TokenList-&gt;Items[i];
        |     |     |  +----------------------------------+ 
  2500  |     |     +--+ if(Token-&gt;TokId == tid_INTEGER){ | 
        |     |     |  +--+-------------------------------+ 
  2501  |     |     |     +--- Type = dt_Int;
        |     |     |   +-+---+ 
  2502  |     |     |   |  }  | 
        |     |     |   +-+---+ 
        |     |     |   +-+-----------------------------------+ 
  2502  |     |     |   |  else if(Token-&gt;TokId == tid_REAL){ | 
        |     |     |   +-+-----------------------------------+ 
  2503  |     |     |     +--- Type = dt_Real;
        |     |     |   +-+---+ 
  2504  |     |     |   |  }  | 
        |     |     |   +-+---+ 
        |     |     |   +-+-----------------------------------------------+ 
  2504  |     |     |   |  else if(Token-&gt;TokId == tid_DOUBLEPRECISION){  | 
        |     |     |   +-+-----------------------------------------------+ 
  2505  |     |     |     +--- Type = dt_Real;
        |     |     |   +-+---+ 
  2506  |     |     |   |  }  | 
        |     |     |   +-+---+ 
        |     |     |   +-+-----------------------------------------+ 
  2506  |     |     |   |  else if(Token-&gt;TokId == tid_CHARACTER){  | 
        |     |     |   +-+-----------------------------------------+ 
  2507  |     |     |     +--- Type = dt_Char;
        |     |     |   +-+---+ 
  2508  |     |     |   |  }  | 
        |     |     |   +-+---+ 
        |     |     |   +-+---------------------------------------+ 
  2508  |     |     |   |  else if(Token-&gt;TokId == tid_LOGICAL){  | 
        |     |     |   +-+---------------------------------------+ 
  2509  |     |     |     +--- Type = dt_Logic;
        |     |     |   +-+---+ 
  2510  |     |     |   |  }  | 
        |     |     |   +-+---+ 
        |     |     |   +-+---------------------------------------+ 
  2510  |     |     |   |  else if(Token-&gt;TokId == tid_COMPLEX){  | 
        |     |     |   +-+---------------------------------------+ 
  2511  |     |     |     +--- Type = dt_Complex;
        |     |     |   +-+---+ 
  2512  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +--------------------------------+ 
  2513  |     |     +--+ if(Token-&gt;TokId == tid_Kakko){ | 
        |     |     |  +--+-----------------------------+ 
  2514  |     |     |     +--- Nest++;
        |     |     |   +-+---+ 
  2515  |     |     |   |  }  | 
        |     |     |   +-+---+ 
        |     |     |   +-+-------------------------------------+ 
  2515  |     |     |   |  else if(Token-&gt;TokId == tid_Kokka){  | 
        |     |     |   +-+-------------------------------------+ 
  2516  |     |     |     +--- Nest--;
        |     |     |   +-+---+ 
  2517  |     |     |   |  }  | 
        |     |     |   +-+---+ 
        |     |     |   +-+-----------------------------+ 
  2517  |     |     |   |  else if(Token-&gt;Str == &quot;-&quot;){  | 
        |     |     |   +-+-----------------------------+ 
  2518  |     |     |     +--- Nest--;
  2519  |     |     |     +--- Token = (TToken *)TokenList-&gt;Items[++i];
  2520  |     |     |     +--- c2 = LowerCase(Token-&gt;Str)[0];
        |     |     |     |  +------------------------------+ 
  2521  |     |     |     +--+ if((c2 &lt; 'a')||(c2 &gt; 'z')){  | 
        |     |     |     |  +--+---------------------------+ 
  2522  |     |     |     |     +--- c2 = 'z';
        |     |     |     |   +-+---+ 
  2523  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |     |  +------------------------------+ 
  2524  |     |     |     +--+ for(j = c ; j &lt;= c2 ; j++){  | 
        |     |     |     |  +--+---------------------------+ 
  2525  |     |     |     |     +--- ImplType[j] = Type;
  2526  |     |     |     |     +--- ImplType[j+'A'-'a'] = Type;
        |     |     |     |   +-+---+ 
  2527  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |   +-+---+ 
  2528  |     |     |   |  }  | 
        |     |     |   +-+---+ 
        |     |     |   +-+-------------------------------------------+ 
  2528  |     |     |   |  else if(LowerCase(Token-&gt;Str) == &quot;none&quot;){  | 
        |     |     |   +-+-------------------------------------------+ 
        |     |     |     |  +--------+ 
  2529  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |   +-+---+ 
  2530  |     |     |   |  }  | 
        |     |     |   +-+---+ 
        |     |     |   +-+-----------------------------+ 
  2530  |     |     |   |  else if(Token-&gt;Str == &quot;,&quot;){  | 
        |     |     |   +-+-----------------------------+ 
  2531  |     |     |     +--- c = 0;
        |     |     |   +-+---+ 
  2532  |     |     |   |  }  | 
        |     |     |   +-+---+ 
        |     |     |   +-+-------+ 
  2532  |     |     |   |  else{  | 
        |     |     |   +-+-------+ 
  2533  |     |     |     +--- c = LowerCase(Token-&gt;Str)[0];
  2534  |     |     |     +--- ImplType[(int)c] = Type;
  2535  |     |     |     +--- ImplType[(int)c+'A'-'a'] = Type;
        |     |     |   +-+---+ 
  2536  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |   +-+---+ 
  2537  |     |   |  }  | 
        |     |   +-----+ 
        |   +-+---+ 
  2538  |   |  }  | 
        |   +-----+ 
  2539  +--- /*----------------------------------------------------------------------------*/
  2540  |    //                                                                               
  2541  |    //  1.ÊóÅEÊúÉÉË™ûÂêç                                                             
  2542  |    //                                                                               
  2543  |    //  2.„Éë„É©„ÉÅB„ÇÉ\Ë™ÉÉÊòé                                                      
  2544  |    //                                                                               
  2545  |    //  3.Ê¶ÇËÉíÅ                                                                    
  2546  |    //    Â§âÊï∞„ÅÉáÂÆöÁÉZÉDÊñáÂÉÖóÂàó„ÇíËÉ\î„Åô„ÄÇFortranË®ÄË™ûÁî®                  
  2547  |    //                                                                               
  2548  |    //  4.Ê©üËÉΩË™ÉÉÊòé                                                              
  2549  |    //                                                                               
  2550  |    //  5.ÊàÉT„ÇäÂÄÅA                                                                
  2551  |    //    ÂÆöÁÉZÉDÊñáÂÉÖóÂàó                                                         
  2552  |    //                                                                               
  2553  |    //  6.ÂÇôËÄÉ                                                                     
  2554  |    //                                                                               
  2555  |    /*----------------------------------------------------------------------------*/ 
        |  +--------------------------------------+ 
  2556  +--+ string TValData::GetDefStr_Fortran() | 
  2557  |  | {                                    | 
        |  +--+-----------------------------------+ 
  2558  |     +--- int j;
  2559  |     +--- string s;
  2560  |     +--- TToken *Token;
  2561  |     |    
  2562  |     +--- s = &quot;&quot;;
        |     |  +--------------------+ 
  2563  |     +--+ if(DefStr1 != &quot;&quot;){ | 
        |     |  +--+-----------------+ 
  2564  |     |     +--- s = Trim(DefStr1 + DefStr2);
  2565  |     |     +--- // Â§âÊï∞„ÅåÊúÄÂàù„Å´ÂáÉRÁèÉZ„Åô„Çã‰ΩçÁÉXÉá DefPos„Åã„ÇâÂâç„Å´„ÇÉP„ÇÉÖ„ÉÅv„ÉÉE„Åó„Å¶„ÄÅ
  2566  |     |     |    // Â§âÊï∞„ÇÑÈñ¢ÊïÅ[‰ªÅEÂ§ñ„ÅåÁèÉZ„Çå„ÇãÂâç„Å´ÊîÉPË°å„Åå„ÅÇ„Çå„ÅÅ[„ÄÅÊîπË°åÔÉVãÁÉDÉRÁôÉX„ÇíÂê´„Çì„Å†DefStr1„Çí‰ÉXÉ\ÁîÉB„Åó  
  2567  |     |     |    // ÂÖÉ„ÅÆ„ÇÉX„ÉÉV„ÇÉP„ÅÉHËøë„ÅÑÂΩÅu„ÅÉH„Åô„Çã„ÄÇ                                                                           
        |     |     |  +------------------------------------+ 
  2568  |     |     +--+ for(j = DefPos-1 ; j &gt;= 0 ; j--){  | 
        |     |     |  +--+---------------------------------+ 
  2569  |     |     |     +--- Token = (TToken *)MainF-&gt;TokenList-&gt;Items[j];
        |     |     |     |  +------------------------------------------------------------+ 
  2570  |     |     |     +--+ if((Token-&gt;TokId == tid_Val)||(Token-&gt;TokId == tid_Func)){ | 
        |     |     |     |  +--+---------------------------------------------------------+ 
        |     |     |     |     |  +--------+ 
  2571  |     |     |     |     +--+ break; | 
        |     |     |     |     |  +--------+ 
        |     |     |     |   +-+---+ 
  2572  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |     |  +----------------------------------+ 
  2573  |     |     |     +--+ if(Token-&gt;TokId == tid_LineEnd){ | 
        |     |     |     |  +--+-------------------------------+ 
        |     |     |     |     |  +------------------------------------------+ 
  2574  |     |     |     |     +--+ if(DefStr1.find('\n') == string::npos){  | 
        |     |     |     |     |  +--+---------------------------------------+ 
  2575  |     |     |     |     |     +--- s = &quot;\n&quot;+ DefStr1+Trim(DefStr2);
        |     |     |     |     |   +-+---+ 
  2576  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-+---+ 
        |     |     |     |     |   +-+-------+ 
  2576  |     |     |     |     |   |  else{  | 
        |     |     |     |     |   +-+-------+ 
  2577  |     |     |     |     |     +--- s = DefStr1+Trim(DefStr2);
        |     |     |     |     |   +-+---+ 
  2578  |     |     |     |     |   |  }  | 
        |     |     |     |     |   +-----+ 
        |     |     |     |   +-+---+ 
  2579  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
        |     |     |   +-+---+ 
  2580  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |     |  +------------------------------------------+ 
  2581  |     |     +--+ if((s == &quot;&quot;)||(s[s.length()-1] != '*')){ | 
        |     |     |  +--+---------------------------------------+ 
  2582  |     |     |     +--- s = s+ &quot; &quot;;
        |     |     |   +-+---+ 
  2583  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |   +-+---+ 
  2584  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-------------------------+ 
  2584  |     |   |  else if(DefPosS != -1){  | 
        |     |   +-+-------------------------+ 
        |     |     |  +----------------------------------------+ 
  2585  |     |     +--+ for(j = DefPosS ; j &lt; DefPosE ; j++){  | 
        |     |     |  +--+-------------------------------------+ 
  2586  |     |     |     +--- Token = (TToken *)MainF-&gt;TokenList-&gt;Items[j];
        |     |     |     |  +----------------------------------------------------------------------+ 
  2587  |     |     |     +--+ if((Token-&gt;TokId == tid_Kannma)&amp;&amp;(j+1 &lt; DefPosE)&amp;&amp;                   | 
  2588  |     |     |     |  |     (((TToken *)MainF-&gt;TokenList-&gt;Items[j+1])-&gt;TokId == tid_SAVE)){  | 
        |     |     |     |  +--+-------------------------------------------------------------------+ 
  2589  |     |     |     |     +--- // , Save „ÅÉb„ÇÉP„ÇÉÖ„ÉÉ„Éó„Åô„Çã„ÄÇ
  2590  |     |     |     |     +--- j++;
        |     |     |     |     |  +------------+ 
  2591  |     |     |     |     +--+ continue;  | 
        |     |     |     |     |  +------------+ 
        |     |     |     |   +-+---+ 
  2592  |     |     |     |   |  }  | 
        |     |     |     |   +-----+ 
  2593  |     |     |     +--- s += Token-&gt;OrgStr;
        |     |     |   +-+---+ 
  2594  |     |     |   |  }  | 
        |     |     |   +-----+ 
        |     |   +-+---+ 
  2595  |     |   |  }  | 
        |     |   +-+---+ 
        |     |   +-+-------+ 
  2595  |     |   |  else{  | 
        |     |   +-+-------+ 
  2596  |     |     +--- // ÂÆöÁÉZÉDÊñáÂÉÖó„Åå„ÅÉF„ÅÑÂ†ÉGÂêà„ÅØ„ÄÅÊöóÈªô„ÅÆ‰∫ÜËÉ@Åv„ÅÉB„Åó„Å¶‰ΩúÊàê„Åó„Å¶Ëøî„Åô„ÄÇ
  2597  |     |     |    // ÂÖàÈ†ÉÖ„ÅÉáÁ©ÉRÁôÉX„ÅÉb„ÄÅÔÉVñÊñáÂ≠óÔÉVà„Éá„Éï„Ç©„ÉÉH„ÉàÔÉVâ„Å®„Åô„Çã„ÄÇ                
        |     |     |  +--------------------+ 
  2598  |     |     +--+ switch(DataType){  | 
        |     |     |  +--+-----------------+ 
        |     |     |     +---------------+ 
  2599  |     |     |     |  case dt_Int: | 
        |     |     |     +---------------+ 
  2600  |     |     |     +--- s += &quot;integer&quot;;
        |     |     |     |  +--------+ 
  2601  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-----------------+ 
  2602  |     |     |     |  case dt_Real:  | 
        |     |     |     +-----------------+ 
  2603  |     |     |     +--- s += &quot;real&quot;;
        |     |     |     |  +--------+ 
  2604  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-----------------+ 
  2605  |     |     |     |  case dt_Char:  | 
        |     |     |     +-----------------+ 
  2606  |     |     |     +--- s += &quot;character&quot;;
        |     |     |     |  +--------+ 
  2607  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-----------------+ 
  2608  |     |     |     |  case dt_Logic: | 
        |     |     |     +-----------------+ 
  2609  |     |     |     +--- s += &quot;logical&quot;;
        |     |     |     |  +--------+ 
  2610  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-------------------+ 
  2611  |     |     |     |  case dt_Complex: | 
        |     |     |     +-------------------+ 
  2612  |     |     |     +--- s += &quot;complex&quot;;
        |     |     |     |  +--------+ 
  2613  |     |     |     +--+ break; | 
        |     |     |     |  +--------+ 
        |     |     |     +-----------+ 
  2614  |     |     |     |  default: | 
        |     |     |     +-----------+ 
        |     |     |     |  +------------+ 
  2615  |     |     |     +--+ return &quot;&quot;; | 
        |     |     |     |  +------------+ 
        |     |     |   +-+---+ 
  2616  |     |     |   |  }  | 
        |     |     |   +-----+ 
  2617  |     |     +--- s = &quot;      &quot;+s;
        |     |   +-+---+ 
  2618  |     |   |  }  | 
        |     |   +-----+ 
        |     |  +------------+ 
  2619  |     +--+ return s;  | 
        |     |  +------------+ 
        |   +-+---+ 
  2620  |   |  }  | 
        |   +-----+ 
  2621  +--- /*----------------------------------------------------------------------------*/
  2622  |    //                                                                               
  2623  |    //  1.ÊóÅEÊúÉÉË™ûÂêç                                                             
  2624  |    //                                                                               
  2625  |    //  2.„Éë„É©„ÉÅB„ÇÉ\Ë™ÉÉÊòé                                                      
  2626  |    //                                                                               
  2627  |    //  3.Ê¶ÇËÉíÅ                                                                    
  2628  |    //    Â§âÊï∞„ÅÉáÂÆöÁÉZÉDÊñáÂÉÖóÂàó„ÇíËÉ\î„Åô„ÄÇCË®ÄË™ûÁî®                        
  2629  |    //                                                                               
  2630  |    //  4.Ê©üËÉΩË™ÉÉÊòé                                                              
  2631  |    //                                                                               
  2632  |    //  5.ÊàÉT„ÇäÂÄÅA                                                                
  2633  |    //    ÂÆöÁÉZÉDÊñáÂÉÖóÂàó                                                         
  2634  |    //                                                                               
  2635  |    //  6.ÂÇôËÄÉ                                                                     
  2636  |    //                                                                               
  2637  |    /*----------------------------------------------------------------------------*/ 
        |  +--------------------------------+ 
  2638  +--+ string TValData::GetDefStr_C() | 
  2639     | {                              | 
           +--+-----------------------------+ 
  2640        +--- int j;
  2641        +--- string s,s2;
  2642        +--- TToken *Token;
  2643        |    
  2644        +--- s = &quot;&quot;;
              |  +--------------------+ 
  2645        +--+ if(DefStr1 != &quot;&quot;){ | 
              |  +--+-----------------+ 
  2646        |     +--- s = Trim(DefStr1 + DefStr2);
  2647        |     +--- // Â§âÊï∞„ÅåÊúÄÂàù„Å´ÂáÉRÁèÉZ„Åô„Çã‰ΩçÁÉXÉá DefPos„Åã„ÇâÂâç„Å´„ÇÉP„ÇÉÖ„ÉÅv„ÉÉE„Åó„Å¶„ÄÅ
  2648        |     |    // Â§âÊï∞„ÇÑÈñ¢ÊïÅ[‰ªÅEÂ§ñ„ÅåÁèÉZ„Çå„ÇãÂâç„Å´ÊîÉPË°å„Åå„ÅÇ„Çå„ÅÅ[„ÄÅÊîπË°åÔÉVãÁÉDÉRÁôÉX„ÇíÂê´„Çì„Å†DefStr1„Çí‰ÉXÉ\ÁîÉB„Åó  
  2649        |     |    // ÂÖÉ„ÅÆ„ÇÉX„ÉÉV„ÇÉP„ÅÉHËøë„ÅÑÂΩÅu„ÅÉH„Åô„Çã„ÄÇ                                                                           
              |     |  +------------------------------------+ 
  2650        |     +--+ for(j = DefPos-1 ; j &gt;= 0 ; j--){  | 
              |     |  +--+---------------------------------+ 
  2651        |     |     +--- Token = (TToken *)MainF-&gt;TokenList-&gt;Items[j];
              |     |     |  +------------------------------------------------------------+ 
  2652        |     |     +--+ if((Token-&gt;TokId == tid_Val)||(Token-&gt;TokId == tid_Func)){ | 
              |     |     |  +--+---------------------------------------------------------+ 
              |     |     |     |  +--------+ 
  2653        |     |     |     +--+ break; | 
              |     |     |     |  +--------+ 
              |     |     |   +-+---+ 
  2654        |     |     |   |  }  | 
              |     |     |   +-----+ 
              |     |     |  +----------------------------------+ 
  2655        |     |     +--+ if(Token-&gt;TokId == tid_LineEnd){ | 
              |     |     |  +--+-------------------------------+ 
              |     |     |     |  +------------------------------------------+ 
  2656        |     |     |     +--+ if(DefStr1.find('\n') == string::npos){  | 
              |     |     |     |  +--+---------------------------------------+ 
  2657        |     |     |     |     +--- s = &quot;\n&quot;+ DefStr1+Trim(DefStr2);
              |     |     |     |   +-+---+ 
  2658        |     |     |     |   |  }  | 
              |     |     |     |   +-+---+ 
              |     |     |     |   +-+-------+ 
  2658        |     |     |     |   |  else{  | 
              |     |     |     |   +-+-------+ 
  2659        |     |     |     |     +--- s = DefStr1+Trim(DefStr2);
              |     |     |     |   +-+---+ 
  2660        |     |     |     |   |  }  | 
              |     |     |     |   +-----+ 
              |     |     |   +-+---+ 
  2661        |     |     |   |  }  | 
              |     |     |   +-----+ 
              |     |   +-+---+ 
  2662        |     |   |  }  | 
              |     |   +-----+ 
              |     |  +------------------------------------------+ 
  2663        |     +--+ if((s == &quot;&quot;)||(s[s.length()-1] != '*')){ | 
              |     |  +--+---------------------------------------+ 
  2664        |     |     +--- s = s+ &quot; &quot;;
              |     |   +-+---+ 
  2665        |     |   |  }  | 
              |     |   +-----+ 
              |   +-+---+ 
  2666        |   |  }  | 
              |   +-+---+ 
              |   +-+-------+ 
  2666        |   |  else{  | 
              |   +-+-------+ 
  2667        |     +--- // ÂÆöÁÉZÉDÊñáÂÉÖó„Åå„ÅÉF„ÅÑÂ†ÉGÂêà„ÅØ‰ΩúÊàê„Åó„Å¶Ëøî„Åô„ÄÇ‰ÉNÄÊôÇÂÅAâÊï∞Á≠â„Åß‰ΩÉ\ÁîÉB„Åï„Çå„Çã„ÄÇ
              |     |  +--------------------+ 
  2668        |     +--+ switch(DataType){  | 
              |     |  +--+-----------------+ 
              |     |     +---------------+ 
  2669        |     |     |  case dt_Int: | 
              |     |     +---------------+ 
  2670        |     |     +--- s += &quot;int&quot;;
              |     |     |  +--------+ 
  2671        |     |     +--+ break; | 
              |     |     |  +--------+ 
              |     |     +-----------------+ 
  2672        |     |     |  case dt_Real:  | 
              |     |     +-----------------+ 
  2673        |     |     +--- s += &quot;double&quot;;
              |     |     |  +--------+ 
  2674        |     |     +--+ break; | 
              |     |     |  +--------+ 
              |     |     +-----------------+ 
  2675        |     |     |  case dt_Char:  | 
              |     |     +-----------------+ 
  2676        |     |     +--- s += &quot;char &quot;;
              |     |     |  +--------+ 
  2677        |     |     +--+ break; | 
              |     |     |  +--------+ 
              |     |     +-----------------+ 
  2678        |     |     |  case dt_Logic: | 
              |     |     +-----------------+ 
  2679        |     |     +--- s += &quot;logical&quot;;
              |     |     |  +--------+ 
  2680        |     |     +--+ break; | 
              |     |     |  +--------+ 
              |     |     +-------------------+ 
  2681        |     |     |  case dt_Complex: | 
              |     |     +-------------------+ 
  2682        |     |     +--- s += &quot;complex&quot;;
              |     |     |  +--------+ 
  2683        |     |     +--+ break; | 
              |     |     |  +--------+ 
              |     |     +-----------------+ 
  2684        |     |     |  case dt_Float: | 
              |     |     +-----------------+ 
  2685        |     |     +--- s += &quot;float&quot;;
              |     |     |  +--------+ 
  2686        |     |     +--+ break; | 
              |     |     |  +--------+ 
              |     |     +-----------+ 
  2687        |     |     |  default: | 
              |     |     +-----------+ 
              |     |     |  +----------------+ 
  2688        |     |     +--+ return &quot;int&quot;;  | 
              |     |     |  +----------------+ 
              |     |   +-+---+ 
  2689        |     |   |  }  | 
              |     |   +-----+ 
  2690        |     +--- s = s+&quot; &quot;;
              |   +-+---+ 
  2691        |   |  }  | 
              |   +-----+ 
              |  +------------+ 
  2692        +--+ return s;  | 
              |  +------------+ 
            +-+---+ 
  2693      |  }  | 
            +-----+ 
</pre>


</body>
</html>
